(function(h,mt){typeof exports=="object"&&typeof module<"u"?mt(exports):typeof define=="function"&&define.amd?define(["exports"],mt):(h=typeof globalThis<"u"?globalThis:h||self,mt(h["nitro-renderer"]={}))})(this,function(h){"use strict";function mt(r,e,t,s){function i(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function o(d){try{l(s.next(d))}catch(c){a(c)}}function u(d){try{l(s.throw(d))}catch(c){a(c)}}function l(d){d.done?n(d.value):i(d.value).then(o,u)}l((s=s.apply(r,e||[])).next())})}typeof SuppressedError=="function"&&SuppressedError;/*!
 * @pixi/constants - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Si;(function(r){r[r.WEBGL_LEGACY=0]="WEBGL_LEGACY",r[r.WEBGL=1]="WEBGL",r[r.WEBGL2=2]="WEBGL2"})(Si||(Si={}));var Jo;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.WEBGL=1]="WEBGL",r[r.CANVAS=2]="CANVAS"})(Jo||(Jo={}));var cl;(function(r){r[r.COLOR=16384]="COLOR",r[r.DEPTH=256]="DEPTH",r[r.STENCIL=1024]="STENCIL"})(cl||(cl={}));var se;(function(r){r[r.NORMAL=0]="NORMAL",r[r.ADD=1]="ADD",r[r.MULTIPLY=2]="MULTIPLY",r[r.SCREEN=3]="SCREEN",r[r.OVERLAY=4]="OVERLAY",r[r.DARKEN=5]="DARKEN",r[r.LIGHTEN=6]="LIGHTEN",r[r.COLOR_DODGE=7]="COLOR_DODGE",r[r.COLOR_BURN=8]="COLOR_BURN",r[r.HARD_LIGHT=9]="HARD_LIGHT",r[r.SOFT_LIGHT=10]="SOFT_LIGHT",r[r.DIFFERENCE=11]="DIFFERENCE",r[r.EXCLUSION=12]="EXCLUSION",r[r.HUE=13]="HUE",r[r.SATURATION=14]="SATURATION",r[r.COLOR=15]="COLOR",r[r.LUMINOSITY=16]="LUMINOSITY",r[r.NORMAL_NPM=17]="NORMAL_NPM",r[r.ADD_NPM=18]="ADD_NPM",r[r.SCREEN_NPM=19]="SCREEN_NPM",r[r.NONE=20]="NONE",r[r.SRC_OVER=0]="SRC_OVER",r[r.SRC_IN=21]="SRC_IN",r[r.SRC_OUT=22]="SRC_OUT",r[r.SRC_ATOP=23]="SRC_ATOP",r[r.DST_OVER=24]="DST_OVER",r[r.DST_IN=25]="DST_IN",r[r.DST_OUT=26]="DST_OUT",r[r.DST_ATOP=27]="DST_ATOP",r[r.ERASE=26]="ERASE",r[r.SUBTRACT=28]="SUBTRACT",r[r.XOR=29]="XOR"})(se||(se={}));var Hr;(function(r){r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(Hr||(Hr={}));var Z;(function(r){r[r.RGBA=6408]="RGBA",r[r.RGB=6407]="RGB",r[r.RG=33319]="RG",r[r.RED=6403]="RED",r[r.RGBA_INTEGER=36249]="RGBA_INTEGER",r[r.RGB_INTEGER=36248]="RGB_INTEGER",r[r.RG_INTEGER=33320]="RG_INTEGER",r[r.RED_INTEGER=36244]="RED_INTEGER",r[r.ALPHA=6406]="ALPHA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(Z||(Z={}));var Vn;(function(r){r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"})(Vn||(Vn={}));var He;(function(r){r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.UNSIGNED_INT=5125]="UNSIGNED_INT",r[r.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",r[r.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",r[r.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",r[r.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",r[r.BYTE=5120]="BYTE",r[r.SHORT=5122]="SHORT",r[r.INT=5124]="INT",r[r.FLOAT=5126]="FLOAT",r[r.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",r[r.HALF_FLOAT=36193]="HALF_FLOAT"})(He||(He={}));var _l;(function(r){r[r.FLOAT=0]="FLOAT",r[r.INT=1]="INT",r[r.UINT=2]="UINT"})(_l||(_l={}));var Ds;(function(r){r[r.NEAREST=0]="NEAREST",r[r.LINEAR=1]="LINEAR"})(Ds||(Ds={}));var Ai;(function(r){r[r.CLAMP=33071]="CLAMP",r[r.REPEAT=10497]="REPEAT",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"})(Ai||(Ai={}));var ln;(function(r){r[r.OFF=0]="OFF",r[r.POW2=1]="POW2",r[r.ON=2]="ON",r[r.ON_MANUAL=3]="ON_MANUAL"})(ln||(ln={}));var cn;(function(r){r[r.NPM=0]="NPM",r[r.UNPACK=1]="UNPACK",r[r.PMA=2]="PMA",r[r.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",r[r.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",r[r.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",r[r.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"})(cn||(cn={}));var _n;(function(r){r[r.NO=0]="NO",r[r.YES=1]="YES",r[r.AUTO=2]="AUTO",r[r.BLEND=0]="BLEND",r[r.CLEAR=1]="CLEAR",r[r.BLIT=2]="BLIT"})(_n||(_n={}));var dl;(function(r){r[r.AUTO=0]="AUTO",r[r.MANUAL=1]="MANUAL"})(dl||(dl={}));var ks;(function(r){r.LOW="lowp",r.MEDIUM="mediump",r.HIGH="highp"})(ks||(ks={}));var Dt;(function(r){r[r.NONE=0]="NONE",r[r.SCISSOR=1]="SCISSOR",r[r.STENCIL=2]="STENCIL",r[r.SPRITE=3]="SPRITE",r[r.COLOR=4]="COLOR"})(Dt||(Dt={}));var II;(function(r){r[r.RED=1]="RED",r[r.GREEN=2]="GREEN",r[r.BLUE=4]="BLUE",r[r.ALPHA=8]="ALPHA"})(II||(II={}));var lt;(function(r){r[r.NONE=0]="NONE",r[r.LOW=2]="LOW",r[r.MEDIUM=4]="MEDIUM",r[r.HIGH=8]="HIGH"})(lt||(lt={}));var kr;(function(r){r[r.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",r[r.ARRAY_BUFFER=34962]="ARRAY_BUFFER",r[r.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"})(kr||(kr={}));/*!
 * @pixi/settings - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var zY={createCanvas:function(r,e){var t=document.createElement("canvas");return t.width=r,t.height=e,t},getWebGLRenderingContext:function(){return WebGLRenderingContext},getNavigator:function(){return navigator},getBaseUrl:function(){var r;return(r=document.baseURI)!==null&&r!==void 0?r:window.location.href},fetch:function(r,e){return fetch(r,e)}},ld=/iPhone/i,TI=/iPod/i,RI=/iPad/i,vI=/\biOS-universal(?:.+)Mac\b/i,cd=/\bAndroid(?:.+)Mobile\b/i,OI=/Android/i,Ha=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,fl=/Silk/i,yi=/Windows Phone/i,SI=/\bWindows(?:.+)ARM\b/i,AI=/BlackBerry/i,yI=/BB10/i,CI=/Opera Mini/i,MI=/\b(CriOS|Chrome)(?:.+)Mobile/i,PI=/Mobile(?:.+)Firefox\b/i,NI=function(r){return typeof r<"u"&&r.platform==="MacIntel"&&typeof r.maxTouchPoints=="number"&&r.maxTouchPoints>1&&typeof MSStream>"u"};function XY(r){return function(e){return e.test(r)}}function KY(r){var e={userAgent:"",platform:"",maxTouchPoints:0};!r&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof r=="string"?e.userAgent=r:r&&r.userAgent&&(e={userAgent:r.userAgent,platform:r.platform,maxTouchPoints:r.maxTouchPoints||0});var t=e.userAgent,s=t.split("[FBAN");typeof s[1]<"u"&&(t=s[0]),s=t.split("Twitter"),typeof s[1]<"u"&&(t=s[0]);var i=XY(t),n={apple:{phone:i(ld)&&!i(yi),ipod:i(TI),tablet:!i(ld)&&(i(RI)||NI(e))&&!i(yi),universal:i(vI),device:(i(ld)||i(TI)||i(RI)||i(vI)||NI(e))&&!i(yi)},amazon:{phone:i(Ha),tablet:!i(Ha)&&i(fl),device:i(Ha)||i(fl)},android:{phone:!i(yi)&&i(Ha)||!i(yi)&&i(cd),tablet:!i(yi)&&!i(Ha)&&!i(cd)&&(i(fl)||i(OI)),device:!i(yi)&&(i(Ha)||i(fl)||i(cd)||i(OI))||i(/\bokhttp\b/i)},windows:{phone:i(yi),tablet:i(SI),device:i(yi)||i(SI)},other:{blackberry:i(AI),blackberry10:i(yI),opera:i(CI),firefox:i(PI),chrome:i(MI),device:i(AI)||i(yI)||i(CI)||i(PI)||i(MI)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}var jn=KY(globalThis.navigator);function qY(){return!jn.apple.device}function QY(r){var e=!0;if(jn.tablet||jn.phone){if(jn.apple.device){var t=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(t){var s=parseInt(t[1],10);s<11&&(e=!1)}}if(jn.android.device){var t=navigator.userAgent.match(/Android\s([0-9.]*)/);if(t){var s=parseInt(t[1],10);s<7&&(e=!1)}}}return e?r:4}var J={ADAPTER:zY,MIPMAP_TEXTURES:ln.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:lt.NONE,SPRITE_MAX_TEXTURES:QY(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,width:800,height:600,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,antialias:!1,preserveDrawingBuffer:!1},GC_MODE:dl.AUTO,GC_MAX_IDLE:60*60,GC_MAX_CHECK_COUNT:60*10,WRAP_MODE:Ai.CLAMP,SCALE_MODE:Ds.LINEAR,PRECISION_VERTEX:ks.HIGH,PRECISION_FRAGMENT:jn.apple.device?ks.HIGH:ks.MEDIUM,CAN_UPLOAD_SAME_BUFFER:qY(),CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},Ci=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _d(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function ZY(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(s){var i=Object.getOwnPropertyDescriptor(r,s);Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:function(){return r[s]}})}),t}var bI={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(t=!1));function i(u,l,d){this.fn=u,this.context=l,this.once=d||!1}function n(u,l,d,c,_){if(typeof d!="function")throw new TypeError("The listener must be a function");var f=new i(d,c||u,_),g=t?t+l:l;return u._events[g]?u._events[g].fn?u._events[g]=[u._events[g],f]:u._events[g].push(f):(u._events[g]=f,u._eventsCount++),u}function a(u,l){--u._eventsCount===0?u._events=new s:delete u._events[l]}function o(){this._events=new s,this._eventsCount=0}o.prototype.eventNames=function(){var l=[],d,c;if(this._eventsCount===0)return l;for(c in d=this._events)e.call(d,c)&&l.push(t?c.slice(1):c);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(d)):l},o.prototype.listeners=function(l){var d=t?t+l:l,c=this._events[d];if(!c)return[];if(c.fn)return[c.fn];for(var _=0,f=c.length,g=new Array(f);_<f;_++)g[_]=c[_].fn;return g},o.prototype.listenerCount=function(l){var d=t?t+l:l,c=this._events[d];return c?c.fn?1:c.length:0},o.prototype.emit=function(l,d,c,_,f,g){var I=t?t+l:l;if(!this._events[I])return!1;var p=this._events[I],R=arguments.length,S,O;if(p.fn){switch(p.once&&this.removeListener(l,p.fn,void 0,!0),R){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,d),!0;case 3:return p.fn.call(p.context,d,c),!0;case 4:return p.fn.call(p.context,d,c,_),!0;case 5:return p.fn.call(p.context,d,c,_,f),!0;case 6:return p.fn.call(p.context,d,c,_,f,g),!0}for(O=1,S=new Array(R-1);O<R;O++)S[O-1]=arguments[O];p.fn.apply(p.context,S)}else{var A=p.length,C;for(O=0;O<A;O++)switch(p[O].once&&this.removeListener(l,p[O].fn,void 0,!0),R){case 1:p[O].fn.call(p[O].context);break;case 2:p[O].fn.call(p[O].context,d);break;case 3:p[O].fn.call(p[O].context,d,c);break;case 4:p[O].fn.call(p[O].context,d,c,_);break;default:if(!S)for(C=1,S=new Array(R-1);C<R;C++)S[C-1]=arguments[C];p[O].fn.apply(p[O].context,S)}}return!0},o.prototype.on=function(l,d,c){return n(this,l,d,c,!1)},o.prototype.once=function(l,d,c){return n(this,l,d,c,!0)},o.prototype.removeListener=function(l,d,c,_){var f=t?t+l:l;if(!this._events[f])return this;if(!d)return a(this,f),this;var g=this._events[f];if(g.fn)g.fn===d&&(!_||g.once)&&(!c||g.context===c)&&a(this,f);else{for(var I=0,p=[],R=g.length;I<R;I++)(g[I].fn!==d||_&&!g[I].once||c&&g[I].context!==c)&&p.push(g[I]);p.length?this._events[f]=p.length===1?p[0]:p:a(this,f)}return this},o.prototype.removeAllListeners=function(l){var d;return l?(d=t?t+l:l,this._events[d]&&a(this,d)):(this._events=new s,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,r.exports=o})(bI);var JY=bI.exports;const $o=_d(JY);var dd={exports:{}};dd.exports=gl,dd.exports.default=gl;function gl(r,e,t){t=t||2;var s=e&&e.length,i=s?e[0]*t:r.length,n=DI(r,0,i,t,!0),a=[];if(!n||n.next===n.prev)return a;var o,u,l,d,c,_,f;if(s&&(n=r5(r,e,n,t)),r.length>80*t){o=l=r[0],u=d=r[1];for(var g=t;g<i;g+=t)c=r[g],_=r[g+1],c<o&&(o=c),_<u&&(u=_),c>l&&(l=c),_>d&&(d=_);f=Math.max(l-o,d-u),f=f!==0?32767/f:0}return eh(n,a,t,o,u,f,0),a}function DI(r,e,t,s,i){var n,a;if(i===Ed(r,e,t,s)>0)for(n=e;n<t;n+=s)a=FI(n,r[n],r[n+1],a);else for(n=t-s;n>=e;n-=s)a=FI(n,r[n],r[n+1],a);return a&&El(a,a.next)&&(sh(a),a=a.next),a}function Yn(r,e){if(!r)return r;e||(e=r);var t=r,s;do if(s=!1,!t.steiner&&(El(t,t.next)||pt(t.prev,t,t.next)===0)){if(sh(t),t=e=t.prev,t===t.next)break;s=!0}else t=t.next;while(s||t!==e);return e}function eh(r,e,t,s,i,n,a){if(r){!a&&n&&h5(r,s,i,n);for(var o=r,u,l;r.prev!==r.next;){if(u=r.prev,l=r.next,n?e5(r,s,i,n):$Y(r)){e.push(u.i/t|0),e.push(r.i/t|0),e.push(l.i/t|0),sh(r),r=l.next,o=l.next;continue}if(r=l,r===o){a?a===1?(r=t5(Yn(r),e,t),eh(r,e,t,s,i,n,2)):a===2&&s5(r,e,t,s,i,n):eh(Yn(r),e,t,s,i,n,1);break}}}}function $Y(r){var e=r.prev,t=r,s=r.next;if(pt(e,t,s)>=0)return!1;for(var i=e.x,n=t.x,a=s.x,o=e.y,u=t.y,l=s.y,d=i<n?i<a?i:a:n<a?n:a,c=o<u?o<l?o:l:u<l?u:l,_=i>n?i>a?i:a:n>a?n:a,f=o>u?o>l?o:l:u>l?u:l,g=s.next;g!==e;){if(g.x>=d&&g.x<=_&&g.y>=c&&g.y<=f&&ka(i,o,n,u,a,l,g.x,g.y)&&pt(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function e5(r,e,t,s){var i=r.prev,n=r,a=r.next;if(pt(i,n,a)>=0)return!1;for(var o=i.x,u=n.x,l=a.x,d=i.y,c=n.y,_=a.y,f=o<u?o<l?o:l:u<l?u:l,g=d<c?d<_?d:_:c<_?c:_,I=o>u?o>l?o:l:u>l?u:l,p=d>c?d>_?d:_:c>_?c:_,R=fd(f,g,e,t,s),S=fd(I,p,e,t,s),O=r.prevZ,A=r.nextZ;O&&O.z>=R&&A&&A.z<=S;){if(O.x>=f&&O.x<=I&&O.y>=g&&O.y<=p&&O!==i&&O!==a&&ka(o,d,u,c,l,_,O.x,O.y)&&pt(O.prev,O,O.next)>=0||(O=O.prevZ,A.x>=f&&A.x<=I&&A.y>=g&&A.y<=p&&A!==i&&A!==a&&ka(o,d,u,c,l,_,A.x,A.y)&&pt(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;O&&O.z>=R;){if(O.x>=f&&O.x<=I&&O.y>=g&&O.y<=p&&O!==i&&O!==a&&ka(o,d,u,c,l,_,O.x,O.y)&&pt(O.prev,O,O.next)>=0)return!1;O=O.prevZ}for(;A&&A.z<=S;){if(A.x>=f&&A.x<=I&&A.y>=g&&A.y<=p&&A!==i&&A!==a&&ka(o,d,u,c,l,_,A.x,A.y)&&pt(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function t5(r,e,t){var s=r;do{var i=s.prev,n=s.next.next;!El(i,n)&&LI(i,s,s.next,n)&&th(i,n)&&th(n,i)&&(e.push(i.i/t|0),e.push(s.i/t|0),e.push(n.i/t|0),sh(s),sh(s.next),s=r=n),s=s.next}while(s!==r);return Yn(s)}function s5(r,e,t,s,i,n){var a=r;do{for(var o=a.next.next;o!==a.prev;){if(a.i!==o.i&&c5(a,o)){var u=UI(a,o);a=Yn(a,a.next),u=Yn(u,u.next),eh(a,e,t,s,i,n,0),eh(u,e,t,s,i,n,0);return}o=o.next}a=a.next}while(a!==r)}function r5(r,e,t,s){var i=[],n,a,o,u,l;for(n=0,a=e.length;n<a;n++)o=e[n]*s,u=n<a-1?e[n+1]*s:r.length,l=DI(r,o,u,s,!1),l===l.next&&(l.steiner=!0),i.push(l5(l));for(i.sort(i5),n=0;n<i.length;n++)t=n5(i[n],t);return t}function i5(r,e){return r.x-e.x}function n5(r,e){var t=a5(r,e);if(!t)return e;var s=UI(t,r);return Yn(s,s.next),Yn(t,t.next)}function a5(r,e){var t=e,s=r.x,i=r.y,n=-1/0,a;do{if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){var o=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(o<=s&&o>n&&(n=o,a=t.x<t.next.x?t:t.next,o===s))return a}t=t.next}while(t!==e);if(!a)return null;var u=a,l=a.x,d=a.y,c=1/0,_;t=a;do s>=t.x&&t.x>=l&&s!==t.x&&ka(i<d?s:n,i,l,d,i<d?n:s,i,t.x,t.y)&&(_=Math.abs(i-t.y)/(s-t.x),th(t,r)&&(_<c||_===c&&(t.x>a.x||t.x===a.x&&o5(a,t)))&&(a=t,c=_)),t=t.next;while(t!==u);return a}function o5(r,e){return pt(r.prev,r,e.prev)<0&&pt(e.next,r,r.next)<0}function h5(r,e,t,s){var i=r;do i.z===0&&(i.z=fd(i.x,i.y,e,t,s)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==r);i.prevZ.nextZ=null,i.prevZ=null,u5(i)}function u5(r){var e,t,s,i,n,a,o,u,l=1;do{for(t=r,r=null,n=null,a=0;t;){for(a++,s=t,o=0,e=0;e<l&&(o++,s=s.nextZ,!!s);e++);for(u=l;o>0||u>0&&s;)o!==0&&(u===0||!s||t.z<=s.z)?(i=t,t=t.nextZ,o--):(i=s,s=s.nextZ,u--),n?n.nextZ=i:r=i,i.prevZ=n,n=i;t=s}n.nextZ=null,l*=2}while(a>1);return r}function fd(r,e,t,s,i){return r=(r-t)*i|0,e=(e-s)*i|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function l5(r){var e=r,t=r;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==r);return t}function ka(r,e,t,s,i,n,a,o){return(i-a)*(e-o)>=(r-a)*(n-o)&&(r-a)*(s-o)>=(t-a)*(e-o)&&(t-a)*(n-o)>=(i-a)*(s-o)}function c5(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!_5(r,e)&&(th(r,e)&&th(e,r)&&d5(r,e)&&(pt(r.prev,r,e.prev)||pt(r,e.prev,e))||El(r,e)&&pt(r.prev,r,r.next)>0&&pt(e.prev,e,e.next)>0)}function pt(r,e,t){return(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y)}function El(r,e){return r.x===e.x&&r.y===e.y}function LI(r,e,t,s){var i=pl(pt(r,e,t)),n=pl(pt(r,e,s)),a=pl(pt(t,s,r)),o=pl(pt(t,s,e));return!!(i!==n&&a!==o||i===0&&ml(r,t,e)||n===0&&ml(r,s,e)||a===0&&ml(t,r,s)||o===0&&ml(t,e,s))}function ml(r,e,t){return e.x<=Math.max(r.x,t.x)&&e.x>=Math.min(r.x,t.x)&&e.y<=Math.max(r.y,t.y)&&e.y>=Math.min(r.y,t.y)}function pl(r){return r>0?1:r<0?-1:0}function _5(r,e){var t=r;do{if(t.i!==r.i&&t.next.i!==r.i&&t.i!==e.i&&t.next.i!==e.i&&LI(t,t.next,r,e))return!0;t=t.next}while(t!==r);return!1}function th(r,e){return pt(r.prev,r,r.next)<0?pt(r,e,r.next)>=0&&pt(r,r.prev,e)>=0:pt(r,e,r.prev)<0||pt(r,r.next,e)<0}function d5(r,e){var t=r,s=!1,i=(r.x+e.x)/2,n=(r.y+e.y)/2;do t.y>n!=t.next.y>n&&t.next.y!==t.y&&i<(t.next.x-t.x)*(n-t.y)/(t.next.y-t.y)+t.x&&(s=!s),t=t.next;while(t!==r);return s}function UI(r,e){var t=new gd(r.i,r.x,r.y),s=new gd(e.i,e.x,e.y),i=r.next,n=e.prev;return r.next=e,e.prev=r,t.next=i,i.prev=t,s.next=t,t.prev=s,n.next=s,s.prev=n,s}function FI(r,e,t,s){var i=new gd(r,e,t);return s?(i.next=s.next,i.prev=s,s.next.prev=i,s.next=i):(i.prev=i,i.next=i),i}function sh(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function gd(r,e,t){this.i=r,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}gl.deviation=function(r,e,t,s){var i=e&&e.length,n=i?e[0]*t:r.length,a=Math.abs(Ed(r,0,n,t));if(i)for(var o=0,u=e.length;o<u;o++){var l=e[o]*t,d=o<u-1?e[o+1]*t:r.length;a-=Math.abs(Ed(r,l,d,t))}var c=0;for(o=0;o<s.length;o+=3){var _=s[o]*t,f=s[o+1]*t,g=s[o+2]*t;c+=Math.abs((r[_]-r[g])*(r[f+1]-r[_+1])-(r[_]-r[f])*(r[g+1]-r[_+1]))}return a===0&&c===0?0:Math.abs((c-a)/a)};function Ed(r,e,t,s){for(var i=0,n=e,a=t-s;n<t;n+=s)i+=(r[a]-r[n])*(r[n+1]+r[a+1]),a=n;return i}gl.flatten=function(r){for(var e=r[0][0].length,t={vertices:[],holes:[],dimensions:e},s=0,i=0;i<r.length;i++){for(var n=0;n<r[i].length;n++)for(var a=0;a<e;a++)t.vertices.push(r[i][n][a]);i>0&&(s+=r[i-1].length,t.holes.push(s))}return t};var f5=dd.exports;const wI=_d(f5);var Il={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */Il.exports,function(r,e){(function(t){var s=e&&!e.nodeType&&e,i=r&&!r.nodeType&&r,n=typeof Ci=="object"&&Ci;(n.global===n||n.window===n||n.self===n)&&(t=n);var a,o=2147483647,u=36,l=1,d=26,c=38,_=700,f=72,g=128,I="-",p=/^xn--/,R=/[^\x20-\x7E]/,S=/[\x2E\u3002\uFF0E\uFF61]/g,O={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},A=u-l,C=Math.floor,M=String.fromCharCode,N;function L(K){throw new RangeError(O[K])}function b(K,ae){for(var De=K.length,je=[];De--;)je[De]=ae(K[De]);return je}function D(K,ae){var De=K.split("@"),je="";De.length>1&&(je=De[0]+"@",K=De[1]),K=K.replace(S,".");var Le=K.split("."),Be=b(Le,ae).join(".");return je+Be}function x(K){for(var ae=[],De=0,je=K.length,Le,Be;De<je;)Le=K.charCodeAt(De++),Le>=55296&&Le<=56319&&De<je?(Be=K.charCodeAt(De++),(Be&64512)==56320?ae.push(((Le&1023)<<10)+(Be&1023)+65536):(ae.push(Le),De--)):ae.push(Le);return ae}function q(K){return b(K,function(ae){var De="";return ae>65535&&(ae-=65536,De+=M(ae>>>10&1023|55296),ae=56320|ae&1023),De+=M(ae),De}).join("")}function $(K){return K-48<10?K-22:K-65<26?K-65:K-97<26?K-97:u}function Te(K,ae){return K+22+75*(K<26)-((ae!=0)<<5)}function j(K,ae,De){var je=0;for(K=De?C(K/_):K>>1,K+=C(K/ae);K>A*d>>1;je+=u)K=C(K/A);return C(je+(A+1)*K/(K+c))}function Q(K){var ae=[],De=K.length,je,Le=0,Be=g,Xe=f,ht,gt,es,bt,Et,Bt,jt,vi,Oi;for(ht=K.lastIndexOf(I),ht<0&&(ht=0),gt=0;gt<ht;++gt)K.charCodeAt(gt)>=128&&L("not-basic"),ae.push(K.charCodeAt(gt));for(es=ht>0?ht+1:0;es<De;){for(bt=Le,Et=1,Bt=u;es>=De&&L("invalid-input"),jt=$(K.charCodeAt(es++)),(jt>=u||jt>C((o-Le)/Et))&&L("overflow"),Le+=jt*Et,vi=Bt<=Xe?l:Bt>=Xe+d?d:Bt-Xe,!(jt<vi);Bt+=u)Oi=u-vi,Et>C(o/Oi)&&L("overflow"),Et*=Oi;je=ae.length+1,Xe=j(Le-bt,je,bt==0),C(Le/je)>o-Be&&L("overflow"),Be+=C(Le/je),Le%=je,ae.splice(Le++,0,Be)}return q(ae)}function oe(K){var ae,De,je,Le,Be,Xe,ht,gt,es,bt,Et,Bt=[],jt,vi,Oi,ll;for(K=x(K),jt=K.length,ae=g,De=0,Be=f,Xe=0;Xe<jt;++Xe)Et=K[Xe],Et<128&&Bt.push(M(Et));for(je=Le=Bt.length,Le&&Bt.push(I);je<jt;){for(ht=o,Xe=0;Xe<jt;++Xe)Et=K[Xe],Et>=ae&&Et<ht&&(ht=Et);for(vi=je+1,ht-ae>C((o-De)/vi)&&L("overflow"),De+=(ht-ae)*vi,ae=ht,Xe=0;Xe<jt;++Xe)if(Et=K[Xe],Et<ae&&++De>o&&L("overflow"),Et==ae){for(gt=De,es=u;bt=es<=Be?l:es>=Be+d?d:es-Be,!(gt<bt);es+=u)ll=gt-bt,Oi=u-bt,Bt.push(M(Te(bt+ll%Oi,0))),gt=C(ll/Oi);Bt.push(M(Te(gt,0))),Be=j(De,vi,je==Le),De=0,++je}++De,++ae}return Bt.join("")}function $t(K){return D(K,function(ae){return p.test(ae)?Q(ae.slice(4).toLowerCase()):ae})}function Gt(K){return D(K,function(ae){return R.test(ae)?"xn--"+oe(ae):ae})}if(a={version:"1.4.1",ucs2:{decode:x,encode:q},decode:Q,encode:oe,toASCII:Gt,toUnicode:$t},s&&i)if(r.exports==s)i.exports=a;else for(N in a)a.hasOwnProperty(N)&&(s[N]=a[N]);else t.punycode=a})(Ci)}(Il,Il.exports);var g5=Il.exports,E5=Error,m5=EvalError,p5=RangeError,I5=ReferenceError,xI=SyntaxError,rh=TypeError,T5=URIError,R5=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),s=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(s)!=="[object Symbol]")return!1;var i=42;e[t]=i;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var n=Object.getOwnPropertySymbols(e);if(n.length!==1||n[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,t);if(a.value!==i||a.enumerable!==!0)return!1}return!0},GI=typeof Symbol<"u"&&Symbol,v5=R5,O5=function(){return typeof GI!="function"||typeof Symbol!="function"||typeof GI("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:v5()},md={__proto__:null,foo:{}},S5=Object,A5=function(){return{__proto__:md}.foo===md.foo&&!(md instanceof S5)},y5="Function.prototype.bind called on incompatible ",C5=Object.prototype.toString,M5=Math.max,P5="[object Function]",BI=function(e,t){for(var s=[],i=0;i<e.length;i+=1)s[i]=e[i];for(var n=0;n<t.length;n+=1)s[n+e.length]=t[n];return s},N5=function(e,t){for(var s=[],i=t||0,n=0;i<e.length;i+=1,n+=1)s[n]=e[i];return s},b5=function(r,e){for(var t="",s=0;s<r.length;s+=1)t+=r[s],s+1<r.length&&(t+=e);return t},D5=function(e){var t=this;if(typeof t!="function"||C5.apply(t)!==P5)throw new TypeError(y5+t);for(var s=N5(arguments,1),i,n=function(){if(this instanceof i){var d=t.apply(this,BI(s,arguments));return Object(d)===d?d:this}return t.apply(e,BI(s,arguments))},a=M5(0,t.length-s.length),o=[],u=0;u<a;u++)o[u]="$"+u;if(i=Function("binder","return function ("+b5(o,",")+"){ return binder.apply(this,arguments); }")(n),t.prototype){var l=function(){};l.prototype=t.prototype,i.prototype=new l,l.prototype=null}return i},L5=D5,pd=Function.prototype.bind||L5,U5=Function.prototype.call,F5=Object.prototype.hasOwnProperty,w5=pd,x5=w5.call(U5,F5),Fe,G5=E5,B5=m5,H5=p5,k5=I5,Va=xI,ja=rh,V5=T5,HI=Function,Id=function(r){try{return HI('"use strict"; return ('+r+").constructor;")()}catch{}},Wn=Object.getOwnPropertyDescriptor;if(Wn)try{Wn({},"")}catch{Wn=null}var Td=function(){throw new ja},j5=Wn?function(){try{return arguments.callee,Td}catch{try{return Wn(arguments,"callee").get}catch{return Td}}}():Td,Ya=O5(),Y5=A5(),Yt=Object.getPrototypeOf||(Y5?function(r){return r.__proto__}:null),Wa={},W5=typeof Uint8Array>"u"||!Yt?Fe:Yt(Uint8Array),zn={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?Fe:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Fe:ArrayBuffer,"%ArrayIteratorPrototype%":Ya&&Yt?Yt([][Symbol.iterator]()):Fe,"%AsyncFromSyncIteratorPrototype%":Fe,"%AsyncFunction%":Wa,"%AsyncGenerator%":Wa,"%AsyncGeneratorFunction%":Wa,"%AsyncIteratorPrototype%":Wa,"%Atomics%":typeof Atomics>"u"?Fe:Atomics,"%BigInt%":typeof BigInt>"u"?Fe:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Fe:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Fe:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Fe:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":G5,"%eval%":eval,"%EvalError%":B5,"%Float32Array%":typeof Float32Array>"u"?Fe:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Fe:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Fe:FinalizationRegistry,"%Function%":HI,"%GeneratorFunction%":Wa,"%Int8Array%":typeof Int8Array>"u"?Fe:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Fe:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Fe:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Ya&&Yt?Yt(Yt([][Symbol.iterator]())):Fe,"%JSON%":typeof JSON=="object"?JSON:Fe,"%Map%":typeof Map>"u"?Fe:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Ya||!Yt?Fe:Yt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Fe:Promise,"%Proxy%":typeof Proxy>"u"?Fe:Proxy,"%RangeError%":H5,"%ReferenceError%":k5,"%Reflect%":typeof Reflect>"u"?Fe:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Fe:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Ya||!Yt?Fe:Yt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Fe:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Ya&&Yt?Yt(""[Symbol.iterator]()):Fe,"%Symbol%":Ya?Symbol:Fe,"%SyntaxError%":Va,"%ThrowTypeError%":j5,"%TypedArray%":W5,"%TypeError%":ja,"%Uint8Array%":typeof Uint8Array>"u"?Fe:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Fe:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Fe:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Fe:Uint32Array,"%URIError%":V5,"%WeakMap%":typeof WeakMap>"u"?Fe:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Fe:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Fe:WeakSet};if(Yt)try{null.error}catch(r){var z5=Yt(Yt(r));zn["%Error.prototype%"]=z5}var X5=function r(e){var t;if(e==="%AsyncFunction%")t=Id("async function () {}");else if(e==="%GeneratorFunction%")t=Id("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=Id("async function* () {}");else if(e==="%AsyncGenerator%"){var s=r("%AsyncGeneratorFunction%");s&&(t=s.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=r("%AsyncGenerator%");i&&Yt&&(t=Yt(i.prototype))}return zn[e]=t,t},kI={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ih=pd,Tl=x5,K5=ih.call(Function.call,Array.prototype.concat),q5=ih.call(Function.apply,Array.prototype.splice),VI=ih.call(Function.call,String.prototype.replace),Rl=ih.call(Function.call,String.prototype.slice),Q5=ih.call(Function.call,RegExp.prototype.exec),Z5=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,J5=/\\(\\)?/g,$5=function(e){var t=Rl(e,0,1),s=Rl(e,-1);if(t==="%"&&s!=="%")throw new Va("invalid intrinsic syntax, expected closing `%`");if(s==="%"&&t!=="%")throw new Va("invalid intrinsic syntax, expected opening `%`");var i=[];return VI(e,Z5,function(n,a,o,u){i[i.length]=o?VI(u,J5,"$1"):a||n}),i},eW=function(e,t){var s=e,i;if(Tl(kI,s)&&(i=kI[s],s="%"+i[0]+"%"),Tl(zn,s)){var n=zn[s];if(n===Wa&&(n=X5(s)),typeof n>"u"&&!t)throw new ja("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:s,value:n}}throw new Va("intrinsic "+e+" does not exist!")},za=function(e,t){if(typeof e!="string"||e.length===0)throw new ja("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new ja('"allowMissing" argument must be a boolean');if(Q5(/^%?[^%]*%?$/,e)===null)throw new Va("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var s=$5(e),i=s.length>0?s[0]:"",n=eW("%"+i+"%",t),a=n.name,o=n.value,u=!1,l=n.alias;l&&(i=l[0],q5(s,K5([0,1],l)));for(var d=1,c=!0;d<s.length;d+=1){var _=s[d],f=Rl(_,0,1),g=Rl(_,-1);if((f==='"'||f==="'"||f==="`"||g==='"'||g==="'"||g==="`")&&f!==g)throw new Va("property names with quotes must have matching quotes");if((_==="constructor"||!c)&&(u=!0),i+="."+_,a="%"+i+"%",Tl(zn,a))o=zn[a];else if(o!=null){if(!(_ in o)){if(!t)throw new ja("base intrinsic for "+e+" exists, but the property is not available.");return}if(Wn&&d+1>=s.length){var I=Wn(o,_);c=!!I,c&&"get"in I&&!("originalValue"in I.get)?o=I.get:o=o[_]}else c=Tl(o,_),o=o[_];c&&!u&&(zn[a]=o)}}return o},jI={exports:{}},Rd,YI;function vd(){if(YI)return Rd;YI=1;var r=za,e=r("%Object.defineProperty%",!0)||!1;if(e)try{e({},"a",{value:1})}catch{e=!1}return Rd=e,Rd}var tW=za,vl=tW("%Object.getOwnPropertyDescriptor%",!0);if(vl)try{vl([],"length")}catch{vl=null}var WI=vl,zI=vd(),sW=xI,Xa=rh,XI=WI,rW=function(e,t,s){if(!e||typeof e!="object"&&typeof e!="function")throw new Xa("`obj` must be an object or a function`");if(typeof t!="string"&&typeof t!="symbol")throw new Xa("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new Xa("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new Xa("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new Xa("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Xa("`loose`, if provided, must be a boolean");var i=arguments.length>3?arguments[3]:null,n=arguments.length>4?arguments[4]:null,a=arguments.length>5?arguments[5]:null,o=arguments.length>6?arguments[6]:!1,u=!!XI&&XI(e,t);if(zI)zI(e,t,{configurable:a===null&&u?u.configurable:!a,enumerable:i===null&&u?u.enumerable:!i,value:s,writable:n===null&&u?u.writable:!n});else if(o||!i&&!n&&!a)e[t]=s;else throw new sW("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Od=vd(),KI=function(){return!!Od};KI.hasArrayLengthDefineBug=function(){if(!Od)return null;try{return Od([],"length",{value:1}).length!==1}catch{return!0}};var iW=KI,nW=za,qI=rW,aW=iW(),QI=WI,ZI=rh,oW=nW("%Math.floor%"),hW=function(e,t){if(typeof e!="function")throw new ZI("`fn` is not a function");if(typeof t!="number"||t<0||t>4294967295||oW(t)!==t)throw new ZI("`length` must be a positive 32-bit integer");var s=arguments.length>2&&!!arguments[2],i=!0,n=!0;if("length"in e&&QI){var a=QI(e,"length");a&&!a.configurable&&(i=!1),a&&!a.writable&&(n=!1)}return(i||n||!s)&&(aW?qI(e,"length",t,!0,!0):qI(e,"length",t)),e};(function(r){var e=pd,t=za,s=hW,i=rh,n=t("%Function.prototype.apply%"),a=t("%Function.prototype.call%"),o=t("%Reflect.apply%",!0)||e.call(a,n),u=vd(),l=t("%Math.max%");r.exports=function(_){if(typeof _!="function")throw new i("a function is required");var f=o(e,a,arguments);return s(f,1+l(0,_.length-(arguments.length-1)),!0)};var d=function(){return o(e,n,arguments)};u?u(r.exports,"apply",{value:d}):r.exports.apply=d})(jI);var uW=jI.exports,JI=za,$I=uW,lW=$I(JI("String.prototype.indexOf")),cW=function(e,t){var s=JI(e,!!t);return typeof s=="function"&&lW(e,".prototype.")>-1?$I(s):s};const _W=ZY(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var Sd=typeof Map=="function"&&Map.prototype,Ad=Object.getOwnPropertyDescriptor&&Sd?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Ol=Sd&&Ad&&typeof Ad.get=="function"?Ad.get:null,eT=Sd&&Map.prototype.forEach,yd=typeof Set=="function"&&Set.prototype,Cd=Object.getOwnPropertyDescriptor&&yd?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Sl=yd&&Cd&&typeof Cd.get=="function"?Cd.get:null,tT=yd&&Set.prototype.forEach,dW=typeof WeakMap=="function"&&WeakMap.prototype,nh=dW?WeakMap.prototype.has:null,fW=typeof WeakSet=="function"&&WeakSet.prototype,ah=fW?WeakSet.prototype.has:null,gW=typeof WeakRef=="function"&&WeakRef.prototype,sT=gW?WeakRef.prototype.deref:null,EW=Boolean.prototype.valueOf,mW=Object.prototype.toString,pW=Function.prototype.toString,IW=String.prototype.match,Md=String.prototype.slice,dn=String.prototype.replace,TW=String.prototype.toUpperCase,rT=String.prototype.toLowerCase,iT=RegExp.prototype.test,nT=Array.prototype.concat,Vr=Array.prototype.join,RW=Array.prototype.slice,aT=Math.floor,Pd=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Nd=Object.getOwnPropertySymbols,bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Ka=typeof Symbol=="function"&&typeof Symbol.iterator=="object",ls=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Ka||"symbol")?Symbol.toStringTag:null,oT=Object.prototype.propertyIsEnumerable,hT=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(r){return r.__proto__}:null);function uT(r,e){if(r===1/0||r===-1/0||r!==r||r&&r>-1e3&&r<1e3||iT.call(/e/,e))return e;var t=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof r=="number"){var s=r<0?-aT(-r):aT(r);if(s!==r){var i=String(s),n=Md.call(e,i.length+1);return dn.call(i,t,"$&_")+"."+dn.call(dn.call(n,/([0-9]{3})/g,"$&_"),/_$/,"")}}return dn.call(e,t,"$&_")}var Dd=_W,lT=Dd.custom,cT=fT(lT)?lT:null,vW=function r(e,t,s,i){var n=t||{};if(fn(n,"quoteStyle")&&n.quoteStyle!=="single"&&n.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(fn(n,"maxStringLength")&&(typeof n.maxStringLength=="number"?n.maxStringLength<0&&n.maxStringLength!==1/0:n.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=fn(n,"customInspect")?n.customInspect:!0;if(typeof a!="boolean"&&a!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(fn(n,"indent")&&n.indent!==null&&n.indent!=="	"&&!(parseInt(n.indent,10)===n.indent&&n.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(fn(n,"numericSeparator")&&typeof n.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var o=n.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return ET(e,n);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var u=String(e);return o?uT(e,u):u}if(typeof e=="bigint"){var l=String(e)+"n";return o?uT(e,l):l}var d=typeof n.depth>"u"?5:n.depth;if(typeof s>"u"&&(s=0),s>=d&&d>0&&typeof e=="object")return Ld(e)?"[Array]":"[Object]";var c=HW(n,s);if(typeof i>"u")i=[];else if(gT(i,e)>=0)return"[Circular]";function _($,Te,j){if(Te&&(i=RW.call(i),i.push(Te)),j){var Q={depth:n.depth};return fn(n,"quoteStyle")&&(Q.quoteStyle=n.quoteStyle),r($,Q,s+1,i)}return r($,n,s+1,i)}if(typeof e=="function"&&!dT(e)){var f=bW(e),g=Al(e,_);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(g.length>0?" { "+Vr.call(g,", ")+" }":"")}if(fT(e)){var I=Ka?dn.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):bd.call(e);return typeof e=="object"&&!Ka?oh(I):I}if(xW(e)){for(var p="<"+rT.call(String(e.nodeName)),R=e.attributes||[],S=0;S<R.length;S++)p+=" "+R[S].name+"="+_T(OW(R[S].value),"double",n);return p+=">",e.childNodes&&e.childNodes.length&&(p+="..."),p+="</"+rT.call(String(e.nodeName))+">",p}if(Ld(e)){if(e.length===0)return"[]";var O=Al(e,_);return c&&!BW(O)?"["+Fd(O,c)+"]":"[ "+Vr.call(O,", ")+" ]"}if(AW(e)){var A=Al(e,_);return!("cause"in Error.prototype)&&"cause"in e&&!oT.call(e,"cause")?"{ ["+String(e)+"] "+Vr.call(nT.call("[cause]: "+_(e.cause),A),", ")+" }":A.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Vr.call(A,", ")+" }"}if(typeof e=="object"&&a){if(cT&&typeof e[cT]=="function"&&Dd)return Dd(e,{depth:d-s});if(a!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(DW(e)){var C=[];return eT&&eT.call(e,function($,Te){C.push(_(Te,e,!0)+" => "+_($,e))}),mT("Map",Ol.call(e),C,c)}if(FW(e)){var M=[];return tT&&tT.call(e,function($){M.push(_($,e))}),mT("Set",Sl.call(e),M,c)}if(LW(e))return Ud("WeakMap");if(wW(e))return Ud("WeakSet");if(UW(e))return Ud("WeakRef");if(CW(e))return oh(_(Number(e)));if(PW(e))return oh(_(Pd.call(e)));if(MW(e))return oh(EW.call(e));if(yW(e))return oh(_(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(e===Ci)return"{ [object globalThis] }";if(!SW(e)&&!dT(e)){var N=Al(e,_),L=hT?hT(e)===Object.prototype:e instanceof Object||e.constructor===Object,b=e instanceof Object?"":"null prototype",D=!L&&ls&&Object(e)===e&&ls in e?Md.call(gn(e),8,-1):b?"Object":"",x=L||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",q=x+(D||b?"["+Vr.call(nT.call([],D||[],b||[]),": ")+"] ":"");return N.length===0?q+"{}":c?q+"{"+Fd(N,c)+"}":q+"{ "+Vr.call(N,", ")+" }"}return String(e)};function _T(r,e,t){var s=(t.quoteStyle||e)==="double"?'"':"'";return s+r+s}function OW(r){return dn.call(String(r),/"/g,"&quot;")}function Ld(r){return gn(r)==="[object Array]"&&(!ls||!(typeof r=="object"&&ls in r))}function SW(r){return gn(r)==="[object Date]"&&(!ls||!(typeof r=="object"&&ls in r))}function dT(r){return gn(r)==="[object RegExp]"&&(!ls||!(typeof r=="object"&&ls in r))}function AW(r){return gn(r)==="[object Error]"&&(!ls||!(typeof r=="object"&&ls in r))}function yW(r){return gn(r)==="[object String]"&&(!ls||!(typeof r=="object"&&ls in r))}function CW(r){return gn(r)==="[object Number]"&&(!ls||!(typeof r=="object"&&ls in r))}function MW(r){return gn(r)==="[object Boolean]"&&(!ls||!(typeof r=="object"&&ls in r))}function fT(r){if(Ka)return r&&typeof r=="object"&&r instanceof Symbol;if(typeof r=="symbol")return!0;if(!r||typeof r!="object"||!bd)return!1;try{return bd.call(r),!0}catch{}return!1}function PW(r){if(!r||typeof r!="object"||!Pd)return!1;try{return Pd.call(r),!0}catch{}return!1}var NW=Object.prototype.hasOwnProperty||function(r){return r in this};function fn(r,e){return NW.call(r,e)}function gn(r){return mW.call(r)}function bW(r){if(r.name)return r.name;var e=IW.call(pW.call(r),/^function\s*([\w$]+)/);return e?e[1]:null}function gT(r,e){if(r.indexOf)return r.indexOf(e);for(var t=0,s=r.length;t<s;t++)if(r[t]===e)return t;return-1}function DW(r){if(!Ol||!r||typeof r!="object")return!1;try{Ol.call(r);try{Sl.call(r)}catch{return!0}return r instanceof Map}catch{}return!1}function LW(r){if(!nh||!r||typeof r!="object")return!1;try{nh.call(r,nh);try{ah.call(r,ah)}catch{return!0}return r instanceof WeakMap}catch{}return!1}function UW(r){if(!sT||!r||typeof r!="object")return!1;try{return sT.call(r),!0}catch{}return!1}function FW(r){if(!Sl||!r||typeof r!="object")return!1;try{Sl.call(r);try{Ol.call(r)}catch{return!0}return r instanceof Set}catch{}return!1}function wW(r){if(!ah||!r||typeof r!="object")return!1;try{ah.call(r,ah);try{nh.call(r,nh)}catch{return!0}return r instanceof WeakSet}catch{}return!1}function xW(r){return!r||typeof r!="object"?!1:typeof HTMLElement<"u"&&r instanceof HTMLElement?!0:typeof r.nodeName=="string"&&typeof r.getAttribute=="function"}function ET(r,e){if(r.length>e.maxStringLength){var t=r.length-e.maxStringLength,s="... "+t+" more character"+(t>1?"s":"");return ET(Md.call(r,0,e.maxStringLength),e)+s}var i=dn.call(dn.call(r,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,GW);return _T(i,"single",e)}function GW(r){var e=r.charCodeAt(0),t={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return t?"\\"+t:"\\x"+(e<16?"0":"")+TW.call(e.toString(16))}function oh(r){return"Object("+r+")"}function Ud(r){return r+" { ? }"}function mT(r,e,t,s){var i=s?Fd(t,s):Vr.call(t,", ");return r+" ("+e+") {"+i+"}"}function BW(r){for(var e=0;e<r.length;e++)if(gT(r[e],`
`)>=0)return!1;return!0}function HW(r,e){var t;if(r.indent==="	")t="	";else if(typeof r.indent=="number"&&r.indent>0)t=Vr.call(Array(r.indent+1)," ");else return null;return{base:t,prev:Vr.call(Array(e+1),t)}}function Fd(r,e){if(r.length===0)return"";var t=`
`+e.prev+e.base;return t+Vr.call(r,","+t)+`
`+e.prev}function Al(r,e){var t=Ld(r),s=[];if(t){s.length=r.length;for(var i=0;i<r.length;i++)s[i]=fn(r,i)?e(r[i],r):""}var n=typeof Nd=="function"?Nd(r):[],a;if(Ka){a={};for(var o=0;o<n.length;o++)a["$"+n[o]]=n[o]}for(var u in r)fn(r,u)&&(t&&String(Number(u))===u&&u<r.length||Ka&&a["$"+u]instanceof Symbol||(iT.call(/[^\w$]/,u)?s.push(e(u,r)+": "+e(r[u],r)):s.push(u+": "+e(r[u],r))));if(typeof Nd=="function")for(var l=0;l<n.length;l++)oT.call(r,n[l])&&s.push("["+e(n[l])+"]: "+e(r[n[l]],r));return s}var pT=za,qa=cW,kW=vW,VW=rh,yl=pT("%WeakMap%",!0),Cl=pT("%Map%",!0),jW=qa("WeakMap.prototype.get",!0),YW=qa("WeakMap.prototype.set",!0),WW=qa("WeakMap.prototype.has",!0),zW=qa("Map.prototype.get",!0),XW=qa("Map.prototype.set",!0),KW=qa("Map.prototype.has",!0),wd=function(r,e){for(var t=r,s;(s=t.next)!==null;t=s)if(s.key===e)return t.next=s.next,s.next=r.next,r.next=s,s},qW=function(r,e){var t=wd(r,e);return t&&t.value},QW=function(r,e,t){var s=wd(r,e);s?s.value=t:r.next={key:e,next:r.next,value:t}},ZW=function(r,e){return!!wd(r,e)},JW=function(){var e,t,s,i={assert:function(n){if(!i.has(n))throw new VW("Side channel does not contain "+kW(n))},get:function(n){if(yl&&n&&(typeof n=="object"||typeof n=="function")){if(e)return jW(e,n)}else if(Cl){if(t)return zW(t,n)}else if(s)return qW(s,n)},has:function(n){if(yl&&n&&(typeof n=="object"||typeof n=="function")){if(e)return WW(e,n)}else if(Cl){if(t)return KW(t,n)}else if(s)return ZW(s,n);return!1},set:function(n,a){yl&&n&&(typeof n=="object"||typeof n=="function")?(e||(e=new yl),YW(e,n,a)):Cl?(t||(t=new Cl),XW(t,n,a)):(s||(s={key:{},next:null}),QW(s,n,a))}};return i},$W=String.prototype.replace,ez=/%20/g,xd={RFC1738:"RFC1738",RFC3986:"RFC3986"},Gd={default:xd.RFC3986,formatters:{RFC1738:function(r){return $W.call(r,ez,"+")},RFC3986:function(r){return String(r)}},RFC1738:xd.RFC1738,RFC3986:xd.RFC3986},tz=Gd,Bd=Object.prototype.hasOwnProperty,Xn=Array.isArray,jr=function(){for(var r=[],e=0;e<256;++e)r.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return r}(),sz=function(e){for(;e.length>1;){var t=e.pop(),s=t.obj[t.prop];if(Xn(s)){for(var i=[],n=0;n<s.length;++n)typeof s[n]<"u"&&i.push(s[n]);t.obj[t.prop]=i}}},IT=function(e,t){for(var s=t&&t.plainObjects?Object.create(null):{},i=0;i<e.length;++i)typeof e[i]<"u"&&(s[i]=e[i]);return s},rz=function r(e,t,s){if(!t)return e;if(typeof t!="object"){if(Xn(e))e.push(t);else if(e&&typeof e=="object")(s&&(s.plainObjects||s.allowPrototypes)||!Bd.call(Object.prototype,t))&&(e[t]=!0);else return[e,t];return e}if(!e||typeof e!="object")return[e].concat(t);var i=e;return Xn(e)&&!Xn(t)&&(i=IT(e,s)),Xn(e)&&Xn(t)?(t.forEach(function(n,a){if(Bd.call(e,a)){var o=e[a];o&&typeof o=="object"&&n&&typeof n=="object"?e[a]=r(o,n,s):e.push(n)}else e[a]=n}),e):Object.keys(t).reduce(function(n,a){var o=t[a];return Bd.call(n,a)?n[a]=r(n[a],o,s):n[a]=o,n},i)},iz=function(e,t){return Object.keys(t).reduce(function(s,i){return s[i]=t[i],s},e)},nz=function(r,e,t){var s=r.replace(/\+/g," ");if(t==="iso-8859-1")return s.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(s)}catch{return s}},az=function(e,t,s,i,n){if(e.length===0)return e;var a=e;if(typeof e=="symbol"?a=Symbol.prototype.toString.call(e):typeof e!="string"&&(a=String(e)),s==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(d){return"%26%23"+parseInt(d.slice(2),16)+"%3B"});for(var o="",u=0;u<a.length;++u){var l=a.charCodeAt(u);if(l===45||l===46||l===95||l===126||l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122||n===tz.RFC1738&&(l===40||l===41)){o+=a.charAt(u);continue}if(l<128){o=o+jr[l];continue}if(l<2048){o=o+(jr[192|l>>6]+jr[128|l&63]);continue}if(l<55296||l>=57344){o=o+(jr[224|l>>12]+jr[128|l>>6&63]+jr[128|l&63]);continue}u+=1,l=65536+((l&1023)<<10|a.charCodeAt(u)&1023),o+=jr[240|l>>18]+jr[128|l>>12&63]+jr[128|l>>6&63]+jr[128|l&63]}return o},oz=function(e){for(var t=[{obj:{o:e},prop:"o"}],s=[],i=0;i<t.length;++i)for(var n=t[i],a=n.obj[n.prop],o=Object.keys(a),u=0;u<o.length;++u){var l=o[u],d=a[l];typeof d=="object"&&d!==null&&s.indexOf(d)===-1&&(t.push({obj:a,prop:l}),s.push(d))}return sz(t),e},hz=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},uz=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},lz=function(e,t){return[].concat(e,t)},cz=function(e,t){if(Xn(e)){for(var s=[],i=0;i<e.length;i+=1)s.push(t(e[i]));return s}return t(e)},TT={arrayToObject:IT,assign:iz,combine:lz,compact:oz,decode:nz,encode:az,isBuffer:uz,isRegExp:hz,maybeMap:cz,merge:rz},RT=JW,Ml=TT,hh=Gd,_z=Object.prototype.hasOwnProperty,vT={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},Yr=Array.isArray,dz=Array.prototype.push,OT=function(r,e){dz.apply(r,Yr(e)?e:[e])},fz=Date.prototype.toISOString,ST=hh.default,Ht={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Ml.encode,encodeValuesOnly:!1,format:ST,formatter:hh.formatters[ST],indices:!1,serializeDate:function(e){return fz.call(e)},skipNulls:!1,strictNullHandling:!1},gz=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},Hd={},Ez=function r(e,t,s,i,n,a,o,u,l,d,c,_,f,g,I,p,R,S){for(var O=e,A=S,C=0,M=!1;(A=A.get(Hd))!==void 0&&!M;){var N=A.get(e);if(C+=1,typeof N<"u"){if(N===C)throw new RangeError("Cyclic object value");M=!0}typeof A.get(Hd)>"u"&&(C=0)}if(typeof d=="function"?O=d(t,O):O instanceof Date?O=f(O):s==="comma"&&Yr(O)&&(O=Ml.maybeMap(O,function(K){return K instanceof Date?f(K):K})),O===null){if(a)return l&&!p?l(t,Ht.encoder,R,"key",g):t;O=""}if(gz(O)||Ml.isBuffer(O)){if(l){var L=p?t:l(t,Ht.encoder,R,"key",g);return[I(L)+"="+I(l(O,Ht.encoder,R,"value",g))]}return[I(t)+"="+I(String(O))]}var b=[];if(typeof O>"u")return b;var D;if(s==="comma"&&Yr(O))p&&l&&(O=Ml.maybeMap(O,l)),D=[{value:O.length>0?O.join(",")||null:void 0}];else if(Yr(d))D=d;else{var x=Object.keys(O);D=c?x.sort(c):x}var q=u?t.replace(/\./g,"%2E"):t,$=i&&Yr(O)&&O.length===1?q+"[]":q;if(n&&Yr(O)&&O.length===0)return $+"[]";for(var Te=0;Te<D.length;++Te){var j=D[Te],Q=typeof j=="object"&&typeof j.value<"u"?j.value:O[j];if(!(o&&Q===null)){var oe=_&&u?j.replace(/\./g,"%2E"):j,$t=Yr(O)?typeof s=="function"?s($,oe):$:$+(_?"."+oe:"["+oe+"]");S.set(e,C);var Gt=RT();Gt.set(Hd,S),OT(b,r(Q,$t,s,i,n,a,o,u,s==="comma"&&p&&Yr(O)?null:l,d,c,_,f,g,I,p,R,Gt))}}return b},mz=function(e){if(!e)return Ht;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var t=e.charset||Ht.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var s=hh.default;if(typeof e.format<"u"){if(!_z.call(hh.formatters,e.format))throw new TypeError("Unknown format option provided.");s=e.format}var i=hh.formatters[s],n=Ht.filter;(typeof e.filter=="function"||Yr(e.filter))&&(n=e.filter);var a;if(e.arrayFormat in vT?a=e.arrayFormat:"indices"in e?a=e.indices?"indices":"repeat":a=Ht.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var o=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:Ht.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:Ht.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Ht.allowEmptyArrays,arrayFormat:a,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Ht.charsetSentinel,commaRoundTrip:e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?Ht.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:Ht.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:Ht.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:Ht.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:Ht.encodeValuesOnly,filter:n,format:s,formatter:i,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:Ht.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:Ht.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Ht.strictNullHandling}},pz=function(r,e){var t=r,s=mz(e),i,n;typeof s.filter=="function"?(n=s.filter,t=n("",t)):Yr(s.filter)&&(n=s.filter,i=n);var a=[];if(typeof t!="object"||t===null)return"";var o=vT[s.arrayFormat],u=o==="comma"&&s.commaRoundTrip;i||(i=Object.keys(t)),s.sort&&i.sort(s.sort);for(var l=RT(),d=0;d<i.length;++d){var c=i[d];s.skipNulls&&t[c]===null||OT(a,Ez(t[c],c,o,u,s.allowEmptyArrays,s.strictNullHandling,s.skipNulls,s.encodeDotInKeys,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,l))}var _=a.join(s.delimiter),f=s.addQueryPrefix===!0?"?":"";return s.charsetSentinel&&(s.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),_.length>0?f+_:""},Qa=TT,kd=Object.prototype.hasOwnProperty,Iz=Array.isArray,At={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!0,decoder:Qa.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Tz=function(r){return r.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},AT=function(r,e){return r&&typeof r=="string"&&e.comma&&r.indexOf(",")>-1?r.split(","):r},Rz="utf8=%26%2310003%3B",vz="utf8=%E2%9C%93",Oz=function(e,t){var s={__proto__:null},i=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,n=t.parameterLimit===1/0?void 0:t.parameterLimit,a=i.split(t.delimiter,n),o=-1,u,l=t.charset;if(t.charsetSentinel)for(u=0;u<a.length;++u)a[u].indexOf("utf8=")===0&&(a[u]===vz?l="utf-8":a[u]===Rz&&(l="iso-8859-1"),o=u,u=a.length);for(u=0;u<a.length;++u)if(u!==o){var d=a[u],c=d.indexOf("]="),_=c===-1?d.indexOf("="):c+1,f,g;_===-1?(f=t.decoder(d,At.decoder,l,"key"),g=t.strictNullHandling?null:""):(f=t.decoder(d.slice(0,_),At.decoder,l,"key"),g=Qa.maybeMap(AT(d.slice(_+1),t),function(p){return t.decoder(p,At.decoder,l,"value")})),g&&t.interpretNumericEntities&&l==="iso-8859-1"&&(g=Tz(g)),d.indexOf("[]=")>-1&&(g=Iz(g)?[g]:g);var I=kd.call(s,f);I&&t.duplicates==="combine"?s[f]=Qa.combine(s[f],g):(!I||t.duplicates==="last")&&(s[f]=g)}return s},Sz=function(r,e,t,s){for(var i=s?e:AT(e,t),n=r.length-1;n>=0;--n){var a,o=r[n];if(o==="[]"&&t.parseArrays)a=t.allowEmptyArrays&&i===""?[]:[].concat(i);else{a=t.plainObjects?Object.create(null):{};var u=o.charAt(0)==="["&&o.charAt(o.length-1)==="]"?o.slice(1,-1):o,l=t.decodeDotInKeys?u.replace(/%2E/g,"."):u,d=parseInt(l,10);!t.parseArrays&&l===""?a={0:i}:!isNaN(d)&&o!==l&&String(d)===l&&d>=0&&t.parseArrays&&d<=t.arrayLimit?(a=[],a[d]=i):l!=="__proto__"&&(a[l]=i)}i=a}return i},Az=function(e,t,s,i){if(e){var n=s.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/,o=/(\[[^[\]]*])/g,u=s.depth>0&&a.exec(n),l=u?n.slice(0,u.index):n,d=[];if(l){if(!s.plainObjects&&kd.call(Object.prototype,l)&&!s.allowPrototypes)return;d.push(l)}for(var c=0;s.depth>0&&(u=o.exec(n))!==null&&c<s.depth;){if(c+=1,!s.plainObjects&&kd.call(Object.prototype,u[1].slice(1,-1))&&!s.allowPrototypes)return;d.push(u[1])}return u&&d.push("["+n.slice(u.index)+"]"),Sz(d,t,s,i)}},yz=function(e){if(!e)return At;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=typeof e.charset>"u"?At.charset:e.charset,s=typeof e.duplicates>"u"?At.duplicates:e.duplicates;if(s!=="combine"&&s!=="first"&&s!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var i=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:At.allowDots:!!e.allowDots;return{allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:At.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:At.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:At.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:At.arrayLimit,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:At.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:At.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:At.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:At.decoder,delimiter:typeof e.delimiter=="string"||Qa.isRegExp(e.delimiter)?e.delimiter:At.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:At.depth,duplicates:s,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:At.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:At.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:At.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:At.strictNullHandling}},Cz=function(r,e){var t=yz(e);if(r===""||r===null||typeof r>"u")return t.plainObjects?Object.create(null):{};for(var s=typeof r=="string"?Oz(r,t):r,i=t.plainObjects?Object.create(null):{},n=Object.keys(s),a=0;a<n.length;++a){var o=n[a],u=Az(o,s[o],t,typeof r=="string");i=Qa.merge(i,u,t)}return t.allowSparse===!0?i:Qa.compact(i)},Mz=pz,Pz=Cz,Nz=Gd,bz={formats:Nz,parse:Pz,stringify:Mz},Dz=g5;function Sr(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Lz=/^([a-z0-9.+-]+:)/i,Uz=/:[0-9]*$/,Fz=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,wz=["<",">",'"',"`"," ","\r",`
`,"	"],xz=["{","}","|","\\","^","`"].concat(wz),Vd=["'"].concat(xz),yT=["%","/","?",";","#"].concat(Vd),CT=["/","?","#"],Gz=255,MT=/^[+a-z0-9A-Z_-]{0,63}$/,Bz=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Hz={javascript:!0,"javascript:":!0},jd={javascript:!0,"javascript:":!0},Za={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Yd=bz;function Pl(r,e,t){if(r&&typeof r=="object"&&r instanceof Sr)return r;var s=new Sr;return s.parse(r,e,t),s}Sr.prototype.parse=function(r,e,t){if(typeof r!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof r);var s=r.indexOf("?"),i=s!==-1&&s<r.indexOf("#")?"?":"#",n=r.split(i),a=/\\/g;n[0]=n[0].replace(a,"/"),r=n.join(i);var o=r;if(o=o.trim(),!t&&r.split("#").length===1){var u=Fz.exec(o);if(u)return this.path=o,this.href=o,this.pathname=u[1],u[2]?(this.search=u[2],e?this.query=Yd.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var l=Lz.exec(o);if(l){l=l[0];var d=l.toLowerCase();this.protocol=d,o=o.substr(l.length)}if(t||l||o.match(/^\/\/[^@/]+@[^@/]+/)){var c=o.substr(0,2)==="//";c&&!(l&&jd[l])&&(o=o.substr(2),this.slashes=!0)}if(!jd[l]&&(c||l&&!Za[l])){for(var _=-1,f=0;f<CT.length;f++){var g=o.indexOf(CT[f]);g!==-1&&(_===-1||g<_)&&(_=g)}var I,p;_===-1?p=o.lastIndexOf("@"):p=o.lastIndexOf("@",_),p!==-1&&(I=o.slice(0,p),o=o.slice(p+1),this.auth=decodeURIComponent(I)),_=-1;for(var f=0;f<yT.length;f++){var g=o.indexOf(yT[f]);g!==-1&&(_===-1||g<_)&&(_=g)}_===-1&&(_=o.length),this.host=o.slice(0,_),o=o.slice(_),this.parseHost(),this.hostname=this.hostname||"";var R=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!R)for(var S=this.hostname.split(/\./),f=0,O=S.length;f<O;f++){var A=S[f];if(A&&!A.match(MT)){for(var C="",M=0,N=A.length;M<N;M++)A.charCodeAt(M)>127?C+="x":C+=A[M];if(!C.match(MT)){var L=S.slice(0,f),b=S.slice(f+1),D=A.match(Bz);D&&(L.push(D[1]),b.unshift(D[2])),b.length&&(o="/"+b.join(".")+o),this.hostname=L.join(".");break}}}this.hostname.length>Gz?this.hostname="":this.hostname=this.hostname.toLowerCase(),R||(this.hostname=Dz.toASCII(this.hostname));var x=this.port?":"+this.port:"",q=this.hostname||"";this.host=q+x,this.href+=this.host,R&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),o[0]!=="/"&&(o="/"+o))}if(!Hz[d])for(var f=0,O=Vd.length;f<O;f++){var $=Vd[f];if(o.indexOf($)!==-1){var Te=encodeURIComponent($);Te===$&&(Te=escape($)),o=o.split($).join(Te)}}var j=o.indexOf("#");j!==-1&&(this.hash=o.substr(j),o=o.slice(0,j));var Q=o.indexOf("?");if(Q!==-1?(this.search=o.substr(Q),this.query=o.substr(Q+1),e&&(this.query=Yd.parse(this.query)),o=o.slice(0,Q)):e&&(this.search="",this.query={}),o&&(this.pathname=o),Za[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var x=this.pathname||"",oe=this.search||"";this.path=x+oe}return this.href=this.format(),this};function kz(r){return typeof r=="string"&&(r=Pl(r)),r instanceof Sr?r.format():Sr.prototype.format.call(r)}Sr.prototype.format=function(){var r=this.auth||"";r&&(r=encodeURIComponent(r),r=r.replace(/%3A/i,":"),r+="@");var e=this.protocol||"",t=this.pathname||"",s=this.hash||"",i=!1,n="";this.host?i=r+this.host:this.hostname&&(i=r+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(n=Yd.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var a=this.search||n&&"?"+n||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||Za[e])&&i!==!1?(i="//"+(i||""),t&&t.charAt(0)!=="/"&&(t="/"+t)):i||(i=""),s&&s.charAt(0)!=="#"&&(s="#"+s),a&&a.charAt(0)!=="?"&&(a="?"+a),t=t.replace(/[?#]/g,function(o){return encodeURIComponent(o)}),a=a.replace("#","%23"),e+i+t+a+s};function Vz(r,e){return Pl(r,!1,!0).resolve(e)}Sr.prototype.resolve=function(r){return this.resolveObject(Pl(r,!1,!0)).format()},Sr.prototype.resolveObject=function(r){if(typeof r=="string"){var e=new Sr;e.parse(r,!1,!0),r=e}for(var t=new Sr,s=Object.keys(this),i=0;i<s.length;i++){var n=s[i];t[n]=this[n]}if(t.hash=r.hash,r.href==="")return t.href=t.format(),t;if(r.slashes&&!r.protocol){for(var a=Object.keys(r),o=0;o<a.length;o++){var u=a[o];u!=="protocol"&&(t[u]=r[u])}return Za[t.protocol]&&t.hostname&&!t.pathname&&(t.pathname="/",t.path=t.pathname),t.href=t.format(),t}if(r.protocol&&r.protocol!==t.protocol){if(!Za[r.protocol]){for(var l=Object.keys(r),d=0;d<l.length;d++){var c=l[d];t[c]=r[c]}return t.href=t.format(),t}if(t.protocol=r.protocol,!r.host&&!jd[r.protocol]){for(var O=(r.pathname||"").split("/");O.length&&!(r.host=O.shift()););r.host||(r.host=""),r.hostname||(r.hostname=""),O[0]!==""&&O.unshift(""),O.length<2&&O.unshift(""),t.pathname=O.join("/")}else t.pathname=r.pathname;if(t.search=r.search,t.query=r.query,t.host=r.host||"",t.auth=r.auth,t.hostname=r.hostname||r.host,t.port=r.port,t.pathname||t.search){var _=t.pathname||"",f=t.search||"";t.path=_+f}return t.slashes=t.slashes||r.slashes,t.href=t.format(),t}var g=t.pathname&&t.pathname.charAt(0)==="/",I=r.host||r.pathname&&r.pathname.charAt(0)==="/",p=I||g||t.host&&r.pathname,R=p,S=t.pathname&&t.pathname.split("/")||[],O=r.pathname&&r.pathname.split("/")||[],A=t.protocol&&!Za[t.protocol];if(A&&(t.hostname="",t.port=null,t.host&&(S[0]===""?S[0]=t.host:S.unshift(t.host)),t.host="",r.protocol&&(r.hostname=null,r.port=null,r.host&&(O[0]===""?O[0]=r.host:O.unshift(r.host)),r.host=null),p=p&&(O[0]===""||S[0]==="")),I)t.host=r.host||r.host===""?r.host:t.host,t.hostname=r.hostname||r.hostname===""?r.hostname:t.hostname,t.search=r.search,t.query=r.query,S=O;else if(O.length)S||(S=[]),S.pop(),S=S.concat(O),t.search=r.search,t.query=r.query;else if(r.search!=null){if(A){t.host=S.shift(),t.hostname=t.host;var C=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;C&&(t.auth=C.shift(),t.hostname=C.shift(),t.host=t.hostname)}return t.search=r.search,t.query=r.query,(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t}if(!S.length)return t.pathname=null,t.search?t.path="/"+t.search:t.path=null,t.href=t.format(),t;for(var M=S.slice(-1)[0],N=(t.host||r.host||S.length>1)&&(M==="."||M==="..")||M==="",L=0,b=S.length;b>=0;b--)M=S[b],M==="."?S.splice(b,1):M===".."?(S.splice(b,1),L++):L&&(S.splice(b,1),L--);if(!p&&!R)for(;L--;L)S.unshift("..");p&&S[0]!==""&&(!S[0]||S[0].charAt(0)!=="/")&&S.unshift(""),N&&S.join("/").substr(-1)!=="/"&&S.push("");var D=S[0]===""||S[0]&&S[0].charAt(0)==="/";if(A){t.hostname=D?"":S.length?S.shift():"",t.host=t.hostname;var C=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;C&&(t.auth=C.shift(),t.hostname=C.shift(),t.host=t.hostname)}return p=p||t.host&&S.length,p&&!D&&S.unshift(""),S.length>0?t.pathname=S.join("/"):(t.pathname=null,t.path=null),(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=r.auth||t.auth,t.slashes=t.slashes||r.slashes,t.href=t.format(),t},Sr.prototype.parseHost=function(){var r=this.host,e=Uz.exec(r);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),r=r.substr(0,r.length-e.length)),r&&(this.hostname=r)};var jz=Pl,Yz=Vz,Wz=kz;/*!
 * @pixi/utils - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var uh={parse:jz,format:Wz,resolve:Yz};J.RETINA_PREFIX=/@([0-9\.]+)x/,J.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var PT=!1,NT="6.5.10";function zz(r){var e;if(!PT){if(J.ADAPTER.getNavigator().userAgent.toLowerCase().indexOf("chrome")>-1){var t=[`
 %c %c %c PixiJS `+NT+" -  "+r+`   %c  %c  http://www.pixijs.com/  %c %c %c%c 

`,"background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=globalThis.console).log.apply(e,t)}else globalThis.console&&globalThis.console.log("PixiJS "+NT+" - "+r+" - http://www.pixijs.com/");PT=!0}}var Wd;function Xz(){return typeof Wd>"u"&&(Wd=function(){var e={stencil:!0,failIfMajorPerformanceCaveat:J.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!J.ADAPTER.getWebGLRenderingContext())return!1;var t=J.ADAPTER.createCanvas(),s=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),i=!!(s&&s.getContextAttributes().stencil);if(s){var n=s.getExtension("WEBGL_lose_context");n&&n.loseContext()}return s=null,i}catch{return!1}}()),Wd}var Kz="#f0f8ff",qz="#faebd7",Qz="#00ffff",Zz="#7fffd4",Jz="#f0ffff",$z="#f5f5dc",e4="#ffe4c4",t4="#000000",s4="#ffebcd",r4="#0000ff",i4="#8a2be2",n4="#a52a2a",a4="#deb887",o4="#5f9ea0",h4="#7fff00",u4="#d2691e",l4="#ff7f50",c4="#6495ed",_4="#fff8dc",d4="#dc143c",f4="#00ffff",g4="#00008b",E4="#008b8b",m4="#b8860b",p4="#a9a9a9",I4="#006400",T4="#a9a9a9",R4="#bdb76b",v4="#8b008b",O4="#556b2f",S4="#ff8c00",A4="#9932cc",y4="#8b0000",C4="#e9967a",M4="#8fbc8f",P4="#483d8b",N4="#2f4f4f",b4="#2f4f4f",D4="#00ced1",L4="#9400d3",U4="#ff1493",F4="#00bfff",w4="#696969",x4="#696969",G4="#1e90ff",B4="#b22222",H4="#fffaf0",k4="#228b22",V4="#ff00ff",j4="#dcdcdc",Y4="#f8f8ff",W4="#daa520",z4="#ffd700",X4="#808080",K4="#008000",q4="#adff2f",Q4="#808080",Z4="#f0fff0",J4="#ff69b4",$4="#cd5c5c",eX="#4b0082",tX="#fffff0",sX="#f0e68c",rX="#fff0f5",iX="#e6e6fa",nX="#7cfc00",aX="#fffacd",oX="#add8e6",hX="#f08080",uX="#e0ffff",lX="#fafad2",cX="#d3d3d3",_X="#90ee90",dX="#d3d3d3",fX="#ffb6c1",gX="#ffa07a",EX="#20b2aa",mX="#87cefa",pX="#778899",IX="#778899",TX="#b0c4de",RX="#ffffe0",vX="#00ff00",OX="#32cd32",SX="#faf0e6",AX="#ff00ff",yX="#800000",CX="#66cdaa",MX="#0000cd",PX="#ba55d3",NX="#9370db",bX="#3cb371",DX="#7b68ee",LX="#00fa9a",UX="#48d1cc",FX="#c71585",wX="#191970",xX="#f5fffa",GX="#ffe4e1",BX="#ffe4b5",HX="#ffdead",kX="#000080",VX="#fdf5e6",jX="#808000",YX="#6b8e23",WX="#ffa500",zX="#ff4500",XX="#da70d6",KX="#eee8aa",qX="#98fb98",QX="#afeeee",ZX="#db7093",JX="#ffefd5",$X="#ffdab9",e6="#cd853f",t6="#ffc0cb",s6="#dda0dd",r6="#b0e0e6",i6="#800080",n6="#663399",a6="#ff0000",o6="#bc8f8f",h6="#4169e1",u6="#8b4513",l6="#fa8072",c6="#f4a460",_6="#2e8b57",d6="#fff5ee",f6="#a0522d",g6="#c0c0c0",E6="#87ceeb",m6="#6a5acd",p6="#708090",I6="#708090",T6="#fffafa",R6="#00ff7f",v6="#4682b4",O6="#d2b48c",S6="#008080",A6="#d8bfd8",y6="#ff6347",C6="#40e0d0",M6="#ee82ee",P6="#f5deb3",N6="#ffffff",b6="#f5f5f5",D6="#ffff00",L6="#9acd32",U6={aliceblue:Kz,antiquewhite:qz,aqua:Qz,aquamarine:Zz,azure:Jz,beige:$z,bisque:e4,black:t4,blanchedalmond:s4,blue:r4,blueviolet:i4,brown:n4,burlywood:a4,cadetblue:o4,chartreuse:h4,chocolate:u4,coral:l4,cornflowerblue:c4,cornsilk:_4,crimson:d4,cyan:f4,darkblue:g4,darkcyan:E4,darkgoldenrod:m4,darkgray:p4,darkgreen:I4,darkgrey:T4,darkkhaki:R4,darkmagenta:v4,darkolivegreen:O4,darkorange:S4,darkorchid:A4,darkred:y4,darksalmon:C4,darkseagreen:M4,darkslateblue:P4,darkslategray:N4,darkslategrey:b4,darkturquoise:D4,darkviolet:L4,deeppink:U4,deepskyblue:F4,dimgray:w4,dimgrey:x4,dodgerblue:G4,firebrick:B4,floralwhite:H4,forestgreen:k4,fuchsia:V4,gainsboro:j4,ghostwhite:Y4,goldenrod:W4,gold:z4,gray:X4,green:K4,greenyellow:q4,grey:Q4,honeydew:Z4,hotpink:J4,indianred:$4,indigo:eX,ivory:tX,khaki:sX,lavenderblush:rX,lavender:iX,lawngreen:nX,lemonchiffon:aX,lightblue:oX,lightcoral:hX,lightcyan:uX,lightgoldenrodyellow:lX,lightgray:cX,lightgreen:_X,lightgrey:dX,lightpink:fX,lightsalmon:gX,lightseagreen:EX,lightskyblue:mX,lightslategray:pX,lightslategrey:IX,lightsteelblue:TX,lightyellow:RX,lime:vX,limegreen:OX,linen:SX,magenta:AX,maroon:yX,mediumaquamarine:CX,mediumblue:MX,mediumorchid:PX,mediumpurple:NX,mediumseagreen:bX,mediumslateblue:DX,mediumspringgreen:LX,mediumturquoise:UX,mediumvioletred:FX,midnightblue:wX,mintcream:xX,mistyrose:GX,moccasin:BX,navajowhite:HX,navy:kX,oldlace:VX,olive:jX,olivedrab:YX,orange:WX,orangered:zX,orchid:XX,palegoldenrod:KX,palegreen:qX,paleturquoise:QX,palevioletred:ZX,papayawhip:JX,peachpuff:$X,peru:e6,pink:t6,plum:s6,powderblue:r6,purple:i6,rebeccapurple:n6,red:a6,rosybrown:o6,royalblue:h6,saddlebrown:u6,salmon:l6,sandybrown:c6,seagreen:_6,seashell:d6,sienna:f6,silver:g6,skyblue:E6,slateblue:m6,slategray:p6,slategrey:I6,snow:T6,springgreen:R6,steelblue:v6,tan:O6,teal:S6,thistle:A6,tomato:y6,turquoise:C6,violet:M6,wheat:P6,white:N6,whitesmoke:b6,yellow:D6,yellowgreen:L6};function Nl(r,e){return e===void 0&&(e=[]),e[0]=(r>>16&255)/255,e[1]=(r>>8&255)/255,e[2]=(r&255)/255,e}function bT(r){var e=r.toString(16);return e="000000".substring(0,6-e.length)+e,"#"+e}function F6(r){return typeof r=="string"&&(r=U6[r.toLowerCase()]||r,r[0]==="#"&&(r=r.slice(1))),parseInt(r,16)}function w6(){for(var r=[],e=[],t=0;t<32;t++)r[t]=t,e[t]=t;r[se.NORMAL_NPM]=se.NORMAL,r[se.ADD_NPM]=se.ADD,r[se.SCREEN_NPM]=se.SCREEN,e[se.NORMAL]=se.NORMAL_NPM,e[se.ADD]=se.ADD_NPM,e[se.SCREEN]=se.SCREEN_NPM;var s=[];return s.push(e),s.push(r),s}var DT=w6();function x6(r,e){return DT[e?1:0][r]}function LT(r,e){if(e===1)return(e*255<<24)+r;if(e===0)return 0;var t=r>>16&255,s=r>>8&255,i=r&255;return t=t*e+.5|0,s=s*e+.5|0,i=i*e+.5|0,(e*255<<24)+(t<<16)+(s<<8)+i}function G6(r,e,t,s){return t=t||new Float32Array(4),t[0]=(r>>16&255)/255,t[1]=(r>>8&255)/255,t[2]=(r&255)/255,(s||s===void 0)&&(t[0]*=e,t[1]*=e,t[2]*=e),t[3]=e,t}function B6(r,e){e===void 0&&(e=null);var t=r*6;if(e=e||new Uint16Array(t),e.length!==t)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+t);for(var s=0,i=0;s<t;s+=6,i+=4)e[s+0]=i+0,e[s+1]=i+1,e[s+2]=i+2,e[s+3]=i+0,e[s+4]=i+2,e[s+5]=i+3;return e}function UT(r){if(r.BYTES_PER_ELEMENT===4)return r instanceof Float32Array?"Float32Array":r instanceof Uint32Array?"Uint32Array":"Int32Array";if(r.BYTES_PER_ELEMENT===2){if(r instanceof Uint16Array)return"Uint16Array"}else if(r.BYTES_PER_ELEMENT===1&&r instanceof Uint8Array)return"Uint8Array";return null}function bl(r){return r+=r===0?1:0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1}function FT(r){return!(r&r-1)&&!!r}function wT(r){var e=(r>65535?1:0)<<4;r>>>=e;var t=(r>255?1:0)<<3;return r>>>=t,e|=t,t=(r>15?1:0)<<2,r>>>=t,e|=t,t=(r>3?1:0)<<1,r>>>=t,e|=t,e|r>>1}function Dl(r,e,t){var s=r.length,i;if(!(e>=s||t===0)){t=e+t>s?s-e:t;var n=s-t;for(i=e;i<n;++i)r[i]=r[i+t];r.length=n}}function Ja(r){return r===0?0:r<0?-1:1}var H6=0;function Kn(){return++H6}var xT={};function Wr(r,e,t){if(t===void 0&&(t=3),!xT[e]){var s=new Error().stack;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",e+`
Deprecated since v`+r):(s=s.split(`
`).splice(t).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+`
Deprecated since v`+r),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+`
Deprecated since v`+r),console.warn(s))),xT[e]=!0}}var GT={},Mi=Object.create(null),qn=Object.create(null),BT=function(){function r(e,t,s){this.canvas=J.ADAPTER.createCanvas(),this.context=this.canvas.getContext("2d"),this.resolution=s||J.RESOLUTION,this.resize(e,t)}return r.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},r.prototype.resize=function(e,t){this.canvas.width=Math.round(e*this.resolution),this.canvas.height=Math.round(t*this.resolution)},r.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(r.prototype,"width",{get:function(){return this.canvas.width},set:function(e){this.canvas.width=Math.round(e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this.canvas.height},set:function(e){this.canvas.height=Math.round(e)},enumerable:!1,configurable:!0}),r}();function k6(r){var e=r.width,t=r.height,s=r.getContext("2d",{willReadFrequently:!0}),i=s.getImageData(0,0,e,t),n=i.data,a=n.length,o={top:null,left:null,right:null,bottom:null},u=null,l,d,c;for(l=0;l<a;l+=4)n[l+3]!==0&&(d=l/4%e,c=~~(l/4/e),o.top===null&&(o.top=c),(o.left===null||d<o.left)&&(o.left=d),(o.right===null||o.right<d)&&(o.right=d+1),(o.bottom===null||o.bottom<c)&&(o.bottom=c));return o.top!==null&&(e=o.right-o.left,t=o.bottom-o.top+1,u=s.getImageData(o.left,o.top,e,t)),{height:t,width:e,data:u}}var Ll;function V6(r,e){if(e===void 0&&(e=globalThis.location),r.indexOf("data:")===0)return"";e=e||globalThis.location,Ll||(Ll=document.createElement("a")),Ll.href=r;var t=uh.parse(Ll.href),s=!t.port&&e.port===""||t.port===e.port;return t.hostname!==e.hostname||!s||t.protocol!==e.protocol?"anonymous":""}function zd(r,e){var t=J.RETINA_PREFIX.exec(r);return t?parseFloat(t[1]):e!==void 0?e:1}/*!
 * @pixi/extensions - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/extensions is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var lh=function(){return lh=Object.assign||function(e){for(var t=arguments,s,i=1,n=arguments.length;i<n;i++){s=t[i];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},lh.apply(this,arguments)},Lt;(function(r){r.Application="application",r.RendererPlugin="renderer-webgl-plugin",r.CanvasRendererPlugin="renderer-canvas-plugin",r.Loader="loader",r.LoadParser="load-parser",r.ResolveParser="resolve-parser",r.CacheParser="cache-parser",r.DetectionParser="detection-parser"})(Lt||(Lt={}));var HT=function(r){if(typeof r=="function"||typeof r=="object"&&r.extension){if(!r.extension)throw new Error("Extension class must have an extension object");var e=typeof r.extension!="object"?{type:r.extension}:r.extension;r=lh(lh({},e),{ref:r})}if(typeof r=="object")r=lh({},r);else throw new Error("Invalid extension type");return typeof r.type=="string"&&(r.type=[r.type]),r},Pi={_addHandlers:null,_removeHandlers:null,_queue:{},remove:function(){for(var r=arguments,e=this,t=[],s=0;s<arguments.length;s++)t[s]=r[s];return t.map(HT).forEach(function(i){i.type.forEach(function(n){var a,o;return(o=(a=e._removeHandlers)[n])===null||o===void 0?void 0:o.call(a,i)})}),this},add:function(){for(var r=arguments,e=this,t=[],s=0;s<arguments.length;s++)t[s]=r[s];return t.map(HT).forEach(function(i){i.type.forEach(function(n){var a=e._addHandlers,o=e._queue;a[n]?a[n](i):(o[n]=o[n]||[],o[n].push(i))})}),this},handle:function(r,e,t){var s=this._addHandlers=this._addHandlers||{},i=this._removeHandlers=this._removeHandlers||{};if(s[r]||i[r])throw new Error("Extension type "+r+" already has a handler");s[r]=e,i[r]=t;var n=this._queue;return n[r]&&(n[r].forEach(function(a){return e(a)}),delete n[r]),this},handleByMap:function(r,e){return this.handle(r,function(t){e[t.name]=t.ref},function(t){delete e[t.name]})},handleByList:function(r,e){return this.handle(r,function(t){var s,i;e.includes(t.ref)||(e.push(t.ref),r===Lt.Loader&&((i=(s=t.ref).add)===null||i===void 0||i.call(s)))},function(t){var s=e.indexOf(t.ref);s!==-1&&e.splice(s,1)})}};/*!
 * @pixi/runner - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ts=function(){function r(e){this.items=[],this._name=e,this._aliasCount=0}return r.prototype.emit=function(e,t,s,i,n,a,o,u){if(arguments.length>8)throw new Error("max arguments reached");var l=this,d=l.name,c=l.items;this._aliasCount++;for(var _=0,f=c.length;_<f;_++)c[_][d](e,t,s,i,n,a,o,u);return c===this.items&&this._aliasCount--,this},r.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},r.prototype.add=function(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this},r.prototype.remove=function(e){var t=this.items.indexOf(e);return t!==-1&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this},r.prototype.contains=function(e){return this.items.indexOf(e)!==-1},r.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},r.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(r.prototype,"empty",{get:function(){return this.items.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),r}();Object.defineProperties(ts.prototype,{dispatch:{value:ts.prototype.emit},run:{value:ts.prototype.emit}});/*!
 * @pixi/ticker - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */J.TARGET_FPMS=.06;var $a;(function(r){r[r.INTERACTION=50]="INTERACTION",r[r.HIGH=25]="HIGH",r[r.NORMAL=0]="NORMAL",r[r.LOW=-25]="LOW",r[r.UTILITY=-50]="UTILITY"})($a||($a={}));var Xd=function(){function r(e,t,s,i){t===void 0&&(t=null),s===void 0&&(s=0),i===void 0&&(i=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=t,this.priority=s,this.once=i}return r.prototype.match=function(e,t){return t===void 0&&(t=null),this.fn===e&&this.context===t},r.prototype.emit=function(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));var t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t},r.prototype.connect=function(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this},r.prototype.destroy=function(e){e===void 0&&(e=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var t=this.next;return this.next=e?null:t,this.previous=null,t},r}(),zr=function(){function r(){var e=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Xd(null,null,1/0),this.deltaMS=1/J.TARGET_FPMS,this.elapsedMS=1/J.TARGET_FPMS,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&e._requestId===null&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}return r.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},r.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},r.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},r.prototype.add=function(e,t,s){return s===void 0&&(s=$a.NORMAL),this._addListener(new Xd(e,t,s))},r.prototype.addOnce=function(e,t,s){return s===void 0&&(s=$a.NORMAL),this._addListener(new Xd(e,t,s,!0))},r.prototype._addListener=function(e){var t=this._head.next,s=this._head;if(!t)e.connect(s);else{for(;t;){if(e.priority>t.priority){e.connect(s);break}s=t,t=t.next}e.previous||e.connect(s)}return this._startIfPossible(),this},r.prototype.remove=function(e,t){for(var s=this._head.next;s;)s.match(e,t)?s=s.destroy():s=s.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(r.prototype,"count",{get:function(){if(!this._head)return 0;for(var e=0,t=this._head;t=t.next;)e++;return e},enumerable:!1,configurable:!0}),r.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},r.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},r.prototype.destroy=function(){if(!this._protected){this.stop();for(var e=this._head.next;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}},r.prototype.update=function(e){e===void 0&&(e=performance.now());var t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){var s=e-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=e-s%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*J.TARGET_FPMS;for(var i=this._head,n=i.next;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e},Object.defineProperty(r.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(e){var t=Math.min(this.maxFPS,e),s=Math.min(Math.max(0,t)/1e3,J.TARGET_FPMS);this._maxElapsedMS=1/s},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(e){if(e===0)this._minElapsedMS=0;else{var t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(r,"shared",{get:function(){if(!r._shared){var e=r._shared=new r;e.autoStart=!0,e._protected=!0}return r._shared},enumerable:!1,configurable:!0}),Object.defineProperty(r,"system",{get:function(){if(!r._system){var e=r._system=new r;e.autoStart=!0,e._protected=!0}return r._system},enumerable:!1,configurable:!0}),r}(),j6=function(){function r(){}return r.init=function(e){var t=this;e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set:function(s){this._ticker&&this._ticker.remove(this.render,this),this._ticker=s,s&&s.add(this.render,this,$a.LOW)},get:function(){return this._ticker}}),this.stop=function(){t._ticker.stop()},this.start=function(){t._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?zr.shared:new zr,e.autoStart&&this.start()},r.destroy=function(){if(this._ticker){var e=this._ticker;this.ticker=null,e.destroy()}},r.extension=Lt.Application,r}();/*!
 * @pixi/math - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ch=Math.PI*2,Y6=180/Math.PI,W6=Math.PI/180,Wt;(function(r){r[r.POLY=0]="POLY",r[r.RECT=1]="RECT",r[r.CIRC=2]="CIRC",r[r.ELIP=3]="ELIP",r[r.RREC=4]="RREC"})(Wt||(Wt={}));var k=function(){function r(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.x=0,this.y=0,this.x=e,this.y=t}return r.prototype.clone=function(){return new r(this.x,this.y)},r.prototype.copyFrom=function(e){return this.set(e.x,e.y),this},r.prototype.copyTo=function(e){return e.set(this.x,this.y),e},r.prototype.equals=function(e){return e.x===this.x&&e.y===this.y},r.prototype.set=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=e),this.x=e,this.y=t,this},r.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},r}(),Ul=[new k,new k,new k,new k],he=function(){function r(e,t,s,i){e===void 0&&(e=0),t===void 0&&(t=0),s===void 0&&(s=0),i===void 0&&(i=0),this.x=Number(e),this.y=Number(t),this.width=Number(s),this.height=Number(i),this.type=Wt.RECT}return Object.defineProperty(r.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(r,"EMPTY",{get:function(){return new r(0,0,0,0)},enumerable:!1,configurable:!0}),r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.copyFrom=function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this},r.prototype.copyTo=function(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e},r.prototype.contains=function(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height},r.prototype.intersects=function(e,t){if(!t){var s=this.x<e.x?e.x:this.x,i=this.right>e.right?e.right:this.right;if(i<=s)return!1;var n=this.y<e.y?e.y:this.y,a=this.bottom>e.bottom?e.bottom:this.bottom;return a>n}var o=this.left,u=this.right,l=this.top,d=this.bottom;if(u<=o||d<=l)return!1;var c=Ul[0].set(e.left,e.top),_=Ul[1].set(e.left,e.bottom),f=Ul[2].set(e.right,e.top),g=Ul[3].set(e.right,e.bottom);if(f.x<=c.x||_.y<=c.y)return!1;var I=Math.sign(t.a*t.d-t.b*t.c);if(I===0||(t.apply(c,c),t.apply(_,_),t.apply(f,f),t.apply(g,g),Math.max(c.x,_.x,f.x,g.x)<=o||Math.min(c.x,_.x,f.x,g.x)>=u||Math.max(c.y,_.y,f.y,g.y)<=l||Math.min(c.y,_.y,f.y,g.y)>=d))return!1;var p=I*(_.y-c.y),R=I*(c.x-_.x),S=p*o+R*l,O=p*u+R*l,A=p*o+R*d,C=p*u+R*d;if(Math.max(S,O,A,C)<=p*c.x+R*c.y||Math.min(S,O,A,C)>=p*g.x+R*g.y)return!1;var M=I*(c.y-f.y),N=I*(f.x-c.x),L=M*o+N*l,b=M*u+N*l,D=M*o+N*d,x=M*u+N*d;return!(Math.max(L,b,D,x)<=M*c.x+N*c.y||Math.min(L,b,D,x)>=M*g.x+N*g.y)},r.prototype.pad=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=e),this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this},r.prototype.fit=function(e){var t=Math.max(this.x,e.x),s=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),n=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(s-t,0),this.y=i,this.height=Math.max(n-i,0),this},r.prototype.ceil=function(e,t){e===void 0&&(e=1),t===void 0&&(t=.001);var s=Math.ceil((this.x+this.width-t)*e)/e,i=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=s-this.x,this.height=i-this.y,this},r.prototype.enlarge=function(e){var t=Math.min(this.x,e.x),s=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),n=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=s-t,this.y=i,this.height=n-i,this},r.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},r}(),z6=function(){function r(e,t,s){e===void 0&&(e=0),t===void 0&&(t=0),s===void 0&&(s=0),this.x=e,this.y=t,this.radius=s,this.type=Wt.CIRC}return r.prototype.clone=function(){return new r(this.x,this.y,this.radius)},r.prototype.contains=function(e,t){if(this.radius<=0)return!1;var s=this.radius*this.radius,i=this.x-e,n=this.y-t;return i*=i,n*=n,i+n<=s},r.prototype.getBounds=function(){return new he(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)},r.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},r}(),X6=function(){function r(e,t,s,i){e===void 0&&(e=0),t===void 0&&(t=0),s===void 0&&(s=0),i===void 0&&(i=0),this.x=e,this.y=t,this.width=s,this.height=i,this.type=Wt.ELIP}return r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;var s=(e-this.x)/this.width,i=(t-this.y)/this.height;return s*=s,i*=i,s+i<=1},r.prototype.getBounds=function(){return new he(this.x-this.width,this.y-this.height,this.width,this.height)},r.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},r}(),_h=function(){function r(){for(var e=arguments,t=[],s=0;s<arguments.length;s++)t[s]=e[s];var i=Array.isArray(t[0])?t[0]:t;if(typeof i[0]!="number"){for(var n=[],a=0,o=i.length;a<o;a++)n.push(i[a].x,i[a].y);i=n}this.points=i,this.type=Wt.POLY,this.closeStroke=!0}return r.prototype.clone=function(){var e=this.points.slice(),t=new r(e);return t.closeStroke=this.closeStroke,t},r.prototype.contains=function(e,t){for(var s=!1,i=this.points.length/2,n=0,a=i-1;n<i;a=n++){var o=this.points[n*2],u=this.points[n*2+1],l=this.points[a*2],d=this.points[a*2+1],c=u>t!=d>t&&e<(l-o)*((t-u)/(d-u))+o;c&&(s=!s)}return s},r.prototype.toString=function(){return"[@pixi/math:Polygon"+("closeStroke="+this.closeStroke)+("points="+this.points.reduce(function(e,t){return e+", "+t},"")+"]")},r}(),K6=function(){function r(e,t,s,i,n){e===void 0&&(e=0),t===void 0&&(t=0),s===void 0&&(s=0),i===void 0&&(i=0),n===void 0&&(n=20),this.x=e,this.y=t,this.width=s,this.height=i,this.radius=n,this.type=Wt.RREC}return r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height,this.radius)},r.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){var s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+s&&t<=this.y+this.height-s||e>=this.x+s&&e<=this.x+this.width-s)return!0;var i=e-(this.x+s),n=t-(this.y+s),a=s*s;if(i*i+n*n<=a||(i=e-(this.x+this.width-s),i*i+n*n<=a)||(n=t-(this.y+this.height-s),i*i+n*n<=a)||(i=e-(this.x+s),i*i+n*n<=a))return!0}return!1},r.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+("width="+this.width+" height="+this.height+" radius="+this.radius+"]")},r}(),eo=function(){function r(e,t,s,i){s===void 0&&(s=0),i===void 0&&(i=0),this._x=s,this._y=i,this.cb=e,this.scope=t}return r.prototype.clone=function(e,t){return e===void 0&&(e=this.cb),t===void 0&&(t=this.scope),new r(e,t,this._x,this._y)},r.prototype.set=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=e),(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this.cb.call(this.scope)),this},r.prototype.copyFrom=function(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this},r.prototype.copyTo=function(e){return e.set(this._x,this._y),e},r.prototype.equals=function(e){return e.x===this._x&&e.y===this._y},r.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(r.prototype,"x",{get:function(){return this._x},set:function(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"y",{get:function(){return this._y},set:function(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),r}(),Ye=function(){function r(e,t,s,i,n,a){e===void 0&&(e=1),t===void 0&&(t=0),s===void 0&&(s=0),i===void 0&&(i=1),n===void 0&&(n=0),a===void 0&&(a=0),this.array=null,this.a=e,this.b=t,this.c=s,this.d=i,this.tx=n,this.ty=a}return r.prototype.fromArray=function(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]},r.prototype.set=function(e,t,s,i,n,a){return this.a=e,this.b=t,this.c=s,this.d=i,this.tx=n,this.ty=a,this},r.prototype.toArray=function(e,t){this.array||(this.array=new Float32Array(9));var s=t||this.array;return e?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s},r.prototype.apply=function(e,t){t=t||new k;var s=e.x,i=e.y;return t.x=this.a*s+this.c*i+this.tx,t.y=this.b*s+this.d*i+this.ty,t},r.prototype.applyInverse=function(e,t){t=t||new k;var s=1/(this.a*this.d+this.c*-this.b),i=e.x,n=e.y;return t.x=this.d*s*i+-this.c*s*n+(this.ty*this.c-this.tx*this.d)*s,t.y=this.a*s*n+-this.b*s*i+(-this.ty*this.a+this.tx*this.b)*s,t},r.prototype.translate=function(e,t){return this.tx+=e,this.ty+=t,this},r.prototype.scale=function(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this},r.prototype.rotate=function(e){var t=Math.cos(e),s=Math.sin(e),i=this.a,n=this.c,a=this.tx;return this.a=i*t-this.b*s,this.b=i*s+this.b*t,this.c=n*t-this.d*s,this.d=n*s+this.d*t,this.tx=a*t-this.ty*s,this.ty=a*s+this.ty*t,this},r.prototype.append=function(e){var t=this.a,s=this.b,i=this.c,n=this.d;return this.a=e.a*t+e.b*i,this.b=e.a*s+e.b*n,this.c=e.c*t+e.d*i,this.d=e.c*s+e.d*n,this.tx=e.tx*t+e.ty*i+this.tx,this.ty=e.tx*s+e.ty*n+this.ty,this},r.prototype.setTransform=function(e,t,s,i,n,a,o,u,l){return this.a=Math.cos(o+l)*n,this.b=Math.sin(o+l)*n,this.c=-Math.sin(o-u)*a,this.d=Math.cos(o-u)*a,this.tx=e-(s*this.a+i*this.c),this.ty=t-(s*this.b+i*this.d),this},r.prototype.prepend=function(e){var t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){var s=this.a,i=this.c;this.a=s*e.a+this.b*e.c,this.b=s*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this},r.prototype.decompose=function(e){var t=this.a,s=this.b,i=this.c,n=this.d,a=e.pivot,o=-Math.atan2(-i,n),u=Math.atan2(s,t),l=Math.abs(o+u);return l<1e-5||Math.abs(ch-l)<1e-5?(e.rotation=u,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=o,e.skew.y=u),e.scale.x=Math.sqrt(t*t+s*s),e.scale.y=Math.sqrt(i*i+n*n),e.position.x=this.tx+(a.x*t+a.y*i),e.position.y=this.ty+(a.x*s+a.y*n),e},r.prototype.invert=function(){var e=this.a,t=this.b,s=this.c,i=this.d,n=this.tx,a=e*i-t*s;return this.a=i/a,this.b=-t/a,this.c=-s/a,this.d=e/a,this.tx=(s*this.ty-i*n)/a,this.ty=-(e*this.ty-t*n)/a,this},r.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},r.prototype.clone=function(){var e=new r;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},r.prototype.copyTo=function(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},r.prototype.copyFrom=function(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this},r.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(r,"IDENTITY",{get:function(){return new r},enumerable:!1,configurable:!0}),Object.defineProperty(r,"TEMP_MATRIX",{get:function(){return new r},enumerable:!1,configurable:!0}),r}(),Qn=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Zn=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Jn=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],$n=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Kd=[],kT=[],Fl=Math.sign;function q6(){for(var r=0;r<16;r++){var e=[];Kd.push(e);for(var t=0;t<16;t++)for(var s=Fl(Qn[r]*Qn[t]+Jn[r]*Zn[t]),i=Fl(Zn[r]*Qn[t]+$n[r]*Zn[t]),n=Fl(Qn[r]*Jn[t]+Jn[r]*$n[t]),a=Fl(Zn[r]*Jn[t]+$n[r]*$n[t]),o=0;o<16;o++)if(Qn[o]===s&&Zn[o]===i&&Jn[o]===n&&$n[o]===a){e.push(o);break}}for(var r=0;r<16;r++){var u=new Ye;u.set(Qn[r],Zn[r],Jn[r],$n[r],0,0),kT.push(u)}}q6();var we={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(r){return Qn[r]},uY:function(r){return Zn[r]},vX:function(r){return Jn[r]},vY:function(r){return $n[r]},inv:function(r){return r&8?r&15:-r&7},add:function(r,e){return Kd[r][e]},sub:function(r,e){return Kd[r][we.inv(e)]},rotate180:function(r){return r^4},isVertical:function(r){return(r&3)===2},byDirection:function(r,e){return Math.abs(r)*2<=Math.abs(e)?e>=0?we.S:we.N:Math.abs(e)*2<=Math.abs(r)?r>0?we.E:we.W:e>0?r>0?we.SE:we.SW:r>0?we.NE:we.NW},matrixAppendRotationInv:function(r,e,t,s){t===void 0&&(t=0),s===void 0&&(s=0);var i=kT[we.inv(e)];i.tx=t,i.ty=s,r.append(i)}},VT=function(){function r(){this.worldTransform=new Ye,this.localTransform=new Ye,this.position=new eo(this.onChange,this,0,0),this.scale=new eo(this.onChange,this,1,1),this.pivot=new eo(this.onChange,this,0,0),this.skew=new eo(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return r.prototype.onChange=function(){this._localID++},r.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},r.prototype.toString=function(){return"[@pixi/math:Transform "+("position=("+this.position.x+", "+this.position.y+") ")+("rotation="+this.rotation+" ")+("scale=("+this.scale.x+", "+this.scale.y+") ")+("skew=("+this.skew.x+", "+this.skew.y+") ")+"]"},r.prototype.updateLocalTransform=function(){var e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)},r.prototype.updateTransform=function(e){var t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){var s=e.worldTransform,i=this.worldTransform;i.a=t.a*s.a+t.b*s.c,i.b=t.a*s.b+t.b*s.d,i.c=t.c*s.a+t.d*s.c,i.d=t.c*s.b+t.d*s.d,i.tx=t.tx*s.a+t.ty*s.c+s.tx,i.ty=t.tx*s.b+t.ty*s.d+s.ty,this._parentID=e._worldID,this._worldID++}},r.prototype.setFromMatrix=function(e){e.decompose(this),this._localID++},Object.defineProperty(r.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())},enumerable:!1,configurable:!0}),r.IDENTITY=new r,r}();/*!
 * @pixi/core - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */J.PREFER_ENV=jn.any?Si.WEBGL:Si.WEBGL2,J.STRICT_TEXTURE_CACHE=!1;var qd=[];function jT(r,e){if(!r)return null;var t="";if(typeof r=="string"){var s=/\.(\w{3,4})(?:$|\?|#)/i.exec(r);s&&(t=s[1].toLowerCase())}for(var i=qd.length-1;i>=0;--i){var n=qd[i];if(n.test&&n.test(r,t))return new n(r,e)}throw new Error("Unrecognized source type to auto-detect Resource")}/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var Qd=function(r,e){return Qd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var i in s)s.hasOwnProperty(i)&&(t[i]=s[i])},Qd(r,e)};function at(r,e){Qd(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Zd=function(){return Zd=Object.assign||function(e){for(var t=arguments,s,i=1,n=arguments.length;i<n;i++){s=t[i];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Zd.apply(this,arguments)};function Q6(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(r);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(r,s[i])&&(t[s[i]]=r[s[i]]);return t}var dh=function(){function r(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new ts("setRealSize"),this.onUpdate=new ts("update"),this.onError=new ts("onError")}return r.prototype.bind=function(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},r.prototype.unbind=function(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)},r.prototype.resize=function(e,t){(e!==this._width||t!==this._height)&&(this._width=e,this._height=t,this.onResize.emit(e,t))},Object.defineProperty(r.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),r.prototype.update=function(){this.destroyed||this.onUpdate.emit()},r.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(r.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),r.prototype.style=function(e,t,s){return!1},r.prototype.dispose=function(){},r.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},r.test=function(e,t){return!1},r}(),Jd=function(r){at(e,r);function e(t,s){var i=this,n=s||{},a=n.width,o=n.height;if(!a||!o)throw new Error("BufferResource width or height invalid");return i=r.call(this,a,o)||this,i.data=t,i}return e.prototype.upload=function(t,s,i){var n=t.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.alphaMode===cn.UNPACK);var a=s.realWidth,o=s.realHeight;return i.width===a&&i.height===o?n.texSubImage2D(s.target,0,0,0,a,o,s.format,i.type,this.data):(i.width=a,i.height=o,n.texImage2D(s.target,0,i.internalFormat,a,o,0,s.format,i.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(dh),Z6={scaleMode:Ds.NEAREST,format:Z.RGBA,alphaMode:cn.NPM},Qe=function(r){at(e,r);function e(t,s){t===void 0&&(t=null),s===void 0&&(s=null);var i=r.call(this)||this;s=s||{};var n=s.alphaMode,a=s.mipmap,o=s.anisotropicLevel,u=s.scaleMode,l=s.width,d=s.height,c=s.wrapMode,_=s.format,f=s.type,g=s.target,I=s.resolution,p=s.resourceOptions;return t&&!(t instanceof dh)&&(t=jT(t,p),t.internal=!0),i.resolution=I||J.RESOLUTION,i.width=Math.round((l||0)*i.resolution)/i.resolution,i.height=Math.round((d||0)*i.resolution)/i.resolution,i._mipmap=a!==void 0?a:J.MIPMAP_TEXTURES,i.anisotropicLevel=o!==void 0?o:J.ANISOTROPIC_LEVEL,i._wrapMode=c||J.WRAP_MODE,i._scaleMode=u!==void 0?u:J.SCALE_MODE,i.format=_||Z.RGBA,i.type=f||He.UNSIGNED_BYTE,i.target=g||Vn.TEXTURE_2D,i.alphaMode=n!==void 0?n:cn.UNPACK,i.uid=Kn(),i.touched=0,i.isPowerOfTwo=!1,i._refreshPOT(),i._glTextures={},i.dirtyId=0,i.dirtyStyleId=0,i.cacheId=null,i.valid=l>0&&d>0,i.textureCacheIds=[],i.destroyed=!1,i.resource=null,i._batchEnabled=0,i._batchLocation=0,i.parentTextureArray=null,i.setResource(t),i}return Object.defineProperty(e.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mipmap",{get:function(){return this._mipmap},set:function(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),e.prototype.setStyle=function(t,s){var i;return t!==void 0&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),s!==void 0&&s!==this.mipmap&&(this.mipmap=s,i=!0),i&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,s,i){return i=i||this.resolution,this.setRealSize(t*i,s*i,i)},e.prototype.setRealSize=function(t,s,i){return this.resolution=i||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(s)/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=FT(this.realWidth)&&FT(this.realHeight)},e.prototype.setResolution=function(t){var s=this.resolution;return s===t?this:(this.resolution=t,this.valid&&(this.width=Math.round(this.width*s)/t,this.height=Math.round(this.height*s)/t,this.emit("update",this)),this._refreshPOT(),this)},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete qn[this.cacheId],delete Mi[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.prototype.castToBaseTexture=function(){return this},e.from=function(t,s,i){i===void 0&&(i=J.STRICT_TEXTURE_CACHE);var n=typeof t=="string",a=null;if(n)a=t;else{if(!t._pixiId){var o=s&&s.pixiIdPrefix||"pixiid";t._pixiId=o+"_"+Kn()}a=t._pixiId}var u=qn[a];if(n&&i&&!u)throw new Error('The cacheId "'+a+'" does not exist in BaseTextureCache.');return u||(u=new e(t,s),u.cacheId=a,e.addToCache(u,a)),u},e.fromBuffer=function(t,s,i,n){t=t||new Float32Array(s*i*4);var a=new Jd(t,{width:s,height:i}),o=t instanceof Float32Array?He.FLOAT:He.UNSIGNED_BYTE;return new e(a,Object.assign({},Z6,n||{width:s,height:i,type:o}))},e.addToCache=function(t,s){s&&(t.textureCacheIds.indexOf(s)===-1&&t.textureCacheIds.push(s),qn[s]&&console.warn("BaseTexture added to the cache with an id ["+s+"] that already had an entry"),qn[s]=t)},e.removeFromCache=function(t){if(typeof t=="string"){var s=qn[t];if(s){var i=s.textureCacheIds.indexOf(t);return i>-1&&s.textureCacheIds.splice(i,1),delete qn[t],s}}else if(t&&t.textureCacheIds){for(var n=0;n<t.textureCacheIds.length;++n)delete qn[t.textureCacheIds[n]];return t.textureCacheIds.length=0,t}return null},e._globalBatch=0,e}($o),YT=function(r){at(e,r);function e(t,s){var i=this,n=s||{},a=n.width,o=n.height;i=r.call(this,a,o)||this,i.items=[],i.itemDirtyIds=[];for(var u=0;u<t;u++){var l=new Qe;i.items.push(l),i.itemDirtyIds.push(-2)}return i.length=t,i._load=null,i.baseTexture=null,i}return e.prototype.initFromArray=function(t,s){for(var i=0;i<this.length;i++)t[i]&&(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof dh?this.addResourceAt(t[i],i):this.addResourceAt(jT(t[i],s),i))},e.prototype.dispose=function(){for(var t=0,s=this.length;t<s;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,s){if(!this.items[s])throw new Error("Index "+s+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[s].setResource(t),this},e.prototype.bind=function(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");r.prototype.bind.call(this,t);for(var s=0;s<this.length;s++)this.items[s].parentTextureArray=t,this.items[s].on("update",t.update,t)},e.prototype.unbind=function(t){r.prototype.unbind.call(this,t);for(var s=0;s<this.length;s++)this.items[s].parentTextureArray=null,this.items[s].off("update",t.update,t)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var s=this.items.map(function(n){return n.resource}).filter(function(n){return n}),i=s.map(function(n){return n.load()});return this._load=Promise.all(i).then(function(){var n=t.items[0],a=n.realWidth,o=n.realHeight;return t.resize(a,o),Promise.resolve(t)}),this._load},e}(dh),J6=function(r){at(e,r);function e(t,s){var i=this,n=s||{},a=n.width,o=n.height,u,l;return Array.isArray(t)?(u=t,l=t.length):l=t,i=r.call(this,l,{width:a,height:o})||this,u&&i.initFromArray(u,s),i}return e.prototype.addBaseTextureAt=function(t,s){if(t.resource)this.addResourceAt(t.resource,s);else throw new Error("ArrayResource does not support RenderTexture");return this},e.prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=Vn.TEXTURE_2D_ARRAY},e.prototype.upload=function(t,s,i){var n=this,a=n.length,o=n.itemDirtyIds,u=n.items,l=t.gl;i.dirtyId<0&&l.texImage3D(l.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,a,0,s.format,i.type,null);for(var d=0;d<a;d++){var c=u[d];o[d]<c.dirtyId&&(o[d]=c.dirtyId,c.valid&&l.texSubImage3D(l.TEXTURE_2D_ARRAY,0,0,0,d,c.resource.width,c.resource.height,1,s.format,i.type,c.resource.source))}return!0},e}(YT),En=function(r){at(e,r);function e(t){var s=this,i=t,n=i.naturalWidth||i.videoWidth||i.width,a=i.naturalHeight||i.videoHeight||i.height;return s=r.call(this,n,a)||this,s.source=t,s.noSubImage=!1,s}return e.crossOrigin=function(t,s,i){i===void 0&&s.indexOf("data:")!==0?t.crossOrigin=V6(s):i!==!1&&(t.crossOrigin=typeof i=="string"?i:"anonymous")},e.prototype.upload=function(t,s,i,n){var a=t.gl,o=s.realWidth,u=s.realHeight;if(n=n||this.source,n instanceof HTMLImageElement){if(!n.complete||n.naturalWidth===0)return!1}else if(n instanceof HTMLVideoElement&&n.readyState<=1)return!1;return a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.alphaMode===cn.UNPACK),!this.noSubImage&&s.target===a.TEXTURE_2D&&i.width===o&&i.height===u?a.texSubImage2D(a.TEXTURE_2D,0,0,0,s.format,i.type,n):(i.width=o,i.height=u,a.texImage2D(s.target,0,i.internalFormat,s.format,i.type,n)),!0},e.prototype.update=function(){if(!this.destroyed){var t=this.source,s=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(s,i),r.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(dh),$6=function(r){at(e,r);function e(t){return r.call(this,t)||this}return e.test=function(t){var s=globalThis.OffscreenCanvas;return s&&t instanceof s?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement},e}(En),e8=function(r){at(e,r);function e(t,s){var i=this,n=s||{},a=n.width,o=n.height,u=n.autoLoad,l=n.linkBaseTexture;if(t&&t.length!==e.SIDES)throw new Error("Invalid length. Got "+t.length+", expected 6");i=r.call(this,6,{width:a,height:o})||this;for(var d=0;d<e.SIDES;d++)i.items[d].target=Vn.TEXTURE_CUBE_MAP_POSITIVE_X+d;return i.linkBaseTexture=l!==!1,t&&i.initFromArray(t,s),u!==!1&&i.load(),i}return e.prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=Vn.TEXTURE_CUBE_MAP},e.prototype.addBaseTextureAt=function(t,s,i){if(!this.items[s])throw new Error("Index "+s+" is out of bounds");if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0)if(t.resource)this.addResourceAt(t.resource,s);else throw new Error("CubeResource does not support copying of renderTexture.");else t.target=Vn.TEXTURE_CUBE_MAP_POSITIVE_X+s,t.parentTextureArray=this.baseTexture,this.items[s]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[s]=t,this},e.prototype.upload=function(t,s,i){for(var n=this.itemDirtyIds,a=0;a<e.SIDES;a++){var o=this.items[a];(n[a]<o.dirtyId||i.dirtyId<s.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(t,o,i),n[a]=o.dirtyId):n[a]<-1&&(t.gl.texImage2D(o.target,0,i.internalFormat,s.realWidth,s.realHeight,0,s.format,i.type,null),n[a]=-1))}return!0},e.test=function(t){return Array.isArray(t)&&t.length===e.SIDES},e.SIDES=6,e}(YT),WT=function(r){at(e,r);function e(t,s){var i=this;if(s=s||{},!(t instanceof HTMLImageElement)){var n=new Image;En.crossOrigin(n,t,s.crossorigin),n.src=t,t=n}return i=r.call(this,t)||this,!t.complete&&i._width&&i._height&&(i._width=0,i._height=0),i.url=t.src,i._process=null,i.preserveBitmap=!1,i.createBitmap=(s.createBitmap!==void 0?s.createBitmap:J.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,i.alphaMode=typeof s.alphaMode=="number"?s.alphaMode:null,i.bitmap=null,i._load=null,s.autoLoad!==!1&&i.load(),i}return e.prototype.load=function(t){var s=this;return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise(function(i,n){var a=s.source;s.url=a.src;var o=function(){s.destroyed||(a.onload=null,a.onerror=null,s.resize(a.width,a.height),s._load=null,s.createBitmap?i(s.process()):i(s))};a.complete&&a.src?o():(a.onload=o,a.onerror=function(u){n(u),s.onError.emit(u)})}),this._load)},e.prototype.process=function(){var t=this,s=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);var i=globalThis.createImageBitmap,n=!s.crossOrigin||s.crossOrigin==="anonymous";return this._process=fetch(s.src,{mode:n?"cors":"no-cors"}).then(function(a){return a.blob()}).then(function(a){return i(a,0,0,s.width,s.height,{premultiplyAlpha:t.alphaMode===null||t.alphaMode===cn.UNPACK?"premultiply":"none"})}).then(function(a){return t.destroyed?Promise.reject():(t.bitmap=a,t.update(),t._process=null,Promise.resolve(t))}),this._process},e.prototype.upload=function(t,s,i){if(typeof this.alphaMode=="number"&&(s.alphaMode=this.alphaMode),!this.createBitmap)return r.prototype.upload.call(this,t,s,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(r.prototype.upload.call(this,t,s,i,this.bitmap),!this.preserveBitmap){var n=!0,a=s._glTextures;for(var o in a){var u=a[o];if(u!==i&&u.dirtyId!==s.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,r.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e.test=function(t){return typeof t=="string"||t instanceof HTMLImageElement},e}(En),t8=function(r){at(e,r);function e(t,s){var i=this;return s=s||{},i=r.call(this,J.ADAPTER.createCanvas())||this,i._width=0,i._height=0,i.svg=t,i.scale=s.scale||1,i._overrideWidth=s.width,i._overrideHeight=s.height,i._resolve=null,i._crossorigin=s.crossorigin,i._load=null,s.autoLoad!==!1&&i.load(),i}return e.prototype.load=function(){var t=this;return this._load?this._load:(this._load=new Promise(function(s){if(t._resolve=function(){t.resize(t.source.width,t.source.height),s(t)},e.SVG_XML.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()}),this._load)},e.prototype._loadSvg=function(){var t=this,s=new Image;En.crossOrigin(s,this.svg,this._crossorigin),s.src=this.svg,s.onerror=function(i){t._resolve&&(s.onerror=null,t.onError.emit(i))},s.onload=function(){if(t._resolve){var i=s.width,n=s.height;if(!i||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var a=i*t.scale,o=n*t.scale;(t._overrideWidth||t._overrideHeight)&&(a=t._overrideWidth||t._overrideHeight/n*i,o=t._overrideHeight||t._overrideWidth/i*n),a=Math.round(a),o=Math.round(o);var u=t.source;u.width=a,u.height=o,u._pixiId="canvas_"+Kn(),u.getContext("2d").drawImage(s,0,0,i,n,0,0,a,o),t._resolve(),t._resolve=null}}},e.getSize=function(t){var s=e.SVG_SIZE.exec(t),i={};return s&&(i[s[1]]=Math.round(parseFloat(s[3])),i[s[5]]=Math.round(parseFloat(s[7]))),i},e.prototype.dispose=function(){r.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,s){return s==="svg"||typeof t=="string"&&t.startsWith("data:image/svg+xml")||typeof t=="string"&&e.SVG_XML.test(t)},e.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,e.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,e}(En),s8=function(r){at(e,r);function e(t,s){var i=this;if(s=s||{},!(t instanceof HTMLVideoElement)){var n=document.createElement("video");n.setAttribute("preload","auto"),n.setAttribute("webkit-playsinline",""),n.setAttribute("playsinline",""),typeof t=="string"&&(t=[t]);var a=t[0].src||t[0];En.crossOrigin(n,a,s.crossorigin);for(var o=0;o<t.length;++o){var u=document.createElement("source"),l=t[o],d=l.src,c=l.mime;d=d||t[o];var _=d.split("?").shift().toLowerCase(),f=_.slice(_.lastIndexOf(".")+1);c=c||e.MIME_TYPES[f]||"video/"+f,u.src=d,u.type=c,n.appendChild(u)}t=n}return i=r.call(this,t)||this,i.noSubImage=!0,i._autoUpdate=!0,i._isConnectedToTicker=!1,i._updateFPS=s.updateFPS||0,i._msToNextUpdate=0,i.autoPlay=s.autoPlay!==!1,i._load=null,i._resolve=null,i._onCanPlay=i._onCanPlay.bind(i),i._onError=i._onError.bind(i),s.autoLoad!==!1&&i.load(),i}return e.prototype.update=function(t){if(!this.destroyed){var s=zr.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-s),(!this._updateFPS||this._msToNextUpdate<=0)&&(r.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var s=this.source;return(s.readyState===s.HAVE_ENOUGH_DATA||s.readyState===s.HAVE_FUTURE_DATA)&&s.width&&s.height&&(s.complete=!0),s.addEventListener("play",this._onPlayStart.bind(this)),s.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(s.addEventListener("canplay",this._onCanPlay),s.addEventListener("canplaythrough",this._onCanPlay),s.addEventListener("error",this._onError,!0)),this._load=new Promise(function(i){t.valid?i(t):(t._resolve=i,s.load())}),this._load},e.prototype._onError=function(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)},e.prototype._isSourcePlaying=function(){var t=this.source;return!t.paused&&!t.ended&&this._isSourceReady()},e.prototype._isSourceReady=function(){var t=this.source;return t.readyState>2},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(zr.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(zr.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var s=this.valid;this.resize(t.videoWidth,t.videoHeight),!s&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&(zr.shared.remove(this.update,this),this._isConnectedToTicker=!1);var t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),r.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(zr.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(zr.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(t){t!==this._updateFPS&&(this._updateFPS=t)},enumerable:!1,configurable:!0}),e.test=function(t,s){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||e.TYPES.indexOf(s)>-1},e.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],e.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},e}(En),r8=function(r){at(e,r);function e(t){return r.call(this,t)||this}return e.test=function(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&t instanceof ImageBitmap},e}(En);qd.push(WT,r8,$6,s8,t8,Jd,e8,J6);var i8=function(r){at(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.upload=function(t,s,i){var n=t.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.alphaMode===cn.UNPACK);var a=s.realWidth,o=s.realHeight;return i.width===a&&i.height===o?n.texSubImage2D(s.target,0,0,0,a,o,s.format,i.type,this.data):(i.width=a,i.height=o,n.texImage2D(s.target,0,i.internalFormat,a,o,0,s.format,i.type,this.data)),!0},e}(Jd),$d=function(){function r(e,t){this.width=Math.round(e||100),this.height=Math.round(t||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new ts("disposeFramebuffer"),this.multisample=lt.NONE}return Object.defineProperty(r.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),r.prototype.addColorTexture=function(e,t){return e===void 0&&(e=0),this.colorTextures[e]=t||new Qe(null,{scaleMode:Ds.NEAREST,resolution:1,mipmap:ln.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},r.prototype.addDepthTexture=function(e){return this.depthTexture=e||new Qe(new i8(null,{width:this.width,height:this.height}),{scaleMode:Ds.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:ln.OFF,format:Z.DEPTH_COMPONENT,type:He.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},r.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},r.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},r.prototype.resize=function(e,t){if(e=Math.round(e),t=Math.round(t),!(e===this.width&&t===this.height)){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(var s=0;s<this.colorTextures.length;s++){var i=this.colorTextures[s],n=i.resolution;i.setSize(e/n,t/n)}if(this.depthTexture){var n=this.depthTexture.resolution;this.depthTexture.setSize(e/n,t/n)}}},r.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},r.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},r}(),zT=function(r){at(e,r);function e(t){t===void 0&&(t={});var s=this;if(typeof t=="number"){var i=arguments[0],n=arguments[1],a=arguments[2],o=arguments[3];t={width:i,height:n,scaleMode:a,resolution:o}}return t.width=t.width||100,t.height=t.height||100,t.multisample=t.multisample!==void 0?t.multisample:lt.NONE,s=r.call(this,null,t)||this,s.mipmap=ln.OFF,s.valid=!0,s.clearColor=[0,0,0,0],s.framebuffer=new $d(s.realWidth,s.realHeight).addColorTexture(0,s),s.framebuffer.multisample=t.multisample,s.maskStack=[],s.filterStack=[{}],s}return e.prototype.resize=function(t,s){this.framebuffer.resize(t*this.resolution,s*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},e.prototype.dispose=function(){this.framebuffer.dispose(),r.prototype.dispose.call(this)},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},e}(Qe),XT=function(){function r(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return r.prototype.set=function(e,t,s){var i=t.width,n=t.height;if(s){var a=e.width/2/i,o=e.height/2/n,u=e.x/i+a,l=e.y/n+o;s=we.add(s,we.NW),this.x0=u+a*we.uX(s),this.y0=l+o*we.uY(s),s=we.add(s,2),this.x1=u+a*we.uX(s),this.y1=l+o*we.uY(s),s=we.add(s,2),this.x2=u+a*we.uX(s),this.y2=l+o*we.uY(s),s=we.add(s,2),this.x3=u+a*we.uX(s),this.y3=l+o*we.uY(s)}else this.x0=e.x/i,this.y0=e.y/n,this.x1=(e.x+e.width)/i,this.y1=e.y/n,this.x2=(e.x+e.width)/i,this.y2=(e.y+e.height)/n,this.x3=e.x/i,this.y3=(e.y+e.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},r.prototype.toString=function(){return"[@pixi/core:TextureUvs "+("x0="+this.x0+" y0="+this.y0+" ")+("x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" ")+("y2="+this.y2+" x3="+this.x3+" y3="+this.y3)+"]"},r}(),KT=new XT;function wl(r){r.destroy=function(){},r.on=function(){},r.once=function(){},r.emit=function(){}}var Re=function(r){at(e,r);function e(t,s,i,n,a,o){var u=r.call(this)||this;if(u.noFrame=!1,s||(u.noFrame=!0,s=new he(0,0,1,1)),t instanceof e&&(t=t.baseTexture),u.baseTexture=t,u._frame=s,u.trim=n,u.valid=!1,u._uvs=KT,u.uvMatrix=null,u.orig=i||s,u._rotate=Number(a||0),a===!0)u._rotate=2;else if(u._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return u.defaultAnchor=o?new k(o.x,o.y):new k(0,0),u._updateID=0,u.textureCacheIds=[],t.valid?u.noFrame?t.valid&&u.onBaseTextureUpdated(t):u.frame=s:t.once("loaded",u.onBaseTextureUpdated,u),u.noFrame&&t.on("update",u.onBaseTextureUpdated,u),u}return e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var s=this.baseTexture.resource;s&&s.url&&Mi[s.url]&&e.removeFromCache(s.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){var t=this._frame.clone(),s=this._frame===this.orig?t:this.orig.clone(),i=new e(this.baseTexture,!this.noFrame&&t,s,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(i._frame=t),i},e.prototype.updateUvs=function(){this._uvs===KT&&(this._uvs=new XT),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,s,i){s===void 0&&(s={}),i===void 0&&(i=J.STRICT_TEXTURE_CACHE);var n=typeof t=="string",a=null;if(n)a=t;else if(t instanceof Qe){if(!t.cacheId){var o=s&&s.pixiIdPrefix||"pixiid";t.cacheId=o+"-"+Kn(),Qe.addToCache(t,t.cacheId)}a=t.cacheId}else{if(!t._pixiId){var o=s&&s.pixiIdPrefix||"pixiid";t._pixiId=o+"_"+Kn()}a=t._pixiId}var u=Mi[a];if(n&&i&&!u)throw new Error('The cacheId "'+a+'" does not exist in TextureCache.');return!u&&!(t instanceof Qe)?(s.resolution||(s.resolution=zd(t)),u=new e(new Qe(t,s)),u.baseTexture.cacheId=a,Qe.addToCache(u.baseTexture,a),e.addToCache(u,a)):!u&&t instanceof Qe&&(u=new e(t),e.addToCache(u,a)),u},e.fromURL=function(t,s){var i=Object.assign({autoLoad:!1},s==null?void 0:s.resourceOptions),n=e.from(t,Object.assign({resourceOptions:i},s),!1),a=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):a.load().then(function(){return Promise.resolve(n)})},e.fromBuffer=function(t,s,i,n){return new e(Qe.fromBuffer(t,s,i,n))},e.fromLoader=function(t,s,i,n){var a=new Qe(t,Object.assign({scaleMode:J.SCALE_MODE,resolution:zd(s)},n)),o=a.resource;o instanceof WT&&(o.url=s);var u=new e(a);return i||(i=s),Qe.addToCache(u.baseTexture,i),e.addToCache(u,i),i!==s&&(Qe.addToCache(u.baseTexture,s),e.addToCache(u,s)),u.baseTexture.valid?Promise.resolve(u):new Promise(function(l){u.baseTexture.once("loaded",function(){return l(u)})})},e.addToCache=function(t,s){s&&(t.textureCacheIds.indexOf(s)===-1&&t.textureCacheIds.push(s),Mi[s]&&console.warn("Texture added to the cache with an id ["+s+"] that already had an entry"),Mi[s]=t)},e.removeFromCache=function(t){if(typeof t=="string"){var s=Mi[t];if(s){var i=s.textureCacheIds.indexOf(t);return i>-1&&s.textureCacheIds.splice(i,1),delete Mi[t],s}}else if(t&&t.textureCacheIds){for(var n=0;n<t.textureCacheIds.length;++n)Mi[t.textureCacheIds[n]]===t&&delete Mi[t.textureCacheIds[n]];return t.textureCacheIds.length=0,t}return null},Object.defineProperty(e.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var s=t.x,i=t.y,n=t.width,a=t.height,o=s+n>this.baseTexture.width,u=i+a>this.baseTexture.height;if(o||u){var l=o&&u?"and":"or",d="X: "+s+" + "+n+" = "+(s+n)+" > "+this.baseTexture.width,c="Y: "+i+" + "+a+" = "+(i+a)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+(d+" "+l+" "+c))}this.valid=n&&a&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),e.prototype.castToBaseTexture=function(){return this.baseTexture},Object.defineProperty(e,"EMPTY",{get:function(){return e._EMPTY||(e._EMPTY=new e(new Qe),wl(e._EMPTY),wl(e._EMPTY.baseTexture)),e._EMPTY},enumerable:!1,configurable:!0}),Object.defineProperty(e,"WHITE",{get:function(){if(!e._WHITE){var t=J.ADAPTER.createCanvas(16,16),s=t.getContext("2d");t.width=16,t.height=16,s.fillStyle="white",s.fillRect(0,0,16,16),e._WHITE=new e(Qe.from(t)),wl(e._WHITE),wl(e._WHITE.baseTexture)}return e._WHITE},enumerable:!1,configurable:!0}),e}($o),kt=function(r){at(e,r);function e(t,s){var i=r.call(this,t,s)||this;return i.valid=!0,i.filterFrame=null,i.filterPoolKey=null,i.updateUvs(),i}return Object.defineProperty(e.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(t){this.framebuffer.multisample=t},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,s,i){i===void 0&&(i=!0);var n=this.baseTexture.resolution,a=Math.round(t*n)/n,o=Math.round(s*n)/n;this.valid=a>0&&o>0,this._frame.width=this.orig.width=a,this._frame.height=this.orig.height=o,i&&this.baseTexture.resize(a,o),this.updateUvs()},e.prototype.setResolution=function(t){var s=this.baseTexture;s.resolution!==t&&(s.setResolution(t),this.resize(s.width,s.height,!1))},e.create=function(t){for(var s=arguments,i=[],n=1;n<arguments.length;n++)i[n-1]=s[n];return typeof t=="number"&&(Wr("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),t={width:t,height:i[0],scaleMode:i[1],resolution:i[2]}),new e(new zT(t))},e}(Re),n8=function(){function r(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return r.prototype.createTexture=function(e,t,s){s===void 0&&(s=lt.NONE);var i=new zT(Object.assign({width:e,height:t,resolution:1,multisample:s},this.textureOptions));return new kt(i)},r.prototype.getOptimalTexture=function(e,t,s,i){s===void 0&&(s=1),i===void 0&&(i=lt.NONE);var n;e=Math.ceil(e*s-1e-6),t=Math.ceil(t*s-1e-6),!this.enableFullScreen||e!==this._pixelsWidth||t!==this._pixelsHeight?(e=bl(e),t=bl(t),n=((e&65535)<<16|t&65535)>>>0,i>1&&(n+=i*4294967296)):n=i>1?-i:-1,this.texturePool[n]||(this.texturePool[n]=[]);var a=this.texturePool[n].pop();return a||(a=this.createTexture(e,t,i)),a.filterPoolKey=n,a.setResolution(s),a},r.prototype.getFilterTexture=function(e,t,s){var i=this.getOptimalTexture(e.width,e.height,t||e.resolution,s||lt.NONE);return i.filterFrame=e.filterFrame,i},r.prototype.returnTexture=function(e){var t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)},r.prototype.returnFilterTexture=function(e){this.returnTexture(e)},r.prototype.clear=function(e){if(e=e!==!1,e)for(var t in this.texturePool){var s=this.texturePool[t];if(s)for(var i=0;i<s.length;i++)s[i].destroy(!0)}this.texturePool={}},r.prototype.setScreenSize=function(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(var t in this.texturePool)if(Number(t)<0){var s=this.texturePool[t];if(s)for(var i=0;i<s.length;i++)s[i].destroy(!0);this.texturePool[t]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}},r.SCREEN_KEY=-1,r}(),qT=function(){function r(e,t,s,i,n,a,o){t===void 0&&(t=0),s===void 0&&(s=!1),i===void 0&&(i=He.FLOAT),this.buffer=e,this.size=t,this.normalized=s,this.type=i,this.stride=n,this.start=a,this.instance=o}return r.prototype.destroy=function(){this.buffer=null},r.from=function(e,t,s,i,n){return new r(e,t,s,i,n)},r}(),a8=0,vs=function(){function r(e,t,s){t===void 0&&(t=!0),s===void 0&&(s=!1),this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=s,this.static=t,this.id=a8++,this.disposeRunner=new ts("disposeBuffer")}return r.prototype.update=function(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++},r.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},r.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(r.prototype,"index",{get:function(){return this.type===kr.ELEMENT_ARRAY_BUFFER},set:function(e){this.type=e?kr.ELEMENT_ARRAY_BUFFER:kr.ARRAY_BUFFER},enumerable:!1,configurable:!0}),r.from=function(e){return e instanceof Array&&(e=new Float32Array(e)),new r(e)},r}(),o8={Float32Array,Uint32Array,Int32Array,Uint8Array};function h8(r,e){for(var t=0,s=0,i={},n=0;n<r.length;n++)s+=e[n],t+=r[n].length;for(var a=new ArrayBuffer(t*4),o=null,u=0,n=0;n<r.length;n++){var l=e[n],d=r[n],c=UT(d);i[c]||(i[c]=new o8[c](a)),o=i[c];for(var _=0;_<d.length;_++){var f=(_/l|0)*s+u,g=_%l;o[f+g]=d[_]}u+=l}return new Float32Array(a)}var QT={5126:4,5123:2,5121:1},u8=0,l8={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},xl=function(){function r(e,t){e===void 0&&(e=[]),t===void 0&&(t={}),this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=u8++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ts("disposeGeometry"),this.refCount=0}return r.prototype.addAttribute=function(e,t,s,i,n,a,o,u){if(s===void 0&&(s=0),i===void 0&&(i=!1),u===void 0&&(u=!1),!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof vs||(t instanceof Array&&(t=new Float32Array(t)),t=new vs(t));var l=e.split("|");if(l.length>1){for(var d=0;d<l.length;d++)this.addAttribute(l[d],t,s,i,n);return this}var c=this.buffers.indexOf(t);return c===-1&&(this.buffers.push(t),c=this.buffers.length-1),this.attributes[e]=new qT(c,s,i,n,a,o,u),this.instanced=this.instanced||u,this},r.prototype.getAttribute=function(e){return this.attributes[e]},r.prototype.getBuffer=function(e){return this.buffers[this.getAttribute(e).buffer]},r.prototype.addIndex=function(e){return e instanceof vs||(e instanceof Array&&(e=new Uint16Array(e)),e=new vs(e)),e.type=kr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.indexOf(e)===-1&&this.buffers.push(e),this},r.prototype.getIndex=function(){return this.indexBuffer},r.prototype.interleave=function(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;var e=[],t=[],s=new vs,i;for(i in this.attributes){var n=this.attributes[i],a=this.buffers[n.buffer];e.push(a.data),t.push(n.size*QT[n.type]/4),n.buffer=0}for(s.data=h8(e,t),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[s],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},r.prototype.getSize=function(){for(var e in this.attributes){var t=this.attributes[e],s=this.buffers[t.buffer];return s.data.length/(t.stride/4||t.size)}return 0},r.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},r.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},r.prototype.clone=function(){for(var e=new r,t=0;t<this.buffers.length;t++)e.buffers[t]=new vs(this.buffers[t].data.slice(0));for(var t in this.attributes){var s=this.attributes[t];e.attributes[t]=new qT(s.buffer,s.size,s.normalized,s.type,s.stride,s.start,s.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=kr.ELEMENT_ARRAY_BUFFER),e},r.merge=function(e){for(var t=new r,s=[],i=[],n=[],a,o=0;o<e.length;o++){a=e[o];for(var u=0;u<a.buffers.length;u++)i[u]=i[u]||0,i[u]+=a.buffers[u].data.length,n[u]=0}for(var o=0;o<a.buffers.length;o++)s[o]=new l8[UT(a.buffers[o].data)](i[o]),t.buffers[o]=new vs(s[o]);for(var o=0;o<e.length;o++){a=e[o];for(var u=0;u<a.buffers.length;u++)s[u].set(a.buffers[u].data,n[u]),n[u]+=a.buffers[u].data.length}if(t.attributes=a.attributes,a.indexBuffer){t.indexBuffer=t.buffers[a.buffers.indexOf(a.indexBuffer)],t.indexBuffer.type=kr.ELEMENT_ARRAY_BUFFER;for(var l=0,d=0,c=0,_=0,o=0;o<a.buffers.length;o++)if(a.buffers[o]!==a.indexBuffer){_=o;break}for(var o in a.attributes){var f=a.attributes[o];(f.buffer|0)===_&&(d+=f.size*QT[f.type]/4)}for(var o=0;o<e.length;o++){for(var g=e[o].indexBuffer.data,u=0;u<g.length;u++)t.indexBuffer.data[u+c]+=l;l+=e[o].buffers[_].data.length/d,c+=g.length}}return t},r}(),c8=function(r){at(e,r);function e(){var t=r.call(this)||this;return t.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),t}return e}(xl),ZT=function(r){at(e,r);function e(){var t=r.call(this)||this;return t.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),t.uvs=new Float32Array([0,0,1,0,1,1,0,1]),t.vertexBuffer=new vs(t.vertices),t.uvBuffer=new vs(t.uvs),t.addAttribute("aVertexPosition",t.vertexBuffer).addAttribute("aTextureCoord",t.uvBuffer).addIndex([0,1,2,0,2,3]),t}return e.prototype.map=function(t,s){var i=0,n=0;return this.uvs[0]=i,this.uvs[1]=n,this.uvs[2]=i+s.width/t.width,this.uvs[3]=n,this.uvs[4]=i+s.width/t.width,this.uvs[5]=n+s.height/t.height,this.uvs[6]=i,this.uvs[7]=n+s.height/t.height,i=s.x,n=s.y,this.vertices[0]=i,this.vertices[1]=n,this.vertices[2]=i+s.width,this.vertices[3]=n,this.vertices[4]=i+s.width,this.vertices[5]=n+s.height,this.vertices[6]=i,this.vertices[7]=n+s.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(xl),_8=0,ea=function(){function r(e,t,s){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=_8++,this.static=!!t,this.ubo=!!s,e instanceof vs?(this.buffer=e,this.buffer.type=kr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new vs(new Float32Array(1)),this.buffer.type=kr.UNIFORM_BUFFER,this.autoManage=!0))}return r.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},r.prototype.add=function(e,t,s){if(!this.ubo)this.uniforms[e]=new r(t,s);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")},r.from=function(e,t,s){return new r(e,t,s)},r.uboFrom=function(e,t){return new r(e,t??!0,!0)},r}(),d8=function(){function r(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=lt.NONE,this.sourceFrame=new he,this.destinationFrame=new he,this.bindingSourceFrame=new he,this.bindingDestinationFrame=new he,this.filters=[],this.transform=null}return r.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},r}(),Gl=[new k,new k,new k,new k],ef=new Ye,f8=function(){function r(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new n8,this.texturePool.setScreenSize(e.view),this.statePool=[],this.quad=new c8,this.quadUv=new ZT,this.tempRect=new he,this.activeState={},this.globalUniforms=new ea({outputFrame:new he,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return r.prototype.push=function(e,t){for(var s,i,n=this.renderer,a=this.defaultFilterStack,o=this.statePool.pop()||new d8,u=this.renderer.renderTexture,l=t[0].resolution,d=t[0].multisample,c=t[0].padding,_=t[0].autoFit,f=(s=t[0].legacy)!==null&&s!==void 0?s:!0,g=1;g<t.length;g++){var I=t[g];l=Math.min(l,I.resolution),d=Math.min(d,I.multisample),c=this.useMaxPadding?Math.max(c,I.padding):c+I.padding,_=_&&I.autoFit,f=f||((i=I.legacy)!==null&&i!==void 0?i:!0)}a.length===1&&(this.defaultFilterStack[0].renderTexture=u.current),a.push(o),o.resolution=l,o.multisample=d,o.legacy=f,o.target=e,o.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),o.sourceFrame.pad(c);var p=this.tempRect.copyFrom(u.sourceFrame);n.projection.transform&&this.transformAABB(ef.copyFrom(n.projection.transform).invert(),p),_?(o.sourceFrame.fit(p),(o.sourceFrame.width<=0||o.sourceFrame.height<=0)&&(o.sourceFrame.width=0,o.sourceFrame.height=0)):o.sourceFrame.intersects(p)||(o.sourceFrame.width=0,o.sourceFrame.height=0),this.roundFrame(o.sourceFrame,u.current?u.current.resolution:n.resolution,u.sourceFrame,u.destinationFrame,n.projection.transform),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,l,d),o.filters=t,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;var R=this.tempRect;R.x=0,R.y=0,R.width=o.sourceFrame.width,R.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,o.bindingSourceFrame.copyFrom(u.sourceFrame),o.bindingDestinationFrame.copyFrom(u.destinationFrame),o.transform=n.projection.transform,n.projection.transform=null,u.bind(o.renderTexture,o.sourceFrame,R),n.framebuffer.clear(0,0,0,0)},r.prototype.pop=function(){var e=this.defaultFilterStack,t=e.pop(),s=t.filters;this.activeState=t;var i=this.globalUniforms.uniforms;i.outputFrame=t.sourceFrame,i.resolution=t.resolution;var n=i.inputSize,a=i.inputPixel,o=i.inputClamp;if(n[0]=t.destinationFrame.width,n[1]=t.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],a[0]=Math.round(n[0]*t.resolution),a[1]=Math.round(n[1]*t.resolution),a[2]=1/a[0],a[3]=1/a[1],o[0]=.5*a[2],o[1]=.5*a[3],o[2]=t.sourceFrame.width*n[2]-.5*a[2],o[3]=t.sourceFrame.height*n[3]-.5*a[3],t.legacy){var u=i.filterArea;u[0]=t.destinationFrame.width,u[1]=t.destinationFrame.height,u[2]=t.sourceFrame.x,u[3]=t.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var l=e[e.length-1];if(this.renderer.framebuffer.blit(),s.length===1)s[0].apply(this,t.renderTexture,l.renderTexture,_n.BLEND,t),this.returnFilterTexture(t.renderTexture);else{var d=t.renderTexture,c=this.getOptimalFilterTexture(d.width,d.height,t.resolution);c.filterFrame=d.filterFrame;var _=0;for(_=0;_<s.length-1;++_){_===1&&t.multisample>1&&(c=this.getOptimalFilterTexture(d.width,d.height,t.resolution),c.filterFrame=d.filterFrame),s[_].apply(this,d,c,_n.CLEAR,t);var f=d;d=c,c=f}s[_].apply(this,d,l.renderTexture,_n.BLEND,t),_>1&&t.multisample>1&&this.returnFilterTexture(t.renderTexture),this.returnFilterTexture(d),this.returnFilterTexture(c)}t.clear(),this.statePool.push(t)},r.prototype.bindAndClear=function(e,t){t===void 0&&(t=_n.CLEAR);var s=this.renderer,i=s.renderTexture,n=s.state;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e&&e.filterFrame){var a=this.tempRect;a.x=0,a.y=0,a.width=e.filterFrame.width,a.height=e.filterFrame.height,i.bind(e,e.filterFrame,a)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var o=n.stateId&1||this.forceClear;(t===_n.CLEAR||t===_n.BLIT&&o)&&this.renderer.framebuffer.clear(0,0,0,0)},r.prototype.applyFilter=function(e,t,s,i){var n=this.renderer;n.state.set(e.state),this.bindAndClear(s,i),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(t._frame,t.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(Hr.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(Hr.TRIANGLE_STRIP))},r.prototype.calculateSpriteMatrix=function(e,t){var s=this.activeState,i=s.sourceFrame,n=s.destinationFrame,a=t._texture.orig,o=e.set(n.width,0,0,n.height,i.x,i.y),u=t.worldTransform.copyTo(Ye.TEMP_MATRIX);return u.invert(),o.prepend(u),o.scale(1/a.width,1/a.height),o.translate(t.anchor.x,t.anchor.y),o},r.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},r.prototype.getOptimalFilterTexture=function(e,t,s,i){return s===void 0&&(s=1),i===void 0&&(i=lt.NONE),this.texturePool.getOptimalTexture(e,t,s,i)},r.prototype.getFilterTexture=function(e,t,s){if(typeof e=="number"){var i=e;e=t,t=i}e=e||this.activeState.renderTexture;var n=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution,s||lt.NONE);return n.filterFrame=e.filterFrame,n},r.prototype.returnFilterTexture=function(e){this.texturePool.returnTexture(e)},r.prototype.emptyPool=function(){this.texturePool.clear(!0)},r.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},r.prototype.transformAABB=function(e,t){var s=Gl[0],i=Gl[1],n=Gl[2],a=Gl[3];s.set(t.left,t.top),i.set(t.left,t.bottom),n.set(t.right,t.top),a.set(t.right,t.bottom),e.apply(s,s),e.apply(i,i),e.apply(n,n),e.apply(a,a);var o=Math.min(s.x,i.x,n.x,a.x),u=Math.min(s.y,i.y,n.y,a.y),l=Math.max(s.x,i.x,n.x,a.x),d=Math.max(s.y,i.y,n.y,a.y);t.x=o,t.y=u,t.width=l-o,t.height=d-u},r.prototype.roundFrame=function(e,t,s,i,n){if(!(e.width<=0||e.height<=0||s.width<=0||s.height<=0)){if(n){var a=n.a,o=n.b,u=n.c,l=n.d;if((Math.abs(o)>1e-4||Math.abs(u)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(l)>1e-4))return}n=n?ef.copyFrom(n):ef.identity(),n.translate(-s.x,-s.y).scale(i.width/s.width,i.height/s.height).translate(i.x,i.y),this.transformAABB(n,e),e.ceil(t),this.transformAABB(n.invert(),e)}},r}(),Bl=function(){function r(e){this.renderer=e}return r.prototype.flush=function(){},r.prototype.destroy=function(){this.renderer=null},r.prototype.start=function(){},r.prototype.stop=function(){this.flush()},r.prototype.render=function(e){},r}(),g8=function(){function r(e){this.renderer=e,this.emptyRenderer=new Bl(e),this.currentRenderer=this.emptyRenderer}return r.prototype.setObjectRenderer=function(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())},r.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},r.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},r.prototype.copyBoundTextures=function(e,t){for(var s=this.renderer.texture.boundTextures,i=t-1;i>=0;--i)e[i]=s[i]||null,e[i]&&(e[i]._batchLocation=i)},r.prototype.boundArray=function(e,t,s,i){for(var n=e.elements,a=e.ids,o=e.count,u=0,l=0;l<o;l++){var d=n[l],c=d._batchLocation;if(c>=0&&c<i&&t[c]===d){a[l]=c;continue}for(;u<i;){var _=t[u];if(_&&_._batchEnabled===s&&_._batchLocation===u){u++;continue}a[l]=u,d._batchLocation=u,t[u]=d;break}}},r.prototype.destroy=function(){this.renderer=null},r}(),JT=0,E8=function(){function r(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),e.view.addEventListener("webglcontextlost",this.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(r.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),r.prototype.contextChange=function(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=JT++},r.prototype.initFromContext=function(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=JT++,this.renderer.runners.contextChange.emit(e)},r.prototype.initFromOptions=function(e){var t=this.createContext(this.renderer.view,e);this.initFromContext(t)},r.prototype.createContext=function(e,t){var s;if(J.PREFER_ENV>=Si.WEBGL2&&(s=e.getContext("webgl2",t)),s)this.webGLVersion=2;else if(this.webGLVersion=1,s=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),!s)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=s,this.getExtensions(),this.gl},r.prototype.getExtensions=function(){var e=this.gl,t={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,t,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,t,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})},r.prototype.handleContextLost=function(e){var t=this;e.preventDefault(),setTimeout(function(){t.gl.isContextLost()&&t.extensions.loseContext&&t.extensions.loseContext.restoreContext()},0)},r.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},r.prototype.destroy=function(){var e=this.renderer.view;this.renderer=null,e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},r.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},r.prototype.validateContext=function(e){var t=e.getContextAttributes(),s="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;s&&(this.webGLVersion=2),t&&!t.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var i=s||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},r}(),m8=function(){function r(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=lt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}return r}(),p8=new he,I8=function(){function r(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new $d(10,10),this.msaaSamples=null}return r.prototype.contextChange=function(){this.disposeAll(!0);var e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new he,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){var t=this.renderer.context.extensions.drawBuffers,s=this.renderer.context.extensions.depthTexture;J.PREFER_ENV===Si.WEBGL_LEGACY&&(t=null,s=null),t?e.drawBuffers=function(i){return t.drawBuffersWEBGL(i)}:(this.hasMRT=!1,e.drawBuffers=function(){}),s||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)},r.prototype.bind=function(e,t,s){s===void 0&&(s=0);var i=this.gl;if(e){var n=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,i.bindFramebuffer(i.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==s&&(e.dirtyId++,e.dirtyFormat++,n.mipLevel=s),n.dirtyId!==e.dirtyId&&(n.dirtyId=e.dirtyId,n.dirtyFormat!==e.dirtyFormat?(n.dirtyFormat=e.dirtyFormat,n.dirtySize=e.dirtySize,this.updateFramebuffer(e,s)):n.dirtySize!==e.dirtySize&&(n.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(var a=0;a<e.colorTextures.length;a++){var o=e.colorTextures[a];this.renderer.texture.unbind(o.parentTextureArray||o)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t){var u=t.width>>s,l=t.height>>s,d=u/t.width;this.setViewport(t.x*d,t.y*d,u,l)}else{var u=e.width>>s,l=e.height>>s;this.setViewport(0,0,u,l)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},r.prototype.setViewport=function(e,t,s,i){var n=this.viewport;e=Math.round(e),t=Math.round(t),s=Math.round(s),i=Math.round(i),(n.width!==s||n.height!==i||n.x!==e||n.y!==t)&&(n.x=e,n.y=t,n.width=s,n.height=i,this.gl.viewport(e,t,s,i))},Object.defineProperty(r.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),r.prototype.clear=function(e,t,s,i,n){n===void 0&&(n=cl.COLOR|cl.DEPTH);var a=this.gl;a.clearColor(e,t,s,i),a.clear(n)},r.prototype.initFramebuffer=function(e){var t=this.gl,s=new m8(t.createFramebuffer());return s.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=s,this.managedFramebuffers.push(e),e.disposeRunner.add(this),s},r.prototype.resizeFramebuffer=function(e){var t=this.gl,s=e.glFramebuffers[this.CONTEXT_UID];s.msaaBuffer&&(t.bindRenderbuffer(t.RENDERBUFFER,s.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,s.multisample,t.RGBA8,e.width,e.height)),s.stencil&&(t.bindRenderbuffer(t.RENDERBUFFER,s.stencil),s.msaaBuffer?t.renderbufferStorageMultisample(t.RENDERBUFFER,s.multisample,t.DEPTH24_STENCIL8,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height));var i=e.colorTextures,n=i.length;t.drawBuffers||(n=Math.min(n,1));for(var a=0;a<n;a++){var o=i[a],u=o.parentTextureArray||o;this.renderer.texture.bind(u,0)}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)},r.prototype.updateFramebuffer=function(e,t){var s=this.gl,i=e.glFramebuffers[this.CONTEXT_UID],n=e.colorTextures,a=n.length;s.drawBuffers||(a=Math.min(a,1)),i.multisample>1&&this.canMultisampleFramebuffer(e)?(i.msaaBuffer=i.msaaBuffer||s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,i.msaaBuffer),s.renderbufferStorageMultisample(s.RENDERBUFFER,i.multisample,s.RGBA8,e.width,e.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,i.msaaBuffer)):i.msaaBuffer&&(s.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));for(var o=[],u=0;u<a;u++){var l=n[u],d=l.parentTextureArray||l;this.renderer.texture.bind(d,0),!(u===0&&i.msaaBuffer)&&(s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+u,l.target,d._glTextures[this.CONTEXT_UID].texture,t),o.push(s.COLOR_ATTACHMENT0+u))}if(o.length>1&&s.drawBuffers(o),e.depthTexture){var c=this.writeDepthTexture;if(c){var _=e.depthTexture;this.renderer.texture.bind(_,0),s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,_._glTextures[this.CONTEXT_UID].texture,t)}}(e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)?(i.stencil=i.stencil||s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,i.stencil),i.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,i.multisample,s.DEPTH24_STENCIL8,e.width,e.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,e.width,e.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,i.stencil)):i.stencil&&(s.deleteRenderbuffer(i.stencil),i.stencil=null)},r.prototype.canMultisampleFramebuffer=function(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture},r.prototype.detectSamples=function(e){var t=this.msaaSamples,s=lt.NONE;if(e<=1||t===null)return s;for(var i=0;i<t.length;i++)if(t[i]<=e){s=t[i];break}return s===1&&(s=lt.NONE),s},r.prototype.blit=function(e,t,s){var i=this,n=i.current,a=i.renderer,o=i.gl,u=i.CONTEXT_UID;if(a.context.webGLVersion===2&&n){var l=n.glFramebuffers[u];if(l){if(!e){if(!l.msaaBuffer)return;var d=n.colorTextures[0];if(!d)return;l.blitFramebuffer||(l.blitFramebuffer=new $d(n.width,n.height),l.blitFramebuffer.addColorTexture(0,d)),e=l.blitFramebuffer,e.colorTextures[0]!==d&&(e.colorTextures[0]=d,e.dirtyId++,e.dirtyFormat++),(e.width!==n.width||e.height!==n.height)&&(e.width=n.width,e.height=n.height,e.dirtyId++,e.dirtySize++)}t||(t=p8,t.width=n.width,t.height=n.height),s||(s=t);var c=t.width===s.width&&t.height===s.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(t.left,t.top,t.right,t.bottom,s.left,s.top,s.right,s.bottom,o.COLOR_BUFFER_BIT,c?o.NEAREST:o.LINEAR)}}},r.prototype.disposeFramebuffer=function(e,t){var s=e.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(s){delete e.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(e);n>=0&&this.managedFramebuffers.splice(n,1),e.disposeRunner.remove(this),t||(i.deleteFramebuffer(s.framebuffer),s.msaaBuffer&&i.deleteRenderbuffer(s.msaaBuffer),s.stencil&&i.deleteRenderbuffer(s.stencil)),s.blitFramebuffer&&s.blitFramebuffer.dispose()}},r.prototype.disposeAll=function(e){var t=this.managedFramebuffers;this.managedFramebuffers=[];for(var s=0;s<t.length;s++)this.disposeFramebuffer(t[s],e)},r.prototype.forceStencil=function(){var e=this.current;if(e){var t=e.glFramebuffers[this.CONTEXT_UID];if(!(!t||t.stencil)){e.stencil=!0;var s=e.width,i=e.height,n=this.gl,a=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,a),t.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,t.multisample,n.DEPTH24_STENCIL8,s,i):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,s,i),t.stencil=a,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,a)}}},r.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new he},r.prototype.destroy=function(){this.renderer=null},r}(),tf={5126:4,5123:2,5121:1},T8=function(){function r(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return r.prototype.contextChange=function(){this.disposeAll(!0);var e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,t.webGLVersion!==2){var s=this.renderer.context.extensions.vertexArrayObject;J.PREFER_ENV===Si.WEBGL_LEGACY&&(s=null),s?(e.createVertexArray=function(){return s.createVertexArrayOES()},e.bindVertexArray=function(n){return s.bindVertexArrayOES(n)},e.deleteVertexArray=function(n){return s.deleteVertexArrayOES(n)}):(this.hasVao=!1,e.createVertexArray=function(){return null},e.bindVertexArray=function(){return null},e.deleteVertexArray=function(){return null})}if(t.webGLVersion!==2){var i=e.getExtension("ANGLE_instanced_arrays");i?(e.vertexAttribDivisor=function(n,a){return i.vertexAttribDivisorANGLE(n,a)},e.drawElementsInstanced=function(n,a,o,u,l){return i.drawElementsInstancedANGLE(n,a,o,u,l)},e.drawArraysInstanced=function(n,a,o,u){return i.drawArraysInstancedANGLE(n,a,o,u)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=t.webGLVersion===2||!!t.extensions.uint32ElementIndex},r.prototype.bind=function(e,t){t=t||this.renderer.shader.shader;var s=this.gl,i=e.glVertexArrayObjects[this.CONTEXT_UID],n=!1;i||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=i={},n=!0);var a=i[t.program.id]||this.initGeometryVao(e,t,n);this._activeGeometry=e,this._activeVao!==a&&(this._activeVao=a,this.hasVao?s.bindVertexArray(a):this.activateVao(e,t.program)),this.updateBuffers()},r.prototype.reset=function(){this.unbind()},r.prototype.updateBuffers=function(){for(var e=this._activeGeometry,t=this.renderer.buffer,s=0;s<e.buffers.length;s++){var i=e.buffers[s];t.update(i)}},r.prototype.checkCompatibility=function(e,t){var s=e.attributes,i=t.attributeData;for(var n in i)if(!s[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},r.prototype.getSignature=function(e,t){var s=e.attributes,i=t.attributeData,n=["g",e.id];for(var a in s)i[a]&&n.push(a,i[a].location);return n.join("-")},r.prototype.initGeometryVao=function(e,t,s){s===void 0&&(s=!0);var i=this.gl,n=this.CONTEXT_UID,a=this.renderer.buffer,o=t.program;o.glPrograms[n]||this.renderer.shader.generateProgram(t),this.checkCompatibility(e,o);var u=this.getSignature(e,o),l=e.glVertexArrayObjects[this.CONTEXT_UID],d=l[u];if(d)return l[o.id]=d,d;var c=e.buffers,_=e.attributes,f={},g={};for(var I in c)f[I]=0,g[I]=0;for(var I in _)!_[I].size&&o.attributeData[I]?_[I].size=o.attributeData[I].size:_[I].size||console.warn("PIXI Geometry attribute '"+I+"' size cannot be determined (likely the bound shader does not have the attribute)"),f[_[I].buffer]+=_[I].size*tf[_[I].type];for(var I in _){var p=_[I],R=p.size;p.stride===void 0&&(f[p.buffer]===R*tf[p.type]?p.stride=0:p.stride=f[p.buffer]),p.start===void 0&&(p.start=g[p.buffer],g[p.buffer]+=R*tf[p.type])}d=i.createVertexArray(),i.bindVertexArray(d);for(var S=0;S<c.length;S++){var O=c[S];a.bind(O),s&&O._glBuffers[n].refCount++}return this.activateVao(e,o),this._activeVao=d,l[o.id]=d,l[u]=d,d},r.prototype.disposeGeometry=function(e,t){var s;if(this.managedGeometries[e.id]){delete this.managedGeometries[e.id];var i=e.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,a=e.buffers,o=(s=this.renderer)===null||s===void 0?void 0:s.buffer;if(e.disposeRunner.remove(this),!!i){if(o)for(var u=0;u<a.length;u++){var l=a[u]._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!t&&o.dispose(a[u],t))}if(!t){for(var d in i)if(d[0]==="g"){var c=i[d];this._activeVao===c&&this.unbind(),n.deleteVertexArray(c)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}},r.prototype.disposeAll=function(e){for(var t=Object.keys(this.managedGeometries),s=0;s<t.length;s++)this.disposeGeometry(this.managedGeometries[t[s]],e)},r.prototype.activateVao=function(e,t){var s=this.gl,i=this.CONTEXT_UID,n=this.renderer.buffer,a=e.buffers,o=e.attributes;e.indexBuffer&&n.bind(e.indexBuffer);var u=null;for(var l in o){var d=o[l],c=a[d.buffer],_=c._glBuffers[i];if(t.attributeData[l]){u!==_&&(n.bind(c),u=_);var f=t.attributeData[l].location;if(s.enableVertexAttribArray(f),s.vertexAttribPointer(f,d.size,d.type||s.FLOAT,d.normalized,d.stride,d.start),d.instance)if(this.hasInstance)s.vertexAttribDivisor(f,1);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}},r.prototype.draw=function(e,t,s,i){var n=this.gl,a=this._activeGeometry;if(a.indexBuffer){var o=a.indexBuffer.data.BYTES_PER_ELEMENT,u=o===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;o===2||o===4&&this.canUseUInt32ElementIndex?a.instanced?n.drawElementsInstanced(e,t||a.indexBuffer.data.length,u,(s||0)*o,i||1):n.drawElements(e,t||a.indexBuffer.data.length,u,(s||0)*o):console.warn("unsupported index buffer type: uint32")}else a.instanced?n.drawArraysInstanced(e,s,t||a.getSize(),i||1):n.drawArrays(e,s,t||a.getSize());return this},r.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},r.prototype.destroy=function(){this.renderer=null},r}(),R8=function(){function r(e){e===void 0&&(e=null),this.type=Dt.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=J.FILTER_MULTISAMPLE,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}return Object.defineProperty(r.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null},enumerable:!1,configurable:!0}),r.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Dt.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},r.prototype.copyCountersOrReset=function(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},r}();function $T(r,e,t){var s=r.createShader(e);return r.shaderSource(s,t),r.compileShader(s),s}function eR(r,e){var t=r.getShaderSource(e).split(`
`).map(function(l,d){return d+": "+l}),s=r.getShaderInfoLog(e),i=s.split(`
`),n={},a=i.map(function(l){return parseFloat(l.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))}).filter(function(l){return l&&!n[l]?(n[l]=!0,!0):!1}),o=[""];a.forEach(function(l){t[l-1]="%c"+t[l-1]+"%c",o.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});var u=t.join(`
`);o[0]=u,console.error(s),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,o),console.groupEnd()}function v8(r,e,t,s){r.getProgramParameter(e,r.LINK_STATUS)||(r.getShaderParameter(t,r.COMPILE_STATUS)||eR(r,t),r.getShaderParameter(s,r.COMPILE_STATUS)||eR(r,s),console.error("PixiJS Error: Could not initialize shader."),r.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",r.getProgramInfoLog(e)))}function sf(r){for(var e=new Array(r),t=0;t<e.length;t++)e[t]=!1;return e}function tR(r,e){switch(r){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return sf(2*e);case"bvec3":return sf(3*e);case"bvec4":return sf(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var sR={},fh=sR;function O8(){if(fh===sR||fh&&fh.isContextLost()){var r=J.ADAPTER.createCanvas(),e=void 0;J.PREFER_ENV>=Si.WEBGL2&&(e=r.getContext("webgl2",{})),e||(e=r.getContext("webgl",{})||r.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),fh=e}return fh}var Hl;function S8(){if(!Hl){Hl=ks.MEDIUM;var r=O8();if(r&&r.getShaderPrecisionFormat){var e=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);Hl=e.precision?ks.HIGH:ks.MEDIUM}}return Hl}function rR(r,e,t){if(r.substring(0,9)!=="precision"){var s=e;return e===ks.HIGH&&t!==ks.HIGH&&(s=ks.MEDIUM),"precision "+s+` float;
`+r}else if(t!==ks.HIGH&&r.substring(0,15)==="precision highp")return r.replace("precision highp","precision mediump");return r}var A8={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function iR(r){return A8[r]}var kl=null,nR={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function aR(r,e){if(!kl){var t=Object.keys(nR);kl={};for(var s=0;s<t.length;++s){var i=t[s];kl[r[i]]=nR[i]}}return kl[e]}var to=[{test:function(r){return r.type==="float"&&r.size===1&&!r.isArray},code:function(r){return`
            if(uv["`+r+'"] !== ud["'+r+`"].value)
            {
                ud["`+r+'"].value = uv["'+r+`"]
                gl.uniform1f(ud["`+r+'"].location, uv["'+r+`"])
            }
            `}},{test:function(r,e){return(r.type==="sampler2D"||r.type==="samplerCube"||r.type==="sampler2DArray")&&r.size===1&&!r.isArray&&(e==null||e.castToBaseTexture!==void 0)},code:function(r){return`t = syncData.textureCount++;

            renderer.texture.bind(uv["`+r+`"], t);

            if(ud["`+r+`"].value !== t)
            {
                ud["`+r+`"].value = t;
                gl.uniform1i(ud["`+r+`"].location, t);
; // eslint-disable-line max-len
            }`}},{test:function(r,e){return r.type==="mat3"&&r.size===1&&!r.isArray&&e.a!==void 0},code:function(r){return`
            gl.uniformMatrix3fv(ud["`+r+'"].location, false, uv["'+r+`"].toArray(true));
            `},codeUbo:function(r){return`
                var `+r+"_matrix = uv."+r+`.toArray(true);

                data[offset] = `+r+`_matrix[0];
                data[offset+1] = `+r+`_matrix[1];
                data[offset+2] = `+r+`_matrix[2];
        
                data[offset + 4] = `+r+`_matrix[3];
                data[offset + 5] = `+r+`_matrix[4];
                data[offset + 6] = `+r+`_matrix[5];
        
                data[offset + 8] = `+r+`_matrix[6];
                data[offset + 9] = `+r+`_matrix[7];
                data[offset + 10] = `+r+`_matrix[8];
            `}},{test:function(r,e){return r.type==="vec2"&&r.size===1&&!r.isArray&&e.x!==void 0},code:function(r){return`
                cv = ud["`+r+`"].value;
                v = uv["`+r+`"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["`+r+`"].location, v.x, v.y);
                }`},codeUbo:function(r){return`
                v = uv.`+r+`;

                data[offset] = v.x;
                data[offset+1] = v.y;
            `}},{test:function(r){return r.type==="vec2"&&r.size===1&&!r.isArray},code:function(r){return`
                cv = ud["`+r+`"].value;
                v = uv["`+r+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["`+r+`"].location, v[0], v[1]);
                }
            `}},{test:function(r,e){return r.type==="vec4"&&r.size===1&&!r.isArray&&e.width!==void 0},code:function(r){return`
                cv = ud["`+r+`"].value;
                v = uv["`+r+`"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["`+r+`"].location, v.x, v.y, v.width, v.height)
                }`},codeUbo:function(r){return`
                    v = uv.`+r+`;

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `}},{test:function(r){return r.type==="vec4"&&r.size===1&&!r.isArray},code:function(r){return`
                cv = ud["`+r+`"].value;
                v = uv["`+r+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["`+r+`"].location, v[0], v[1], v[2], v[3])
                }`}}],y8={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},C8={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function M8(r,e){var t,s=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(var i in r.uniforms){var n=e[i];if(!n){!((t=r.uniforms[i])===null||t===void 0)&&t.group&&(r.uniforms[i].ubo?s.push(`
                        renderer.shader.syncUniformBufferGroup(uv.`+i+", '"+i+`');
                    `):s.push(`
                        renderer.shader.syncUniformGroup(uv.`+i+`, syncData);
                    `));continue}for(var a=r.uniforms[i],o=!1,u=0;u<to.length;u++)if(to[u].test(n,a)){s.push(to[u].code(i,a)),o=!0;break}if(!o){var l=n.size===1&&!n.isArray?y8:C8,d=l[n.type].replace("location",'ud["'+i+'"].location');s.push(`
            cu = ud["`+i+`"];
            cv = cu.value;
            v = uv["`+i+`"];
            `+d+";")}}return new Function("ud","uv","renderer","syncData",s.join(`
`))}var P8=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function N8(r){for(var e="",t=0;t<r;++t)t>0&&(e+=`
else `),t<r-1&&(e+="if(test == "+t+".0){}");return e}function b8(r,e){if(r===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var t=e.createShader(e.FRAGMENT_SHADER);;){var s=P8.replace(/%forloop%/gi,N8(r));if(e.shaderSource(t,s),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS))r=r/2|0;else break}return r}var gh;function D8(){if(typeof gh=="boolean")return gh;try{var r=new Function("param1","param2","param3","return param1[param2] === param3;");gh=r({a:"b"},"a","b")===!0}catch{gh=!1}return gh}var L8=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,U8=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`,F8=0,Vl={},jl=function(){function r(e,t,s){s===void 0&&(s="pixi-shader"),this.id=F8++,this.vertexSrc=e||r.defaultVertexSrc,this.fragmentSrc=t||r.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.vertexSrc.substring(0,8)!=="#version"&&(s=s.replace(/\s+/g,"-"),Vl[s]?(Vl[s]++,s+="-"+Vl[s]):Vl[s]=1,this.vertexSrc="#define SHADER_NAME "+s+`
`+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+s+`
`+this.fragmentSrc,this.vertexSrc=rR(this.vertexSrc,J.PRECISION_VERTEX,ks.HIGH),this.fragmentSrc=rR(this.fragmentSrc,J.PRECISION_FRAGMENT,S8())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(r,"defaultVertexSrc",{get:function(){return U8},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultFragmentSrc",{get:function(){return L8},enumerable:!1,configurable:!0}),r.from=function(e,t,s){var i=e+t,n=GT[i];return n||(GT[i]=n=new r(e,t,s)),n},r}(),ta=function(){function r(e,t){this.uniformBindCount=0,this.program=e,t?t instanceof ea?this.uniformGroup=t:this.uniformGroup=new ea(t):this.uniformGroup=new ea({}),this.disposeRunner=new ts("disposeShader")}return r.prototype.checkUniformExists=function(e,t){if(t.uniforms[e])return!0;for(var s in t.uniforms){var i=t.uniforms[s];if(i.group&&this.checkUniformExists(e,i))return!0}return!1},r.prototype.destroy=function(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()},Object.defineProperty(r.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),r.from=function(e,t,s){var i=jl.from(e,t);return new r(i,s)},r}(),rf=0,nf=1,af=2,of=3,hf=4,uf=5,Eh=function(){function r(){this.data=0,this.blendMode=se.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(r.prototype,"blend",{get:function(){return!!(this.data&1<<rf)},set:function(e){!!(this.data&1<<rf)!==e&&(this.data^=1<<rf)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"offsets",{get:function(){return!!(this.data&1<<nf)},set:function(e){!!(this.data&1<<nf)!==e&&(this.data^=1<<nf)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"culling",{get:function(){return!!(this.data&1<<af)},set:function(e){!!(this.data&1<<af)!==e&&(this.data^=1<<af)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"depthTest",{get:function(){return!!(this.data&1<<of)},set:function(e){!!(this.data&1<<of)!==e&&(this.data^=1<<of)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"depthMask",{get:function(){return!!(this.data&1<<uf)},set:function(e){!!(this.data&1<<uf)!==e&&(this.data^=1<<uf)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"clockwiseFrontFace",{get:function(){return!!(this.data&1<<hf)},set:function(e){!!(this.data&1<<hf)!==e&&(this.data^=1<<hf)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"blendMode",{get:function(){return this._blendMode},set:function(e){this.blend=e!==se.NONE,this._blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(e){this.offsets=!!e,this._polygonOffset=e},enumerable:!1,configurable:!0}),r.prototype.toString=function(){return"[@pixi/core:State "+("blendMode="+this.blendMode+" ")+("clockwiseFrontFace="+this.clockwiseFrontFace+" ")+("culling="+this.culling+" ")+("depthMask="+this.depthMask+" ")+("polygonOffset="+this.polygonOffset)+"]"},r.for2d=function(){var e=new r;return e.depthTest=!1,e.blend=!0,e},r}(),w8=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,x8=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,so=function(r){at(e,r);function e(t,s,i){var n=this,a=jl.from(t||e.defaultVertexSrc,s||e.defaultFragmentSrc);return n=r.call(this,a,i)||this,n.padding=0,n.resolution=J.FILTER_RESOLUTION,n.multisample=J.FILTER_MULTISAMPLE,n.enabled=!0,n.autoFit=!0,n.state=new Eh,n}return e.prototype.apply=function(t,s,i,n,a){t.applyFilter(this,s,i,n)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._resolution=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultVertexSrc",{get:function(){return x8},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return w8},enumerable:!1,configurable:!0}),e}(ta),G8=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,B8=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,oR=new Ye,hR=function(){function r(e,t){this._texture=e,this.mapCoord=new Ye,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof t>"u"?.5:t,this.isSimple=!1}return Object.defineProperty(r.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture=e,this._textureID=-1},enumerable:!1,configurable:!0}),r.prototype.multiplyUvs=function(e,t){t===void 0&&(t=e);for(var s=this.mapCoord,i=0;i<e.length;i+=2){var n=e[i],a=e[i+1];t[i]=n*s.a+a*s.c+s.tx,t[i+1]=n*s.b+a*s.d+s.ty}return t},r.prototype.update=function(e){var t=this._texture;if(!t||!t.valid||!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;var s=t._uvs;this.mapCoord.set(s.x1-s.x0,s.y1-s.y0,s.x3-s.x0,s.y3-s.y0,s.x0,s.y0);var i=t.orig,n=t.trim;n&&(oR.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(oR));var a=t.baseTexture,o=this.uClampFrame,u=this.clampMargin/a.resolution,l=this.clampOffset;return o[0]=(t._frame.x+u+l)/a.width,o[1]=(t._frame.y+u+l)/a.height,o[2]=(t._frame.x+t._frame.width-u+l)/a.width,o[3]=(t._frame.y+t._frame.height-u+l)/a.height,this.uClampOffset[0]=l/a.realWidth,this.uClampOffset[1]=l/a.realHeight,this.isSimple=t._frame.width===a.width&&t._frame.height===a.height&&t.rotate===0,!0},r}(),H8=function(r){at(e,r);function e(t,s,i){var n=this,a=null;return typeof t!="string"&&s===void 0&&i===void 0&&(a=t,t=void 0,s=void 0,i=void 0),n=r.call(this,t||G8,s||B8,i)||this,n.maskSprite=a,n.maskMatrix=new Ye,n}return Object.defineProperty(e.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),e.prototype.apply=function(t,s,i,n){var a=this._maskSprite,o=a._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new hR(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,a).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=a.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,s,i,n))},e}(so),k8=function(){function r(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return r.prototype.setMaskStack=function(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)},r.prototype.push=function(e,t){var s=t;if(!s.isMaskData){var i=this.maskDataPool.pop()||new R8;i.pooled=!0,i.maskObject=t,s=i}var n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(s.copyCountersOrReset(n),s._colorMask=n?n._colorMask:15,s.autoDetect&&this.detect(s),s._target=e,s.type!==Dt.SPRITE&&this.maskStack.push(s),s.enabled)switch(s.type){case Dt.SCISSOR:this.renderer.scissor.push(s);break;case Dt.STENCIL:this.renderer.stencil.push(s);break;case Dt.SPRITE:s.copyCountersOrReset(null),this.pushSpriteMask(s);break;case Dt.COLOR:this.pushColorMask(s);break}s.type===Dt.SPRITE&&this.maskStack.push(s)},r.prototype.pop=function(e){var t=this.maskStack.pop();if(!(!t||t._target!==e)){if(t.enabled)switch(t.type){case Dt.SCISSOR:this.renderer.scissor.pop(t);break;case Dt.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case Dt.SPRITE:this.popSpriteMask(t);break;case Dt.COLOR:this.popColorMask(t);break}if(t.reset(),t.pooled&&this.maskDataPool.push(t),this.maskStack.length!==0){var s=this.maskStack[this.maskStack.length-1];s.type===Dt.SPRITE&&s._filters&&(s._filters[0].maskSprite=s.maskObject)}}},r.prototype.detect=function(e){var t=e.maskObject;t?t.isSprite?e.type=Dt.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=Dt.SCISSOR:e.type=Dt.STENCIL:e.type=Dt.COLOR},r.prototype.pushSpriteMask=function(e){var t,s,i=e.maskObject,n=e._target,a=e._filters;a||(a=this.alphaMaskPool[this.alphaMaskIndex],a||(a=this.alphaMaskPool[this.alphaMaskIndex]=[new H8]));var o=this.renderer,u=o.renderTexture,l,d;if(u.current){var c=u.current;l=e.resolution||c.resolution,d=(t=e.multisample)!==null&&t!==void 0?t:c.multisample}else l=e.resolution||o.resolution,d=(s=e.multisample)!==null&&s!==void 0?s:o.multisample;a[0].resolution=l,a[0].multisample=d,a[0].maskSprite=i;var _=n.filterArea;n.filterArea=i.getBounds(!0),o.filter.push(n,a),n.filterArea=_,e._filters||this.alphaMaskIndex++},r.prototype.popSpriteMask=function(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},r.prototype.pushColorMask=function(e){var t=e._colorMask,s=e._colorMask=t&e.colorMask;s!==t&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)},r.prototype.popColorMask=function(e){var t=e._colorMask,s=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;s!==t&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)},r.prototype.destroy=function(){this.renderer=null},r}(),uR=function(){function r(e){this.renderer=e,this.maskStack=[],this.glConst=0}return r.prototype.getStackLength=function(){return this.maskStack.length},r.prototype.setMaskStack=function(e){var t=this.renderer.gl,s=this.getStackLength();this.maskStack=e;var i=this.getStackLength();i!==s&&(i===0?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))},r.prototype._useCurrent=function(){},r.prototype.destroy=function(){this.renderer=null,this.maskStack=null},r}(),lR=new Ye,cR=[],V8=function(r){at(e,r);function e(t){var s=r.call(this,t)||this;return s.glConst=J.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST,s}return e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.calcScissorRect=function(t){var s;if(!t._scissorRectLocal){var i=t._scissorRect,n=t.maskObject,a=this.renderer,o=a.renderTexture,u=n.getBounds(!0,(s=cR.pop())!==null&&s!==void 0?s:new he);this.roundFrameToPixels(u,o.current?o.current.resolution:a.resolution,o.sourceFrame,o.destinationFrame,a.projection.transform),i&&u.fit(i),t._scissorRectLocal=u}},e.isMatrixRotated=function(t){if(!t)return!1;var s=t.a,i=t.b,n=t.c,a=t.d;return(Math.abs(i)>1e-4||Math.abs(n)>1e-4)&&(Math.abs(s)>1e-4||Math.abs(a)>1e-4)},e.prototype.testScissor=function(t){var s=t.maskObject;if(!s.isFastRect||!s.isFastRect()||e.isMatrixRotated(s.worldTransform)||e.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);var i=t._scissorRectLocal;return i.width>0&&i.height>0},e.prototype.roundFrameToPixels=function(t,s,i,n,a){e.isMatrixRotated(a)||(a=a?lR.copyFrom(a):lR.identity(),a.translate(-i.x,-i.y).scale(n.width/i.width,n.height/i.height).translate(n.x,n.y),this.renderer.filter.transformAABB(a,t),t.fit(n),t.x=Math.round(t.x*s),t.y=Math.round(t.y*s),t.width=Math.round(t.width*s),t.height=Math.round(t.height*s))},e.prototype.push=function(t){t._scissorRectLocal||this.calcScissorRect(t);var s=this.renderer.gl;t._scissorRect||s.enable(s.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()},e.prototype.pop=function(t){var s=this.renderer.gl;t&&cR.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():s.disable(s.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,s;this.renderer.renderTexture.current?s=t.y:s=this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,s,t.width,t.height)},e}(uR),j8=function(r){at(e,r);function e(t){var s=r.call(this,t)||this;return s.glConst=J.ADAPTER.getWebGLRenderingContext().STENCIL_TEST,s}return e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var s=t.maskObject,i=this.renderer.gl,n=t._stencilCounter;n===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),t._stencilCounter++;var a=t._colorMask;a!==0&&(t._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,n,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),s.renderable=!0,s.render(this.renderer),this.renderer.batch.flush(),s.renderable=!1,a!==0&&(t._colorMask=a,i.colorMask((a&1)!==0,(a&2)!==0,(a&4)!==0,(a&8)!==0)),this._useCurrent()},e.prototype.pop=function(t){var s=this.renderer.gl;if(this.getStackLength()===0)s.disable(s.STENCIL_TEST);else{var i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,n=i?i._colorMask:15;n!==0&&(i._colorMask=0,s.colorMask(!1,!1,!1,!1)),s.stencilOp(s.KEEP,s.KEEP,s.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,n!==0&&(i._colorMask=n,s.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e}(uR),Y8=function(){function r(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Ye,this.transform=null}return r.prototype.update=function(e,t,s,i){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,s,i),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},r.prototype.calculateProjection=function(e,t,s,i){var n=this.projectionMatrix,a=i?-1:1;n.identity(),n.a=1/t.width*2,n.d=a*(1/t.height*2),n.tx=-1-t.x*n.a,n.ty=-a-t.y*n.d},r.prototype.setTransform=function(e){},r.prototype.destroy=function(){this.renderer=null},r}(),sa=new he,mh=new he,W8=function(){function r(e){this.renderer=e,this.clearColor=e._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new he,this.destinationFrame=new he,this.viewportFrame=new he}return r.prototype.bind=function(e,t,s){e===void 0&&(e=null);var i=this.renderer;this.current=e;var n,a,o;e?(n=e.baseTexture,o=n.resolution,t||(sa.width=e.frame.width,sa.height=e.frame.height,t=sa),s||(mh.x=e.frame.x,mh.y=e.frame.y,mh.width=t.width,mh.height=t.height,s=mh),a=n.framebuffer):(o=i.resolution,t||(sa.width=i.screen.width,sa.height=i.screen.height,t=sa),s||(s=sa,s.width=t.width,s.height=t.height));var u=this.viewportFrame;u.x=s.x*o,u.y=s.y*o,u.width=s.width*o,u.height=s.height*o,e||(u.y=i.view.height-(u.y+u.height)),u.ceil(),this.renderer.framebuffer.bind(a,u),this.renderer.projection.update(s,t,o,!a),e?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(s)},r.prototype.clear=function(e,t){this.current?e=e||this.current.baseTexture.clearColor:e=e||this.clearColor;var s=this.destinationFrame,i=this.current?this.current.baseTexture:this.renderer.screen,n=s.width!==i.width||s.height!==i.height;if(n){var a=this.viewportFrame,o=a.x,u=a.y,l=a.width,d=a.height;o=Math.round(o),u=Math.round(u),l=Math.round(l),d=Math.round(d),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(o,u,l,d)}this.renderer.framebuffer.clear(e[0],e[1],e[2],e[3],t),n&&this.renderer.scissor.pop()},r.prototype.resize=function(){this.bind(null)},r.prototype.reset=function(){this.bind(null)},r.prototype.destroy=function(){this.renderer=null},r}();function z8(r,e,t,s,i){t.buffer.update(i)}var X8={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},_R={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function K8(r){for(var e=r.map(function(u){return{data:u,offset:0,dataLen:0,dirty:0}}),t=0,s=0,i=0,n=0;n<e.length;n++){var a=e[n];if(t=_R[a.data.type],a.data.size>1&&(t=Math.max(t,16)*a.data.size),a.dataLen=t,s%t!==0&&s<16){var o=s%t%16;s+=o,i+=o}s+t>16?(i=Math.ceil(i/16)*16,a.offset=i,i+=t,s=t):(a.offset=i,s+=t,i+=t)}return i=Math.ceil(i/16)*16,{uboElements:e,size:i}}function q8(r,e){var t=[];for(var s in r)e[s]&&t.push(e[s]);return t.sort(function(i,n){return i.index-n.index}),t}function Q8(r,e){if(!r.autoManage)return{size:0,syncFunc:z8};for(var t=q8(r.uniforms,e),s=K8(t),i=s.uboElements,n=s.size,a=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `],o=0;o<i.length;o++){for(var u=i[o],l=r.uniforms[u.data.name],d=u.data.name,c=!1,_=0;_<to.length;_++){var f=to[_];if(f.codeUbo&&f.test(u.data,l)){a.push("offset = "+u.offset/4+";",to[_].codeUbo(u.data.name,l)),c=!0;break}}if(!c)if(u.data.size>1){var g=iR(u.data.type),I=Math.max(_R[u.data.type]/16,1),p=g/I,R=(4-p%4)%4;a.push(`
                cv = ud.`+d+`.value;
                v = uv.`+d+`;
                offset = `+u.offset/4+`;

                t = 0;

                for(var i=0; i < `+u.data.size*I+`; i++)
                {
                    for(var j = 0; j < `+p+`; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += `+R+`;
                }

                `)}else{var S=X8[u.data.type];a.push(`
                cv = ud.`+d+`.value;
                v = uv.`+d+`;
                offset = `+u.offset/4+`;
                `+S+`;
                `)}}return a.push(`
       renderer.buffer.update(buffer);
    `),{size:n,syncFunc:new Function("ud","uv","renderer","syncData","buffer",a.join(`
`))}}var Z8=function(){function r(e,t){this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return r.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},r}();function J8(r,e){for(var t={},s=e.getProgramParameter(r,e.ACTIVE_ATTRIBUTES),i=0;i<s;i++){var n=e.getActiveAttrib(r,i);if(n.name.indexOf("gl_")!==0){var a=aR(e,n.type),o={type:a,name:n.name,size:iR(a),location:e.getAttribLocation(r,n.name)};t[n.name]=o}}return t}function $8(r,e){for(var t={},s=e.getProgramParameter(r,e.ACTIVE_UNIFORMS),i=0;i<s;i++){var n=e.getActiveUniform(r,i),a=n.name.replace(/\[.*?\]$/,""),o=!!n.name.match(/\[.*?\]$/),u=aR(e,n.type);t[a]={name:a,index:i,type:u,size:n.size,isArray:o,value:tR(u,n.size)}}return t}function eK(r,e){var t=$T(r,r.VERTEX_SHADER,e.vertexSrc),s=$T(r,r.FRAGMENT_SHADER,e.fragmentSrc),i=r.createProgram();if(r.attachShader(i,t),r.attachShader(i,s),r.linkProgram(i),r.getProgramParameter(i,r.LINK_STATUS)||v8(r,i,t,s),e.attributeData=J8(i,r),e.uniformData=$8(i,r),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){var n=Object.keys(e.attributeData);n.sort(function(d,c){return d>c?1:-1});for(var a=0;a<n.length;a++)e.attributeData[n[a]].location=a,r.bindAttribLocation(i,a,n[a]);r.linkProgram(i)}r.deleteShader(t),r.deleteShader(s);var o={};for(var a in e.uniformData){var u=e.uniformData[a];o[a]={location:r.getUniformLocation(i,a),value:tR(u.type,u.size)}}var l=new Z8(i,o);return l}var tK=0,Yl={textureCount:0,uboCount:0},sK=function(){function r(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=tK++}return r.prototype.systemCheck=function(){if(!D8())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},r.prototype.contextChange=function(e){this.gl=e,this.reset()},r.prototype.bind=function(e,t){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;var s=e.program,i=s.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==s&&(this.program=s,this.gl.useProgram(i.program)),t||(Yl.textureCount=0,Yl.uboCount=0,this.syncUniformGroup(e.uniformGroup,Yl)),i},r.prototype.setUniforms=function(e){var t=this.shader.program,s=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(s.uniformData,e,this.renderer)},r.prototype.syncUniformGroup=function(e,t){var s=this.getGlProgram();(!e.static||e.dirtyId!==s.uniformDirtyGroups[e.id])&&(s.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,s,t))},r.prototype.syncUniforms=function(e,t,s){var i=e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e);i(t.uniformData,e.uniforms,this.renderer,s)},r.prototype.createSyncGroups=function(e){var t=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[t]||(this.cache[t]=M8(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]},r.prototype.syncUniformBufferGroup=function(e,t){var s=this.getGlProgram();if(!e.static||e.dirtyId!==0||!s.uniformGroups[e.id]){e.dirtyId=0;var i=s.uniformGroups[e.id]||this.createSyncBufferGroup(e,s,t);e.buffer.update(),i(s.uniformData,e.uniforms,this.renderer,Yl,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,s.uniformBufferBindings[t])},r.prototype.createSyncBufferGroup=function(e,t,s){var i=this.renderer.gl;this.renderer.buffer.bind(e.buffer);var n=this.gl.getUniformBlockIndex(t.program,s);t.uniformBufferBindings[s]=this.shader.uniformBindCount,i.uniformBlockBinding(t.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;var a=this.getSignature(e,this.shader.program.uniformData,"ubo"),o=this._uboCache[a];if(o||(o=this._uboCache[a]=Q8(e,this.shader.program.uniformData)),e.autoManage){var u=new Float32Array(o.size/4);e.buffer.update(u)}return t.uniformGroups[e.id]=o.syncFunc,t.uniformGroups[e.id]},r.prototype.getSignature=function(e,t,s){var i=e.uniforms,n=[s+"-"];for(var a in i)n.push(a),t[a]&&n.push(t[a].type);return n.join("-")},r.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},r.prototype.generateProgram=function(e){var t=this.gl,s=e.program,i=eK(t,s);return s.glPrograms[this.renderer.CONTEXT_UID]=i,i},r.prototype.reset=function(){this.program=null,this.shader=null},r.prototype.disposeShader=function(e){this.shader===e&&(this.shader=null)},r.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},r}();function rK(r,e){return e===void 0&&(e=[]),e[se.NORMAL]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[se.ADD]=[r.ONE,r.ONE],e[se.MULTIPLY]=[r.DST_COLOR,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],e[se.SCREEN]=[r.ONE,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],e[se.OVERLAY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[se.DARKEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[se.LIGHTEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[se.COLOR_DODGE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[se.COLOR_BURN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[se.HARD_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[se.SOFT_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[se.DIFFERENCE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[se.EXCLUSION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[se.HUE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[se.SATURATION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[se.COLOR]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[se.LUMINOSITY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[se.NONE]=[0,0],e[se.NORMAL_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],e[se.ADD_NPM]=[r.SRC_ALPHA,r.ONE,r.ONE,r.ONE],e[se.SCREEN_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],e[se.SRC_IN]=[r.DST_ALPHA,r.ZERO],e[se.SRC_OUT]=[r.ONE_MINUS_DST_ALPHA,r.ZERO],e[se.SRC_ATOP]=[r.DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],e[se.DST_OVER]=[r.ONE_MINUS_DST_ALPHA,r.ONE],e[se.DST_IN]=[r.ZERO,r.SRC_ALPHA],e[se.DST_OUT]=[r.ZERO,r.ONE_MINUS_SRC_ALPHA],e[se.DST_ATOP]=[r.ONE_MINUS_DST_ALPHA,r.SRC_ALPHA],e[se.XOR]=[r.ONE_MINUS_DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],e[se.SUBTRACT]=[r.ONE,r.ONE,r.ONE,r.ONE,r.FUNC_REVERSE_SUBTRACT,r.FUNC_ADD],e}var iK=0,nK=1,aK=2,oK=3,hK=4,uK=5,lK=function(){function r(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=se.NONE,this._blendEq=!1,this.map=[],this.map[iK]=this.setBlend,this.map[nK]=this.setOffset,this.map[aK]=this.setCullFace,this.map[oK]=this.setDepthTest,this.map[hK]=this.setFrontFace,this.map[uK]=this.setDepthMask,this.checks=[],this.defaultState=new Eh,this.defaultState.blend=!0}return r.prototype.contextChange=function(e){this.gl=e,this.blendModes=rK(e),this.set(this.defaultState),this.reset()},r.prototype.set=function(e){if(e=e||this.defaultState,this.stateId!==e.data){for(var t=this.stateId^e.data,s=0;t;)t&1&&this.map[s].call(this,!!(e.data&1<<s)),t=t>>1,s++;this.stateId=e.data}for(var s=0;s<this.checks.length;s++)this.checks[s](this,e)},r.prototype.forceState=function(e){e=e||this.defaultState;for(var t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(var t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data},r.prototype.setBlend=function(e){this.updateCheck(r.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)},r.prototype.setOffset=function(e){this.updateCheck(r.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},r.prototype.setDepthTest=function(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)},r.prototype.setDepthMask=function(e){this.gl.depthMask(e)},r.prototype.setCullFace=function(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)},r.prototype.setFrontFace=function(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])},r.prototype.setBlendMode=function(e){if(e!==this.blendMode){this.blendMode=e;var t=this.blendModes[e],s=this.gl;t.length===2?s.blendFunc(t[0],t[1]):s.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,s.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,s.blendEquationSeparate(s.FUNC_ADD,s.FUNC_ADD))}},r.prototype.setPolygonOffset=function(e,t){this.gl.polygonOffset(e,t)},r.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},r.prototype.updateCheck=function(e,t){var s=this.checks.indexOf(e);t&&s===-1?this.checks.push(e):!t&&s!==-1&&this.checks.splice(s,1)},r.checkBlendMode=function(e,t){e.setBlendMode(t.blendMode)},r.checkPolygonOffset=function(e,t){e.setPolygonOffset(1,t.polygonOffset)},r.prototype.destroy=function(){this.gl=null},r}(),cK=function(){function r(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=J.GC_MAX_IDLE,this.checkCountMax=J.GC_MAX_CHECK_COUNT,this.mode=J.GC_MODE}return r.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==dl.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},r.prototype.run=function(){for(var e=this.renderer.texture,t=e.managedTextures,s=!1,i=0;i<t.length;i++){var n=t[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(e.destroyTexture(n,!0),t[i]=null,s=!0)}if(s){for(var a=0,i=0;i<t.length;i++)t[i]!==null&&(t[a++]=t[i]);t.length=a}},r.prototype.unload=function(e){var t=this.renderer.texture,s=e._texture;s&&!s.framebuffer&&t.destroyTexture(s);for(var i=e.children.length-1;i>=0;i--)this.unload(e.children[i])},r.prototype.destroy=function(){this.renderer=null},r}();function _K(r){var e,t,s,i,n,a,o,u,l,d,c,_,f,g,I,p,R,S,O,A,C,M,N;return"WebGL2RenderingContext"in globalThis&&r instanceof globalThis.WebGL2RenderingContext?N=(e={},e[He.UNSIGNED_BYTE]=(t={},t[Z.RGBA]=r.RGBA8,t[Z.RGB]=r.RGB8,t[Z.RG]=r.RG8,t[Z.RED]=r.R8,t[Z.RGBA_INTEGER]=r.RGBA8UI,t[Z.RGB_INTEGER]=r.RGB8UI,t[Z.RG_INTEGER]=r.RG8UI,t[Z.RED_INTEGER]=r.R8UI,t[Z.ALPHA]=r.ALPHA,t[Z.LUMINANCE]=r.LUMINANCE,t[Z.LUMINANCE_ALPHA]=r.LUMINANCE_ALPHA,t),e[He.BYTE]=(s={},s[Z.RGBA]=r.RGBA8_SNORM,s[Z.RGB]=r.RGB8_SNORM,s[Z.RG]=r.RG8_SNORM,s[Z.RED]=r.R8_SNORM,s[Z.RGBA_INTEGER]=r.RGBA8I,s[Z.RGB_INTEGER]=r.RGB8I,s[Z.RG_INTEGER]=r.RG8I,s[Z.RED_INTEGER]=r.R8I,s),e[He.UNSIGNED_SHORT]=(i={},i[Z.RGBA_INTEGER]=r.RGBA16UI,i[Z.RGB_INTEGER]=r.RGB16UI,i[Z.RG_INTEGER]=r.RG16UI,i[Z.RED_INTEGER]=r.R16UI,i[Z.DEPTH_COMPONENT]=r.DEPTH_COMPONENT16,i),e[He.SHORT]=(n={},n[Z.RGBA_INTEGER]=r.RGBA16I,n[Z.RGB_INTEGER]=r.RGB16I,n[Z.RG_INTEGER]=r.RG16I,n[Z.RED_INTEGER]=r.R16I,n),e[He.UNSIGNED_INT]=(a={},a[Z.RGBA_INTEGER]=r.RGBA32UI,a[Z.RGB_INTEGER]=r.RGB32UI,a[Z.RG_INTEGER]=r.RG32UI,a[Z.RED_INTEGER]=r.R32UI,a[Z.DEPTH_COMPONENT]=r.DEPTH_COMPONENT24,a),e[He.INT]=(o={},o[Z.RGBA_INTEGER]=r.RGBA32I,o[Z.RGB_INTEGER]=r.RGB32I,o[Z.RG_INTEGER]=r.RG32I,o[Z.RED_INTEGER]=r.R32I,o),e[He.FLOAT]=(u={},u[Z.RGBA]=r.RGBA32F,u[Z.RGB]=r.RGB32F,u[Z.RG]=r.RG32F,u[Z.RED]=r.R32F,u[Z.DEPTH_COMPONENT]=r.DEPTH_COMPONENT32F,u),e[He.HALF_FLOAT]=(l={},l[Z.RGBA]=r.RGBA16F,l[Z.RGB]=r.RGB16F,l[Z.RG]=r.RG16F,l[Z.RED]=r.R16F,l),e[He.UNSIGNED_SHORT_5_6_5]=(d={},d[Z.RGB]=r.RGB565,d),e[He.UNSIGNED_SHORT_4_4_4_4]=(c={},c[Z.RGBA]=r.RGBA4,c),e[He.UNSIGNED_SHORT_5_5_5_1]=(_={},_[Z.RGBA]=r.RGB5_A1,_),e[He.UNSIGNED_INT_2_10_10_10_REV]=(f={},f[Z.RGBA]=r.RGB10_A2,f[Z.RGBA_INTEGER]=r.RGB10_A2UI,f),e[He.UNSIGNED_INT_10F_11F_11F_REV]=(g={},g[Z.RGB]=r.R11F_G11F_B10F,g),e[He.UNSIGNED_INT_5_9_9_9_REV]=(I={},I[Z.RGB]=r.RGB9_E5,I),e[He.UNSIGNED_INT_24_8]=(p={},p[Z.DEPTH_STENCIL]=r.DEPTH24_STENCIL8,p),e[He.FLOAT_32_UNSIGNED_INT_24_8_REV]=(R={},R[Z.DEPTH_STENCIL]=r.DEPTH32F_STENCIL8,R),e):N=(S={},S[He.UNSIGNED_BYTE]=(O={},O[Z.RGBA]=r.RGBA,O[Z.RGB]=r.RGB,O[Z.ALPHA]=r.ALPHA,O[Z.LUMINANCE]=r.LUMINANCE,O[Z.LUMINANCE_ALPHA]=r.LUMINANCE_ALPHA,O),S[He.UNSIGNED_SHORT_5_6_5]=(A={},A[Z.RGB]=r.RGB,A),S[He.UNSIGNED_SHORT_4_4_4_4]=(C={},C[Z.RGBA]=r.RGBA,C),S[He.UNSIGNED_SHORT_5_5_5_1]=(M={},M[Z.RGBA]=r.RGBA,M),S),N}var lf=function(){function r(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=He.UNSIGNED_BYTE,this.internalFormat=Z.RGBA,this.samplerType=0}return r}(),dK=function(){function r(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Qe,this.hasIntegerTextures=!1}return r.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=_K(e);var t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(var s=0;s<t;s++)this.boundTextures[s]=null;this.emptyTextures={};var i=new lf(e.createTexture());e.bindTexture(e.TEXTURE_2D,i.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=i,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new lf(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(var s=0;s<6;s++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},r.prototype.bind=function(e,t){t===void 0&&(t=0);var s=this.gl;if(e=e==null?void 0:e.castToBaseTexture(),e&&e.valid&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;var i=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,s.activeTexture(s.TEXTURE0+t)),s.bindTexture(e.target,i.texture)),i.dirtyId!==e.dirtyId?(this.currentLocation!==t&&(this.currentLocation=t,s.activeTexture(s.TEXTURE0+t)),this.updateTexture(e)):i.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[t]=e}else this.currentLocation!==t&&(this.currentLocation=t,s.activeTexture(s.TEXTURE0+t)),s.bindTexture(s.TEXTURE_2D,this.emptyTextures[s.TEXTURE_2D].texture),this.boundTextures[t]=null},r.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture},r.prototype.unbind=function(e){var t=this,s=t.gl,i=t.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var n=0;n<i.length;n++)i[n]===this.unknownTexture&&this.bind(null,n)}for(var n=0;n<i.length;n++)i[n]===e&&(this.currentLocation!==n&&(s.activeTexture(s.TEXTURE0+n),this.currentLocation=n),s.bindTexture(e.target,this.emptyTextures[e.target].texture),i[n]=null)},r.prototype.ensureSamplerType=function(e){var t=this,s=t.boundTextures,i=t.hasIntegerTextures,n=t.CONTEXT_UID;if(i)for(var a=e-1;a>=0;--a){var o=s[a];if(o){var u=o._glTextures[n];u.samplerType!==_l.FLOAT&&this.renderer.texture.unbind(o)}}},r.prototype.initTexture=function(e){var t=new lf(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t},r.prototype.initTextureType=function(e,t){var s,i;t.internalFormat=(i=(s=this.internalFormats[e.type])===null||s===void 0?void 0:s[e.format])!==null&&i!==void 0?i:e.format,this.webGLVersion===2&&e.type===He.HALF_FLOAT?t.type=this.gl.HALF_FLOAT:t.type=e.type},r.prototype.updateTexture=function(e){var t=e._glTextures[this.CONTEXT_UID];if(t){var s=this.renderer;if(this.initTextureType(e,t),e.resource&&e.resource.upload(s,e,t))t.samplerType!==_l.FLOAT&&(this.hasIntegerTextures=!0);else{var i=e.realWidth,n=e.realHeight,a=s.gl;(t.width!==i||t.height!==n||t.dirtyId<0)&&(t.width=i,t.height=n,a.texImage2D(e.target,0,t.internalFormat,i,n,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}},r.prototype.destroyTexture=function(e,t){var s=this.gl;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),s.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){var i=this.managedTextures.indexOf(e);i!==-1&&Dl(this.managedTextures,i,1)}},r.prototype.updateTextureStyle=function(e){var t=e._glTextures[this.CONTEXT_UID];t&&((e.mipmap===ln.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?t.mipmap=!1:t.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?t.wrapMode=Ai.CLAMP:t.wrapMode=e.wrapMode,e.resource&&e.resource.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)},r.prototype.setStyle=function(e,t){var s=this.gl;if(t.mipmap&&e.mipmap!==ln.ON_MANUAL&&s.generateMipmap(e.target),s.texParameteri(e.target,s.TEXTURE_WRAP_S,t.wrapMode),s.texParameteri(e.target,s.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){s.texParameteri(e.target,s.TEXTURE_MIN_FILTER,e.scaleMode===Ds.LINEAR?s.LINEAR_MIPMAP_LINEAR:s.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&e.anisotropicLevel>0&&e.scaleMode===Ds.LINEAR){var n=Math.min(e.anisotropicLevel,s.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));s.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else s.texParameteri(e.target,s.TEXTURE_MIN_FILTER,e.scaleMode===Ds.LINEAR?s.LINEAR:s.NEAREST);s.texParameteri(e.target,s.TEXTURE_MAG_FILTER,e.scaleMode===Ds.LINEAR?s.LINEAR:s.NEAREST)},r.prototype.destroy=function(){this.renderer=null},r}(),cf=new Ye,fK=function(r){at(e,r);function e(t,s){t===void 0&&(t=Jo.UNKNOWN);var i=r.call(this)||this;return s=Object.assign({},J.RENDER_OPTIONS,s),i.options=s,i.type=t,i.screen=new he(0,0,s.width,s.height),i.view=s.view||J.ADAPTER.createCanvas(),i.resolution=s.resolution||J.RESOLUTION,i.useContextAlpha=s.useContextAlpha,i.autoDensity=!!s.autoDensity,i.preserveDrawingBuffer=s.preserveDrawingBuffer,i.clearBeforeRender=s.clearBeforeRender,i._backgroundColor=0,i._backgroundColorRgba=[0,0,0,1],i._backgroundColorString="#000000",i.backgroundColor=s.backgroundColor||i._backgroundColor,i.backgroundAlpha=s.backgroundAlpha,s.transparent!==void 0&&(Wr("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),i.useContextAlpha=s.transparent,i.backgroundAlpha=s.transparent?0:1),i._lastObjectRendered=null,i.plugins={},i}return e.prototype.initPlugins=function(t){for(var s in t)this.plugins[s]=new t[s](this)},Object.defineProperty(e.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,s){this.view.width=Math.round(t*this.resolution),this.view.height=Math.round(s*this.resolution);var i=this.view.width/this.resolution,n=this.view.height/this.resolution;this.screen.width=i,this.screen.height=n,this.autoDensity&&(this.view.style.width=i+"px",this.view.style.height=n+"px"),this.emit("resize",i,n)},e.prototype.generateTexture=function(t,s,i,n){s===void 0&&(s={}),typeof s=="number"&&(Wr("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),s={scaleMode:s,resolution:i,region:n});var a=s.region,o=Q6(s,["region"]);n=a||t.getLocalBounds(null,!0),n.width===0&&(n.width=1),n.height===0&&(n.height=1);var u=kt.create(Zd({width:n.width,height:n.height},o));return cf.tx=-n.x,cf.ty=-n.y,this.render(t,{renderTexture:u,clear:!1,transform:cf,skipUpdateTransform:!!t.parent}),u},e.prototype.destroy=function(t){for(var s in this.plugins)this.plugins[s].destroy(),this.plugins[s]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var i=this;i.plugins=null,i.type=Jo.UNKNOWN,i.view=null,i.screen=null,i._tempDisplayObjectParent=null,i.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=bT(t),Nl(t,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(t){this._backgroundColorRgba[3]=t},enumerable:!1,configurable:!0}),e}($o),gK=function(){function r(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}return r}(),EK=function(){function r(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}return r.prototype.destroy=function(){this.renderer=null},r.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},r.prototype.bind=function(e){var t=this,s=t.gl,i=t.CONTEXT_UID,n=e._glBuffers[i]||this.createGLBuffer(e);s.bindBuffer(e.type,n.buffer)},r.prototype.bindBufferBase=function(e,t){var s=this,i=s.gl,n=s.CONTEXT_UID;if(this.boundBufferBases[t]!==e){var a=e._glBuffers[n]||this.createGLBuffer(e);this.boundBufferBases[t]=e,i.bindBufferBase(i.UNIFORM_BUFFER,t,a.buffer)}},r.prototype.bindBufferRange=function(e,t,s){var i=this,n=i.gl,a=i.CONTEXT_UID;s=s||0;var o=e._glBuffers[a]||this.createGLBuffer(e);n.bindBufferRange(n.UNIFORM_BUFFER,t||0,o.buffer,s*256,256)},r.prototype.update=function(e){var t=this,s=t.gl,i=t.CONTEXT_UID,n=e._glBuffers[i];if(e._updateID!==n.updateID)if(n.updateID=e._updateID,s.bindBuffer(e.type,n.buffer),n.byteLength>=e.data.byteLength)s.bufferSubData(e.type,0,e.data);else{var a=e.static?s.STATIC_DRAW:s.DYNAMIC_DRAW;n.byteLength=e.data.byteLength,s.bufferData(e.type,e.data,a)}},r.prototype.dispose=function(e,t){if(this.managedBuffers[e.id]){delete this.managedBuffers[e.id];var s=e._glBuffers[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this),s&&(t||i.deleteBuffer(s.buffer),delete e._glBuffers[this.CONTEXT_UID])}},r.prototype.disposeAll=function(e){for(var t=Object.keys(this.managedBuffers),s=0;s<t.length;s++)this.dispose(this.managedBuffers[t[s]],e)},r.prototype.createGLBuffer=function(e){var t=this,s=t.CONTEXT_UID,i=t.gl;return e._glBuffers[s]=new gK(i.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[s]},r}(),_f=function(r){at(e,r);function e(t){var s=r.call(this,Jo.WEBGL,t)||this;return t=s.options,s.gl=null,s.CONTEXT_UID=0,s.runners={destroy:new ts("destroy"),contextChange:new ts("contextChange"),reset:new ts("reset"),update:new ts("update"),postrender:new ts("postrender"),prerender:new ts("prerender"),resize:new ts("resize")},s.runners.contextChange.add(s),s.globalUniforms=new ea({projectionMatrix:new Ye},!0),s.addSystem(k8,"mask").addSystem(E8,"context").addSystem(lK,"state").addSystem(sK,"shader").addSystem(dK,"texture").addSystem(EK,"buffer").addSystem(T8,"geometry").addSystem(I8,"framebuffer").addSystem(V8,"scissor").addSystem(j8,"stencil").addSystem(Y8,"projection").addSystem(cK,"textureGC").addSystem(f8,"filter").addSystem(W8,"renderTexture").addSystem(g8,"batch"),s.initPlugins(e.__plugins),s.multisample=void 0,t.context?s.context.initFromContext(t.context):s.context.initFromOptions({alpha:!!s.useContextAlpha,antialias:t.antialias,premultipliedAlpha:s.useContextAlpha&&s.useContextAlpha!=="notMultiplied",stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:s.options.powerPreference}),s.renderingToScreen=!0,zz(s.context.webGLVersion===2?"WebGL 2":"WebGL 1"),s.resize(s.options.width,s.options.height),s}return e.create=function(t){if(Xz())return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},e.prototype.contextChange=function(){var t=this.gl,s;if(this.context.webGLVersion===1){var i=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),s=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,i)}else{var i=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),s=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,i)}s>=lt.HIGH?this.multisample=lt.HIGH:s>=lt.MEDIUM?this.multisample=lt.MEDIUM:s>=lt.LOW?this.multisample=lt.LOW:this.multisample=lt.NONE},e.prototype.addSystem=function(t,s){var i=new t(this);if(this[s])throw new Error('Whoops! The name "'+s+'" is already in use');this[s]=i;for(var n in this.runners)this.runners[n].add(i);return this},e.prototype.render=function(t,s){var i,n,a,o;if(s&&(s instanceof kt?(Wr("6.0.0","Renderer#render arguments changed, use options instead."),i=s,n=arguments[2],a=arguments[3],o=arguments[4]):(i=s.renderTexture,n=s.clear,a=s.transform,o=s.skipUpdateTransform)),this.renderingToScreen=!i,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=a,!this.context.isLost){if(i||(this._lastObjectRendered=t),!o){var u=t.enableTempParent();t.updateTransform(),t.disableTempParent(u)}this.renderTexture.bind(i),this.batch.currentRenderer.start(),(n!==void 0?n:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),i&&i.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},e.prototype.generateTexture=function(t,s,i,n){s===void 0&&(s={});var a=r.prototype.generateTexture.call(this,t,s,i,n);return this.framebuffer.blit(),a},e.prototype.resize=function(t,s){r.prototype.resize.call(this,t,s),this.runners.resize.emit(this.screen.height,this.screen.width)},e.prototype.reset=function(){return this.runners.reset.emit(),this},e.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},e.prototype.destroy=function(t){this.runners.destroy.emit();for(var s in this.runners)this.runners[s].destroy();r.prototype.destroy.call(this,t),this.gl=null},Object.defineProperty(e.prototype,"extract",{get:function(){return Wr("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),e.registerPlugin=function(t,s){Wr("6.5.0","Renderer.registerPlugin() has been deprecated, please use extensions.add() instead."),Pi.add({name:t,type:Lt.RendererPlugin,ref:s})},e.__plugins={},e}(fK);Pi.handleByMap(Lt.RendererPlugin,_f.__plugins);function mK(r){return _f.create(r)}var pK=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,IK=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,TK=pK,RK=IK,df=function(){function r(){this.texArray=null,this.blend=0,this.type=Hr.TRIANGLES,this.start=0,this.size=0,this.data=null}return r}(),ff=function(){function r(){this.elements=[],this.ids=[],this.count=0}return r.prototype.clear=function(){for(var e=0;e<this.count;e++)this.elements[e]=null;this.count=0},r}(),vK=function(){function r(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(r.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),r.prototype.view=function(e){return this[e+"View"]},r.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},r.sizeOf=function(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(e+" isn't a valid view type")}},r}(),OK=function(r){at(e,r);function e(t){var s=r.call(this,t)||this;return s.shaderGenerator=null,s.geometryClass=null,s.vertexSize=null,s.state=Eh.for2d(),s.size=J.SPRITE_BATCH_SIZE*4,s._vertexCount=0,s._indexCount=0,s._bufferedElements=[],s._bufferedTextures=[],s._bufferSize=0,s._shader=null,s._packedGeometries=[],s._packedGeometryPoolSize=2,s._flushId=0,s._aBuffers={},s._iBuffers={},s.MAX_TEXTURES=1,s.renderer.on("prerender",s.onPrerender,s),t.runners.contextChange.add(s),s._dcIndex=0,s._aIndex=0,s._iIndex=0,s._attributeBuffer=null,s._indexBuffer=null,s._tempBoundTextures=[],s}return e.prototype.contextChange=function(){var t=this.renderer.gl;J.PREFER_ENV===Si.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),J.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=b8(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var s=0;s<this._packedGeometryPoolSize;s++)this._packedGeometries[s]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,s=e._textureArrayPool,i=this.size/4,n=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new df);for(;s.length<n;)s.push(new ff);for(var a=0;a<this.MAX_TEXTURES;a++)this._tempBoundTextures[a]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this,s=t._bufferedTextures,i=t.MAX_TEXTURES,n=e._textureArrayPool,a=this.renderer.batch,o=this._tempBoundTextures,u=this.renderer.textureGC.count,l=++Qe._globalBatch,d=0,c=n[0],_=0;a.copyBoundTextures(o,i);for(var f=0;f<this._bufferSize;++f){var g=s[f];s[f]=null,g._batchEnabled!==l&&(c.count>=i&&(a.boundArray(c,o,l,i),this.buildDrawCalls(c,_,f),_=f,c=n[++d],++l),g._batchEnabled=l,g.touched=u,c.elements[c.count++]=g)}c.count>0&&(a.boundArray(c,o,l,i),this.buildDrawCalls(c,_,this._bufferSize),++d,++l);for(var f=0;f<o.length;f++)o[f]=null;Qe._globalBatch=l},e.prototype.buildDrawCalls=function(t,s,i){var n=this,a=n._bufferedElements,o=n._attributeBuffer,u=n._indexBuffer,l=n.vertexSize,d=e._drawCallPool,c=this._dcIndex,_=this._aIndex,f=this._iIndex,g=d[c];g.start=this._iIndex,g.texArray=t;for(var I=s;I<i;++I){var p=a[I],R=p._texture.baseTexture,S=DT[R.alphaMode?1:0][p.blendMode];a[I]=null,s<I&&g.blend!==S&&(g.size=f-g.start,s=I,g=d[++c],g.texArray=t,g.start=f),this.packInterleavedGeometry(p,o,u,_,f),_+=p.vertexData.length/2*l,f+=p.indices.length,g.blend=S}s<i&&(g.size=f-g.start,++c),this._dcIndex=c,this._aIndex=_,this._iIndex=f},e.prototype.bindAndClearTexArray=function(t){for(var s=this.renderer.texture,i=0;i<t.count;i++)s.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this,s=t._packedGeometries,i=t._attributeBuffer,n=t._indexBuffer;J.CAN_UPLOAD_SAME_BUFFER?(s[this._flushId]._buffer.update(i.rawBinaryData),s[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,s[this._flushId]=new this.geometryClass),s[this._flushId]._buffer.update(i.rawBinaryData),s[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(s[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,s=this.renderer,i=s.gl,n=s.state,a=e._drawCallPool,o=null,u=0;u<t;u++){var l=a[u],d=l.texArray,c=l.type,_=l.size,f=l.start,g=l.blend;o!==d&&(o=d,this.bindAndClearTexArray(d)),this.state.blendMode=g,n.set(this.state),i.drawElements(c,_,i.UNSIGNED_SHORT,f*2)}},e.prototype.flush=function(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),J.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),r.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var s=bl(Math.ceil(t/8)),i=wT(s),n=s*8;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var a=this._aBuffers[n];return a||(this._aBuffers[n]=a=new vK(n*this.vertexSize*4)),a},e.prototype.getIndexBuffer=function(t){var s=bl(Math.ceil(t/12)),i=wT(s),n=s*12;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);var a=this._iBuffers[i];return a||(this._iBuffers[i]=a=new Uint16Array(n)),a},e.prototype.packInterleavedGeometry=function(t,s,i,n,a){for(var o=s.uint32View,u=s.float32View,l=n/this.vertexSize,d=t.uvs,c=t.indices,_=t.vertexData,f=t._texture.baseTexture._batchLocation,g=Math.min(t.worldAlpha,1),I=g<1&&t._texture.baseTexture.alphaMode?LT(t._tintRGB,g):t._tintRGB+(g*255<<24),p=0;p<_.length;p+=2)u[n++]=_[p],u[n++]=_[p+1],u[n++]=d[p],u[n++]=d[p+1],o[n++]=I,u[n++]=f;for(var p=0;p<c.length;p++)i[a++]=l+c[p]},e._drawCallPool=[],e._textureArrayPool=[],e}(Bl),SK=function(){function r(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},t.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(t.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return r.prototype.generateShader=function(e){if(!this.programCache[e]){for(var t=new Int32Array(e),s=0;s<e;s++)t[s]=s;this.defaultGroupCache[e]=ea.from({uSamplers:t},!0);var i=this.fragTemplate;i=i.replace(/%count%/gi,""+e),i=i.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new jl(this.vertexSrc,i)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new Ye,default:this.defaultGroupCache[e]};return new ta(this.programCache[e],n)},r.prototype.generateSampleSrc=function(e){var t="";t+=`
`,t+=`
`;for(var s=0;s<e;s++)s>0&&(t+=`
else `),s<e-1&&(t+="if(vTextureId < "+s+".5)"),t+=`
{`,t+=`
	color = texture2D(uSamplers[`+s+"], vTextureCoord);",t+=`
}`;return t+=`
`,t+=`
`,t},r}(),dR=function(r){at(e,r);function e(t){t===void 0&&(t=!1);var s=r.call(this)||this;return s._buffer=new vs(null,t,!1),s._indexBuffer=new vs(null,t,!0),s.addAttribute("aVertexPosition",s._buffer,2,!1,He.FLOAT).addAttribute("aTextureCoord",s._buffer,2,!1,He.FLOAT).addAttribute("aColor",s._buffer,4,!0,He.UNSIGNED_BYTE).addAttribute("aTextureId",s._buffer,1,!0,He.FLOAT).addIndex(s._indexBuffer),s}return e}(xl),fR=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`,gR=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,AK=function(){function r(){}return r.create=function(e){var t=Object.assign({vertex:fR,fragment:gR,geometryClass:dR,vertexSize:6},e),s=t.vertex,i=t.fragment,n=t.vertexSize,a=t.geometryClass;return function(o){at(u,o);function u(l){var d=o.call(this,l)||this;return d.shaderGenerator=new SK(s,i),d.geometryClass=a,d.vertexSize=n,d}return u}(OK)},Object.defineProperty(r,"defaultVertexSrc",{get:function(){return fR},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultFragmentTemplate",{get:function(){return gR},enumerable:!1,configurable:!0}),r}(),ER=AK.create();Object.assign(ER,{extension:{name:"batch",type:Lt.RendererPlugin}});/*!
 * @pixi/loaders - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/loaders is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Wl=function(){function r(e,t,s){t===void 0&&(t=!1),this._fn=e,this._once=t,this._thisArg=s,this._next=this._prev=this._owner=null}return r.prototype.detach=function(){return this._owner===null?!1:(this._owner.detach(this),!0)},r}();function mR(r,e){return r._head?(r._tail._next=e,e._prev=r._tail,r._tail=e):(r._head=e,r._tail=e),e._owner=r,e}var Ni=function(){function r(){this._head=this._tail=void 0}return r.prototype.handlers=function(e){e===void 0&&(e=!1);var t=this._head;if(e)return!!t;for(var s=[];t;)s.push(t),t=t._next;return s},r.prototype.has=function(e){if(!(e instanceof Wl))throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");return e._owner===this},r.prototype.dispatch=function(){for(var e=arguments,t=[],s=0;s<arguments.length;s++)t[s]=e[s];var i=this._head;if(!i)return!1;for(;i;)i._once&&this.detach(i),i._fn.apply(i._thisArg,t),i=i._next;return!0},r.prototype.add=function(e,t){if(t===void 0&&(t=null),typeof e!="function")throw new Error("MiniSignal#add(): First arg must be a Function.");return mR(this,new Wl(e,!1,t))},r.prototype.once=function(e,t){if(t===void 0&&(t=null),typeof e!="function")throw new Error("MiniSignal#once(): First arg must be a Function.");return mR(this,new Wl(e,!0,t))},r.prototype.detach=function(e){if(!(e instanceof Wl))throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");return e._owner!==this?this:(e._prev&&(e._prev._next=e._next),e._next&&(e._next._prev=e._prev),e===this._head?(this._head=e._next,e._next===null&&(this._tail=null)):e===this._tail&&(this._tail=e._prev,this._tail._next=null),e._owner=null,this)},r.prototype.detachAll=function(){var e=this._head;if(!e)return this;for(this._head=this._tail=null;e;)e._owner=null,e=e._next;return this},r}();function pR(r,e){e=e||{};for(var t={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},s=t.parser[e.strictMode?"strict":"loose"].exec(r),i={},n=14;n--;)i[t.key[n]]=s[n]||"";return i[t.q.name]={},i[t.key[12]].replace(t.q.parser,function(a,o,u){o&&(i[t.q.name][o]=u)}),i}var gf,zl=null,yK=0,IR=200,CK=204,MK=1223,PK=2;function TR(){}function RR(r,e,t){e&&e.indexOf(".")===0&&(e=e.substring(1)),e&&(r[e]=t)}function Ef(r){return r.toString().replace("object ","")}var Ls=function(){function r(e,t,s){if(this._dequeue=TR,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=null,this._boundOnError=null,this._boundOnProgress=null,this._boundOnTimeout=null,this._boundXhrOnError=null,this._boundXhrOnTimeout=null,this._boundXhrOnAbort=null,this._boundXhrOnLoad=null,typeof e!="string"||typeof t!="string")throw new Error("Both name and url are required for constructing a resource.");s=s||{},this._flags=0,this._setFlag(r.STATUS_FLAGS.DATA_URL,t.indexOf("data:")===0),this.name=e,this.url=t,this.extension=this._getExtension(),this.data=null,this.crossOrigin=s.crossOrigin===!0?"anonymous":s.crossOrigin,this.timeout=s.timeout||0,this.loadType=s.loadType||this._determineLoadType(),this.xhrType=s.xhrType,this.metadata=s.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=r.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=TR,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new Ni,this.onProgress=new Ni,this.onComplete=new Ni,this.onAfterMiddleware=new Ni}return r.setExtensionLoadType=function(e,t){RR(r._loadTypeMap,e,t)},r.setExtensionXhrType=function(e,t){RR(r._xhrTypeMap,e,t)},Object.defineProperty(r.prototype,"isDataUrl",{get:function(){return this._hasFlag(r.STATUS_FLAGS.DATA_URL)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isComplete",{get:function(){return this._hasFlag(r.STATUS_FLAGS.COMPLETE)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isLoading",{get:function(){return this._hasFlag(r.STATUS_FLAGS.LOADING)},enumerable:!1,configurable:!0}),r.prototype.complete=function(){this._clearEvents(),this._finish()},r.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=r.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},r.prototype.load=function(e){var t=this;if(!this.isLoading){if(this.isComplete){e&&setTimeout(function(){return e(t)},1);return}else e&&this.onComplete.once(e);switch(this._setFlag(r.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),(this.crossOrigin===!1||typeof this.crossOrigin!="string")&&(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case r.LOAD_TYPE.IMAGE:this.type=r.TYPE.IMAGE,this._loadElement("image");break;case r.LOAD_TYPE.AUDIO:this.type=r.TYPE.AUDIO,this._loadSourceElement("audio");break;case r.LOAD_TYPE.VIDEO:this.type=r.TYPE.VIDEO,this._loadSourceElement("video");break;case r.LOAD_TYPE.XHR:default:typeof gf>"u"&&(gf=!!(globalThis.XDomainRequest&&!("withCredentials"in new XMLHttpRequest))),gf&&this.crossOrigin?this._loadXdr():this._loadXhr();break}}},r.prototype._hasFlag=function(e){return(this._flags&e)!==0},r.prototype._setFlag=function(e,t){this._flags=t?this._flags|e:this._flags&~e},r.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},r.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(r.STATUS_FLAGS.COMPLETE,!0),this._setFlag(r.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},r.prototype._loadElement=function(e){this.metadata.loadElement?this.data=this.metadata.loadElement:e==="image"&&typeof globalThis.Image<"u"?this.data=new Image:this.data=document.createElement(e),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},r.prototype._loadSourceElement=function(e){if(this.metadata.loadElement?this.data=this.metadata.loadElement:e==="audio"&&typeof globalThis.Audio<"u"?this.data=new Audio:this.data=document.createElement(e),this.data===null){this.abort("Unsupported element: "+e);return}if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var t=this.metadata.mimeType,s=0;s<this.url.length;++s)this.data.appendChild(this._createSource(e,this.url[s],Array.isArray(t)?t[s]:t));else{var t=this.metadata.mimeType;this.data.appendChild(this._createSource(e,this.url,Array.isArray(t)?t[0]:t))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},r.prototype._loadXhr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;this.crossOrigin==="use-credentials"&&(e.withCredentials=!0),e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===r.XHR_RESPONSE_TYPE.JSON||this.xhrType===r.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=r.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},r.prototype._loadXdr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var e=this.xhr=new globalThis.XDomainRequest;e.timeout=this.timeout||5e3,e.onerror=this._boundXhrOnError,e.ontimeout=this._boundXhrOnTimeout,e.onprogress=this._boundOnProgress,e.onload=this._boundXhrOnLoad,e.open("GET",this.url,!0),setTimeout(function(){return e.send()},1)},r.prototype._createSource=function(e,t,s){s||(s=e+"/"+this._getExtension(t));var i=document.createElement("source");return i.src=t,i.type=s,i},r.prototype._onError=function(e){this.abort("Failed to load element using: "+e.target.nodeName)},r.prototype._onProgress=function(e){e&&e.lengthComputable&&this.onProgress.dispatch(this,e.loaded/e.total)},r.prototype._onTimeout=function(){this.abort("Load timed out.")},r.prototype._xhrOnError=function(){var e=this.xhr;this.abort(Ef(e)+" Request failed. Status: "+e.status+', text: "'+e.statusText+'"')},r.prototype._xhrOnTimeout=function(){var e=this.xhr;this.abort(Ef(e)+" Request timed out.")},r.prototype._xhrOnAbort=function(){var e=this.xhr;this.abort(Ef(e)+" Request was aborted by the user.")},r.prototype._xhrOnLoad=function(){var e=this.xhr,t="",s=typeof e.status>"u"?IR:e.status;(e.responseType===""||e.responseType==="text"||typeof e.responseType>"u")&&(t=e.responseText),s===yK&&(t.length>0||e.responseType===r.XHR_RESPONSE_TYPE.BUFFER)?s=IR:s===MK&&(s=CK);var i=s/100|0;if(i===PK)if(this.xhrType===r.XHR_RESPONSE_TYPE.TEXT)this.data=t,this.type=r.TYPE.TEXT;else if(this.xhrType===r.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(t),this.type=r.TYPE.JSON}catch(o){this.abort("Error trying to parse loaded json: "+o);return}else if(this.xhrType===r.XHR_RESPONSE_TYPE.DOCUMENT)try{if(globalThis.DOMParser){var n=new DOMParser;this.data=n.parseFromString(t,"text/xml")}else{var a=document.createElement("div");a.innerHTML=t,this.data=a}this.type=r.TYPE.XML}catch(o){this.abort("Error trying to parse loaded xml: "+o);return}else this.data=e.response||t;else{this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL);return}this.complete()},r.prototype._determineCrossOrigin=function(e,t){if(e.indexOf("data:")===0)return"";if(globalThis.origin!==globalThis.location.origin)return"anonymous";t=t||globalThis.location,zl||(zl=document.createElement("a")),zl.href=e;var s=pR(zl.href,{strictMode:!0}),i=!s.port&&t.port===""||s.port===t.port,n=s.protocol?s.protocol+":":"";return s.host!==t.hostname||!i||n!==t.protocol?"anonymous":""},r.prototype._determineXhrType=function(){return r._xhrTypeMap[this.extension]||r.XHR_RESPONSE_TYPE.TEXT},r.prototype._determineLoadType=function(){return r._loadTypeMap[this.extension]||r.LOAD_TYPE.XHR},r.prototype._getExtension=function(e){e===void 0&&(e=this.url);var t="";if(this.isDataUrl){var s=e.indexOf("/");t=e.substring(s+1,e.indexOf(";",s))}else{var i=e.indexOf("?"),n=e.indexOf("#"),a=Math.min(i>-1?i:e.length,n>-1?n:e.length);e=e.substring(0,a),t=e.substring(e.lastIndexOf(".")+1)}return t.toLowerCase()},r.prototype._getMimeFromXhrType=function(e){switch(e){case r.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case r.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case r.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case r.XHR_RESPONSE_TYPE.JSON:return"application/json";case r.XHR_RESPONSE_TYPE.DEFAULT:case r.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},r}();(function(r){(function(e){e[e.NONE=0]="NONE",e[e.DATA_URL=1]="DATA_URL",e[e.COMPLETE=2]="COMPLETE",e[e.LOADING=4]="LOADING"})(r.STATUS_FLAGS||(r.STATUS_FLAGS={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.JSON=1]="JSON",e[e.XML=2]="XML",e[e.IMAGE=3]="IMAGE",e[e.AUDIO=4]="AUDIO",e[e.VIDEO=5]="VIDEO",e[e.TEXT=6]="TEXT"}(r.TYPE||(r.TYPE={})),function(e){e[e.XHR=1]="XHR",e[e.IMAGE=2]="IMAGE",e[e.AUDIO=3]="AUDIO",e[e.VIDEO=4]="VIDEO"}(r.LOAD_TYPE||(r.LOAD_TYPE={})),function(e){e.DEFAULT="text",e.BUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.TEXT="text"}(r.XHR_RESPONSE_TYPE||(r.XHR_RESPONSE_TYPE={})),r._loadTypeMap={gif:r.LOAD_TYPE.IMAGE,png:r.LOAD_TYPE.IMAGE,bmp:r.LOAD_TYPE.IMAGE,jpg:r.LOAD_TYPE.IMAGE,jpeg:r.LOAD_TYPE.IMAGE,tif:r.LOAD_TYPE.IMAGE,tiff:r.LOAD_TYPE.IMAGE,webp:r.LOAD_TYPE.IMAGE,tga:r.LOAD_TYPE.IMAGE,avif:r.LOAD_TYPE.IMAGE,svg:r.LOAD_TYPE.IMAGE,"svg+xml":r.LOAD_TYPE.IMAGE,mp3:r.LOAD_TYPE.AUDIO,ogg:r.LOAD_TYPE.AUDIO,wav:r.LOAD_TYPE.AUDIO,mp4:r.LOAD_TYPE.VIDEO,webm:r.LOAD_TYPE.VIDEO},r._xhrTypeMap={xhtml:r.XHR_RESPONSE_TYPE.DOCUMENT,html:r.XHR_RESPONSE_TYPE.DOCUMENT,htm:r.XHR_RESPONSE_TYPE.DOCUMENT,xml:r.XHR_RESPONSE_TYPE.DOCUMENT,tmx:r.XHR_RESPONSE_TYPE.DOCUMENT,svg:r.XHR_RESPONSE_TYPE.DOCUMENT,tsx:r.XHR_RESPONSE_TYPE.DOCUMENT,gif:r.XHR_RESPONSE_TYPE.BLOB,png:r.XHR_RESPONSE_TYPE.BLOB,bmp:r.XHR_RESPONSE_TYPE.BLOB,jpg:r.XHR_RESPONSE_TYPE.BLOB,jpeg:r.XHR_RESPONSE_TYPE.BLOB,tif:r.XHR_RESPONSE_TYPE.BLOB,tiff:r.XHR_RESPONSE_TYPE.BLOB,webp:r.XHR_RESPONSE_TYPE.BLOB,tga:r.XHR_RESPONSE_TYPE.BLOB,avif:r.XHR_RESPONSE_TYPE.BLOB,json:r.XHR_RESPONSE_TYPE.JSON,text:r.XHR_RESPONSE_TYPE.TEXT,txt:r.XHR_RESPONSE_TYPE.TEXT,ttf:r.XHR_RESPONSE_TYPE.BUFFER,otf:r.XHR_RESPONSE_TYPE.BUFFER},r.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="})(Ls||(Ls={}));function ra(){}function NK(r){return function(){for(var t=arguments,s=[],i=0;i<arguments.length;i++)s[i]=t[i];if(r===null)throw new Error("Callback was already called.");var n=r;r=null,n.apply(this,s)}}var bK=function(){function r(e,t){this.data=e,this.callback=t}return r}(),mf=function(){function r(e,t){var s=this;if(t===void 0&&(t=1),this.workers=0,this.saturated=ra,this.unsaturated=ra,this.empty=ra,this.drain=ra,this.error=ra,this.started=!1,this.paused=!1,this._tasks=[],this._insert=function(i,n,a){if(a&&typeof a!="function")throw new Error("task callback must be a function");if(s.started=!0,i==null&&s.idle()){setTimeout(function(){return s.drain()},1);return}var o=new bK(i,typeof a=="function"?a:ra);n?s._tasks.unshift(o):s._tasks.push(o),setTimeout(s.process,1)},this.process=function(){for(;!s.paused&&s.workers<s.concurrency&&s._tasks.length;){var i=s._tasks.shift();s._tasks.length===0&&s.empty(),s.workers+=1,s.workers===s.concurrency&&s.saturated(),s._worker(i.data,NK(s._next(i)))}},this._worker=e,t===0)throw new Error("Concurrency must not be zero");this.concurrency=t,this.buffer=t/4}return r.prototype._next=function(e){var t=this;return function(){for(var s=arguments,i=[],n=0;n<arguments.length;n++)i[n]=s[n];t.workers-=1,e.callback.apply(e,i),i[0]!=null&&t.error(i[0],e.data),t.workers<=t.concurrency-t.buffer&&t.unsaturated(),t.idle()&&t.drain(),t.process()}},r.prototype.push=function(e,t){this._insert(e,!1,t)},r.prototype.kill=function(){this.workers=0,this.drain=ra,this.started=!1,this._tasks=[]},r.prototype.unshift=function(e,t){this._insert(e,!0,t)},r.prototype.length=function(){return this._tasks.length},r.prototype.running=function(){return this.workers},r.prototype.idle=function(){return this._tasks.length+this.workers===0},r.prototype.pause=function(){this.paused!==!0&&(this.paused=!0)},r.prototype.resume=function(){if(this.paused!==!1){this.paused=!1;for(var e=1;e<=this.concurrency;e++)this.process()}},r.eachSeries=function(e,t,s,i){var n=0,a=e.length;function o(u){if(u||n===a){s&&s(u);return}i?setTimeout(function(){t(e[n++],o)},1):t(e[n++],o)}o()},r.queue=function(e,t){return new r(e,t)},r}(),pf=100,DK=/(#[\w-]+)?$/,Xl=function(){function r(e,t){var s=this;e===void 0&&(e=""),t===void 0&&(t=10),this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(u,l){return s._loadResource(u,l)},this.resources={},this.baseUrl=e,this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(u,l){return s._loadResource(u,l)},this._queue=mf.queue(this._boundLoadResource,t),this._queue.pause(),this.resources={},this.onProgress=new Ni,this.onError=new Ni,this.onLoad=new Ni,this.onStart=new Ni,this.onComplete=new Ni;for(var i=0;i<r._plugins.length;++i){var n=r._plugins[i],a=n.pre,o=n.use;a&&this.pre(a),o&&this.use(o)}this._protected=!1}return r.prototype._add=function(e,t,s,i){if(this.loading&&(!s||!s.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[e])throw new Error('Resource named "'+e+'" already exists.');if(t=this._prepareUrl(t),this.resources[e]=new Ls(e,t,s),typeof i=="function"&&this.resources[e].onAfterMiddleware.once(i),this.loading){for(var n=s.parentResource,a=[],o=0;o<n.children.length;++o)n.children[o].isComplete||a.push(n.children[o]);var u=n.progressChunk*(a.length+1),l=u/(a.length+2);n.children.push(this.resources[e]),n.progressChunk=l;for(var o=0;o<a.length;++o)a[o].progressChunk=l;this.resources[e].progressChunk=l}return this._queue.push(this.resources[e]),this},r.prototype.pre=function(e){return this._beforeMiddleware.push(e),this},r.prototype.use=function(e){return this._afterMiddleware.push(e),this},r.prototype.reset=function(){this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause();for(var e in this.resources){var t=this.resources[e];t._onLoadBinding&&t._onLoadBinding.detach(),t.isLoading&&t.abort("loader reset")}return this.resources={},this},r.prototype.load=function(e){if(Wr("6.5.0","@pixi/loaders is being replaced with @pixi/assets in the next major release."),typeof e=="function"&&this.onComplete.once(e),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var t=this._queue._tasks.length,s=pf/t,i=0;i<this._queue._tasks.length;++i)this._queue._tasks[i].data.progressChunk=s;this._onStart(),this._queue.resume()}return this},Object.defineProperty(r.prototype,"concurrency",{get:function(){return this._queue.concurrency},set:function(e){this._queue.concurrency=e},enumerable:!1,configurable:!0}),r.prototype._prepareUrl=function(e){var t=pR(e,{strictMode:!0}),s;if(t.protocol||!t.path||e.indexOf("//")===0?s=e:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&e.charAt(0)!=="/"?s=this.baseUrl+"/"+e:s=this.baseUrl+e,this.defaultQueryString){var i=DK.exec(s)[0];s=s.slice(0,s.length-i.length),s.indexOf("?")!==-1?s+="&"+this.defaultQueryString:s+="?"+this.defaultQueryString,s+=i}return s},r.prototype._loadResource=function(e,t){var s=this;e._dequeue=t,mf.eachSeries(this._beforeMiddleware,function(i,n){i.call(s,e,function(){n(e.isComplete?{}:null)})},function(){e.isComplete?s._onLoad(e):(e._onLoadBinding=e.onComplete.once(s._onLoad,s),e.load())},!0)},r.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},r.prototype._onComplete=function(){this.progress=pf,this.loading=!1,this.onComplete.dispatch(this,this.resources)},r.prototype._onLoad=function(e){var t=this;e._onLoadBinding=null,this._resourcesParsing.push(e),e._dequeue(),mf.eachSeries(this._afterMiddleware,function(s,i){s.call(t,e,i)},function(){e.onAfterMiddleware.dispatch(e),t.progress=Math.min(pf,t.progress+e.progressChunk),t.onProgress.dispatch(t,e),e.error?t.onError.dispatch(e.error,t,e):t.onLoad.dispatch(t,e),t._resourcesParsing.splice(t._resourcesParsing.indexOf(e),1),t._queue.idle()&&t._resourcesParsing.length===0&&t._onComplete()},!0)},r.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(r,"shared",{get:function(){var e=r._shared;return e||(e=new r,e._protected=!0,r._shared=e),e},enumerable:!1,configurable:!0}),r.registerPlugin=function(e){return Wr("6.5.0","Loader.registerPlugin() is deprecated, use extensions.add() instead."),Pi.add({type:Lt.Loader,ref:e}),r},r._plugins=[],r}();Pi.handleByList(Lt.Loader,Xl._plugins),Xl.prototype.add=function(e,t,s,i){if(Array.isArray(e)){for(var n=0;n<e.length;++n)this.add(e[n]);return this}if(typeof e=="object"&&(s=e,i=t||s.callback||s.onComplete,t=s.url,e=s.name||s.key||s.url),typeof t!="string"&&(i=s,s=t,t=e),typeof t!="string")throw new Error("No url passed to add resource to loader.");return typeof s=="function"&&(i=s,s=null),this._add(e,t,s,i)};var LK=function(){function r(){}return r.init=function(e){e=Object.assign({sharedLoader:!1},e),this.loader=e.sharedLoader?Xl.shared:new Xl},r.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},r.extension=Lt.Application,r}(),UK=function(){function r(){}return r.add=function(){Ls.setExtensionLoadType("svg",Ls.LOAD_TYPE.XHR),Ls.setExtensionXhrType("svg",Ls.XHR_RESPONSE_TYPE.TEXT)},r.use=function(e,t){if(e.data&&(e.type===Ls.TYPE.IMAGE||e.extension==="svg")){var s=e.data,i=e.url,n=e.name,a=e.metadata;Re.fromLoader(s,i,n,a).then(function(o){e.texture=o,t()}).catch(t)}else t()},r.extension=Lt.Loader,r}(),FK="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function wK(r){for(var e="",t=0;t<r.length;){for(var s=[0,0,0],i=[0,0,0,0],n=0;n<s.length;++n)t<r.length?s[n]=r.charCodeAt(t++)&255:s[n]=0;i[0]=s[0]>>2,i[1]=(s[0]&3)<<4|s[1]>>4,i[2]=(s[1]&15)<<2|s[2]>>6,i[3]=s[2]&63;var a=t-(r.length-1);switch(a){case 2:i[3]=64,i[2]=64;break;case 1:i[3]=64;break}for(var n=0;n<i.length;++n)e+=FK.charAt(i[n])}return e}function xK(r,e){if(!r.data){e();return}if(r.xhr&&r.xhrType===Ls.XHR_RESPONSE_TYPE.BLOB){if(!self.Blob||typeof r.data=="string"){var t=r.xhr.getResponseHeader("content-type");if(t&&t.indexOf("image")===0){r.data=new Image,r.data.src="data:"+t+";base64,"+wK(r.xhr.responseText),r.type=Ls.TYPE.IMAGE,r.data.onload=function(){r.data.onload=null,e()};return}}else if(r.data.type.indexOf("image")===0){var s=globalThis.URL||globalThis.webkitURL,i=s.createObjectURL(r.data);r.blob=r.data,r.data=new Image,r.data.src=i,r.type=Ls.TYPE.IMAGE,r.data.onload=function(){s.revokeObjectURL(i),r.data.onload=null,e()};return}}e()}var GK=function(){function r(){}return r.extension=Lt.Loader,r.use=xK,r}();Pi.add(UK,GK);/*!
 * @pixi/spritesheet - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/spritesheet is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Kl=function(){function r(e,t,s){s===void 0&&(s=null),this.linkedSheets=[],this._texture=e instanceof Re?e:null,this.baseTexture=e instanceof Qe?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;var i=this.baseTexture.resource;this.resolution=this._updateResolution(s||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return r.prototype._updateResolution=function(e){e===void 0&&(e=null);var t=this.data.meta.scale,s=zd(e,null);return s===null&&(s=t!==void 0?parseFloat(t):1),s!==1&&this.baseTexture.setResolution(s),s},r.prototype.parse=function(e){var t=this;return e&&Wr("6.5.0","Spritesheet.parse callback is deprecated, use the return Promise instead."),new Promise(function(s){t._callback=function(i){e==null||e(i),s(i)},t._batchIndex=0,t._frameKeys.length<=r.BATCH_SIZE?(t._processFrames(0),t._processAnimations(),t._parseComplete()):t._nextBatch()})},r.prototype._processFrames=function(e){for(var t=e,s=r.BATCH_SIZE;t-e<s&&t<this._frameKeys.length;){var i=this._frameKeys[t],n=this._frames[i],a=n.frame;if(a){var o=null,u=null,l=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,d=new he(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);n.rotated?o=new he(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):o=new he(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(u=new he(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[i]=new Re(this.baseTexture,o,d,u,n.rotated?2:0,n.anchor),Re.addToCache(this.textures[i],i)}t++}},r.prototype._processAnimations=function(){var e=this.data.animations||{};for(var t in e){this.animations[t]=[];for(var s=0;s<e[t].length;s++){var i=e[t][s];this.animations[t].push(this.textures[i])}}},r.prototype._parseComplete=function(){var e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)},r.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*r.BATCH_SIZE),this._batchIndex++,setTimeout(function(){e._batchIndex*r.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete())},0)},r.prototype.destroy=function(e){var t;e===void 0&&(e=!1);for(var s in this.textures)this.textures[s].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((t=this._texture)===null||t===void 0||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]},r.BATCH_SIZE=1e3,r}(),BK=function(){function r(){}return r.use=function(e,t){var s,i,n=this,a=e.name+"_image";if(!e.data||e.type!==Ls.TYPE.JSON||!e.data.frames||n.resources[a]){t();return}var o=(i=(s=e.data)===null||s===void 0?void 0:s.meta)===null||i===void 0?void 0:i.related_multi_packs;if(Array.isArray(o))for(var u=function(g){if(typeof g!="string")return"continue";var I=g.replace(".json",""),p=uh.resolve(e.url.replace(n.baseUrl,""),g);if(n.resources[I]||Object.values(n.resources).some(function(S){return uh.format(uh.parse(S.url))===p}))return"continue";var R={crossOrigin:e.crossOrigin,loadType:Ls.LOAD_TYPE.XHR,xhrType:Ls.XHR_RESPONSE_TYPE.JSON,parentResource:e,metadata:e.metadata};n.add(I,p,R)},l=0,d=o;l<d.length;l++){var c=d[l];u(c)}var _={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},f=r.getResourcePath(e,n.baseUrl);n.add(a,f,_,function(I){if(I.error){t(I.error);return}var p=new Kl(I.texture,e.data,e.url);p.parse().then(function(){e.spritesheet=p,e.textures=p.textures,t()})})},r.getResourcePath=function(e,t){return e.isDataUrl?e.data.meta.image:uh.resolve(e.url.replace(t,""),e.data.meta.image)},r.extension=Lt.Loader,r}();class Y{static log(...e){this.LOG_DEBUG&&console.log(this.logPrefix(),...e)}static warn(...e){this.LOG_WARN&&console.warn(this.logPrefix(),...e)}static error(...e){this.LOG_ERROR&&console.error(this.logPrefix(),...e)}static events(...e){this.LOG_EVENTS&&console.log(this.logPrefix(),...e)}static packets(...e){this.LOG_PACKETS&&console.log(this.logPrefix(),...e)}static logPrefix(){return"[Nitro]"}}Y.LOG_DEBUG=!1,Y.LOG_WARN=!1,Y.LOG_ERROR=!1,Y.LOG_EVENTS=!1,Y.LOG_PACKETS=!1;class Ot{constructor(e=null){if(this._length=0,this._dictionary=new Map,this._array=[],this._keys=[],e)for(const[t,s]of e.entries())this.add(t,s)}get length(){return this._length}get disposed(){return!this._dictionary}dispose(){if(!this._dictionary){for(const e of this._dictionary.keys())this._dictionary.delete(e);this._dictionary=null}this._length=0,this._array=null,this._keys=null}reset(){for(const e of this._dictionary.keys())this._dictionary.delete(e);this._length=0,this._array=[],this._keys=[]}unshift(e,t){return this._dictionary.get(e)!==null?!1:(this._dictionary.set(e,t),this._array.unshift(t),this._keys.unshift(e),this._length++,!0)}add(e,t){return this._dictionary.get(e)!==void 0?!1:(this._dictionary.set(e,t),this._array[this._length]=t,this._keys[this._length]=e,this._length++,!0)}remove(e){const t=this._dictionary.get(e);if(!t)return null;const s=this._array.indexOf(t);return s>=0&&(this._array.splice(s,1),this._keys.splice(s,1),this._length--),this._dictionary.delete(e),t}getWithIndex(e){return e<0||e>=this._length?null:this._array[e]}getKey(e){return e<0||e>=this._length?null:this._keys[e]}getKeys(){return this._keys.slice()}hasKey(e){return this._keys.indexOf(e)>-1}getValue(e){return this._dictionary.get(e)}getValues(){return this._array.slice()}hasValue(e){return this._array.indexOf(e)>-1}indexOf(e){return this._array.indexOf(e)}concatenate(e){for(const t of e._keys)this.add(t,e.getValue(t))}clone(){const e=new Ot;return e.concatenate(this),e}}const If=r=>{let e="";const t=new Uint8Array(r),s=t.byteLength;for(let i=0;i<s;i++)e+=String.fromCharCode(t[i]);return window.btoa(e)};class ph{constructor(e){this._position=0,this._dataView=new DataView(e)}readBytes(e){const t=new ph(this._dataView.buffer.slice(this._position,this._position+e));return this._position+=e,t}readByte(){const e=this._dataView.getInt8(this._position);return this._position++,e}readShort(){const e=this._dataView.getInt16(this._position);return this._position+=2,e}readInt(){const e=this._dataView.getInt32(this._position);return this._position+=4,e}readFloat(){const e=this._dataView.getFloat32(this._position);return this._position+=4,e}readDouble(){const e=this._dataView.getFloat64(this._position);return this._position+=8,e}remaining(){return this._dataView.byteLength-this._position}toString(e){return new TextDecoder().decode(this._dataView.buffer)}toArrayBuffer(){return this._dataView.buffer}}class Tf{constructor(){this._buffer=new Uint8Array,this._position=0}writeByte(e){const t=new Uint8Array(1);return t[0]=e,this.appendArray(t),this}writeBytes(e){const t=new Uint8Array(e);return this.appendArray(t),this}writeShort(e){const t=new Uint8Array(2);return t[0]=e>>8,t[1]=e&255,this.appendArray(t),this}writeInt(e){const t=new Uint8Array(4);return t[0]=e>>24,t[1]=e>>16,t[2]=e>>8,t[3]=e&255,this.appendArray(t),this}writeString(e,t=!0){const s=new TextEncoder().encode(e);return t?(this.writeShort(s.length),this.appendArray(s)):this.appendArray(s),this}appendArray(e){if(!e)return;const t=new Uint8Array(this.position+e.length>this._buffer.length?this.position+e.length:this._buffer.length);t.set(this._buffer),t.set(e,this.position),this._buffer=t,this.position+=e.length}getBuffer(){return this._buffer.buffer}get position(){return this._position}set position(e){this._position=e}toString(e){return new TextDecoder(e).decode(this._buffer)}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const HK=4,vR=0,OR=1,kK=2;function ro(r){let e=r.length;for(;--e>=0;)r[e]=0}const VK=0,SR=1,jK=2,YK=3,WK=258,Rf=29,Ih=256,Th=Ih+1+Rf,io=30,vf=19,AR=2*Th+1,ia=15,Of=16,zK=7,Sf=256,yR=16,CR=17,MR=18,Af=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),ql=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),XK=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),PR=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),KK=512,bi=new Array((Th+2)*2);ro(bi);const Rh=new Array(io*2);ro(Rh);const vh=new Array(KK);ro(vh);const Oh=new Array(WK-YK+1);ro(Oh);const yf=new Array(Rf);ro(yf);const Ql=new Array(io);ro(Ql);function Cf(r,e,t,s,i){this.static_tree=r,this.extra_bits=e,this.extra_base=t,this.elems=s,this.max_length=i,this.has_stree=r&&r.length}let NR,bR,DR;function Mf(r,e){this.dyn_tree=r,this.max_code=0,this.stat_desc=e}const LR=r=>r<256?vh[r]:vh[256+(r>>>7)],Sh=(r,e)=>{r.pending_buf[r.pending++]=e&255,r.pending_buf[r.pending++]=e>>>8&255},Us=(r,e,t)=>{r.bi_valid>Of-t?(r.bi_buf|=e<<r.bi_valid&65535,Sh(r,r.bi_buf),r.bi_buf=e>>Of-r.bi_valid,r.bi_valid+=t-Of):(r.bi_buf|=e<<r.bi_valid&65535,r.bi_valid+=t)},Xr=(r,e,t)=>{Us(r,t[e*2],t[e*2+1])},UR=(r,e)=>{let t=0;do t|=r&1,r>>>=1,t<<=1;while(--e>0);return t>>>1},qK=r=>{r.bi_valid===16?(Sh(r,r.bi_buf),r.bi_buf=0,r.bi_valid=0):r.bi_valid>=8&&(r.pending_buf[r.pending++]=r.bi_buf&255,r.bi_buf>>=8,r.bi_valid-=8)},QK=(r,e)=>{const t=e.dyn_tree,s=e.max_code,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,a=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,u=e.stat_desc.max_length;let l,d,c,_,f,g,I=0;for(_=0;_<=ia;_++)r.bl_count[_]=0;for(t[r.heap[r.heap_max]*2+1]=0,l=r.heap_max+1;l<AR;l++)d=r.heap[l],_=t[t[d*2+1]*2+1]+1,_>u&&(_=u,I++),t[d*2+1]=_,!(d>s)&&(r.bl_count[_]++,f=0,d>=o&&(f=a[d-o]),g=t[d*2],r.opt_len+=g*(_+f),n&&(r.static_len+=g*(i[d*2+1]+f)));if(I!==0){do{for(_=u-1;r.bl_count[_]===0;)_--;r.bl_count[_]--,r.bl_count[_+1]+=2,r.bl_count[u]--,I-=2}while(I>0);for(_=u;_!==0;_--)for(d=r.bl_count[_];d!==0;)c=r.heap[--l],!(c>s)&&(t[c*2+1]!==_&&(r.opt_len+=(_-t[c*2+1])*t[c*2],t[c*2+1]=_),d--)}},FR=(r,e,t)=>{const s=new Array(ia+1);let i=0,n,a;for(n=1;n<=ia;n++)i=i+t[n-1]<<1,s[n]=i;for(a=0;a<=e;a++){let o=r[a*2+1];o!==0&&(r[a*2]=UR(s[o]++,o))}},ZK=()=>{let r,e,t,s,i;const n=new Array(ia+1);for(t=0,s=0;s<Rf-1;s++)for(yf[s]=t,r=0;r<1<<Af[s];r++)Oh[t++]=s;for(Oh[t-1]=s,i=0,s=0;s<16;s++)for(Ql[s]=i,r=0;r<1<<ql[s];r++)vh[i++]=s;for(i>>=7;s<io;s++)for(Ql[s]=i<<7,r=0;r<1<<ql[s]-7;r++)vh[256+i++]=s;for(e=0;e<=ia;e++)n[e]=0;for(r=0;r<=143;)bi[r*2+1]=8,r++,n[8]++;for(;r<=255;)bi[r*2+1]=9,r++,n[9]++;for(;r<=279;)bi[r*2+1]=7,r++,n[7]++;for(;r<=287;)bi[r*2+1]=8,r++,n[8]++;for(FR(bi,Th+1,n),r=0;r<io;r++)Rh[r*2+1]=5,Rh[r*2]=UR(r,5);NR=new Cf(bi,Af,Ih+1,Th,ia),bR=new Cf(Rh,ql,0,io,ia),DR=new Cf(new Array(0),XK,0,vf,zK)},wR=r=>{let e;for(e=0;e<Th;e++)r.dyn_ltree[e*2]=0;for(e=0;e<io;e++)r.dyn_dtree[e*2]=0;for(e=0;e<vf;e++)r.bl_tree[e*2]=0;r.dyn_ltree[Sf*2]=1,r.opt_len=r.static_len=0,r.sym_next=r.matches=0},xR=r=>{r.bi_valid>8?Sh(r,r.bi_buf):r.bi_valid>0&&(r.pending_buf[r.pending++]=r.bi_buf),r.bi_buf=0,r.bi_valid=0},GR=(r,e,t,s)=>{const i=e*2,n=t*2;return r[i]<r[n]||r[i]===r[n]&&s[e]<=s[t]},Pf=(r,e,t)=>{const s=r.heap[t];let i=t<<1;for(;i<=r.heap_len&&(i<r.heap_len&&GR(e,r.heap[i+1],r.heap[i],r.depth)&&i++,!GR(e,s,r.heap[i],r.depth));)r.heap[t]=r.heap[i],t=i,i<<=1;r.heap[t]=s},BR=(r,e,t)=>{let s,i,n=0,a,o;if(r.sym_next!==0)do s=r.pending_buf[r.sym_buf+n++]&255,s+=(r.pending_buf[r.sym_buf+n++]&255)<<8,i=r.pending_buf[r.sym_buf+n++],s===0?Xr(r,i,e):(a=Oh[i],Xr(r,a+Ih+1,e),o=Af[a],o!==0&&(i-=yf[a],Us(r,i,o)),s--,a=LR(s),Xr(r,a,t),o=ql[a],o!==0&&(s-=Ql[a],Us(r,s,o)));while(n<r.sym_next);Xr(r,Sf,e)},Nf=(r,e)=>{const t=e.dyn_tree,s=e.stat_desc.static_tree,i=e.stat_desc.has_stree,n=e.stat_desc.elems;let a,o,u=-1,l;for(r.heap_len=0,r.heap_max=AR,a=0;a<n;a++)t[a*2]!==0?(r.heap[++r.heap_len]=u=a,r.depth[a]=0):t[a*2+1]=0;for(;r.heap_len<2;)l=r.heap[++r.heap_len]=u<2?++u:0,t[l*2]=1,r.depth[l]=0,r.opt_len--,i&&(r.static_len-=s[l*2+1]);for(e.max_code=u,a=r.heap_len>>1;a>=1;a--)Pf(r,t,a);l=n;do a=r.heap[1],r.heap[1]=r.heap[r.heap_len--],Pf(r,t,1),o=r.heap[1],r.heap[--r.heap_max]=a,r.heap[--r.heap_max]=o,t[l*2]=t[a*2]+t[o*2],r.depth[l]=(r.depth[a]>=r.depth[o]?r.depth[a]:r.depth[o])+1,t[a*2+1]=t[o*2+1]=l,r.heap[1]=l++,Pf(r,t,1);while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],QK(r,e),FR(t,u,r.bl_count)},HR=(r,e,t)=>{let s,i=-1,n,a=e[0*2+1],o=0,u=7,l=4;for(a===0&&(u=138,l=3),e[(t+1)*2+1]=65535,s=0;s<=t;s++)n=a,a=e[(s+1)*2+1],!(++o<u&&n===a)&&(o<l?r.bl_tree[n*2]+=o:n!==0?(n!==i&&r.bl_tree[n*2]++,r.bl_tree[yR*2]++):o<=10?r.bl_tree[CR*2]++:r.bl_tree[MR*2]++,o=0,i=n,a===0?(u=138,l=3):n===a?(u=6,l=3):(u=7,l=4))},kR=(r,e,t)=>{let s,i=-1,n,a=e[0*2+1],o=0,u=7,l=4;for(a===0&&(u=138,l=3),s=0;s<=t;s++)if(n=a,a=e[(s+1)*2+1],!(++o<u&&n===a)){if(o<l)do Xr(r,n,r.bl_tree);while(--o!==0);else n!==0?(n!==i&&(Xr(r,n,r.bl_tree),o--),Xr(r,yR,r.bl_tree),Us(r,o-3,2)):o<=10?(Xr(r,CR,r.bl_tree),Us(r,o-3,3)):(Xr(r,MR,r.bl_tree),Us(r,o-11,7));o=0,i=n,a===0?(u=138,l=3):n===a?(u=6,l=3):(u=7,l=4)}},JK=r=>{let e;for(HR(r,r.dyn_ltree,r.l_desc.max_code),HR(r,r.dyn_dtree,r.d_desc.max_code),Nf(r,r.bl_desc),e=vf-1;e>=3&&r.bl_tree[PR[e]*2+1]===0;e--);return r.opt_len+=3*(e+1)+5+5+4,e},$K=(r,e,t,s)=>{let i;for(Us(r,e-257,5),Us(r,t-1,5),Us(r,s-4,4),i=0;i<s;i++)Us(r,r.bl_tree[PR[i]*2+1],3);kR(r,r.dyn_ltree,e-1),kR(r,r.dyn_dtree,t-1)},e7=r=>{let e=4093624447,t;for(t=0;t<=31;t++,e>>>=1)if(e&1&&r.dyn_ltree[t*2]!==0)return vR;if(r.dyn_ltree[9*2]!==0||r.dyn_ltree[10*2]!==0||r.dyn_ltree[13*2]!==0)return OR;for(t=32;t<Ih;t++)if(r.dyn_ltree[t*2]!==0)return OR;return vR};let VR=!1;const t7=r=>{VR||(ZK(),VR=!0),r.l_desc=new Mf(r.dyn_ltree,NR),r.d_desc=new Mf(r.dyn_dtree,bR),r.bl_desc=new Mf(r.bl_tree,DR),r.bi_buf=0,r.bi_valid=0,wR(r)},jR=(r,e,t,s)=>{Us(r,(VK<<1)+(s?1:0),3),xR(r),Sh(r,t),Sh(r,~t),t&&r.pending_buf.set(r.window.subarray(e,e+t),r.pending),r.pending+=t},s7=r=>{Us(r,SR<<1,3),Xr(r,Sf,bi),qK(r)},r7=(r,e,t,s)=>{let i,n,a=0;r.level>0?(r.strm.data_type===kK&&(r.strm.data_type=e7(r)),Nf(r,r.l_desc),Nf(r,r.d_desc),a=JK(r),i=r.opt_len+3+7>>>3,n=r.static_len+3+7>>>3,n<=i&&(i=n)):i=n=t+5,t+4<=i&&e!==-1?jR(r,e,t,s):r.strategy===HK||n===i?(Us(r,(SR<<1)+(s?1:0),3),BR(r,bi,Rh)):(Us(r,(jK<<1)+(s?1:0),3),$K(r,r.l_desc.max_code+1,r.d_desc.max_code+1,a+1),BR(r,r.dyn_ltree,r.dyn_dtree)),wR(r),s&&xR(r)},i7=(r,e,t)=>(r.pending_buf[r.sym_buf+r.sym_next++]=e,r.pending_buf[r.sym_buf+r.sym_next++]=e>>8,r.pending_buf[r.sym_buf+r.sym_next++]=t,e===0?r.dyn_ltree[t*2]++:(r.matches++,e--,r.dyn_ltree[(Oh[t]+Ih+1)*2]++,r.dyn_dtree[LR(e)*2]++),r.sym_next===r.sym_end);var n7=t7,a7=jR,o7=r7,h7=i7,u7=s7,l7={_tr_init:n7,_tr_stored_block:a7,_tr_flush_block:o7,_tr_tally:h7,_tr_align:u7},Ah=(r,e,t,s)=>{let i=r&65535|0,n=r>>>16&65535|0,a=0;for(;t!==0;){a=t>2e3?2e3:t,t-=a;do i=i+e[s++]|0,n=n+i|0;while(--a);i%=65521,n%=65521}return i|n<<16|0};const c7=()=>{let r,e=[];for(var t=0;t<256;t++){r=t;for(var s=0;s<8;s++)r=r&1?3988292384^r>>>1:r>>>1;e[t]=r}return e},_7=new Uint32Array(c7());var zt=(r,e,t,s)=>{const i=_7,n=s+t;r^=-1;for(let a=s;a<n;a++)r=r>>>8^i[(r^e[a])&255];return r^-1},no={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},yh={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:d7,_tr_stored_block:bf,_tr_flush_block:f7,_tr_tally:mn,_tr_align:g7}=l7,{Z_NO_FLUSH:pn,Z_PARTIAL_FLUSH:E7,Z_FULL_FLUSH:m7,Z_FINISH:rr,Z_BLOCK:YR,Z_OK:ss,Z_STREAM_END:WR,Z_STREAM_ERROR:Kr,Z_DATA_ERROR:p7,Z_BUF_ERROR:Df,Z_DEFAULT_COMPRESSION:I7,Z_FILTERED:T7,Z_HUFFMAN_ONLY:Zl,Z_RLE:R7,Z_FIXED:v7,Z_DEFAULT_STRATEGY:O7,Z_UNKNOWN:S7,Z_DEFLATED:Jl}=yh,A7=9,y7=15,C7=8,M7=29,Lf=256+1+M7,P7=30,N7=19,b7=2*Lf+1,D7=15,xe=3,In=258,qr=In+xe+1,L7=32,ao=42,Uf=57,Ff=69,wf=73,xf=91,Gf=103,na=113,Ch=666,Os=1,oo=2,aa=3,ho=4,U7=3,oa=(r,e)=>(r.msg=no[e],e),zR=r=>r*2-(r>4?9:0),Tn=r=>{let e=r.length;for(;--e>=0;)r[e]=0},F7=r=>{let e,t,s,i=r.w_size;e=r.hash_size,s=e;do t=r.head[--s],r.head[s]=t>=i?t-i:0;while(--e);e=i,s=e;do t=r.prev[--s],r.prev[s]=t>=i?t-i:0;while(--e)};let Rn=(r,e,t)=>(e<<r.hash_shift^t)&r.hash_mask;const Vs=r=>{const e=r.state;let t=e.pending;t>r.avail_out&&(t=r.avail_out),t!==0&&(r.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+t),r.next_out),r.next_out+=t,e.pending_out+=t,r.total_out+=t,r.avail_out-=t,e.pending-=t,e.pending===0&&(e.pending_out=0))},js=(r,e)=>{f7(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,e),r.block_start=r.strstart,Vs(r.strm)},Ke=(r,e)=>{r.pending_buf[r.pending++]=e},Mh=(r,e)=>{r.pending_buf[r.pending++]=e>>>8&255,r.pending_buf[r.pending++]=e&255},Bf=(r,e,t,s)=>{let i=r.avail_in;return i>s&&(i=s),i===0?0:(r.avail_in-=i,e.set(r.input.subarray(r.next_in,r.next_in+i),t),r.state.wrap===1?r.adler=Ah(r.adler,e,i,t):r.state.wrap===2&&(r.adler=zt(r.adler,e,i,t)),r.next_in+=i,r.total_in+=i,i)},XR=(r,e)=>{let t=r.max_chain_length,s=r.strstart,i,n,a=r.prev_length,o=r.nice_match;const u=r.strstart>r.w_size-qr?r.strstart-(r.w_size-qr):0,l=r.window,d=r.w_mask,c=r.prev,_=r.strstart+In;let f=l[s+a-1],g=l[s+a];r.prev_length>=r.good_match&&(t>>=2),o>r.lookahead&&(o=r.lookahead);do if(i=e,!(l[i+a]!==g||l[i+a-1]!==f||l[i]!==l[s]||l[++i]!==l[s+1])){s+=2,i++;do;while(l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&s<_);if(n=In-(_-s),s=_-In,n>a){if(r.match_start=e,a=n,n>=o)break;f=l[s+a-1],g=l[s+a]}}while((e=c[e&d])>u&&--t!==0);return a<=r.lookahead?a:r.lookahead},uo=r=>{const e=r.w_size;let t,s,i;do{if(s=r.window_size-r.lookahead-r.strstart,r.strstart>=e+(e-qr)&&(r.window.set(r.window.subarray(e,e+e-s),0),r.match_start-=e,r.strstart-=e,r.block_start-=e,r.insert>r.strstart&&(r.insert=r.strstart),F7(r),s+=e),r.strm.avail_in===0)break;if(t=Bf(r.strm,r.window,r.strstart+r.lookahead,s),r.lookahead+=t,r.lookahead+r.insert>=xe)for(i=r.strstart-r.insert,r.ins_h=r.window[i],r.ins_h=Rn(r,r.ins_h,r.window[i+1]);r.insert&&(r.ins_h=Rn(r,r.ins_h,r.window[i+xe-1]),r.prev[i&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=i,i++,r.insert--,!(r.lookahead+r.insert<xe)););}while(r.lookahead<qr&&r.strm.avail_in!==0)},KR=(r,e)=>{let t=r.pending_buf_size-5>r.w_size?r.w_size:r.pending_buf_size-5,s,i,n,a=0,o=r.strm.avail_in;do{if(s=65535,n=r.bi_valid+42>>3,r.strm.avail_out<n||(n=r.strm.avail_out-n,i=r.strstart-r.block_start,s>i+r.strm.avail_in&&(s=i+r.strm.avail_in),s>n&&(s=n),s<t&&(s===0&&e!==rr||e===pn||s!==i+r.strm.avail_in)))break;a=e===rr&&s===i+r.strm.avail_in?1:0,bf(r,0,0,a),r.pending_buf[r.pending-4]=s,r.pending_buf[r.pending-3]=s>>8,r.pending_buf[r.pending-2]=~s,r.pending_buf[r.pending-1]=~s>>8,Vs(r.strm),i&&(i>s&&(i=s),r.strm.output.set(r.window.subarray(r.block_start,r.block_start+i),r.strm.next_out),r.strm.next_out+=i,r.strm.avail_out-=i,r.strm.total_out+=i,r.block_start+=i,s-=i),s&&(Bf(r.strm,r.strm.output,r.strm.next_out,s),r.strm.next_out+=s,r.strm.avail_out-=s,r.strm.total_out+=s)}while(a===0);return o-=r.strm.avail_in,o&&(o>=r.w_size?(r.matches=2,r.window.set(r.strm.input.subarray(r.strm.next_in-r.w_size,r.strm.next_in),0),r.strstart=r.w_size,r.insert=r.strstart):(r.window_size-r.strstart<=o&&(r.strstart-=r.w_size,r.window.set(r.window.subarray(r.w_size,r.w_size+r.strstart),0),r.matches<2&&r.matches++,r.insert>r.strstart&&(r.insert=r.strstart)),r.window.set(r.strm.input.subarray(r.strm.next_in-o,r.strm.next_in),r.strstart),r.strstart+=o,r.insert+=o>r.w_size-r.insert?r.w_size-r.insert:o),r.block_start=r.strstart),r.high_water<r.strstart&&(r.high_water=r.strstart),a?ho:e!==pn&&e!==rr&&r.strm.avail_in===0&&r.strstart===r.block_start?oo:(n=r.window_size-r.strstart,r.strm.avail_in>n&&r.block_start>=r.w_size&&(r.block_start-=r.w_size,r.strstart-=r.w_size,r.window.set(r.window.subarray(r.w_size,r.w_size+r.strstart),0),r.matches<2&&r.matches++,n+=r.w_size,r.insert>r.strstart&&(r.insert=r.strstart)),n>r.strm.avail_in&&(n=r.strm.avail_in),n&&(Bf(r.strm,r.window,r.strstart,n),r.strstart+=n,r.insert+=n>r.w_size-r.insert?r.w_size-r.insert:n),r.high_water<r.strstart&&(r.high_water=r.strstart),n=r.bi_valid+42>>3,n=r.pending_buf_size-n>65535?65535:r.pending_buf_size-n,t=n>r.w_size?r.w_size:n,i=r.strstart-r.block_start,(i>=t||(i||e===rr)&&e!==pn&&r.strm.avail_in===0&&i<=n)&&(s=i>n?n:i,a=e===rr&&r.strm.avail_in===0&&s===i?1:0,bf(r,r.block_start,s,a),r.block_start+=s,Vs(r.strm)),a?aa:Os)},Hf=(r,e)=>{let t,s;for(;;){if(r.lookahead<qr){if(uo(r),r.lookahead<qr&&e===pn)return Os;if(r.lookahead===0)break}if(t=0,r.lookahead>=xe&&(r.ins_h=Rn(r,r.ins_h,r.window[r.strstart+xe-1]),t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),t!==0&&r.strstart-t<=r.w_size-qr&&(r.match_length=XR(r,t)),r.match_length>=xe)if(s=mn(r,r.strstart-r.match_start,r.match_length-xe),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=xe){r.match_length--;do r.strstart++,r.ins_h=Rn(r,r.ins_h,r.window[r.strstart+xe-1]),t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart;while(--r.match_length!==0);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=Rn(r,r.ins_h,r.window[r.strstart+1]);else s=mn(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(s&&(js(r,!1),r.strm.avail_out===0))return Os}return r.insert=r.strstart<xe-1?r.strstart:xe-1,e===rr?(js(r,!0),r.strm.avail_out===0?aa:ho):r.sym_next&&(js(r,!1),r.strm.avail_out===0)?Os:oo},lo=(r,e)=>{let t,s,i;for(;;){if(r.lookahead<qr){if(uo(r),r.lookahead<qr&&e===pn)return Os;if(r.lookahead===0)break}if(t=0,r.lookahead>=xe&&(r.ins_h=Rn(r,r.ins_h,r.window[r.strstart+xe-1]),t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=xe-1,t!==0&&r.prev_length<r.max_lazy_match&&r.strstart-t<=r.w_size-qr&&(r.match_length=XR(r,t),r.match_length<=5&&(r.strategy===T7||r.match_length===xe&&r.strstart-r.match_start>4096)&&(r.match_length=xe-1)),r.prev_length>=xe&&r.match_length<=r.prev_length){i=r.strstart+r.lookahead-xe,s=mn(r,r.strstart-1-r.prev_match,r.prev_length-xe),r.lookahead-=r.prev_length-1,r.prev_length-=2;do++r.strstart<=i&&(r.ins_h=Rn(r,r.ins_h,r.window[r.strstart+xe-1]),t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart);while(--r.prev_length!==0);if(r.match_available=0,r.match_length=xe-1,r.strstart++,s&&(js(r,!1),r.strm.avail_out===0))return Os}else if(r.match_available){if(s=mn(r,0,r.window[r.strstart-1]),s&&js(r,!1),r.strstart++,r.lookahead--,r.strm.avail_out===0)return Os}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(s=mn(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<xe-1?r.strstart:xe-1,e===rr?(js(r,!0),r.strm.avail_out===0?aa:ho):r.sym_next&&(js(r,!1),r.strm.avail_out===0)?Os:oo},w7=(r,e)=>{let t,s,i,n;const a=r.window;for(;;){if(r.lookahead<=In){if(uo(r),r.lookahead<=In&&e===pn)return Os;if(r.lookahead===0)break}if(r.match_length=0,r.lookahead>=xe&&r.strstart>0&&(i=r.strstart-1,s=a[i],s===a[++i]&&s===a[++i]&&s===a[++i])){n=r.strstart+In;do;while(s===a[++i]&&s===a[++i]&&s===a[++i]&&s===a[++i]&&s===a[++i]&&s===a[++i]&&s===a[++i]&&s===a[++i]&&i<n);r.match_length=In-(n-i),r.match_length>r.lookahead&&(r.match_length=r.lookahead)}if(r.match_length>=xe?(t=mn(r,1,r.match_length-xe),r.lookahead-=r.match_length,r.strstart+=r.match_length,r.match_length=0):(t=mn(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++),t&&(js(r,!1),r.strm.avail_out===0))return Os}return r.insert=0,e===rr?(js(r,!0),r.strm.avail_out===0?aa:ho):r.sym_next&&(js(r,!1),r.strm.avail_out===0)?Os:oo},x7=(r,e)=>{let t;for(;;){if(r.lookahead===0&&(uo(r),r.lookahead===0)){if(e===pn)return Os;break}if(r.match_length=0,t=mn(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++,t&&(js(r,!1),r.strm.avail_out===0))return Os}return r.insert=0,e===rr?(js(r,!0),r.strm.avail_out===0?aa:ho):r.sym_next&&(js(r,!1),r.strm.avail_out===0)?Os:oo};function Qr(r,e,t,s,i){this.good_length=r,this.max_lazy=e,this.nice_length=t,this.max_chain=s,this.func=i}const Ph=[new Qr(0,0,0,0,KR),new Qr(4,4,8,4,Hf),new Qr(4,5,16,8,Hf),new Qr(4,6,32,32,Hf),new Qr(4,4,16,16,lo),new Qr(8,16,32,32,lo),new Qr(8,16,128,128,lo),new Qr(8,32,128,256,lo),new Qr(32,128,258,1024,lo),new Qr(32,258,258,4096,lo)],G7=r=>{r.window_size=2*r.w_size,Tn(r.head),r.max_lazy_match=Ph[r.level].max_lazy,r.good_match=Ph[r.level].good_length,r.nice_match=Ph[r.level].nice_length,r.max_chain_length=Ph[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=xe-1,r.match_available=0,r.ins_h=0};function B7(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Jl,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(b7*2),this.dyn_dtree=new Uint16Array((2*P7+1)*2),this.bl_tree=new Uint16Array((2*N7+1)*2),Tn(this.dyn_ltree),Tn(this.dyn_dtree),Tn(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(D7+1),this.heap=new Uint16Array(2*Lf+1),Tn(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Lf+1),Tn(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Nh=r=>{if(!r)return 1;const e=r.state;return!e||e.strm!==r||e.status!==ao&&e.status!==Uf&&e.status!==Ff&&e.status!==wf&&e.status!==xf&&e.status!==Gf&&e.status!==na&&e.status!==Ch?1:0},qR=r=>{if(Nh(r))return oa(r,Kr);r.total_in=r.total_out=0,r.data_type=S7;const e=r.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap===2?Uf:e.wrap?ao:na,r.adler=e.wrap===2?0:1,e.last_flush=-2,d7(e),ss},QR=r=>{const e=qR(r);return e===ss&&G7(r.state),e},H7=(r,e)=>Nh(r)||r.state.wrap!==2?Kr:(r.state.gzhead=e,ss),ZR=(r,e,t,s,i,n)=>{if(!r)return Kr;let a=1;if(e===I7&&(e=6),s<0?(a=0,s=-s):s>15&&(a=2,s-=16),i<1||i>A7||t!==Jl||s<8||s>15||e<0||e>9||n<0||n>v7||s===8&&a!==1)return oa(r,Kr);s===8&&(s=9);const o=new B7;return r.state=o,o.strm=r,o.status=ao,o.wrap=a,o.gzhead=null,o.w_bits=s,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+xe-1)/xe),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=(o.lit_bufsize-1)*3,o.level=e,o.strategy=n,o.method=t,QR(r)},k7=(r,e)=>ZR(r,e,Jl,y7,C7,O7),V7=(r,e)=>{if(Nh(r)||e>YR||e<0)return r?oa(r,Kr):Kr;const t=r.state;if(!r.output||r.avail_in!==0&&!r.input||t.status===Ch&&e!==rr)return oa(r,r.avail_out===0?Df:Kr);const s=t.last_flush;if(t.last_flush=e,t.pending!==0){if(Vs(r),r.avail_out===0)return t.last_flush=-1,ss}else if(r.avail_in===0&&zR(e)<=zR(s)&&e!==rr)return oa(r,Df);if(t.status===Ch&&r.avail_in!==0)return oa(r,Df);if(t.status===ao&&t.wrap===0&&(t.status=na),t.status===ao){let i=Jl+(t.w_bits-8<<4)<<8,n=-1;if(t.strategy>=Zl||t.level<2?n=0:t.level<6?n=1:t.level===6?n=2:n=3,i|=n<<6,t.strstart!==0&&(i|=L7),i+=31-i%31,Mh(t,i),t.strstart!==0&&(Mh(t,r.adler>>>16),Mh(t,r.adler&65535)),r.adler=1,t.status=na,Vs(r),t.pending!==0)return t.last_flush=-1,ss}if(t.status===Uf){if(r.adler=0,Ke(t,31),Ke(t,139),Ke(t,8),t.gzhead)Ke(t,(t.gzhead.text?1:0)+(t.gzhead.hcrc?2:0)+(t.gzhead.extra?4:0)+(t.gzhead.name?8:0)+(t.gzhead.comment?16:0)),Ke(t,t.gzhead.time&255),Ke(t,t.gzhead.time>>8&255),Ke(t,t.gzhead.time>>16&255),Ke(t,t.gzhead.time>>24&255),Ke(t,t.level===9?2:t.strategy>=Zl||t.level<2?4:0),Ke(t,t.gzhead.os&255),t.gzhead.extra&&t.gzhead.extra.length&&(Ke(t,t.gzhead.extra.length&255),Ke(t,t.gzhead.extra.length>>8&255)),t.gzhead.hcrc&&(r.adler=zt(r.adler,t.pending_buf,t.pending,0)),t.gzindex=0,t.status=Ff;else if(Ke(t,0),Ke(t,0),Ke(t,0),Ke(t,0),Ke(t,0),Ke(t,t.level===9?2:t.strategy>=Zl||t.level<2?4:0),Ke(t,U7),t.status=na,Vs(r),t.pending!==0)return t.last_flush=-1,ss}if(t.status===Ff){if(t.gzhead.extra){let i=t.pending,n=(t.gzhead.extra.length&65535)-t.gzindex;for(;t.pending+n>t.pending_buf_size;){let o=t.pending_buf_size-t.pending;if(t.pending_buf.set(t.gzhead.extra.subarray(t.gzindex,t.gzindex+o),t.pending),t.pending=t.pending_buf_size,t.gzhead.hcrc&&t.pending>i&&(r.adler=zt(r.adler,t.pending_buf,t.pending-i,i)),t.gzindex+=o,Vs(r),t.pending!==0)return t.last_flush=-1,ss;i=0,n-=o}let a=new Uint8Array(t.gzhead.extra);t.pending_buf.set(a.subarray(t.gzindex,t.gzindex+n),t.pending),t.pending+=n,t.gzhead.hcrc&&t.pending>i&&(r.adler=zt(r.adler,t.pending_buf,t.pending-i,i)),t.gzindex=0}t.status=wf}if(t.status===wf){if(t.gzhead.name){let i=t.pending,n;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>i&&(r.adler=zt(r.adler,t.pending_buf,t.pending-i,i)),Vs(r),t.pending!==0)return t.last_flush=-1,ss;i=0}t.gzindex<t.gzhead.name.length?n=t.gzhead.name.charCodeAt(t.gzindex++)&255:n=0,Ke(t,n)}while(n!==0);t.gzhead.hcrc&&t.pending>i&&(r.adler=zt(r.adler,t.pending_buf,t.pending-i,i)),t.gzindex=0}t.status=xf}if(t.status===xf){if(t.gzhead.comment){let i=t.pending,n;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>i&&(r.adler=zt(r.adler,t.pending_buf,t.pending-i,i)),Vs(r),t.pending!==0)return t.last_flush=-1,ss;i=0}t.gzindex<t.gzhead.comment.length?n=t.gzhead.comment.charCodeAt(t.gzindex++)&255:n=0,Ke(t,n)}while(n!==0);t.gzhead.hcrc&&t.pending>i&&(r.adler=zt(r.adler,t.pending_buf,t.pending-i,i))}t.status=Gf}if(t.status===Gf){if(t.gzhead.hcrc){if(t.pending+2>t.pending_buf_size&&(Vs(r),t.pending!==0))return t.last_flush=-1,ss;Ke(t,r.adler&255),Ke(t,r.adler>>8&255),r.adler=0}if(t.status=na,Vs(r),t.pending!==0)return t.last_flush=-1,ss}if(r.avail_in!==0||t.lookahead!==0||e!==pn&&t.status!==Ch){let i=t.level===0?KR(t,e):t.strategy===Zl?x7(t,e):t.strategy===R7?w7(t,e):Ph[t.level].func(t,e);if((i===aa||i===ho)&&(t.status=Ch),i===Os||i===aa)return r.avail_out===0&&(t.last_flush=-1),ss;if(i===oo&&(e===E7?g7(t):e!==YR&&(bf(t,0,0,!1),e===m7&&(Tn(t.head),t.lookahead===0&&(t.strstart=0,t.block_start=0,t.insert=0))),Vs(r),r.avail_out===0))return t.last_flush=-1,ss}return e!==rr?ss:t.wrap<=0?WR:(t.wrap===2?(Ke(t,r.adler&255),Ke(t,r.adler>>8&255),Ke(t,r.adler>>16&255),Ke(t,r.adler>>24&255),Ke(t,r.total_in&255),Ke(t,r.total_in>>8&255),Ke(t,r.total_in>>16&255),Ke(t,r.total_in>>24&255)):(Mh(t,r.adler>>>16),Mh(t,r.adler&65535)),Vs(r),t.wrap>0&&(t.wrap=-t.wrap),t.pending!==0?ss:WR)},j7=r=>{if(Nh(r))return Kr;const e=r.state.status;return r.state=null,e===na?oa(r,p7):ss},Y7=(r,e)=>{let t=e.length;if(Nh(r))return Kr;const s=r.state,i=s.wrap;if(i===2||i===1&&s.status!==ao||s.lookahead)return Kr;if(i===1&&(r.adler=Ah(r.adler,e,t,0)),s.wrap=0,t>=s.w_size){i===0&&(Tn(s.head),s.strstart=0,s.block_start=0,s.insert=0);let u=new Uint8Array(s.w_size);u.set(e.subarray(t-s.w_size,t),0),e=u,t=s.w_size}const n=r.avail_in,a=r.next_in,o=r.input;for(r.avail_in=t,r.next_in=0,r.input=e,uo(s);s.lookahead>=xe;){let u=s.strstart,l=s.lookahead-(xe-1);do s.ins_h=Rn(s,s.ins_h,s.window[u+xe-1]),s.prev[u&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=u,u++;while(--l);s.strstart=u,s.lookahead=xe-1,uo(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=xe-1,s.match_available=0,r.next_in=a,r.input=o,r.avail_in=n,s.wrap=i,ss};var W7=k7,z7=ZR,X7=QR,K7=qR,q7=H7,Q7=V7,Z7=j7,J7=Y7,$7="pako deflate (from Nodeca project)",bh={deflateInit:W7,deflateInit2:z7,deflateReset:X7,deflateResetKeep:K7,deflateSetHeader:q7,deflate:Q7,deflateEnd:Z7,deflateSetDictionary:J7,deflateInfo:$7};const e9=(r,e)=>Object.prototype.hasOwnProperty.call(r,e);var t9=function(r){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const s in t)e9(t,s)&&(r[s]=t[s])}}return r},s9=r=>{let e=0;for(let s=0,i=r.length;s<i;s++)e+=r[s].length;const t=new Uint8Array(e);for(let s=0,i=0,n=r.length;s<n;s++){let a=r[s];t.set(a,i),i+=a.length}return t},$l={assign:t9,flattenChunks:s9};let JR=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{JR=!1}const Dh=new Uint8Array(256);for(let r=0;r<256;r++)Dh[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;Dh[254]=Dh[254]=1;var r9=r=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(r);let e,t,s,i,n,a=r.length,o=0;for(i=0;i<a;i++)t=r.charCodeAt(i),(t&64512)===55296&&i+1<a&&(s=r.charCodeAt(i+1),(s&64512)===56320&&(t=65536+(t-55296<<10)+(s-56320),i++)),o+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(o),n=0,i=0;n<o;i++)t=r.charCodeAt(i),(t&64512)===55296&&i+1<a&&(s=r.charCodeAt(i+1),(s&64512)===56320&&(t=65536+(t-55296<<10)+(s-56320),i++)),t<128?e[n++]=t:t<2048?(e[n++]=192|t>>>6,e[n++]=128|t&63):t<65536?(e[n++]=224|t>>>12,e[n++]=128|t>>>6&63,e[n++]=128|t&63):(e[n++]=240|t>>>18,e[n++]=128|t>>>12&63,e[n++]=128|t>>>6&63,e[n++]=128|t&63);return e};const i9=(r,e)=>{if(e<65534&&r.subarray&&JR)return String.fromCharCode.apply(null,r.length===e?r:r.subarray(0,e));let t="";for(let s=0;s<e;s++)t+=String.fromCharCode(r[s]);return t};var n9=(r,e)=>{const t=e||r.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(r.subarray(0,e));let s,i;const n=new Array(t*2);for(i=0,s=0;s<t;){let a=r[s++];if(a<128){n[i++]=a;continue}let o=Dh[a];if(o>4){n[i++]=65533,s+=o-1;continue}for(a&=o===2?31:o===3?15:7;o>1&&s<t;)a=a<<6|r[s++]&63,o--;if(o>1){n[i++]=65533;continue}a<65536?n[i++]=a:(a-=65536,n[i++]=55296|a>>10&1023,n[i++]=56320|a&1023)}return i9(n,i)},a9=(r,e)=>{e=e||r.length,e>r.length&&(e=r.length);let t=e-1;for(;t>=0&&(r[t]&192)===128;)t--;return t<0||t===0?e:t+Dh[r[t]]>e?t:e},Lh={string2buf:r9,buf2string:n9,utf8border:a9};function o9(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var $R=o9;const ev=Object.prototype.toString,{Z_NO_FLUSH:h9,Z_SYNC_FLUSH:u9,Z_FULL_FLUSH:l9,Z_FINISH:c9,Z_OK:ec,Z_STREAM_END:_9,Z_DEFAULT_COMPRESSION:d9,Z_DEFAULT_STRATEGY:f9,Z_DEFLATED:g9}=yh;function kf(r){this.options=$l.assign({level:d9,method:g9,chunkSize:16384,windowBits:15,memLevel:8,strategy:f9},r||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new $R,this.strm.avail_out=0;let t=bh.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(t!==ec)throw new Error(no[t]);if(e.header&&bh.deflateSetHeader(this.strm,e.header),e.dictionary){let s;if(typeof e.dictionary=="string"?s=Lh.string2buf(e.dictionary):ev.call(e.dictionary)==="[object ArrayBuffer]"?s=new Uint8Array(e.dictionary):s=e.dictionary,t=bh.deflateSetDictionary(this.strm,s),t!==ec)throw new Error(no[t]);this._dict_set=!0}}kf.prototype.push=function(r,e){const t=this.strm,s=this.options.chunkSize;let i,n;if(this.ended)return!1;for(e===~~e?n=e:n=e===!0?c9:h9,typeof r=="string"?t.input=Lh.string2buf(r):ev.call(r)==="[object ArrayBuffer]"?t.input=new Uint8Array(r):t.input=r,t.next_in=0,t.avail_in=t.input.length;;){if(t.avail_out===0&&(t.output=new Uint8Array(s),t.next_out=0,t.avail_out=s),(n===u9||n===l9)&&t.avail_out<=6){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(i=bh.deflate(t,n),i===_9)return t.next_out>0&&this.onData(t.output.subarray(0,t.next_out)),i=bh.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===ec;if(t.avail_out===0){this.onData(t.output);continue}if(n>0&&t.next_out>0){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(t.avail_in===0)break}return!0},kf.prototype.onData=function(r){this.chunks.push(r)},kf.prototype.onEnd=function(r){r===ec&&(this.result=$l.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};const tc=16209,E9=16191;var m9=function(e,t){let s,i,n,a,o,u,l,d,c,_,f,g,I,p,R,S,O,A,C,M,N,L,b,D;const x=e.state;s=e.next_in,b=e.input,i=s+(e.avail_in-5),n=e.next_out,D=e.output,a=n-(t-e.avail_out),o=n+(e.avail_out-257),u=x.dmax,l=x.wsize,d=x.whave,c=x.wnext,_=x.window,f=x.hold,g=x.bits,I=x.lencode,p=x.distcode,R=(1<<x.lenbits)-1,S=(1<<x.distbits)-1;e:do{g<15&&(f+=b[s++]<<g,g+=8,f+=b[s++]<<g,g+=8),O=I[f&R];t:for(;;){if(A=O>>>24,f>>>=A,g-=A,A=O>>>16&255,A===0)D[n++]=O&65535;else if(A&16){C=O&65535,A&=15,A&&(g<A&&(f+=b[s++]<<g,g+=8),C+=f&(1<<A)-1,f>>>=A,g-=A),g<15&&(f+=b[s++]<<g,g+=8,f+=b[s++]<<g,g+=8),O=p[f&S];s:for(;;){if(A=O>>>24,f>>>=A,g-=A,A=O>>>16&255,A&16){if(M=O&65535,A&=15,g<A&&(f+=b[s++]<<g,g+=8,g<A&&(f+=b[s++]<<g,g+=8)),M+=f&(1<<A)-1,M>u){e.msg="invalid distance too far back",x.mode=tc;break e}if(f>>>=A,g-=A,A=n-a,M>A){if(A=M-A,A>d&&x.sane){e.msg="invalid distance too far back",x.mode=tc;break e}if(N=0,L=_,c===0){if(N+=l-A,A<C){C-=A;do D[n++]=_[N++];while(--A);N=n-M,L=D}}else if(c<A){if(N+=l+c-A,A-=c,A<C){C-=A;do D[n++]=_[N++];while(--A);if(N=0,c<C){A=c,C-=A;do D[n++]=_[N++];while(--A);N=n-M,L=D}}}else if(N+=c-A,A<C){C-=A;do D[n++]=_[N++];while(--A);N=n-M,L=D}for(;C>2;)D[n++]=L[N++],D[n++]=L[N++],D[n++]=L[N++],C-=3;C&&(D[n++]=L[N++],C>1&&(D[n++]=L[N++]))}else{N=n-M;do D[n++]=D[N++],D[n++]=D[N++],D[n++]=D[N++],C-=3;while(C>2);C&&(D[n++]=D[N++],C>1&&(D[n++]=D[N++]))}}else if(A&64){e.msg="invalid distance code",x.mode=tc;break e}else{O=p[(O&65535)+(f&(1<<A)-1)];continue s}break}}else if(A&64)if(A&32){x.mode=E9;break e}else{e.msg="invalid literal/length code",x.mode=tc;break e}else{O=I[(O&65535)+(f&(1<<A)-1)];continue t}break}}while(s<i&&n<o);C=g>>3,s-=C,g-=C<<3,f&=(1<<g)-1,e.next_in=s,e.next_out=n,e.avail_in=s<i?5+(i-s):5-(s-i),e.avail_out=n<o?257+(o-n):257-(n-o),x.hold=f,x.bits=g};const co=15,tv=852,sv=592,rv=0,Vf=1,iv=2,p9=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),I9=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),T9=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),R9=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Uh=(r,e,t,s,i,n,a,o)=>{const u=o.bits;let l=0,d=0,c=0,_=0,f=0,g=0,I=0,p=0,R=0,S=0,O,A,C,M,N,L=null,b;const D=new Uint16Array(co+1),x=new Uint16Array(co+1);let q=null,$,Te,j;for(l=0;l<=co;l++)D[l]=0;for(d=0;d<s;d++)D[e[t+d]]++;for(f=u,_=co;_>=1&&D[_]===0;_--);if(f>_&&(f=_),_===0)return i[n++]=1<<24|64<<16|0,i[n++]=1<<24|64<<16|0,o.bits=1,0;for(c=1;c<_&&D[c]===0;c++);for(f<c&&(f=c),p=1,l=1;l<=co;l++)if(p<<=1,p-=D[l],p<0)return-1;if(p>0&&(r===rv||_!==1))return-1;for(x[1]=0,l=1;l<co;l++)x[l+1]=x[l]+D[l];for(d=0;d<s;d++)e[t+d]!==0&&(a[x[e[t+d]]++]=d);if(r===rv?(L=q=a,b=20):r===Vf?(L=p9,q=I9,b=257):(L=T9,q=R9,b=0),S=0,d=0,l=c,N=n,g=f,I=0,C=-1,R=1<<f,M=R-1,r===Vf&&R>tv||r===iv&&R>sv)return 1;for(;;){$=l-I,a[d]+1<b?(Te=0,j=a[d]):a[d]>=b?(Te=q[a[d]-b],j=L[a[d]-b]):(Te=32+64,j=0),O=1<<l-I,A=1<<g,c=A;do A-=O,i[N+(S>>I)+A]=$<<24|Te<<16|j|0;while(A!==0);for(O=1<<l-1;S&O;)O>>=1;if(O!==0?(S&=O-1,S+=O):S=0,d++,--D[l]===0){if(l===_)break;l=e[t+a[d]]}if(l>f&&(S&M)!==C){for(I===0&&(I=f),N+=c,g=l-I,p=1<<g;g+I<_&&(p-=D[g+I],!(p<=0));)g++,p<<=1;if(R+=1<<g,r===Vf&&R>tv||r===iv&&R>sv)return 1;C=S&M,i[C]=f<<24|g<<16|N-n|0}}return S!==0&&(i[N+S]=l-I<<24|64<<16|0),o.bits=f,0};const v9=0,nv=1,av=2,{Z_FINISH:ov,Z_BLOCK:O9,Z_TREES:sc,Z_OK:ha,Z_STREAM_END:S9,Z_NEED_DICT:A9,Z_STREAM_ERROR:ir,Z_DATA_ERROR:hv,Z_MEM_ERROR:uv,Z_BUF_ERROR:y9,Z_DEFLATED:lv}=yh,rc=16180,cv=16181,_v=16182,dv=16183,fv=16184,gv=16185,Ev=16186,mv=16187,pv=16188,Iv=16189,ic=16190,Di=16191,jf=16192,Tv=16193,Yf=16194,Rv=16195,vv=16196,Ov=16197,Sv=16198,nc=16199,ac=16200,Av=16201,yv=16202,Cv=16203,Mv=16204,Pv=16205,Wf=16206,Nv=16207,bv=16208,ct=16209,Dv=16210,Lv=16211,C9=852,M9=592,P9=15,Uv=r=>(r>>>24&255)+(r>>>8&65280)+((r&65280)<<8)+((r&255)<<24);function N9(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const ua=r=>{if(!r)return 1;const e=r.state;return!e||e.strm!==r||e.mode<rc||e.mode>Lv?1:0},Fv=r=>{if(ua(r))return ir;const e=r.state;return r.total_in=r.total_out=e.total=0,r.msg="",e.wrap&&(r.adler=e.wrap&1),e.mode=rc,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(C9),e.distcode=e.distdyn=new Int32Array(M9),e.sane=1,e.back=-1,ha},wv=r=>{if(ua(r))return ir;const e=r.state;return e.wsize=0,e.whave=0,e.wnext=0,Fv(r)},xv=(r,e)=>{let t;if(ua(r))return ir;const s=r.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?ir:(s.window!==null&&s.wbits!==e&&(s.window=null),s.wrap=t,s.wbits=e,wv(r))},Gv=(r,e)=>{if(!r)return ir;const t=new N9;r.state=t,t.strm=r,t.window=null,t.mode=rc;const s=xv(r,e);return s!==ha&&(r.state=null),s},b9=r=>Gv(r,P9);let Bv=!0,zf,Xf;const D9=r=>{if(Bv){zf=new Int32Array(512),Xf=new Int32Array(32);let e=0;for(;e<144;)r.lens[e++]=8;for(;e<256;)r.lens[e++]=9;for(;e<280;)r.lens[e++]=7;for(;e<288;)r.lens[e++]=8;for(Uh(nv,r.lens,0,288,zf,0,r.work,{bits:9}),e=0;e<32;)r.lens[e++]=5;Uh(av,r.lens,0,32,Xf,0,r.work,{bits:5}),Bv=!1}r.lencode=zf,r.lenbits=9,r.distcode=Xf,r.distbits=5},Hv=(r,e,t,s)=>{let i;const n=r.state;return n.window===null&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new Uint8Array(n.wsize)),s>=n.wsize?(n.window.set(e.subarray(t-n.wsize,t),0),n.wnext=0,n.whave=n.wsize):(i=n.wsize-n.wnext,i>s&&(i=s),n.window.set(e.subarray(t-s,t-s+i),n.wnext),s-=i,s?(n.window.set(e.subarray(t-s,t),0),n.wnext=s,n.whave=n.wsize):(n.wnext+=i,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=i))),0},L9=(r,e)=>{let t,s,i,n,a,o,u,l,d,c,_,f,g,I,p=0,R,S,O,A,C,M,N,L;const b=new Uint8Array(4);let D,x;const q=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(ua(r)||!r.output||!r.input&&r.avail_in!==0)return ir;t=r.state,t.mode===Di&&(t.mode=jf),a=r.next_out,i=r.output,u=r.avail_out,n=r.next_in,s=r.input,o=r.avail_in,l=t.hold,d=t.bits,c=o,_=u,L=ha;e:for(;;)switch(t.mode){case rc:if(t.wrap===0){t.mode=jf;break}for(;d<16;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if(t.wrap&2&&l===35615){t.wbits===0&&(t.wbits=15),t.check=0,b[0]=l&255,b[1]=l>>>8&255,t.check=zt(t.check,b,2,0),l=0,d=0,t.mode=cv;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((l&255)<<8)+(l>>8))%31){r.msg="incorrect header check",t.mode=ct;break}if((l&15)!==lv){r.msg="unknown compression method",t.mode=ct;break}if(l>>>=4,d-=4,N=(l&15)+8,t.wbits===0&&(t.wbits=N),N>15||N>t.wbits){r.msg="invalid window size",t.mode=ct;break}t.dmax=1<<t.wbits,t.flags=0,r.adler=t.check=1,t.mode=l&512?Iv:Di,l=0,d=0;break;case cv:for(;d<16;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if(t.flags=l,(t.flags&255)!==lv){r.msg="unknown compression method",t.mode=ct;break}if(t.flags&57344){r.msg="unknown header flags set",t.mode=ct;break}t.head&&(t.head.text=l>>8&1),t.flags&512&&t.wrap&4&&(b[0]=l&255,b[1]=l>>>8&255,t.check=zt(t.check,b,2,0)),l=0,d=0,t.mode=_v;case _v:for(;d<32;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}t.head&&(t.head.time=l),t.flags&512&&t.wrap&4&&(b[0]=l&255,b[1]=l>>>8&255,b[2]=l>>>16&255,b[3]=l>>>24&255,t.check=zt(t.check,b,4,0)),l=0,d=0,t.mode=dv;case dv:for(;d<16;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}t.head&&(t.head.xflags=l&255,t.head.os=l>>8),t.flags&512&&t.wrap&4&&(b[0]=l&255,b[1]=l>>>8&255,t.check=zt(t.check,b,2,0)),l=0,d=0,t.mode=fv;case fv:if(t.flags&1024){for(;d<16;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}t.length=l,t.head&&(t.head.extra_len=l),t.flags&512&&t.wrap&4&&(b[0]=l&255,b[1]=l>>>8&255,t.check=zt(t.check,b,2,0)),l=0,d=0}else t.head&&(t.head.extra=null);t.mode=gv;case gv:if(t.flags&1024&&(f=t.length,f>o&&(f=o),f&&(t.head&&(N=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(s.subarray(n,n+f),N)),t.flags&512&&t.wrap&4&&(t.check=zt(t.check,s,f,n)),o-=f,n+=f,t.length-=f),t.length))break e;t.length=0,t.mode=Ev;case Ev:if(t.flags&2048){if(o===0)break e;f=0;do N=s[n+f++],t.head&&N&&t.length<65536&&(t.head.name+=String.fromCharCode(N));while(N&&f<o);if(t.flags&512&&t.wrap&4&&(t.check=zt(t.check,s,f,n)),o-=f,n+=f,N)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=mv;case mv:if(t.flags&4096){if(o===0)break e;f=0;do N=s[n+f++],t.head&&N&&t.length<65536&&(t.head.comment+=String.fromCharCode(N));while(N&&f<o);if(t.flags&512&&t.wrap&4&&(t.check=zt(t.check,s,f,n)),o-=f,n+=f,N)break e}else t.head&&(t.head.comment=null);t.mode=pv;case pv:if(t.flags&512){for(;d<16;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if(t.wrap&4&&l!==(t.check&65535)){r.msg="header crc mismatch",t.mode=ct;break}l=0,d=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),r.adler=t.check=0,t.mode=Di;break;case Iv:for(;d<32;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}r.adler=t.check=Uv(l),l=0,d=0,t.mode=ic;case ic:if(t.havedict===0)return r.next_out=a,r.avail_out=u,r.next_in=n,r.avail_in=o,t.hold=l,t.bits=d,A9;r.adler=t.check=1,t.mode=Di;case Di:if(e===O9||e===sc)break e;case jf:if(t.last){l>>>=d&7,d-=d&7,t.mode=Wf;break}for(;d<3;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}switch(t.last=l&1,l>>>=1,d-=1,l&3){case 0:t.mode=Tv;break;case 1:if(D9(t),t.mode=nc,e===sc){l>>>=2,d-=2;break e}break;case 2:t.mode=vv;break;case 3:r.msg="invalid block type",t.mode=ct}l>>>=2,d-=2;break;case Tv:for(l>>>=d&7,d-=d&7;d<32;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if((l&65535)!==(l>>>16^65535)){r.msg="invalid stored block lengths",t.mode=ct;break}if(t.length=l&65535,l=0,d=0,t.mode=Yf,e===sc)break e;case Yf:t.mode=Rv;case Rv:if(f=t.length,f){if(f>o&&(f=o),f>u&&(f=u),f===0)break e;i.set(s.subarray(n,n+f),a),o-=f,n+=f,u-=f,a+=f,t.length-=f;break}t.mode=Di;break;case vv:for(;d<14;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if(t.nlen=(l&31)+257,l>>>=5,d-=5,t.ndist=(l&31)+1,l>>>=5,d-=5,t.ncode=(l&15)+4,l>>>=4,d-=4,t.nlen>286||t.ndist>30){r.msg="too many length or distance symbols",t.mode=ct;break}t.have=0,t.mode=Ov;case Ov:for(;t.have<t.ncode;){for(;d<3;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}t.lens[q[t.have++]]=l&7,l>>>=3,d-=3}for(;t.have<19;)t.lens[q[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,D={bits:t.lenbits},L=Uh(v9,t.lens,0,19,t.lencode,0,t.work,D),t.lenbits=D.bits,L){r.msg="invalid code lengths set",t.mode=ct;break}t.have=0,t.mode=Sv;case Sv:for(;t.have<t.nlen+t.ndist;){for(;p=t.lencode[l&(1<<t.lenbits)-1],R=p>>>24,S=p>>>16&255,O=p&65535,!(R<=d);){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if(O<16)l>>>=R,d-=R,t.lens[t.have++]=O;else{if(O===16){for(x=R+2;d<x;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if(l>>>=R,d-=R,t.have===0){r.msg="invalid bit length repeat",t.mode=ct;break}N=t.lens[t.have-1],f=3+(l&3),l>>>=2,d-=2}else if(O===17){for(x=R+3;d<x;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}l>>>=R,d-=R,N=0,f=3+(l&7),l>>>=3,d-=3}else{for(x=R+7;d<x;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}l>>>=R,d-=R,N=0,f=11+(l&127),l>>>=7,d-=7}if(t.have+f>t.nlen+t.ndist){r.msg="invalid bit length repeat",t.mode=ct;break}for(;f--;)t.lens[t.have++]=N}}if(t.mode===ct)break;if(t.lens[256]===0){r.msg="invalid code -- missing end-of-block",t.mode=ct;break}if(t.lenbits=9,D={bits:t.lenbits},L=Uh(nv,t.lens,0,t.nlen,t.lencode,0,t.work,D),t.lenbits=D.bits,L){r.msg="invalid literal/lengths set",t.mode=ct;break}if(t.distbits=6,t.distcode=t.distdyn,D={bits:t.distbits},L=Uh(av,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,D),t.distbits=D.bits,L){r.msg="invalid distances set",t.mode=ct;break}if(t.mode=nc,e===sc)break e;case nc:t.mode=ac;case ac:if(o>=6&&u>=258){r.next_out=a,r.avail_out=u,r.next_in=n,r.avail_in=o,t.hold=l,t.bits=d,m9(r,_),a=r.next_out,i=r.output,u=r.avail_out,n=r.next_in,s=r.input,o=r.avail_in,l=t.hold,d=t.bits,t.mode===Di&&(t.back=-1);break}for(t.back=0;p=t.lencode[l&(1<<t.lenbits)-1],R=p>>>24,S=p>>>16&255,O=p&65535,!(R<=d);){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if(S&&!(S&240)){for(A=R,C=S,M=O;p=t.lencode[M+((l&(1<<A+C)-1)>>A)],R=p>>>24,S=p>>>16&255,O=p&65535,!(A+R<=d);){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}l>>>=A,d-=A,t.back+=A}if(l>>>=R,d-=R,t.back+=R,t.length=O,S===0){t.mode=Pv;break}if(S&32){t.back=-1,t.mode=Di;break}if(S&64){r.msg="invalid literal/length code",t.mode=ct;break}t.extra=S&15,t.mode=Av;case Av:if(t.extra){for(x=t.extra;d<x;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}t.length+=l&(1<<t.extra)-1,l>>>=t.extra,d-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=yv;case yv:for(;p=t.distcode[l&(1<<t.distbits)-1],R=p>>>24,S=p>>>16&255,O=p&65535,!(R<=d);){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if(!(S&240)){for(A=R,C=S,M=O;p=t.distcode[M+((l&(1<<A+C)-1)>>A)],R=p>>>24,S=p>>>16&255,O=p&65535,!(A+R<=d);){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}l>>>=A,d-=A,t.back+=A}if(l>>>=R,d-=R,t.back+=R,S&64){r.msg="invalid distance code",t.mode=ct;break}t.offset=O,t.extra=S&15,t.mode=Cv;case Cv:if(t.extra){for(x=t.extra;d<x;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}t.offset+=l&(1<<t.extra)-1,l>>>=t.extra,d-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){r.msg="invalid distance too far back",t.mode=ct;break}t.mode=Mv;case Mv:if(u===0)break e;if(f=_-u,t.offset>f){if(f=t.offset-f,f>t.whave&&t.sane){r.msg="invalid distance too far back",t.mode=ct;break}f>t.wnext?(f-=t.wnext,g=t.wsize-f):g=t.wnext-f,f>t.length&&(f=t.length),I=t.window}else I=i,g=a-t.offset,f=t.length;f>u&&(f=u),u-=f,t.length-=f;do i[a++]=I[g++];while(--f);t.length===0&&(t.mode=ac);break;case Pv:if(u===0)break e;i[a++]=t.length,u--,t.mode=ac;break;case Wf:if(t.wrap){for(;d<32;){if(o===0)break e;o--,l|=s[n++]<<d,d+=8}if(_-=u,r.total_out+=_,t.total+=_,t.wrap&4&&_&&(r.adler=t.check=t.flags?zt(t.check,i,_,a-_):Ah(t.check,i,_,a-_)),_=u,t.wrap&4&&(t.flags?l:Uv(l))!==t.check){r.msg="incorrect data check",t.mode=ct;break}l=0,d=0}t.mode=Nv;case Nv:if(t.wrap&&t.flags){for(;d<32;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if(t.wrap&4&&l!==(t.total&4294967295)){r.msg="incorrect length check",t.mode=ct;break}l=0,d=0}t.mode=bv;case bv:L=S9;break e;case ct:L=hv;break e;case Dv:return uv;case Lv:default:return ir}return r.next_out=a,r.avail_out=u,r.next_in=n,r.avail_in=o,t.hold=l,t.bits=d,(t.wsize||_!==r.avail_out&&t.mode<ct&&(t.mode<Wf||e!==ov))&&Hv(r,r.output,r.next_out,_-r.avail_out),c-=r.avail_in,_-=r.avail_out,r.total_in+=c,r.total_out+=_,t.total+=_,t.wrap&4&&_&&(r.adler=t.check=t.flags?zt(t.check,i,_,r.next_out-_):Ah(t.check,i,_,r.next_out-_)),r.data_type=t.bits+(t.last?64:0)+(t.mode===Di?128:0)+(t.mode===nc||t.mode===Yf?256:0),(c===0&&_===0||e===ov)&&L===ha&&(L=y9),L},U9=r=>{if(ua(r))return ir;let e=r.state;return e.window&&(e.window=null),r.state=null,ha},F9=(r,e)=>{if(ua(r))return ir;const t=r.state;return t.wrap&2?(t.head=e,e.done=!1,ha):ir},w9=(r,e)=>{const t=e.length;let s,i,n;return ua(r)||(s=r.state,s.wrap!==0&&s.mode!==ic)?ir:s.mode===ic&&(i=1,i=Ah(i,e,t,0),i!==s.check)?hv:(n=Hv(r,e,t,t),n?(s.mode=Dv,uv):(s.havedict=1,ha))};var x9=wv,G9=xv,B9=Fv,H9=b9,k9=Gv,V9=L9,j9=U9,Y9=F9,W9=w9,z9="pako inflate (from Nodeca project)",Li={inflateReset:x9,inflateReset2:G9,inflateResetKeep:B9,inflateInit:H9,inflateInit2:k9,inflate:V9,inflateEnd:j9,inflateGetHeader:Y9,inflateSetDictionary:W9,inflateInfo:z9};function X9(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var K9=X9;const kv=Object.prototype.toString,{Z_NO_FLUSH:q9,Z_FINISH:Q9,Z_OK:Fh,Z_STREAM_END:Kf,Z_NEED_DICT:qf,Z_STREAM_ERROR:Z9,Z_DATA_ERROR:Vv,Z_MEM_ERROR:J9}=yh;function wh(r){this.options=$l.assign({chunkSize:1024*64,windowBits:15,to:""},r||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(r&&r.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new $R,this.strm.avail_out=0;let t=Li.inflateInit2(this.strm,e.windowBits);if(t!==Fh)throw new Error(no[t]);if(this.header=new K9,Li.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Lh.string2buf(e.dictionary):kv.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=Li.inflateSetDictionary(this.strm,e.dictionary),t!==Fh)))throw new Error(no[t])}wh.prototype.push=function(r,e){const t=this.strm,s=this.options.chunkSize,i=this.options.dictionary;let n,a,o;if(this.ended)return!1;for(e===~~e?a=e:a=e===!0?Q9:q9,kv.call(r)==="[object ArrayBuffer]"?t.input=new Uint8Array(r):t.input=r,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(s),t.next_out=0,t.avail_out=s),n=Li.inflate(t,a),n===qf&&i&&(n=Li.inflateSetDictionary(t,i),n===Fh?n=Li.inflate(t,a):n===Vv&&(n=qf));t.avail_in>0&&n===Kf&&t.state.wrap>0&&r[t.next_in]!==0;)Li.inflateReset(t),n=Li.inflate(t,a);switch(n){case Z9:case Vv:case qf:case J9:return this.onEnd(n),this.ended=!0,!1}if(o=t.avail_out,t.next_out&&(t.avail_out===0||n===Kf))if(this.options.to==="string"){let u=Lh.utf8border(t.output,t.next_out),l=t.next_out-u,d=Lh.buf2string(t.output,u);t.next_out=l,t.avail_out=s-l,l&&t.output.set(t.output.subarray(u,u+l),0),this.onData(d)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(n===Fh&&o===0)){if(n===Kf)return n=Li.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,!0;if(t.avail_in===0)break}}return!0},wh.prototype.onData=function(r){this.chunks.push(r)},wh.prototype.onEnd=function(r){r===Fh&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=$l.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function Qf(r,e){const t=new wh(e);if(t.push(r),t.err)throw t.msg||no[t.err];return t.result}function $9(r,e){return e=e||{},e.raw=!0,Qf(r,e)}var eq=wh,tq=Qf,sq=$9,rq=Qf,iq=yh,nq={Inflate:eq,inflate:tq,inflateRaw:sq,ungzip:rq,constants:iq};const{Inflate:wZ,inflate:aq,inflateRaw:xZ,ungzip:GZ}=nq;var jv=aq;class _o{constructor(e){this._jsonFile=null,this._image=null,this._imageData=null,this._baseTexture=null,this.parse(e)}parse(e){const t=new ph(e);let s=t.readShort();for(;s>0;){const i=t.readShort(),n=t.readBytes(i).toString(),a=t.readInt(),o=t.readBytes(a);if(n.endsWith(".json")){const u=jv(o.toArrayBuffer());this._jsonFile=JSON.parse(_o.TEXT_DECODER.decode(u))}else{const u=jv(o.toArrayBuffer()),l=If(u);this._baseTexture=new Qe("data:image/png;base64,"+l)}s--}}get jsonFile(){return this._jsonFile}get baseTexture(){return this._baseTexture}}_o.TEXT_DECODER=new TextDecoder("utf-8");/*!
 * @pixi/display - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */J.SORTABLE_CHILDREN=!1;var xh=function(){function r(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return r.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},r.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},r.prototype.getRectangle=function(e){return this.minX>this.maxX||this.minY>this.maxY?he.EMPTY:(e=e||new he(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)},r.prototype.addPoint=function(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)},r.prototype.addPointMatrix=function(e,t){var s=e.a,i=e.b,n=e.c,a=e.d,o=e.tx,u=e.ty,l=s*t.x+n*t.y+o,d=i*t.x+a*t.y+u;this.minX=Math.min(this.minX,l),this.maxX=Math.max(this.maxX,l),this.minY=Math.min(this.minY,d),this.maxY=Math.max(this.maxY,d)},r.prototype.addQuad=function(e){var t=this.minX,s=this.minY,i=this.maxX,n=this.maxY,a=e[0],o=e[1];t=a<t?a:t,s=o<s?o:s,i=a>i?a:i,n=o>n?o:n,a=e[2],o=e[3],t=a<t?a:t,s=o<s?o:s,i=a>i?a:i,n=o>n?o:n,a=e[4],o=e[5],t=a<t?a:t,s=o<s?o:s,i=a>i?a:i,n=o>n?o:n,a=e[6],o=e[7],t=a<t?a:t,s=o<s?o:s,i=a>i?a:i,n=o>n?o:n,this.minX=t,this.minY=s,this.maxX=i,this.maxY=n},r.prototype.addFrame=function(e,t,s,i,n){this.addFrameMatrix(e.worldTransform,t,s,i,n)},r.prototype.addFrameMatrix=function(e,t,s,i,n){var a=e.a,o=e.b,u=e.c,l=e.d,d=e.tx,c=e.ty,_=this.minX,f=this.minY,g=this.maxX,I=this.maxY,p=a*t+u*s+d,R=o*t+l*s+c;_=p<_?p:_,f=R<f?R:f,g=p>g?p:g,I=R>I?R:I,p=a*i+u*s+d,R=o*i+l*s+c,_=p<_?p:_,f=R<f?R:f,g=p>g?p:g,I=R>I?R:I,p=a*t+u*n+d,R=o*t+l*n+c,_=p<_?p:_,f=R<f?R:f,g=p>g?p:g,I=R>I?R:I,p=a*i+u*n+d,R=o*i+l*n+c,_=p<_?p:_,f=R<f?R:f,g=p>g?p:g,I=R>I?R:I,this.minX=_,this.minY=f,this.maxX=g,this.maxY=I},r.prototype.addVertexData=function(e,t,s){for(var i=this.minX,n=this.minY,a=this.maxX,o=this.maxY,u=t;u<s;u+=2){var l=e[u],d=e[u+1];i=l<i?l:i,n=d<n?d:n,a=l>a?l:a,o=d>o?d:o}this.minX=i,this.minY=n,this.maxX=a,this.maxY=o},r.prototype.addVertices=function(e,t,s,i){this.addVerticesMatrix(e.worldTransform,t,s,i)},r.prototype.addVerticesMatrix=function(e,t,s,i,n,a){n===void 0&&(n=0),a===void 0&&(a=n);for(var o=e.a,u=e.b,l=e.c,d=e.d,c=e.tx,_=e.ty,f=this.minX,g=this.minY,I=this.maxX,p=this.maxY,R=s;R<i;R+=2){var S=t[R],O=t[R+1],A=o*S+l*O+c,C=d*O+u*S+_;f=Math.min(f,A-n),I=Math.max(I,A+n),g=Math.min(g,C-a),p=Math.max(p,C+a)}this.minX=f,this.minY=g,this.maxX=I,this.maxY=p},r.prototype.addBounds=function(e){var t=this.minX,s=this.minY,i=this.maxX,n=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<s?e.minY:s,this.maxX=e.maxX>i?e.maxX:i,this.maxY=e.maxY>n?e.maxY:n},r.prototype.addBoundsMask=function(e,t){var s=e.minX>t.minX?e.minX:t.minX,i=e.minY>t.minY?e.minY:t.minY,n=e.maxX<t.maxX?e.maxX:t.maxX,a=e.maxY<t.maxY?e.maxY:t.maxY;if(s<=n&&i<=a){var o=this.minX,u=this.minY,l=this.maxX,d=this.maxY;this.minX=s<o?s:o,this.minY=i<u?i:u,this.maxX=n>l?n:l,this.maxY=a>d?a:d}},r.prototype.addBoundsMatrix=function(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)},r.prototype.addBoundsArea=function(e,t){var s=e.minX>t.x?e.minX:t.x,i=e.minY>t.y?e.minY:t.y,n=e.maxX<t.x+t.width?e.maxX:t.x+t.width,a=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(s<=n&&i<=a){var o=this.minX,u=this.minY,l=this.maxX,d=this.maxY;this.minX=s<o?s:o,this.minY=i<u?i:u,this.maxX=n>l?n:l,this.maxY=a>d?a:d}},r.prototype.pad=function(e,t){e===void 0&&(e=0),t===void 0&&(t=e),this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)},r.prototype.addFramePad=function(e,t,s,i,n,a){e-=n,t-=a,s+=n,i+=a,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>s?this.maxX:s,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>i?this.maxY:i},r}();/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var Zf=function(r,e){return Zf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var i in s)s.hasOwnProperty(i)&&(t[i]=s[i])},Zf(r,e)};function Jf(r,e){Zf(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var yt=function(r){Jf(e,r);function e(){var t=r.call(this)||this;return t.tempDisplayObjectParent=null,t.transform=new VT,t.alpha=1,t.visible=!0,t.renderable=!0,t.cullable=!1,t.cullArea=null,t.parent=null,t.worldAlpha=1,t._lastSortedIndex=0,t._zIndex=0,t.filterArea=null,t.filters=null,t._enabledFilters=null,t._bounds=new xh,t._localBounds=null,t._boundsID=0,t._boundsRect=null,t._localBoundsRect=null,t._mask=null,t._maskRefCount=0,t._destroyed=!1,t.isSprite=!1,t.isMask=!1,t}return e.mixin=function(t){for(var s=Object.keys(t),i=0;i<s.length;++i){var n=s[i];Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t,n))}},Object.defineProperty(e.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.getBounds=function(t,s){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),s||(this._boundsRect||(this._boundsRect=new he),s=this._boundsRect),this._bounds.getRectangle(s)},e.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new he),t=this._localBoundsRect),this._localBounds||(this._localBounds=new xh);var s=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var n=this._bounds,a=this._boundsID;this._bounds=this._localBounds;var o=this.getBounds(!1,t);return this.parent=i,this.transform=s,this._bounds=n,this._bounds.updateID+=this._boundsID-a,o},e.prototype.toGlobal=function(t,s,i){return i===void 0&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,s)},e.prototype.toLocal=function(t,s,i,n){return s&&(t=s.toGlobal(t,i,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,s,i,n,a,o,u,l,d){return t===void 0&&(t=0),s===void 0&&(s=0),i===void 0&&(i=1),n===void 0&&(n=1),a===void 0&&(a=0),o===void 0&&(o=0),u===void 0&&(u=0),l===void 0&&(l=0),d===void 0&&(d=0),this.position.x=t,this.position.y=s,this.scale.x=i||1,this.scale.y=n||1,this.rotation=a,this.skew.x=o,this.skew.y=u,this.pivot.x=l,this.pivot.y=d,this},e.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()},Object.defineProperty(e.prototype,"_tempDisplayObjectParent",{get:function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Yv),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),e.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t},e.prototype.disableTempParent=function(t){this.parent=t},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skew",{get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.transform.rotation*Y6},set:function(t){this.transform.rotation=t*W6},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){if(this._mask!==t){if(this._mask){var s=this._mask.isMaskData?this._mask.maskObject:this._mask;s&&(s._maskRefCount--,s._maskRefCount===0&&(s.renderable=!0,s.isMask=!1))}if(this._mask=t,this._mask){var s=this._mask.isMaskData?this._mask.maskObject:this._mask;s&&(s._maskRefCount===0&&(s.renderable=!1,s.isMask=!0),s._maskRefCount++)}}},enumerable:!1,configurable:!0}),e}($o),Yv=function(r){Jf(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.sortDirty=null,t}return e}(yt);yt.prototype.displayObjectUpdateTransform=yt.prototype.updateTransform;function oq(r,e){return r.zIndex===e.zIndex?r._lastSortedIndex-e._lastSortedIndex:r.zIndex-e.zIndex}var Zr=function(r){Jf(e,r);function e(){var t=r.call(this)||this;return t.children=[],t.sortableChildren=J.SORTABLE_CHILDREN,t.sortDirty=!1,t}return e.prototype.onChildrenChange=function(t){},e.prototype.addChild=function(){for(var t=arguments,s=[],i=0;i<arguments.length;i++)s[i]=t[i];if(s.length>1)for(var n=0;n<s.length;n++)this.addChild(s[n]);else{var a=s[0];a.parent&&a.parent.removeChild(a),a.parent=this,this.sortDirty=!0,a.transform._parentID=-1,this.children.push(a),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",a,this,this.children.length-1),a.emit("added",this)}return s[0]},e.prototype.addChildAt=function(t,s){if(s<0||s>this.children.length)throw new Error(t+"addChildAt: The index "+s+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(s,0,t),this._boundsID++,this.onChildrenChange(s),t.emit("added",this),this.emit("childAdded",t,this,s),t},e.prototype.swapChildren=function(t,s){if(t!==s){var i=this.getChildIndex(t),n=this.getChildIndex(s);this.children[i]=s,this.children[n]=t,this.onChildrenChange(i<n?i:n)}},e.prototype.getChildIndex=function(t){var s=this.children.indexOf(t);if(s===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return s},e.prototype.setChildIndex=function(t,s){if(s<0||s>=this.children.length)throw new Error("The index "+s+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);Dl(this.children,i,1),this.children.splice(s,0,t),this.onChildrenChange(s)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(){for(var t=arguments,s=[],i=0;i<arguments.length;i++)s[i]=t[i];if(s.length>1)for(var n=0;n<s.length;n++)this.removeChild(s[n]);else{var a=s[0],o=this.children.indexOf(a);if(o===-1)return null;a.parent=null,a.transform._parentID=-1,Dl(this.children,o,1),this._boundsID++,this.onChildrenChange(o),a.emit("removed",this),this.emit("childRemoved",a,this,o)}return s[0]},e.prototype.removeChildAt=function(t){var s=this.getChildAt(t);return s.parent=null,s.transform._parentID=-1,Dl(this.children,t,1),this._boundsID++,this.onChildrenChange(t),s.emit("removed",this),this.emit("childRemoved",s,this,t),s},e.prototype.removeChildren=function(t,s){t===void 0&&(t=0),s===void 0&&(s=this.children.length);var i=t,n=s,a=n-i,o;if(a>0&&a<=n){o=this.children.splice(i,a);for(var u=0;u<o.length;++u)o[u].parent=null,o[u].transform&&(o[u].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var u=0;u<o.length;++u)o[u].emit("removed",this),this.emit("childRemoved",o[u],this,u);return o}else if(a===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,s=0,i=this.children.length;s<i;++s){var n=this.children[s];n._lastSortedIndex=s,!t&&n.zIndex!==0&&(t=!0)}t&&this.children.length>1&&this.children.sort(oq),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,s=this.children.length;t<s;++t){var i=this.children[t];i.visible&&i.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var s=this.children[t];if(!(!s.visible||!s.renderable))if(s.calculateBounds(),s._mask){var i=s._mask.isMaskData?s._mask.maskObject:s._mask;i?(i.calculateBounds(),this._bounds.addBoundsMask(s._bounds,i._bounds)):this._bounds.addBounds(s._bounds)}else s.filterArea?this._bounds.addBoundsArea(s._bounds,s.filterArea):this._bounds.addBounds(s._bounds)}this._bounds.updateID=this._boundsID},e.prototype.getLocalBounds=function(t,s){s===void 0&&(s=!1);var i=r.prototype.getLocalBounds.call(this,t);if(!s)for(var n=0,a=this.children.length;n<a;++n){var o=this.children[n];o.visible&&o.updateTransform()}return i},e.prototype._calculateBounds=function(){},e.prototype._renderWithCulling=function(t){var s=t.renderTexture.sourceFrame;if(s.width>0&&s.height>0){var i,n;if(this.cullArea?(i=this.cullArea,n=this.worldTransform):this._render!==e.prototype._render&&(i=this.getBounds(!0)),i&&s.intersects(i,n))this._render(t);else if(this.cullArea)return;for(var a=0,o=this.children.length;a<o;++a){var u=this.children[a],l=u.cullable;u.cullable=l||!this.cullArea,u.render(t),u.cullable=l}}},e.prototype.render=function(t){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(var s=0,i=this.children.length;s<i;++s)this.children[s].render(t)}},e.prototype.renderAdvanced=function(t){var s=this.filters,i=this._mask;if(s){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var n=0;n<s.length;n++)s[n].enabled&&this._enabledFilters.push(s[n])}var a=s&&this._enabledFilters&&this._enabledFilters.length||i&&(!i.isMaskData||i.enabled&&(i.autoDetect||i.type!==Dt.NONE));if(a&&t.batch.flush(),s&&this._enabledFilters&&this._enabledFilters.length&&t.filter.push(this,this._enabledFilters),i&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(var n=0,o=this.children.length;n<o;++n)this.children[n].render(t)}a&&t.batch.flush(),i&&t.mask.pop(this),s&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(t){r.prototype.destroy.call(this),this.sortDirty=!1;var s=typeof t=="boolean"?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(s)for(var n=0;n<i.length;++n)i[n].destroy(t)},Object.defineProperty(e.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var s=this.getLocalBounds().width;s!==0?this.scale.x=t/s:this.scale.x=1,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var s=this.getLocalBounds().height;s!==0?this.scale.y=t/s:this.scale.y=1,this._height=t},enumerable:!1,configurable:!0}),e}(yt);Zr.prototype.containerUpdateTransform=Zr.prototype.updateTransform;class Gh{__init(){this.tileAnim=[0,0]}__init2(){this.dontUseTransform=!1}constructor(e){Gh.prototype.__init.call(this),Gh.prototype.__init2.call(this),this.renderer=e,this.tileAnim=[0,0]}static getInstance(e){return e.plugins.tilemap||(e.plugins.tilemap=new Gh(e)),e.plugins.tilemap}}const $f={TEXTURES_PER_TILEMAP:16,TEXTILE_DIMEN:1024,TEXTILE_UNITS:1,TEXTILE_SCALE_MODE:Ds.LINEAR,use32bitIndex:!1,DO_CLEAR:!0,get maxTextures(){return this.MAX_TEXTURES},set maxTextures(r){this.MAX_TEXTURES=r},get boundSize(){return this.TEXTURE_TILE_DIMEN},set boundSize(r){this.TILE_TEXTURE_DIMEN=r},get boundCountPerBuffer(){return this.TEXTILE_UNITS},set boundCountPerBuffer(r){this.TEXTILE_UNITS=r}};function oc(r,e){return r??e()}var Ge;(function(r){r[r.U=0]="U";const t=0+1;r[r.V=t]="V";const s=t+1;r[r.X=s]="X";const i=s+1;r[r.Y=i]="Y";const n=i+1;r[r.TILE_WIDTH=n]="TILE_WIDTH";const a=n+1;r[r.TILE_HEIGHT=a]="TILE_HEIGHT";const o=a+1;r[r.ROTATE=o]="ROTATE";const u=o+1;r[r.ANIM_X=u]="ANIM_X";const l=u+1;r[r.ANIM_Y=l]="ANIM_Y";const d=l+1;r[r.TEXTURE_INDEX=d]="TEXTURE_INDEX";const c=d+1;r[r.ANIM_COUNT_X=c]="ANIM_COUNT_X";const _=c+1;r[r.ANIM_COUNT_Y=_]="ANIM_COUNT_Y";const f=_+1;r[r.ANIM_DIVISOR=f]="ANIM_DIVISOR";const g=f+1;r[r.ALPHA=g]="ALPHA"})(Ge||(Ge={}));const Ar=Object.keys(Ge).length/2;class Xt extends Zr{__init(){this.shadowColor=new Float32Array([0,0,0,.5])}__init2(){this._globalMat=null}__init3(){this.tileAnim=null}__init4(){this.modificationMarker=0}__init5(){this.offsetX=0}__init6(){this.offsetY=0}__init7(){this.compositeParent=!1}__init8(){this.tilemapBounds=new xh}__init9(){this.hasAnimatedTile=!1}__init10(){this.pointsBuf=[]}constructor(e){super(),Xt.prototype.__init.call(this),Xt.prototype.__init2.call(this),Xt.prototype.__init3.call(this),Xt.prototype.__init4.call(this),Xt.prototype.__init5.call(this),Xt.prototype.__init6.call(this),Xt.prototype.__init7.call(this),Xt.prototype.__init8.call(this),Xt.prototype.__init9.call(this),Xt.prototype.__init10.call(this),Xt.prototype.__init11.call(this),Xt.prototype.__init12.call(this),Xt.prototype.__init13.call(this),Xt.prototype.__init14.call(this),Xt.prototype.__init15.call(this),Xt.prototype.__init16.call(this),this.setTileset(e)}getTileset(){return this.tileset}setTileset(e=[]){Array.isArray(e)||(e=[e]);for(let t=0;t<e.length;t++)e[t].baseTexture&&(e[t]=e[t].baseTexture);return this.tileset=e,this}clear(){return this.pointsBuf.length=0,this.modificationMarker=0,this.tilemapBounds.clear(),this.hasAnimatedTile=!1,this}tile(e,t,s,i={}){let n,a=-1;if(typeof e=="number")a=e,n=this.tileset[a];else{let O;typeof e=="string"?O=Re.from(e):O=e;const A=this.tileset;for(let C=0;C<A.length;C++)if(A[C]===O.castToBaseTexture()){a=C;break}"baseTexture"in O&&(i.u=oc(i.u,()=>O.frame.x),i.v=oc(i.v,()=>O.frame.y),i.tileWidth=oc(i.tileWidth,()=>O.orig.width),i.tileHeight=oc(i.tileHeight,()=>O.orig.height)),n=O.castToBaseTexture()}if(!n||a<0)return console.error("The tile texture was not found in the tilemap tileset."),this;const{u:o=0,v:u=0,tileWidth:l=n.realWidth,tileHeight:d=n.realHeight,animX:c=0,animY:_=0,rotate:f=0,animCountX:g=1024,animCountY:I=1024,animDivisor:p=1,alpha:R=1}=i,S=this.pointsBuf;return this.hasAnimatedTile=this.hasAnimatedTile||c>0||_>0,S.push(o),S.push(u),S.push(t),S.push(s),S.push(l),S.push(d),S.push(f),S.push(c|0),S.push(_|0),S.push(a),S.push(g),S.push(I),S.push(p),S.push(R),this.tilemapBounds.addFramePad(t,s,t+l,s+d,0,0),this}tileRotate(e){const t=this.pointsBuf;t[t.length-(Ar-Ge.TEXTURE_INDEX)]=e}tileAnimX(e,t){const s=this.pointsBuf;s[s.length-(Ar-Ge.ANIM_X)]=e,s[s.length-(Ar-Ge.ANIM_COUNT_X)]=t}tileAnimY(e,t){const s=this.pointsBuf;s[s.length-(Ar-Ge.ANIM_Y)]=e,s[s.length-(Ar-Ge.ANIM_COUNT_Y)]=t}tileAnimDivisor(e){const t=this.pointsBuf;t[t.length-(Ar-Ge.ANIM_DIVISOR)]=e}tileAlpha(e){const t=this.pointsBuf;t[t.length-(Ar-Ge.ALPHA)]=e}__init11(){this.renderCanvas=e=>{const t=Gh.getInstance(e);if(t&&!t.dontUseTransform){const s=this.worldTransform;e.context.setTransform(s.a,s.b,s.c,s.d,s.tx*e.resolution,s.ty*e.resolution)}this.renderCanvasCore(e)}}renderCanvasCore(e){if(this.tileset.length===0)return;const t=this.pointsBuf,s=this.tileAnim||e.plugins.tilemap&&e.plugins.tilemap.tileAnim;e.context.fillStyle="#000000";for(let i=0,n=t.length;i<n;i+=Ar){let a=t[i+Ge.U],o=t[i+Ge.V];const u=t[i+Ge.X],l=t[i+Ge.Y],d=t[i+Ge.TILE_WIDTH],c=t[i+Ge.TILE_HEIGHT];a+=t[i+Ge.ANIM_X]*s[0],o+=t[i+Ge.ANIM_Y]*s[1];const _=t[i+Ge.TEXTURE_INDEX],f=t[i+Ge.ALPHA];_>=0&&this.tileset[_]?(e.context.globalAlpha=f,e.context.drawImage(this.tileset[_].getDrawableSource(),a,o,d,c,u,l,d,c)):(e.context.globalAlpha=.5,e.context.fillRect(u,l,d,c)),e.context.globalAlpha=1}}__init12(){this.vbId=0}__init13(){this.vb=null}__init14(){this.vbBuffer=null}__init15(){this.vbArray=null}__init16(){this.vbInts=null}destroyVb(){this.vb&&(this.vb.destroy(),this.vb=null)}render(e){const t=e.plugins.tilemap,s=t.getShader();e.batch.setObjectRenderer(t),this._globalMat=s.uniforms.projTransMatrix,e.globalUniforms.uniforms.projectionMatrix.copyTo(this._globalMat).append(this.worldTransform),s.uniforms.shadowColor=this.shadowColor,s.uniforms.animationFrame=this.tileAnim||t.tileAnim,this.renderWebGLCore(e,t)}renderWebGLCore(e,t){const s=this.pointsBuf;if(s.length===0)return;const i=s.length/Ar,n=t.getShader(),a=this.tileset;if(a.length===0)return;t.bindTileTextures(e,a),e.shader.bind(n,!1);let o=this.vb;o||(o=t.createVb(),this.vb=o,this.vbId=o.id,this.vbBuffer=null,this.modificationMarker=0),t.checkIndexBuffer(i,o);const u=o.getBuffer("aVertexPosition"),l=i*o.vertPerQuad;if(l!==0){if(this.modificationMarker!==l){this.modificationMarker=l;const d=o.stride*l;if(!this.vbBuffer||this.vbBuffer.byteLength<d){let p=o.stride;for(;p<d;)p*=2;this.vbBuffer=new ArrayBuffer(p),this.vbArray=new Float32Array(this.vbBuffer),this.vbInts=new Uint32Array(this.vbBuffer),u.update(this.vbBuffer)}const c=this.vbArray;let _=0,f=0,g=this.offsetX,I=this.offsetY;for(let p=0;p<s.length;p+=Ar){this.compositeParent&&(f=s[p+Ge.TEXTURE_INDEX],g=0,I=0);const S=s[p+Ge.X],O=s[p+Ge.Y],A=s[p+Ge.TILE_WIDTH],C=s[p+Ge.TILE_HEIGHT],M=s[p+Ge.U]+g,N=s[p+Ge.V]+I;let L=s[p+Ge.ROTATE];const b=s[p+Ge.ANIM_X],D=s[p+Ge.ANIM_Y],x=s[p+Ge.ANIM_COUNT_X]||1024,q=s[p+Ge.ANIM_COUNT_Y]||1024,$=b+x*2048,Te=D+q*2048,j=s[p+Ge.ANIM_DIVISOR],Q=s[p+Ge.ALPHA];let oe,$t,Gt,K,ae,De,je,Le;if(L===0)oe=M,$t=N,Gt=M+A,K=N,ae=M+A,De=N+C,je=M,Le=N+C;else{let Be=A/2,Xe=C/2;L%4!==0&&(Be=C/2,Xe=A/2);const ht=M+Be,gt=N+Xe;L=we.add(L,we.NW),oe=ht+Be*we.uX(L),$t=gt+Xe*we.uY(L),L=we.add(L,2),Gt=ht+Be*we.uX(L),K=gt+Xe*we.uY(L),L=we.add(L,2),ae=ht+Be*we.uX(L),De=gt+Xe*we.uY(L),L=we.add(L,2),je=ht+Be*we.uX(L),Le=gt+Xe*we.uY(L)}c[_++]=S,c[_++]=O,c[_++]=oe,c[_++]=$t,c[_++]=M+.5,c[_++]=N+.5,c[_++]=M+A-.5,c[_++]=N+C-.5,c[_++]=$,c[_++]=Te,c[_++]=f,c[_++]=j,c[_++]=Q,c[_++]=S+A,c[_++]=O,c[_++]=Gt,c[_++]=K,c[_++]=M+.5,c[_++]=N+.5,c[_++]=M+A-.5,c[_++]=N+C-.5,c[_++]=$,c[_++]=Te,c[_++]=f,c[_++]=j,c[_++]=Q,c[_++]=S+A,c[_++]=O+C,c[_++]=ae,c[_++]=De,c[_++]=M+.5,c[_++]=N+.5,c[_++]=M+A-.5,c[_++]=N+C-.5,c[_++]=$,c[_++]=Te,c[_++]=f,c[_++]=j,c[_++]=Q,c[_++]=S,c[_++]=O+C,c[_++]=je,c[_++]=Le,c[_++]=M+.5,c[_++]=N+.5,c[_++]=M+A-.5,c[_++]=N+C-.5,c[_++]=$,c[_++]=Te,c[_++]=f,c[_++]=j,c[_++]=Q}u.update(c)}e.geometry.bind(o,n),e.geometry.draw(Hr.TRIANGLES,i*6,0)}}isModified(e){return!!(this.modificationMarker!==this.pointsBuf.length||e&&this.hasAnimatedTile)}clearModify(){this.modificationMarker=this.pointsBuf.length}_calculateBounds(){const{minX:e,minY:t,maxX:s,maxY:i}=this.tilemapBounds;this._bounds.addFrame(this.transform,e,t,s,i)}getLocalBounds(e){return this.children.length===0?this.tilemapBounds.getRectangle(e):super.getLocalBounds.call(this,e)}destroy(e){super.destroy(e),this.destroyVb()}addFrame(e,t,s,i,n){return this.tile(e,t,s,{animX:i,animY:n}),!0}addRect(e,t,s,i,n,a,o,u=0,l=0,d=0,c=1024,_=1024,f=1,g=1){return this.tile(e,i,n,{u:t,v:s,tileWidth:a,tileHeight:o,animX:u,animY:l,rotate:d,animCountX:c,animCountY:_,animDivisor:f,alpha:g})}}function hq(r){let e="";e+=`
`,e+=`
`,e+="if(vTextureId <= -1.0) {",e+=`
	color = shadowColor;`,e+=`
}`;for(let t=0;t<r;t++)e+=`
else `,t<r-1&&(e+=`if(textureId == ${t}.0)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${t}], textureCoord * uSamplerSize[${t}]);`,e+=`
}`;return e+=`
`,e+=`
`,e}function uq(r,e){const t=[];for(let i=0;i<e;i++)t[i]=i;r.uniforms.uSamplers=t;const s=[];for(let i=0;i<e;i++)s.push(1/2048),s.push(1/2048);r.uniforms.uSamplerSize=s}function lq(r,e){return e.replace(/%count%/gi,`${r}`).replace(/%forloop%/gi,hq(r))}const cq=`#version 100
precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aFrame;
attribute vec2 aAnim;
attribute float aAnimDivisor;
attribute float aTextureId;
attribute float aAlpha;

uniform mat3 projTransMatrix;
uniform vec2 animationFrame;

varying vec2 vTextureCoord;
varying float vTextureId;
varying vec4 vFrame;
varying float vAlpha;

void main(void)
{
   gl_Position = vec4((projTransMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vec2 animCount = floor((aAnim + 0.5) / 2048.0);
   vec2 animFrameOffset = aAnim - animCount * 2048.0;
   vec2 currentFrame = floor(animationFrame / aAnimDivisor);
   vec2 animOffset = animFrameOffset * floor(mod(currentFrame + 0.5, animCount));

   vTextureCoord = aTextureCoord + animOffset;
   vFrame = aFrame + vec4(animOffset, animOffset);
   vTextureId = aTextureId;
   vAlpha = aAlpha;
}
`,_q=`#version 100
#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
varying vec2 vTextureCoord;
varying vec4 vFrame;
varying float vTextureId;
varying float vAlpha;
uniform vec4 shadowColor;
uniform sampler2D uSamplers[%count%];
uniform vec2 uSamplerSize[%count%];

void main(void)
{
   vec2 textureCoord = clamp(vTextureCoord, vFrame.xy, vFrame.zw);
   float textureId = floor(vTextureId + 0.5);

   vec4 color;
   %forloop%
   gl_FragColor = color * vAlpha;
}
`;class eg extends ta{__init(){this.maxTextures=0}constructor(e){super(new jl(cq,lq(e,_q)),{animationFrame:new Float32Array(2),uSamplers:[],uSamplerSize:[],projTransMatrix:new Ye}),eg.prototype.__init.call(this),this.maxTextures=e,uq(this,this.maxTextures)}}class fo extends xl{__init2(){this.vertSize=13}__init3(){this.vertPerQuad=4}__init4(){this.stride=this.vertSize*4}__init5(){this.lastTimeAccess=0}constructor(){super(),fo.prototype.__init2.call(this),fo.prototype.__init3.call(this),fo.prototype.__init4.call(this),fo.prototype.__init5.call(this);const e=this.buf=new vs(new Float32Array(2),!0,!1);this.addAttribute("aVertexPosition",e,0,!1,0,this.stride,0).addAttribute("aTextureCoord",e,0,!1,0,this.stride,2*4).addAttribute("aFrame",e,0,!1,0,this.stride,4*4).addAttribute("aAnim",e,0,!1,0,this.stride,8*4).addAttribute("aTextureId",e,0,!1,0,this.stride,10*4).addAttribute("aAnimDivisor",e,0,!1,0,this.stride,11*4).addAttribute("aAlpha",e,0,!1,0,this.stride,12*4)}}class go extends Bl{__init(){this.tileAnim=[0,0]}__init2(){this.ibLen=0}__init3(){this.indexBuffer=null}__init4(){this.textiles=[]}constructor(e){super(e),go.prototype.__init.call(this),go.prototype.__init2.call(this),go.prototype.__init3.call(this),go.prototype.__init4.call(this),this.shader=new eg($f.TEXTURES_PER_TILEMAP),this.indexBuffer=new vs(void 0,!0,!0),this.checkIndexBuffer(2e3),this.makeTextiles()}bindTileTextures(e,t){const s=t.length,i=this.shader,n=$f.TEXTURES_PER_TILEMAP,a=i.uniforms.uSamplerSize;if(!(s>$f.TEXTILE_UNITS*n)){for(let o=0;o<t.length;o++){const u=t[o];if(!u||!u.valid)return;e.texture.bind(t[o],o),a[o*2]=1/t[o].realWidth,a[o*2+1]=1/t[o].realHeight}i.uniforms.uSamplerSize=a}}start(){}createVb(){const e=new fo;return e.addIndex(this.indexBuffer),e.lastTimeAccess=Date.now(),e}getShader(){return this.shader}destroy(){super.destroy(),this.shader=null}checkIndexBuffer(e,t=null){const s=e*6;s<=this.ibLen||(this.ibLen=s,this.indexBuffer.update(B6(e,void 0)))}makeTextiles(){}}_f.registerPlugin("tilemap",go);class Wv extends so{constructor(e){super(`attribute vec2 aVertexPosition;
            attribute vec2 aTextureCoord;
            
            uniform mat3 projectionMatrix;
            
            varying vec2 vTextureCoord;
            
            void main(void)
            {
                gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
                vTextureCoord = aTextureCoord;
            }`,`varying vec2 vTextureCoord;
            uniform sampler2D uSampler;
            
            uniform float gamma;
            uniform float contrast;
            uniform float saturation;
            uniform float brightness;
            uniform float red;
            uniform float green;
            uniform float blue;
            uniform float alpha;
            
            void main(void)
            {
                vec4 c = texture2D(uSampler, vTextureCoord);
            
                if (c.a > 0.0) {
                    c.rgb /= c.a;
            
                    vec3 rgb = pow(c.rgb, vec3(1. / gamma));
                    rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, saturation), contrast);
                    rgb.r *= red;
                    rgb.g *= green;
                    rgb.b *= blue;
                    c.rgb = rgb * brightness;
            
                    c.rgb *= c.a;
                }
            
                gl_FragColor = c * alpha;
            }`),this.gamma=1,this.saturation=1,this.contrast=1,this.brightness=1,this.red=1,this.green=1,this.blue=1,this.alpha=1,Object.assign(this,e)}apply(e,t,s,i){this.uniforms.gamma=Math.max(this.gamma,1e-4),this.uniforms.saturation=this.saturation,this.uniforms.contrast=this.contrast,this.uniforms.brightness=this.brightness,this.uniforms.red=this.red,this.uniforms.green=this.green,this.uniforms.blue=this.blue,this.uniforms.alpha=this.alpha,e.applyFilter(this,t,s,i)}}const dq=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,fq=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform sampler2D mask;
uniform int fromChannel;
uniform int toChannel;

void main(void) {
    vec4 maskColor = texture2D(mask, vTextureCoord);
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec4 adjusted = currentColor;

    if(maskColor.r == 0.0 && maskColor.g == 0.0 && maskColor.b == 0.0)
    {
        adjusted.a = 0.0;
    }

    gl_FragColor = vec4(adjusted.r, adjusted.g, adjusted.b, adjusted.a);
}`;class Bh extends so{constructor(e,t,s){super(dq,fq,{mask:e.castToBaseTexture(),fromChannel:t,toChannel:s})}}Bh.CHANNEL_RED=0,Bh.CHANNEL_GREEN=1,Bh.CHANNEL_BLUE=2,Bh.CHANNEL_ALPHA=3;/*!
 * @pixi/app - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/app is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var gq=function(){function r(){}return r.init=function(e){var t=this;Object.defineProperty(this,"resizeTo",{set:function(s){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=s,s&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){t._resizeTo&&(t.cancelResize(),t._resizeId=requestAnimationFrame(function(){return t.resize()}))},this.cancelResize=function(){t._resizeId&&(cancelAnimationFrame(t._resizeId),t._resizeId=null)},this.resize=function(){if(t._resizeTo){t.cancelResize();var s,i;if(t._resizeTo===globalThis.window)s=globalThis.innerWidth,i=globalThis.innerHeight;else{var n=t._resizeTo,a=n.clientWidth,o=n.clientHeight;s=a,i=o}t.renderer.resize(s,i)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null},r.destroy=function(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},r.extension=Lt.Application,r}(),zv=function(){function r(e){var t=this;this.stage=new Zr,e=Object.assign({forceCanvas:!1},e),this.renderer=mK(e),r._plugins.forEach(function(s){s.init.call(t,e)})}return r.registerPlugin=function(e){Wr("6.5.0","Application.registerPlugin() is deprecated, use extensions.add()"),Pi.add({type:Lt.Application,ref:e})},r.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(r.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),r.prototype.destroy=function(e,t){var s=this,i=r._plugins.slice(0);i.reverse(),i.forEach(function(n){n.destroy.call(s)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null},r._plugins=[],r}();Pi.handleByList(Lt.Application,zv._plugins),Pi.add(gq);class _t extends zv{constructor(e){super(e),_t.INSTANCE||(_t.INSTANCE=this)}static get instance(){return this.INSTANCE||null}}_t.INSTANCE=null;const Jr=()=>{var r;return((r=_t.instance)===null||r===void 0?void 0:r.ticker)||null},Xv=()=>{var r;return((r=Jr())===null||r===void 0?void 0:r.FPS)||0},ve=()=>{var r;return((r=Jr())===null||r===void 0?void 0:r.lastTime)||0};/*!
 * @pixi/filter-alpha - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/filter-alpha is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var tg=function(r,e){return tg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var i in s)s.hasOwnProperty(i)&&(t[i]=s[i])},tg(r,e)};function Eq(r,e){tg(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var mq=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`,sg=function(r){Eq(e,r);function e(t){t===void 0&&(t=1);var s=r.call(this,TK,mq,{uAlpha:1})||this;return s.alpha=t,s}return Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(so);class pq extends sg{}class Kv extends Qe{}class nr extends Zr{}class qv extends so{}class Hh extends k{}class Iq extends _h{}class Tq extends he{}class Rq extends kt{}/*!
 * @pixi/sprite - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/sprite is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var rg=function(r,e){return rg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var i in s)s.hasOwnProperty(i)&&(t[i]=s[i])},rg(r,e)};function vq(r,e){rg(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var kh=new k,Oq=new Uint16Array([0,1,2,0,2,3]),Ze=function(r){vq(e,r);function e(t){var s=r.call(this)||this;return s._anchor=new eo(s._onAnchorUpdate,s,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),s._texture=null,s._width=0,s._height=0,s._tint=null,s._tintRGB=null,s.tint=16777215,s.blendMode=se.NORMAL,s._cachedTint=16777215,s.uvs=null,s.texture=t||Re.EMPTY,s.vertexData=new Float32Array(8),s.vertexTrimmedData=null,s._transformID=-1,s._textureID=-1,s._transformTrimmedID=-1,s._textureTrimmedID=-1,s.indices=Oq,s.pluginName="batch",s.isSprite=!0,s._roundPixels=J.ROUND_PIXELS,s}return e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Ja(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Ja(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(!(this._transformID===this.transform._worldID&&this._textureID===t._updateID)){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var s=this.transform.worldTransform,i=s.a,n=s.b,a=s.c,o=s.d,u=s.tx,l=s.ty,d=this.vertexData,c=t.trim,_=t.orig,f=this._anchor,g=0,I=0,p=0,R=0;if(c?(I=c.x-f._x*_.width,g=I+c.width,R=c.y-f._y*_.height,p=R+c.height):(I=-f._x*_.width,g=I+_.width,R=-f._y*_.height,p=R+_.height),d[0]=i*I+a*R+u,d[1]=o*R+n*I+l,d[2]=i*g+a*R+u,d[3]=o*R+n*g+l,d[4]=i*g+a*p+u,d[5]=o*p+n*g+l,d[6]=i*I+a*p+u,d[7]=o*p+n*I+l,this._roundPixels)for(var S=J.RESOLUTION,O=0;O<d.length;++O)d[O]=Math.round((d[O]*S|0)/S)}},e.prototype.calculateTrimmedVertices=function(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,s=this.vertexTrimmedData,i=t.orig,n=this._anchor,a=this.transform.worldTransform,o=a.a,u=a.b,l=a.c,d=a.d,c=a.tx,_=a.ty,f=-n._x*i.width,g=f+i.width,I=-n._y*i.height,p=I+i.height;s[0]=o*f+l*I+c,s[1]=d*I+u*f+_,s[2]=o*g+l*I+c,s[3]=d*I+u*g+_,s[4]=o*g+l*p+c,s[5]=d*p+u*g+_,s[6]=o*f+l*p+c,s[7]=d*p+u*f+_},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,s=this._texture.orig;!t||t.width===s.width&&t.height===s.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(t){return this.children.length===0?(this._localBounds||(this._localBounds=new xh),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new he),t=this._localBoundsRect),this._localBounds.getRectangle(t)):r.prototype.getLocalBounds.call(this,t)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,kh);var s=this._texture.orig.width,i=this._texture.orig.height,n=-s*this.anchor.x,a=0;return kh.x>=n&&kh.x<n+s&&(a=-i*this.anchor.y,kh.y>=a&&kh.y<a+i)},e.prototype.destroy=function(t){r.prototype.destroy.call(this,t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null;var s=typeof t=="boolean"?t:t&&t.texture;if(s){var i=typeof t=="boolean"?t:t&&t.baseTexture;this._texture.destroy(!!i)}this._texture=null},e.from=function(t,s){var i=t instanceof Re?t:Re.from(t,s);return new e(i)},Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var s=Ja(this.scale.x)||1;this.scale.x=s*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var s=Ja(this.scale.y)||1;this.scale.y=s*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||Re.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),e}(Zr);class ot extends Ze{}class Sq extends Kl{}class ig extends Re{}class Aq extends Xt{}const yq=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Cq=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform sampler2D lut;
uniform int channel;

void main(void) {
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec4 adjusted = currentColor;

    if(currentColor.a > 0.0)
    {
        if(channel == 0)
        {
            adjusted = texture2D(lut, vec2((currentColor.r * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 1) {
            adjusted = texture2D(lut, vec2((currentColor.g * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 2) {
            adjusted = texture2D(lut, vec2((currentColor.b * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 3) {
            adjusted = texture2D(lut, vec2((currentColor.a * 255.0 + 0.5) / 256.0, 0.5));
        }
    }

    gl_FragColor = vec4(adjusted.r, adjusted.g, adjusted.b, currentColor.a);
}`;class Ys extends qv{constructor(e,t=Ys.CHANNEL_RED){super(yq,Cq),this._channel=t;let s=[];s=this.getLutForPalette(e),this._lut=Kv.fromBuffer(Uint8Array.from(s),s.length/4,1,{mipmap:0,scaleMode:0}),this.uniforms.lut=this._lut,this.uniforms.channel=this._channel}getLutForPalette(e){const t=[];for(let s=0;s<e.length;s++)t[s*4+Ys.CHANNEL_RED]=e[s]>>16&255,t[s*4+Ys.CHANNEL_GREEN]=e[s]>>8&255,t[s*4+Ys.CHANNEL_BLUE]=e[s]&255,t[s*4+Ys.CHANNEL_ALPHA]=e[s]>>24&255;return t}get lut(){return this._lut}get channel(){return this._channel}}Ys.CHANNEL_RED=0,Ys.CHANNEL_GREEN=1,Ys.CHANNEL_BLUE=2,Ys.CHANNEL_ALPHA=3;/*!
 * @pixi/interaction - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/interaction is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Qv=function(){function r(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new k,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(r.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),r.prototype.getLocalPosition=function(e,t,s){return e.worldTransform.applyInverse(s||this.global,t)},r.prototype.copyEvent=function(e){"isPrimary"in e&&e.isPrimary&&(this.isPrimary=!0),this.button="button"in e&&e.button;var t="buttons"in e&&e.buttons;this.buttons=Number.isInteger(t)?t:"which"in e&&e.which,this.width="width"in e&&e.width,this.height="height"in e&&e.height,this.tiltX="tiltX"in e&&e.tiltX,this.tiltY="tiltY"in e&&e.tiltY,this.pointerType="pointerType"in e&&e.pointerType,this.pressure="pressure"in e&&e.pressure,this.rotationAngle="rotationAngle"in e&&e.rotationAngle,this.twist="twist"in e&&e.twist||0,this.tangentialPressure="tangentialPressure"in e&&e.tangentialPressure||0},r.prototype.reset=function(){this.isPrimary=!1},r}();/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var ng=function(r,e){return ng=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var i in s)s.hasOwnProperty(i)&&(t[i]=s[i])},ng(r,e)};function Mq(r,e){ng(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Zv=function(){function r(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return r.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},r.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},r}(),ag=function(){function r(e){this._pointerId=e,this._flags=r.FLAGS.NONE}return r.prototype._doSet=function(e,t){t?this._flags=this._flags|e:this._flags=this._flags&~e},Object.defineProperty(r.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"flags",{get:function(){return this._flags},set:function(e){this._flags=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"none",{get:function(){return this._flags===r.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"over",{get:function(){return(this._flags&r.FLAGS.OVER)!==0},set:function(e){this._doSet(r.FLAGS.OVER,e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"rightDown",{get:function(){return(this._flags&r.FLAGS.RIGHT_DOWN)!==0},set:function(e){this._doSet(r.FLAGS.RIGHT_DOWN,e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"leftDown",{get:function(){return(this._flags&r.FLAGS.LEFT_DOWN)!==0},set:function(e){this._doSet(r.FLAGS.LEFT_DOWN,e)},enumerable:!1,configurable:!0}),r.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),r}(),Pq=function(){function r(){this._tempPoint=new k}return r.prototype.recursiveFindHit=function(e,t,s,i,n){var a;if(!t||!t.visible)return!1;var o=e.data.global;n=t.interactive||n;var u=!1,l=n,d=!0;if(t.hitArea)i&&(t.worldTransform.applyInverse(o,this._tempPoint),t.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?u=!0:(i=!1,d=!1)),l=!1;else if(t._mask&&i){var c=t._mask.isMaskData?t._mask.maskObject:t._mask;c&&!(!((a=c.containsPoint)===null||a===void 0)&&a.call(c,o))&&(i=!1)}if(d&&t.interactiveChildren&&t.children)for(var _=t.children,f=_.length-1;f>=0;f--){var g=_[f],I=this.recursiveFindHit(e,g,s,i,l);if(I){if(!g.parent)continue;l=!1,I&&(e.target&&(i=!1),u=!0)}}return n&&(i&&!e.target&&!t.hitArea&&t.containsPoint&&t.containsPoint(o)&&(u=!0),t.interactive&&(u&&!e.target&&(e.target=t),s&&s(e,t,!!u))),u},r.prototype.findHit=function(e,t,s,i){this.recursiveFindHit(e,t,s,i,!1)},r}(),Nq={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return this.cursor==="pointer"},set buttonMode(r){r?this.cursor="pointer":this.cursor==="pointer"&&(this.cursor=null)},cursor:null,get trackedPointers(){return this._trackedPointers===void 0&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};yt.mixin(Nq);var hc=1,uc={target:null,data:{global:null}},bq=function(r){Mq(e,r);function e(t,s){var i=r.call(this)||this;return s=s||{},i.renderer=t,i.autoPreventDefault=s.autoPreventDefault!==void 0?s.autoPreventDefault:!0,i.interactionFrequency=s.interactionFrequency||10,i.mouse=new Qv,i.mouse.identifier=hc,i.mouse.global.set(-999999),i.activeInteractionData={},i.activeInteractionData[hc]=i.mouse,i.interactionDataPool=[],i.eventData=new Zv,i.interactionDOMElement=null,i.moveWhenInside=!1,i.eventsAdded=!1,i.tickerAdded=!1,i.mouseOverRenderer=!("PointerEvent"in globalThis),i.supportsTouchEvents="ontouchstart"in globalThis,i.supportsPointerEvents=!!globalThis.PointerEvent,i.onPointerUp=i.onPointerUp.bind(i),i.processPointerUp=i.processPointerUp.bind(i),i.onPointerCancel=i.onPointerCancel.bind(i),i.processPointerCancel=i.processPointerCancel.bind(i),i.onPointerDown=i.onPointerDown.bind(i),i.processPointerDown=i.processPointerDown.bind(i),i.onPointerMove=i.onPointerMove.bind(i),i.processPointerMove=i.processPointerMove.bind(i),i.onPointerOut=i.onPointerOut.bind(i),i.processPointerOverOut=i.processPointerOverOut.bind(i),i.onPointerOver=i.onPointerOver.bind(i),i.cursorStyles={default:"inherit",pointer:"pointer"},i.currentCursorMode=null,i.cursor=null,i.resolution=1,i.delayedEvents=[],i.search=new Pq,i._tempDisplayObject=new Yv,i._eventListenerOptions={capture:!0,passive:!1},i._useSystemTicker=s.useSystemTicker!==void 0?s.useSystemTicker:!0,i.setTargetElement(i.renderer.view,i.renderer.resolution),i}return Object.defineProperty(e.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),e.prototype.hitTest=function(t,s){return uc.target=null,uc.data.global=t,s||(s=this.lastObjectRendered),this.processInteractive(uc,s,null,!0),uc.target},e.prototype.setTargetElement=function(t,s){s===void 0&&(s=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=s,this.addEvents(),this.addTickerListener()},e.prototype.addTickerListener=function(){this.tickerAdded||!this.interactionDOMElement||!this._useSystemTicker||(zr.system.add(this.tickerUpdate,this,$a.INTERACTION),this.tickerAdded=!0)},e.prototype.removeTickerListener=function(){this.tickerAdded&&(zr.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},e.prototype.addEvents=function(){if(!(this.eventsAdded||!this.interactionDOMElement)){var t=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none"),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0}},e.prototype.removeEvents=function(){if(!(!this.eventsAdded||!this.interactionDOMElement)){var t=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1}},e.prototype.tickerUpdate=function(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())},e.prototype.update=function(){if(this.interactionDOMElement){if(this._didMove){this._didMove=!1;return}this.cursor=null;for(var t in this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var s=this.activeInteractionData[t];if(s.originalEvent&&s.pointerType!=="touch"){var i=this.configureInteractionEventForDOMEvent(this.eventData,s.originalEvent,s);this.processInteractive(i,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){t=t||"default";var s=!0;if(globalThis.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(s=!1),this.currentCursorMode!==t){this.currentCursorMode=t;var i=this.cursorStyles[t];if(i)switch(typeof i){case"string":s&&(this.interactionDOMElement.style.cursor=i);break;case"function":i(t);break;case"object":s&&Object.assign(this.interactionDOMElement.style,i);break}else s&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,s,i){(!i.stopPropagationHint||t===i.stopsPropagatingAt)&&(i.currentTarget=t,i.type=s,t.emit(s,i),t[s]&&t[s](i))},e.prototype.delayDispatchEvent=function(t,s,i){this.delayedEvents.push({displayObject:t,eventString:s,eventData:i})},e.prototype.mapPositionToPoint=function(t,s,i){var n;this.interactionDOMElement.parentElement?n=this.interactionDOMElement.getBoundingClientRect():n={x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var a=1/this.resolution;t.x=(s-n.left)*(this.interactionDOMElement.width/n.width)*a,t.y=(i-n.top)*(this.interactionDOMElement.height/n.height)*a},e.prototype.processInteractive=function(t,s,i,n){var a=this.search.findHit(t,s,i,n),o=this.delayedEvents;if(!o.length)return a;t.stopPropagationHint=!1;var u=o.length;this.delayedEvents=[];for(var l=0;l<u;l++){var d=o[l],c=d.displayObject,_=d.eventString,f=d.eventData;f.stopsPropagatingAt===c&&(f.stopPropagationHint=!0),this.dispatchEvent(c,_,f)}return a},e.prototype.onPointerDown=function(t){if(!(this.supportsTouchEvents&&t.pointerType==="touch")){var s=this.normalizeToPointerData(t);if(this.autoPreventDefault&&s[0].isNormalized){var i=t.cancelable||!("cancelable"in t);i&&t.preventDefault()}for(var n=s.length,a=0;a<n;a++){var o=s[a],u=this.getInteractionDataForPointerId(o),l=this.configureInteractionEventForDOMEvent(this.eventData,o,u);if(l.data.originalEvent=t,this.processInteractive(l,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",l),o.pointerType==="touch")this.emit("touchstart",l);else if(o.pointerType==="mouse"||o.pointerType==="pen"){var d=o.button===2;this.emit(d?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,s,i){var n=t.data,a=t.data.identifier;if(i){if(s.trackedPointers[a]||(s.trackedPointers[a]=new ag(a)),this.dispatchEvent(s,"pointerdown",t),n.pointerType==="touch")this.dispatchEvent(s,"touchstart",t);else if(n.pointerType==="mouse"||n.pointerType==="pen"){var o=n.button===2;o?s.trackedPointers[a].rightDown=!0:s.trackedPointers[a].leftDown=!0,this.dispatchEvent(s,o?"rightdown":"mousedown",t)}}},e.prototype.onPointerComplete=function(t,s,i){var n=this.normalizeToPointerData(t),a=n.length,o=t.target;t.composedPath&&t.composedPath().length>0&&(o=t.composedPath()[0]);for(var u=o!==this.interactionDOMElement?"outside":"",l=0;l<a;l++){var d=n[l],c=this.getInteractionDataForPointerId(d),_=this.configureInteractionEventForDOMEvent(this.eventData,d,c);if(_.data.originalEvent=t,this.processInteractive(_,this.lastObjectRendered,i,s||!u),this.emit(s?"pointercancel":"pointerup"+u,_),d.pointerType==="mouse"||d.pointerType==="pen"){var f=d.button===2;this.emit(f?"rightup"+u:"mouseup"+u,_)}else d.pointerType==="touch"&&(this.emit(s?"touchcancel":"touchend"+u,_),this.releaseInteractionDataForPointerId(d.pointerId))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&t.pointerType==="touch"||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,s){var i=t.data,n=t.data.identifier;s.trackedPointers[n]!==void 0&&(delete s.trackedPointers[n],this.dispatchEvent(s,"pointercancel",t),i.pointerType==="touch"&&this.dispatchEvent(s,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&t.pointerType==="touch"||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,s,i){var n=t.data,a=t.data.identifier,o=s.trackedPointers[a],u=n.pointerType==="touch",l=n.pointerType==="mouse"||n.pointerType==="pen",d=!1;if(l){var c=n.button===2,_=ag.FLAGS,f=c?_.RIGHT_DOWN:_.LEFT_DOWN,g=o!==void 0&&o.flags&f;i?(this.dispatchEvent(s,c?"rightup":"mouseup",t),g&&(this.dispatchEvent(s,c?"rightclick":"click",t),d=!0)):g&&this.dispatchEvent(s,c?"rightupoutside":"mouseupoutside",t),o&&(c?o.rightDown=!1:o.leftDown=!1)}i?(this.dispatchEvent(s,"pointerup",t),u&&this.dispatchEvent(s,"touchend",t),o&&((!l||d)&&this.dispatchEvent(s,"pointertap",t),u&&(this.dispatchEvent(s,"tap",t),o.over=!1))):o&&(this.dispatchEvent(s,"pointerupoutside",t),u&&this.dispatchEvent(s,"touchendoutside",t)),o&&o.none&&delete s.trackedPointers[a]},e.prototype.onPointerMove=function(t){if(!(this.supportsTouchEvents&&t.pointerType==="touch")){var s=this.normalizeToPointerData(t);(s[0].pointerType==="mouse"||s[0].pointerType==="pen")&&(this._didMove=!0,this.cursor=null);for(var i=s.length,n=0;n<i;n++){var a=s[n],o=this.getInteractionDataForPointerId(a),u=this.configureInteractionEventForDOMEvent(this.eventData,a,o);u.data.originalEvent=t,this.processInteractive(u,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",u),a.pointerType==="touch"&&this.emit("touchmove",u),(a.pointerType==="mouse"||a.pointerType==="pen")&&this.emit("mousemove",u)}s[0].pointerType==="mouse"&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,s,i){var n=t.data,a=n.pointerType==="touch",o=n.pointerType==="mouse"||n.pointerType==="pen";o&&this.processPointerOverOut(t,s,i),(!this.moveWhenInside||i)&&(this.dispatchEvent(s,"pointermove",t),a&&this.dispatchEvent(s,"touchmove",t),o&&this.dispatchEvent(s,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!(this.supportsTouchEvents&&t.pointerType==="touch")){var s=this.normalizeToPointerData(t),i=s[0];i.pointerType==="mouse"&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var n=this.getInteractionDataForPointerId(i),a=this.configureInteractionEventForDOMEvent(this.eventData,i,n);a.data.originalEvent=i,this.processInteractive(a,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",a),i.pointerType==="mouse"||i.pointerType==="pen"?this.emit("mouseout",a):this.releaseInteractionDataForPointerId(n.identifier)}},e.prototype.processPointerOverOut=function(t,s,i){var n=t.data,a=t.data.identifier,o=n.pointerType==="mouse"||n.pointerType==="pen",u=s.trackedPointers[a];i&&!u&&(u=s.trackedPointers[a]=new ag(a)),u!==void 0&&(i&&this.mouseOverRenderer?(u.over||(u.over=!0,this.delayDispatchEvent(s,"pointerover",t),o&&this.delayDispatchEvent(s,"mouseover",t)),o&&this.cursor===null&&(this.cursor=s.cursor)):u.over&&(u.over=!1,this.dispatchEvent(s,"pointerout",this.eventData),o&&this.dispatchEvent(s,"mouseout",t),u.none&&delete s.trackedPointers[a]))},e.prototype.onPointerOver=function(t){if(!(this.supportsTouchEvents&&t.pointerType==="touch")){var s=this.normalizeToPointerData(t),i=s[0],n=this.getInteractionDataForPointerId(i),a=this.configureInteractionEventForDOMEvent(this.eventData,i,n);a.data.originalEvent=i,i.pointerType==="mouse"&&(this.mouseOverRenderer=!0),this.emit("pointerover",a),(i.pointerType==="mouse"||i.pointerType==="pen")&&this.emit("mouseover",a)}},e.prototype.getInteractionDataForPointerId=function(t){var s=t.pointerId,i;return s===hc||t.pointerType==="mouse"?i=this.mouse:this.activeInteractionData[s]?i=this.activeInteractionData[s]:(i=this.interactionDataPool.pop()||new Qv,i.identifier=s,this.activeInteractionData[s]=i),i.copyEvent(t),i},e.prototype.releaseInteractionDataForPointerId=function(t){var s=this.activeInteractionData[t];s&&(delete this.activeInteractionData[t],s.reset(),this.interactionDataPool.push(s))},e.prototype.configureInteractionEventForDOMEvent=function(t,s,i){return t.data=i,this.mapPositionToPoint(i.global,s.clientX,s.clientY),s.pointerType==="touch"&&(s.globalX=i.global.x,s.globalY=i.global.y),i.originalEvent=s,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var s=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var i=0,n=t.changedTouches.length;i<n;i++){var a=t.changedTouches[i];typeof a.button>"u"&&(a.button=t.touches.length?1:0),typeof a.buttons>"u"&&(a.buttons=t.touches.length?1:0),typeof a.isPrimary>"u"&&(a.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof a.width>"u"&&(a.width=a.radiusX||1),typeof a.height>"u"&&(a.height=a.radiusY||1),typeof a.tiltX>"u"&&(a.tiltX=0),typeof a.tiltY>"u"&&(a.tiltY=0),typeof a.pointerType>"u"&&(a.pointerType="touch"),typeof a.pointerId>"u"&&(a.pointerId=a.identifier||0),typeof a.pressure>"u"&&(a.pressure=a.force||.5),typeof a.twist>"u"&&(a.twist=0),typeof a.tangentialPressure>"u"&&(a.tangentialPressure=0),typeof a.layerX>"u"&&(a.layerX=a.offsetX=a.clientX),typeof a.layerY>"u"&&(a.layerY=a.offsetY=a.clientY),a.isNormalized=!0,s.push(a)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){var o=t;typeof o.isPrimary>"u"&&(o.isPrimary=!0),typeof o.width>"u"&&(o.width=1),typeof o.height>"u"&&(o.height=1),typeof o.tiltX>"u"&&(o.tiltX=0),typeof o.tiltY>"u"&&(o.tiltY=0),typeof o.pointerType>"u"&&(o.pointerType="mouse"),typeof o.pointerId>"u"&&(o.pointerId=hc),typeof o.pressure>"u"&&(o.pressure=.5),typeof o.twist>"u"&&(o.twist=0),typeof o.tangentialPressure>"u"&&(o.tangentialPressure=0),o.isNormalized=!0,s.push(o)}else s.push(t);return s},e.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},e.extension={name:"interaction",type:[Lt.RendererPlugin,Lt.CanvasRendererPlugin]},e}($o);class Dq extends Zv{}class Vh{constructor(){this.RENDER_TEXTURE_POOL=new Map,this.RENDER_TEXTURE_CACHE=[]}clearCache(){this.RENDER_TEXTURE_POOL.forEach(e=>e==null?void 0:e.destroy(!0)),this.RENDER_TEXTURE_POOL.clear(),this.RENDER_TEXTURE_CACHE=[]}clearRenderTexture(e){return e?this.writeToRenderTexture(new Ze(Re.EMPTY),e):null}getTextureIdentifier(e,t,s){return`${s??Vh.DEFAULT_PLANE_ID}:${e}:${t}`}createRenderTexture(e,t,s=null){if(e<0||t<0)return null;if(!s){const n=kt.create({width:e,height:t});return this.RENDER_TEXTURE_CACHE.push(n),n}s=this.getTextureIdentifier(e,t,s);let i=this.RENDER_TEXTURE_POOL.get(s);return i||(i=kt.create({width:e,height:t}),this.RENDER_TEXTURE_CACHE.push(i),this.RENDER_TEXTURE_POOL.set(s,i)),i}createAndFillRenderTexture(e,t,s=null,i=16777215){if(e<0||t<0)return null;const n=this.createRenderTexture(e,t,s);return this.clearAndFillRenderTexture(n,i)}createAndWriteRenderTexture(e,t,s,i=null,n=null){if(e<0||t<0)return null;const a=this.createRenderTexture(e,t,i);return this.writeToRenderTexture(s,a,!0,n)}clearAndFillRenderTexture(e,t=16777215){if(!e)return null;const s=new Ze(Re.WHITE);return s.tint=t,s.width=e.width,s.height=e.height,this.writeToRenderTexture(s,e)}writeToRenderTexture(e,t,s=!0,i=null){return!e||!t?null:(this.getRenderer().render(e,{renderTexture:t,clear:s,transform:i}),t)}getPixels(e,t=null){return this.getExtractor().pixels(e)}getRenderer(){return _t.instance.renderer}getExtractor(){return this.getRenderer().plugins.extract}}Vh.DEFAULT_PLANE_ID="DEFAULT";class Je{static generateTexture(e,t=null,s=null,i=1){return e?(s===null&&(s=J.SCALE_MODE),this.getRenderer().generateTexture(e,{scaleMode:s,resolution:i,region:t})):null}static generateTextureFromImage(e){return e?Re.from(e):null}static generateImage(e){return e?this.getExtractor().image(e):null}static generateImageUrl(e){return e?this.getExtractor().base64(e):null}static generateCanvas(e){return e?this.getExtractor().canvas(e):null}static clearRenderTexture(e){return e?this.writeToRenderTexture(new Ze(Re.EMPTY),e):null}static createRenderTexture(e,t){return e<0||t<0?null:kt.create({width:e,height:t})}static createAndFillRenderTexture(e,t,s=16777215){if(e<0||t<0)return null;const i=this.createRenderTexture(e,t);return this.clearAndFillRenderTexture(i,s)}static createAndWriteRenderTexture(e,t,s,i=null){if(e<0||t<0)return null;const n=this.createRenderTexture(e,t);return this.writeToRenderTexture(s,n,!0,i)}static clearAndFillRenderTexture(e,t=16777215){if(!e)return null;const s=new Ze(Re.WHITE);return s.tint=t,s.width=e.width,s.height=e.height,this.writeToRenderTexture(s,e)}static writeToRenderTexture(e,t,s=!0,i=null){return!e||!t?null:(this.getRenderer().render(e,{renderTexture:t,clear:s,transform:i}),t)}static getPixels(e,t=null){return this.getExtractor().pixels(e)}static getRenderer(){return _t.instance.renderer}static getExtractor(){return this.getRenderer().plugins.extract}}class vn{static createAsset(e,t,s,i,n,a=!1,o=!1,u=!1){const l=vn.GRAPHIC_POOL.length?vn.GRAPHIC_POOL.pop():new vn;return l._name=e,l._source=t||null,s?(l._texture=s,l._initialized=!1):(l._texture=null,l._initialized=!0),l._usesPalette=u,l._x=i,l._y=n,l._flipH=a,l._flipV=o,l._rectangle=null,l}recycle(){this._texture=null,vn.GRAPHIC_POOL.push(this)}initialize(){this._initialized||!this._texture||(this._width=this._texture.width,this._height=this._texture.height,this._initialized=!0)}getImageUrl(){return Je.generateImageUrl(new Ze(this._texture))}get name(){return this._name}get source(){return this._source}get texture(){return this._texture}get usesPalette(){return this._usesPalette}get x(){return this._x}get y(){return this._y}get width(){return this.initialize(),this._width}get height(){return this.initialize(),this._height}get offsetX(){return this._flipH?-this._x:this._x}get offsetY(){return this._flipV?-this._y:this._y}get flipH(){return this._flipH}get flipV(){return this._flipV}get rectangle(){return this._rectangle||(this._rectangle=new he(0,0,this.width,this.height)),this._rectangle}}vn.GRAPHIC_POOL=[];class Jv{constructor(e,t,s){for(this._palette=e;this._palette.length<256;)this._palette.push([0,0,0]);this._primaryColor=t,this._secondaryColor=s}dispose(){}applyPalette(e){var t,s;const i=Je.createAndWriteRenderTexture(e.width,e.height,new Ze(e)),n=Je.getPixels(i);for(let u=0;u<n.length;u+=4){let l=this._palette[n[u+1]];l===void 0&&(l=[0,0,0]),n[u]=l[0],n[u+1]=l[1],n[u+2]=l[2]}const a=(t=i.baseTexture._glTextures[1])===null||t===void 0?void 0:t.texture,o=(s=_t.instance.renderer)===null||s===void 0?void 0:s.gl;return o.bindTexture(o.TEXTURE_2D,a),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,i.width,i.height,0,o.RGBA,o.UNSIGNED_BYTE,n),o.bindTexture(o.TEXTURE_2D,null),i}get primaryColor(){return this._primaryColor}get secondaryColor(){return this._secondaryColor}}class la{constructor(e,t){if(!e)throw new Error("invalid_collection");this._name=e.name,this._baseTexture=t&&t.baseTexture||null,this._data=e,this._textures=new Map,this._assets=new Map,this._palettes=new Map,this._paletteAssetNames=[],t&&this.addLibraryAsset(t.textures),this.define(e)}static removeFileExtension(e){return e.substring(0,e.lastIndexOf("."))||e}dispose(){if(this._palettes){for(const e of this._palettes.values())e.dispose();this._palettes.clear()}if(this._paletteAssetNames&&(this.disposePaletteAssets(),this._paletteAssetNames=null),this._assets){for(const e of this._assets.values())e.recycle();this._assets.clear()}}addReference(){this._referenceCount++,this._referenceTimestamp=ve()}removeReference(){this._referenceCount--,this._referenceCount<=0&&(this._referenceCount=0,this._referenceTimestamp=ve(),this.disposePaletteAssets(!1))}define(e){const t=e.assets,s=e.palettes;t&&this.defineAssets(t),s&&this.definePalettes(s)}defineAssets(e){if(e)for(const t in e){const s=e[t];if(!s)continue;const i=-s.x||0,n=-s.y||0;let a=!1;const o=!1,u=s.usesPalette||!1;let l=s.source||"";s.flipH&&l.length&&(a=!0),l.length||(l=t);const d=this.getLibraryAsset(l);if(!d)continue;let c=this.createAsset(t,l,d,a,o,i,n,u);if(!c){const _=this.getAsset(t);_&&_.name!==_.source&&(c=this.replaceAsset(t,l,d,a,o,i,n,u))}}}definePalettes(e){if(e)for(const t in e){const s=e[t];if(!s)continue;const i=s.id.toString();if(this._palettes.get(i))continue;let n=16777215,a=16777215,o=s.color1;o&&o.length>0&&(n=parseInt(o,16)),o=s.color2,o&&o.length>0&&(a=parseInt(o,16)),this._palettes.set(i,new Jv(s.rgb,n,a))}}createAsset(e,t,s,i,n,a,o,u){if(this._assets.get(e))return!1;const l=vn.createAsset(e,t,s,a,o,i,n,u);return this._assets.set(e,l),!0}replaceAsset(e,t,s,i,n,a,o,u){const l=this._assets.get(e);return l&&(this._assets.delete(e),l.recycle()),this.createAsset(e,t,s,i,n,a,o,u)}getAsset(e){if(!e)return null;const t=this._assets.get(e);return t||null}getAssetWithPalette(e,t){const s=e+"@"+t;let i=this.getAsset(s);if(!i){if(i=this.getAsset(e),!i||!i.usesPalette)return i;const n=this.getPalette(t);if(n){const a=n.applyPalette(i.texture);a&&(this._paletteAssetNames.push(s),this.createAsset(s,i.source+"@"+t,a,i.flipH,i.flipV,i.x,i.y,!1),i=this.getAsset(s))}}return i}getTexture(e){return this._textures.get(e)}getPaletteNames(){return Array.from(this._palettes.keys())}getPaletteColors(e){const t=this.getPalette(e);return t?[t.primaryColor,t.secondaryColor]:null}getPalette(e){if(!e)return null;const t=this._palettes.get(e);return t||null}addAsset(e,t,s,i=0,n=0,a=!1,o=!1){if(!e||!t)return!1;const u=this.getLibraryAsset(e);return u?s?(u.baseTexture=t.baseTexture,u.frame=t.frame,u.trim=t.trim,u.updateUvs(),!0):!1:(this._textures.set(e,t),this.createAsset(e,e,t,a,o,i,n,!1))}disposeAsset(e){const t=this._assets.get(e);if(!t)return;this._assets.delete(e);const s=this.getLibraryAsset(t.source);s&&(this._textures.delete(t.source),s.destroy(!0)),t.recycle()}getLibraryAsset(e){if(!e)return null;e=this._name+"_"+e;const t=this._textures.get(e);return t||null}addLibraryAsset(e){if(e)for(const t in e){const s=e[t];s&&this._textures.set(la.removeFileExtension(t),s)}}disposePaletteAssets(e=!0){if(this._paletteAssetNames&&(e||this._paletteAssetNames.length>la.PALETTE_ASSET_DISPOSE_THRESHOLD)){for(const t of this._paletteAssetNames)this.disposeAsset(t);this._paletteAssetNames=[]}}get referenceCount(){return this._referenceCount}get referenceTimestamp(){return this._referenceTimestamp}get name(){return this._name}get baseTexture(){return this._baseTexture}get data(){return this._data}get textures(){return this._textures}get assets(){return this._assets}}la.PALETTE_ASSET_DISPOSE_THRESHOLD=10;class lc{constructor(){this._textures=new Map,this._collections=new Map}getTexture(e){if(!e)return null;const t=this._textures.get(e);return t||null}setTexture(e,t){!e||!t||this._textures.set(e,t)}getAsset(e){if(!e)return null;for(const t of this._collections.values()){if(!t)continue;const s=t.getAsset(e);if(s)return s}return null}getCollection(e){if(!e)return null;const t=this._collections.get(e);return t||null}createCollection(e,t){if(!e)return null;const s=new la(e,t);if(s){for(const[i,n]of s.textures.entries())this.setTexture(i,n);this._collections.set(s.name,s)}return s}downloadAsset(e){return mt(this,void 0,void 0,function*(){return yield this.downloadAssets([e])})}downloadAssets(e){return mt(this,void 0,void 0,function*(){if(!e||!e.length)return Promise.resolve(!0);try{for(const t of e){const s=yield fetch(t);if(s.status!==200)continue;let i="application/octet-stream";switch(s.headers.has("Content-Type")&&(i=s.headers.get("Content-Type")),i){case"application/octet-stream":{const n=yield s.arrayBuffer(),a=new _o(n);yield this.processAsset(a.baseTexture,a.jsonFile);break}case"image/png":case"image/jpeg":case"image/gif":{const n=yield s.arrayBuffer(),a=If(n),o=Qe.from(`data:${i};base64,${a}`),u=()=>mt(this,void 0,void 0,function*(){const l=new Re(o);this.setTexture(t,l)});o.valid?yield u():yield new Promise((l,d)=>{o.once("update",()=>mt(this,void 0,void 0,function*(){return yield u(),l()}))});break}}}return Promise.resolve(!0)}catch(t){return Y.error(t),Promise.resolve(!1)}})}processAsset(e,t){return mt(this,void 0,void 0,function*(){const s=t.spritesheet;if(!e||!s||!Object.keys(s).length){this.createCollection(t,null);return}const i=()=>mt(this,void 0,void 0,function*(){const n=new Kl(e,s);yield n.parse(),this.createCollection(t,n)});e.valid?yield i():yield new Promise((n,a)=>{e.once("update",()=>mt(this,void 0,void 0,function*(){return yield i(),n()}))})})}get collections(){return this._collections}}lc._INSTANCE=new lc;const Ws=()=>lc._INSTANCE;class $v{constructor(e,t,s){this.name=e,this.textures=t,this.durations=s}}class cc{}cc.UNKNOWN=0,cc.BROWSER=1;class jh{}jh.UNKNOWN=0,jh.FLASH=1,jh.HTML5=2;class zs{}zs.CONNECTION_OPENED="open",zs.CONNECTION_CLOSED="close",zs.CONNECTION_ERROR="error",zs.CONNECTION_MESSAGE="message";class ue{static parseConfiguration(e,t=!1){if(!e)return!1;try{const s=new RegExp(/\${(.*?)}/g);for(const i in e){let n=e[i];typeof n=="string"&&(n=this.interpolate(n,s)),this._definitions.has(i)?t&&this.setValue(i,n):this.setValue(i,n)}return!0}catch(s){return Y.error(s.stack),!1}}static interpolate(e,t=null){t||(t=new RegExp(/\${(.*?)}/g));const s=e.match(t);if(s&&s.length)for(const i of s){const n=this._definitions.get(this.removeInterpolateKey(i));n&&(e=e.replace(i,n))}return e}static removeInterpolateKey(e){return e.replace("${","").replace("}","")}static getValue(e,t=null){let s=this._definitions.get(e);if(s===void 0){if(this._missingKeys.indexOf(e)>=0)return t;this._missingKeys.push(e),Y.warn(`Missing configuration key: ${e}`),s=t}return s}static setValue(e,t){const s=e.split(".");let i=this._config;for(let n=0;n<s.length;n++){const a=s[n].toString();if(n!==s.length-1){i[a]||(i[a]={}),i=i[a];continue}i[a]=t}this._definitions.set(e,t)}static get definitions(){return this._definitions}}ue._definitions=new Map,ue._config={},ue._missingKeys=[];class F{static getExpressionTimeout(e){switch(e=parseInt(e),e){case 1:return 5e3;case 2:return 1400;case 3:return 2e3;case 4:return 2e3;case 5:return 0;case 6:return 700;case 7:return 2e3;case 8:return 1500;case 9:return 1500;case 10:return 1500;default:return 0}}static getExpressionId(e){return F.EXPRESSION_MAP.indexOf(e)}static getExpression(e){return e>F.EXPRESSION_MAP.length?null:F.EXPRESSION_MAP[e]}static getGestureId(e){return F.GESTURE_MAP.indexOf(e)}static getGesture(e){return e>F.GESTURE_MAP.length?null:F.GESTURE_MAP[e]}static idToAvatarActionState(e){return e==="Lay"?"lay":e==="Float"?"float":e==="Swim"?"swim":e==="Sit"?"sit":e==="Respect"?"respect":e==="Wave"?"wave":e==="Idle"?"idle":e==="Dance"?"dance":e==="UseItem"?"usei":e==="CarryItem"?"cri":e==="Talk"?"talk":e==="Sleep"?"Sleep":e==="Move"?"mv":"std"}}F.CARRY_OBJECT="cri",F.DANCE="dance",F.EFFECT="fx",F.EXPRESSION="expression",F.EXPRESSION_BLOW_A_KISS="blow",F.EXPRESSION_CRY="cry",F.EXPRESSION_IDLE="idle",F.EXPRESSION_LAUGH="laugh",F.EXPRESSION_RESPECT="respect",F.EXPRESSION_RIDE_JUMP="ridejump",F.EXPRESSION_SNOWBOARD_OLLIE="sbollie",F.EXPRESSION_SNOWBORD_360="sb360",F.EXPRESSION_WAVE="wave",F.GESTURE="gest",F.GESTURE_AGGRAVATED="agr",F.GESTURE_SAD="sad",F.GESTURE_SMILE="sml",F.GESTURE_SURPRISED="srp",F.GUIDE_STATUS="guide",F.MUTED="muted",F.PET_GESTURE_BLINK="eyb",F.PET_GESTURE_CRAZY="crz",F.PET_GESTURE_JOY="joy",F.PET_GESTURE_MISERABLE="mis",F.PET_GESTURE_PUZZLED="puz",F.PET_GESTURE_TONGUE="tng",F.PLAYING_GAME="playing_game",F.POSTURE="posture",F.POSTURE_FLOAT="float",F.POSTURE_LAY="lay",F.POSTURE_SIT="sit",F.POSTURE_STAND="std",F.POSTURE_SWIM="swim",F.POSTURE_WALK="mv",F.SIGN="sign",F.SLEEP="sleep",F.SNOWWAR_DIE_BACK="swdieback",F.SNOWWAR_DIE_FRONT="swdiefront",F.SNOWWAR_PICK="swpick",F.SNOWWAR_RUN="swrun",F.SNOWWAR_THROW="swthrow",F.TALK="talk",F.BLINK="blink",F.TYPING="typing",F.USE_OBJECT="usei",F.VOTE="vote",F.GESTURE_MAP=["",F.GESTURE_SMILE,F.GESTURE_AGGRAVATED,F.GESTURE_SURPRISED,F.GESTURE_SAD,F.PET_GESTURE_JOY,F.PET_GESTURE_CRAZY,F.PET_GESTURE_TONGUE,F.PET_GESTURE_BLINK,F.PET_GESTURE_MISERABLE,F.PET_GESTURE_PUZZLED],F.EXPRESSION_MAP=["",F.EXPRESSION_WAVE,F.EXPRESSION_BLOW_A_KISS,F.EXPRESSION_LAUGH,F.EXPRESSION_CRY,F.EXPRESSION_IDLE,F.DANCE,F.EXPRESSION_RESPECT,F.EXPRESSION_SNOWBOARD_OLLIE,F.EXPRESSION_SNOWBORD_360,F.EXPRESSION_RIDE_JUMP];class yr{}yr.DIRECTION_TO_ANGLE=[45,90,135,180,225,270,315,0],yr.DIRECTION_IS_FLIPPED=[!1,!1,!1,!1,!0,!0,!0,!1],yr.MIN_DIRECTION=0,yr.MAX_DIRECTION=7;class On{}On.GENERIC="hd",On.HEAD="head",On.TORSO="torso",On.LEGS="legs",On.HOTLOOKS="hotlooks",On.WARDROBE="wardrobe",On.EFFECTS="effects";class Yh{}Yh.OWN_AVATAR_EDITOR=0,Yh.FURNITURE_AVATAR_EDITOR=1,Yh.BOT_EDITOR=2,Yh.DEV_TOOL_EDITOR=3;class og{}og.NOTHING="nothing",og.WARDROBE="wardrobe";class le{}le.BODY="bd",le.SHOES="sh",le.LEGS="lg",le.CHEST="ch",le.WAIST_ACCESSORY="wa",le.CHEST_ACCESSORY="ca",le.HEAD="hd",le.HAIR="hr",le.FACE_ACCESSORY="fa",le.EYE_ACCESSORY="ea",le.HEAD_ACCESSORY="ha",le.HEAD_ACCESSORY_EXTRA="he",le.COAT_CHEST="cc",le.CHEST_PRINT="cp",le.LEFT_HAND_ITEM="li",le.LEFT_HAND="lh",le.LEFT_SLEEVE="ls",le.RIGHT_HAND="rh",le.RIGHT_SLEEVE="rs",le.FACE="fc",le.EYES="ey",le.HAIR_BIG="hrb",le.RIGHT_HAND_ITEM="ri",le.LEFT_COAT_SLEEVE="lc",le.RIGHT_COAT_SLEEVE="rc",le.FIGURE_SETS=[le.SHOES,le.LEGS,le.CHEST,le.WAIST_ACCESSORY,le.CHEST_ACCESSORY,le.HEAD,le.HAIR,le.FACE_ACCESSORY,le.EYE_ACCESSORY,le.HEAD_ACCESSORY,le.HEAD_ACCESSORY_EXTRA,le.COAT_CHEST,le.CHEST_PRINT];class ar{}ar.NONE=0,ar.GUIDE=1,ar.REQUESTER=2;class Cr{}Cr.LARGE="h",Cr.SMALL="sh";class rs{}rs.FULL="full",rs.HEAD="head",rs.BODY="body";class or{}or.VERTICAL="vertical",or.SITTING="sitting",or.HORIZONTAL="horizontal",or.SWIM="swim",or.SNOWWARS_HORIZONTAL="swhorizontal";class Wh{}Wh.TOOL="tool",Wh.COMPONENT="component",Wh.ONLINE_TOOL="online_tool",Wh.LOCAL_ONLY="local_only";class be{}be.DOG=0,be.CAT=1,be.CROCODILE=2,be.TERRIER=3,be.BEAR=4,be.PIG=5,be.LION=6,be.RHINO=7,be.SPIDER=8,be.TURTLE=9,be.CHICKEN=10,be.FROG=11,be.DRAGON=12,be.MONSTER=13,be.MONKEY=14,be.HORSE=15,be.MONSTERPLANT=16,be.BUNNY=17,be.BUNNYEVIL=18,be.BUNNYDEPRESSED=19,be.BUNNYLOVE=20,be.PIGEONGOOD=21,be.PIGEONEVIL=22,be.DEMONMONKEY=23,be.BABYBEAR=24,be.BABYTERRIER=25,be.GNOME=26,be.LEPRECHAUN=27,be.KITTENBABY=28,be.PUPPYBABY=29,be.PIGLETNBABY=30,be.HALOOMPA=31,be.FOOLS=32,be.PTEROSAUR=33,be.VELOCIRAPTOR=34;class Sn{}Sn.NONE=0,Sn.HEART=1,Sn.SMILE=2,Sn.BOBBA=3,Sn.RELATIONSHIP_TYPES=[0,1,2,3],Sn.RELATIONSHIP_NAMES=["None","Heart","Smile","Bobba"];class $r{}$r.HOTEL_VIEW="hotel_view",$r.HOME_ROOM="home_room",$r.NAVIGATOR="navigator",$r.CATALOG="catalog",$r.INVENTORY="inventory",$r.ME_MENU="me_menu",$r.FRIEND_LIST="friendlist";class An{}An.LOVE_LOCK=0,An.CARVE_A_TREE=1,An.FRIENDS_PORTRAIT=2,An.WILD_WEST_WANTED=3,An.HABBOWEEN=4;class _c{}_c.CATALOG="catalog",_c.INVENTORY="inventory";class T{}T.OBJECT_ROOM_ID="object_room_id",T.OBJECT_ACCURATE_Z_VALUE="object_accurate_z_value",T.TILE_CURSOR_HEIGHT="tile_cursor_height",T.FIGURE="figure",T.GENDER="gender",T.OWN_USER="own_user",T.FIGURE_CAN_STAND_UP="figure_can_stand_up",T.FIGURE_VERTICAL_OFFSET="figure_vertical_offset",T.FIGURE_TALK="figure_talk",T.FIGURE_DANCE="figure_dance",T.FIGURE_SLEEP="figure_sleep",T.FIGURE_BLINK="figure_blink",T.FIGURE_EFFECT="figure_effect",T.FIGURE_CARRY_OBJECT="figure_carry_object",T.FIGURE_USE_OBJECT="figure_use_object",T.FIGURE_GESTURE="figure_gesture",T.FIGURE_POSTURE="figure_posture",T.FIGURE_POSTURE_PARAMETER="figure_posture_parameter",T.FIGURE_HIGHLIGHT_ENABLE="figure_highlight_enable",T.FIGURE_HIGHLIGHT="figure_highlight",T.FURNITURE_PURCHASER_NAME="furniture_purchaser_name",T.FURNITURE_PURCHASER_FIGURE="furniture_purchaser_figure",T.STD="std",T.FIGURE_SIGN="figure_sign",T.FIGURE_FLAT_CONTROL="figure_flat_control",T.FIGURE_IS_TYPING="figure_is_typing",T.FIGURE_IS_MUTED="figure_is_muted",T.FIGURE_GAINED_EXPERIENCE="figure_gained_experience",T.FIGURE_EXPERIENCE_TIMESTAMP="figure_experience_timestamp",T.FIGURE_NUMBER_VALUE="figure_number_value",T.FIGURE_IS_PLAYING_GAME="figure_is_playing_game",T.FIGURE_GUIDE_STATUS="figure_guide_status",T.FIGURE_EXPRESSION="figure_expression",T.HEAD_DIRECTION="head_direction",T.FURNITURE_CUSTOM_VARIABLES="furniture_custom_variables",T.FURNITURE_AUTOMATIC_STATE_INDEX="furniture_automatic_state_index",T.FURNITURE_ALWAYS_STACKABLE="furniture_always_stackable",T.FURNITURE_DISABLE_PICKING_ANIMATION="furniture_disable_picking_animation",T.FURNITURE_DATA_FORMAT="furniture_data_format",T.FURNITURE_UNIQUE_SERIAL_NUMBER="furniture_unique_serial_number",T.FURNITURE_UNIQUE_EDITION_SIZE="furniture_unique_edition_size",T.FURNITURE_CRACKABLE_STATE="furniture_crackable_state",T.FURNITURE_CRACKABLE_HITS="furniture_crackable_hits",T.FURNITURE_CRACKABLE_TARGET="furniture_crackable_target",T.FURNITURE_CREDIT_VALUE="furniture_credit_value",T.FURNITURE_DATA="furniture_data",T.FURNITURE_ITEMDATA="furniture_itemdata",T.FURNITURE_COLOR="furniture_color",T.FURNITURE_LIFT_AMOUNT="furniure_lift_amount",T.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID="furniture_guild_customized_guild_id",T.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME="furniture_guild_customized_asset_name",T.FURNITURE_GUILD_CUSTOMIZED_COLOR_1="furniture_guild_customized_color_1",T.FURNITURE_GUILD_CUSTOMIZED_COLOR_2="furniture_guild_customized_color_2",T.FURNITURE_STATE_UPDATE_TIME="furniture_state_update_time",T.FURNITURE_SELECTION_DISABLED="furniture_selection_disabled",T.FURNITURE_SIZE_X="furniture_size_x",T.FURNITURE_SIZE_Y="furniture_size_y",T.FURNITURE_SIZE_Z="furniture_size_z",T.FURNITURE_CENTER_X="furniture_center_x",T.FURNITURE_CENTER_Y="furniture_center_y",T.FURNITURE_CENTER_Z="furniture_center_z",T.FURNITURE_ALLOWED_DIRECTIONS="furniture_allowed_directions",T.FURNITURE_AD_URL="furniture_ad_url",T.FURNITURE_TYPE_ID="furniture_type_id",T.FURNITURE_EXTRAS="furniture_extras",T.FURNITURE_EXPIRY_TIME="furniture_expiry_time",T.FURNITURE_EXPIRTY_TIMESTAMP="furniture_expiry_timestamp",T.FURNITURE_REAL_ROOM_OBJECT="furniture_real_room_object",T.FURNITURE_IS_STICKIE="furniture_is_stickie",T.FURNITURE_BRANDING_IMAGE_STATUS="furniture_branding_image_status",T.FURNITURE_BRANDING_IMAGE_URL="furniture_branding_image_url",T.FURNITURE_BRANDING_URL="furniture_branding_url",T.FURNITURE_BRANDING_OFFSET_X="furniture_branding_offset_x",T.FURNITURE_BRANDING_OFFSET_Y="furniture_branding_offset_y",T.FURNITURE_BRANDING_OFFSET_Z="furniture_branding_offset_z",T.FURNITURE_BRANDING_IS_ANIMATED="furniture_branding_is_animated",T.FURNITURE_BADGE_IMAGE_STATUS="furniture_badge_image_status",T.FURNITURE_BADGE_ASSET_NAME="furniture_badge_asset_name",T.FURNITURE_BADGE_VISIBLE_IN_STATE="furniture_badge_visible_in_state",T.FURNITURE_ALPHA_MULTIPLIER="furniture_alpha_multiplier",T.FURNITURE_USAGE_POLICY="furniture_usage_policy",T.FURNITURE_OWNER_ID="furniture_owner_id",T.FURNITURE_OWNER_NAME="furniture_owner_name",T.FURNITURE_ROOM_BACKGROUND_COLOR_HUE="furniture_room_background_color_hue",T.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION="furniture_room_background_color_saturation",T.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS="furniture_room_background_color_lightness",T.FURNITURE_USES_PLANE_MASK="furniture_uses_plane_mask",T.FURNITURE_PLANE_MASK_TYPE="furniture_plane_mask_type",T.FURNITURE_IS_VARIABLE_HEIGHT="furniture_is_variable_height",T.FURNITURE_VOTE_MAJORITY_RESULT="furniture_vote_majority_result",T.FURNITURE_VOTE_COUNTER_COUNT="furniture_vote_counter_count",T.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED="furniture_soundblock_relative_animation_speed",T.FURNITURE_MANNEQUIN_NAME="furniture_mannequin_name",T.FURNITURE_MANNEQUIN_GENDER="furniture_mannequin_gender",T.FURNITURE_MANNEQUIN_FIGURE="furniture_mannequin_figure",T.FURNITURE_HIGHSCORE_SCORE_TYPE="furniture_highscore_score_type",T.FURNITURE_HIGHSCORE_CLEAR_TYPE="furniture_highscore_clear_type",T.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT="furniture_highscore_data_entry_count",T.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_="furniture_highscore_data_entry_base_users_",T.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_="furniture_highscore_data_entry_base_score_",T.FURNITURE_INTERNAL_LINK="furniture_internal_link",T.FURNITURE_CLOTHING_BOY="furniture_clothing_boy",T.FURNITURE_CLOTHING_GIRL="furniture_clothing_girl",T.FURNITURE_PLANETSYSTEM_DATA="furniture_planetsystem_data",T.FURNITURE_FIREWORKS_DATA="furniture_fireworks_data",T.PET_PALETTE_INDEX="pet_palette_index",T.PET_COLOR="pet_color",T.PET_HEAD_ONLY="pet_head_only",T.PET_CUSTOM_LAYER_IDS="pet_custom_layer_ids",T.PET_CUSTOM_PARTS_IDS="pet_custom_part_ids",T.PET_CUSTOM_PALETTE_IDS="pet_custom_palette_ids",T.PET_IS_RIDING="pet_is_riding",T.PET_TYPE="pet_type",T.PET_ALLOWED_DIRECTIONS="pet_allowed_directions",T.RACE="race",T.ROOM_MAP_DATA="room_map_data",T.ROOM_PLANE_MASK_XML="room_plane_mask_xml",T.ROOM_FLOOR_TYPE="room_floor_type",T.ROOM_WALL_TYPE="room_wall_type",T.ROOM_LANDSCAPE_TYPE="room_landscape_type",T.ROOM_WALL_THICKNESS="room_wall_thickness",T.ROOM_FLOOR_THICKNESS="room_floor_thickness",T.ROOM_FLOOR_HOLE_UPDATE_TIME="room_floor_hole_update_time",T.ROOM_FLOOR_VISIBILITY="room_floor_visibility",T.ROOM_WALL_VISIBILITY="room_wall_visibility",T.ROOM_LANDSCAPE_VISIBILITY="room_landscape_visibility",T.ROOM_DOOR_X="room_door_x",T.ROOM_DOOR_Y="room_door_y",T.ROOM_DOOR_Z="room_door_z",T.ROOM_DOOR_DIR="room_door_dir",T.ROOM_BACKGROUND_COLOR="room_background_color",T.ROOM_COLORIZE_BG_ONLY="room_colorize_bg_only",T.ROOM_RANDOM_SEED="room_random_seed",T.ROOM_WORLD_TYPE="room_world_type",T.ROOM_SELECTED_X="room_selected_x",T.ROOM_SELECTED_Y="room_selected_y",T.ROOM_SELECTED_Z="room_selected_z",T.ROOM_SELECTED_PLANE="room_selected_plane",T.IMAGE_QUERY_SCALE="image_query_scale",T.FURNITURE_FRIENDFURNI_ENGRAVING="furniture_friendfurni_engraving_type",T.SESSION_URL_PREFIX="session_url_prefix",T.SESSION_CURRENT_USER_ID="session_current_user_id";class hg{}hg.UNIQUE_SET=256;class Ui{constructor(){this._flags=0,this._uniqueNumber=0,this._uniqueSeries=0}parseWrapper(e){(this._flags&hg.UNIQUE_SET)>0&&(this._uniqueNumber=e.readInt(),this._uniqueSeries=e.readInt())}initializeFromRoomObjectModel(e){this._uniqueNumber=e.getValue(T.FURNITURE_UNIQUE_SERIAL_NUMBER),this._uniqueSeries=e.getValue(T.FURNITURE_UNIQUE_EDITION_SIZE)}writeRoomObjectModel(e){e&&(e.setValue(T.FURNITURE_UNIQUE_SERIAL_NUMBER,this._uniqueNumber),e.setValue(T.FURNITURE_UNIQUE_EDITION_SIZE,this._uniqueSeries))}getLegacyString(){return""}compare(e){return!1}get state(){const e=parseInt(this.getLegacyString());return isNaN(e)?0:e}get isUnique(){return this._uniqueSeries>0}get uniqueNumber(){return this._uniqueNumber}set uniqueNumber(e){this._uniqueNumber=e}get uniqueSeries(){return this._uniqueSeries}set uniqueSeries(e){this._uniqueSeries=e}get rarityLevel(){return-1}get flags(){return this._flags}set flags(e){this._flags=e}}class is{}is.LEGACY_KEY=0,is.MAP_KEY=1,is.STRING_KEY=2,is.VOTE_KEY=3,is.EMPTY_KEY=4,is.NUMBER_KEY=5,is.HIGHSCORE_KEY=6,is.CRACKABLE_KEY=7;class Eo extends Ui{constructor(){super(),this._state="",this._hits=0,this._target=0}parseWrapper(e){e&&(this._state=e.readString(),this._hits=e.readInt(),this._target=e.readInt(),super.parseWrapper(e))}initializeFromRoomObjectModel(e){super.initializeFromRoomObjectModel(e),this._state=e.getValue(T.FURNITURE_CRACKABLE_STATE),this._hits=e.getValue(T.FURNITURE_CRACKABLE_HITS),this._target=e.getValue(T.FURNITURE_CRACKABLE_TARGET)}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(T.FURNITURE_DATA_FORMAT,Eo.FORMAT_KEY),e.setValue(T.FURNITURE_CRACKABLE_STATE,this._state),e.setValue(T.FURNITURE_CRACKABLE_HITS,this._hits),e.setValue(T.FURNITURE_CRACKABLE_TARGET,this._target)}getLegacyString(){return this._state}compare(e){return!0}get hits(){return this._hits}get target(){return this._target}}Eo.FORMAT_KEY=is.CRACKABLE_KEY;class mo extends Ui{parseWrapper(e){e&&(this._state="",super.parseWrapper(e))}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(T.FURNITURE_DATA_FORMAT,mo.FORMAT_KEY)}getLegacyString(){return this._state}compare(e){return super.compare(e)}}mo.FORMAT_KEY=is.EMPTY_KEY;class ug{constructor(){this._score=-1,this._users=[]}get score(){return this._score}set score(e){this._score=e}get users(){return this._users}set users(e){this._users=e}addUsername(e){this._users.push(e)}}class po extends Ui{constructor(){super(),this._state="",this._scoreType=-1,this._clearType=-1,this._entries=[]}parseWrapper(e){if(!e)return;this._state=e.readString(),this._scoreType=e.readInt(),this._clearType=e.readInt();let t=e.readInt();for(;t>0;){const s=new ug;s.score=e.readInt();let i=e.readInt();for(;i>0;)s.addUsername(e.readString()),i--;this._entries.push(s),t--}super.parseWrapper(e)}initializeFromRoomObjectModel(e){this._scoreType=e.getValue(T.FURNITURE_HIGHSCORE_SCORE_TYPE),this._clearType=e.getValue(T.FURNITURE_HIGHSCORE_CLEAR_TYPE),this._entries=[];const t=e.getValue(T.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT);let s=0;for(;s<t;){const i=new ug;i.score=e.getValue(T.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+s),i.users=e.getValue(T.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+s),this._entries.push(i),s++}super.initializeFromRoomObjectModel(e)}writeRoomObjectModel(e){if(super.writeRoomObjectModel(e),e.setValue(T.FURNITURE_DATA_FORMAT,po.FORMAT_KEY),e.setValue(T.FURNITURE_HIGHSCORE_SCORE_TYPE,this._scoreType),e.setValue(T.FURNITURE_HIGHSCORE_CLEAR_TYPE,this._clearType),this._entries){e.setValue(T.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT,this._entries.length);let t=0;for(;t<this._entries.length;){const s=this._entries[t];e.setValue(T.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+t,s.score),e.setValue(T.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+t,s.users),t++}}}getLegacyString(){return this._state}get entries(){return this._entries}get clearType(){return this._clearType}get scoreType(){return this._scoreType}}po.FORMAT_KEY=is.HIGHSCORE_KEY;class ns extends Ui{constructor(){super(),this._data=""}parseWrapper(e){e&&(this._data=e.readString(),super.parseWrapper(e))}initializeFromRoomObjectModel(e){super.initializeFromRoomObjectModel(e),this._data=e.getValue(T.FURNITURE_DATA)}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(T.FURNITURE_DATA_FORMAT,ns.FORMAT_KEY),e.setValue(T.FURNITURE_DATA,this._data)}getLegacyString(){return this._data}compare(e){return this._data===e.getLegacyString()}setString(e){this._data=e}}ns.FORMAT_KEY=is.LEGACY_KEY;class Xs extends Ui{constructor(){super(),this._data={}}parseWrapper(e){if(!e)return;this._data={};const t=e.readInt();if(t)for(let s=0;s<t;s++)this._data[e.readString()]=e.readString();super.parseWrapper(e)}initializeFromRoomObjectModel(e){super.initializeFromRoomObjectModel(e),this._data=e.getValue(T.FURNITURE_DATA)||{}}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(T.FURNITURE_DATA_FORMAT,Xs.FORMAT_KEY),e.setValue(T.FURNITURE_DATA,this._data)}getLegacyString(){if(!this._data)return"";const e=this._data[Xs.STATE];return e??""}compare(e){return!1}getValue(e){return this._data[e]}get rarityLevel(){if(!this._data)return-1;const e=this._data[Xs.RARITY];return e==null?-1:parseInt(e)}get data(){return this._data}}Xs.FORMAT_KEY=is.MAP_KEY,Xs.STATE="state",Xs.RARITY="rarity";class ei extends Ui{constructor(){super(),this._data=[]}parseWrapper(e){if(!e)return;this._data=[];const t=e.readInt();if(t)for(let s=0;s<t;s++)this._data.push(e.readInt());super.parseWrapper(e)}initializeFromRoomObjectModel(e){super.initializeFromRoomObjectModel(e),this._data=e.getValue(T.FURNITURE_DATA)}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(T.FURNITURE_DATA_FORMAT,ei.FORMAT_KEY),e.setValue(T.FURNITURE_DATA,this._data)}getLegacyString(){return!this._data||!this._data.length?"":this._data[ei.STATE].toString()}compare(e){if(!(e instanceof ei))return!1;let t=0;for(;t<this._data.length;){if(t!==0){if(this._data[t]!==e.getValue(t))return!1}t++}return!0}getValue(e){if(!this._data||!this._data.length)return-1;const t=this._data[e];return t??-1}}ei.FORMAT_KEY=is.NUMBER_KEY,ei.STATE=0;class Mr extends Ui{constructor(){super(),this._data=[]}parseWrapper(e){if(!e)return;this._data=[];const t=e.readInt();if(t)for(let s=0;s<t;s++)this._data.push(e.readString());super.parseWrapper(e)}initializeFromRoomObjectModel(e){super.initializeFromRoomObjectModel(e),this._data=e.getValue(T.FURNITURE_DATA)}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(T.FURNITURE_DATA_FORMAT,Mr.FORMAT_KEY),e.setValue(T.FURNITURE_DATA,this._data)}getLegacyString(){return!this._data||!this._data.length?"":this._data[Mr.STATE]}compare(e){if(!(e instanceof Mr))return!1;let t=0;for(;t<this._data.length;){if(t!==0){if(this._data[t]!==e.getValue(t))return!1}t++}return!0}getValue(e){return this._data[e]||""}setValue(e){this._data=e}}Mr.FORMAT_KEY=is.STRING_KEY,Mr.STATE=0;class ca extends Ui{constructor(){super(),this._state="",this._result=0}parseWrapper(e){e&&(this._state=e.readString(),this._result=e.readInt(),super.parseWrapper(e))}writeRoomObjectModel(e){super.writeRoomObjectModel(e),e.setValue(T.FURNITURE_DATA_FORMAT,ca.FORMAT_KEY);const t={};t.S=this._state,t.R=this._result.toString(),e.setValue(T.FURNITURE_DATA,t)}getLegacyString(){return this._state}compare(e){return!0}setString(e){this._state=e}get result(){return this._result}}ca.FORMAT_KEY=is.VOTE_KEY;class Fi{static getData(e){let t=null;switch(e&255){case Eo.FORMAT_KEY:t=new Eo;break;case mo.FORMAT_KEY:t=new mo;break;case po.FORMAT_KEY:t=new po;break;case ns.FORMAT_KEY:t=new ns;break;case Xs.FORMAT_KEY:t=new Xs;break;case ei.FORMAT_KEY:t=new ei;break;case Mr.FORMAT_KEY:t=new Mr;break;case ca.FORMAT_KEY:t=new ca;break}return t?(t.flags=e&65280,t):null}}class U{}U.MINIMUM=-2,U.ROOM=0,U.FLOOR=10,U.WALL=20,U.UNIT=100,U.CURSOR=200;class w{}w.FURNITURE_BASIC="furniture_basic",w.FURNITURE_MULTISTATE="furniture_multistate",w.FURNITURE_MULTIHEIGHT="furniture_multiheight",w.FURNITURE_RANDOMSTATE="furniture_randomstate",w.FURNITURE_PLACEHOLDER="furniture_placeholder",w.FURNITURE_CREDIT="furniture_credit",w.FURNITURE_STICKIE="furniture_stickie",w.FURNITURE_PRESENT="furniture_present",w.FURNITURE_TROPHY="furniture_trophy",w.FURNITURE_ECOTRON_BOX="furniture_ecotron_box",w.FURNITURE_DICE="furniture_dice",w.FURNITURE_HOCKEY_SCORE="furniture_hockey_score",w.FURNITURE_HABBOWHEEL="furniture_habbowheel",w.FURNITURE_ONE_WAY_DOOR="furniture_one_way_door",w.FURNITURE_PLANET_SYSTEM="furniture_planet_system",w.FURNITURE_WINDOW="furniture_window",w.FURNITURE_EXTERNAL_IMAGE_WALLITEM="furniture_external_image_wallitem",w.FURNITURE_ROOMDIMMER="furniture_roomdimmer",w.FURNITURE_SOUND_MACHINE="furniture_sound_machine",w.FURNITURE_JUKEBOX="furniture_jukebox",w.FURNITURE_CRACKABLE="furniture_crackable",w.FURNITURE_PUSHABLE="furniture_pushable",w.FURNITURE_CLOTHING_CHANGE="furniture_clothing_change",w.FURNITURE_COUNTER_CLOCK="furniture_counter_clock",w.FURNITURE_SCORE="furniture_score",w.FURNITURE_ES="furniture_es",w.FURNITURE_FIREWORKS="furniture_fireworks",w.FURNITURE_SONG_DISK="furniture_song_disk",w.FURNITURE_BB="furniture_bb",w.FURNITURE_BG="furniture_bg",w.FURNITURE_WELCOME_GIFT="furniture_welcome_gift",w.FURNITURE_FLOOR_HOLE="furniture_floor_hole",w.FURNITURE_MANNEQUIN="furniture_mannequin",w.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized",w.FURNITURE_GROUP_FORUM_TERMINAL="furniture_group_forum_terminal",w.FURNITURE_PET_CUSTOMIZATION="furniture_pet_customization",w.FURNITURE_CUCKOO_CLOCK="furniture_cuckoo_clock",w.FURNITURE_VOTE_COUNTER="furniture_vote_counter",w.FURNITURE_VOTE_MAJORITY="furniture_vote_majority",w.FURNITURE_SOUNDBLOCK="furniture_soundblock",w.FURNITURE_RANDOM_TELEPORT="furniture_random_teleport",w.FURNITURE_MONSTERPLANT_SEED="furniture_monsterplant_seed",w.FURNITURE_PURCHASABLE_CLOTHING="furniture_purchasable_clothing",w.FURNITURE_BACKGROUND_COLOR="furniture_background_color",w.FURNITURE_MYSTERYBOX="furniture_mysterybox",w.FURNITURE_EFFECTBOX="furniture_effectbox",w.FURNITURE_MYSTERYTROPHY="furniture_mysterytrophy",w.FURNITURE_ACHIEVEMENT_RESOLUTION="furniture_achievement_resolution",w.FURNITURE_LOVELOCK="furniture_lovelock",w.FURNITURE_WILDWEST_WANTED="furniture_wildwest_wanted",w.FURNITURE_HWEEN_LOVELOCK="furniture_hween_lovelock",w.FURNITURE_BADGE_DISPLAY="furniture_badge_display",w.FURNITURE_HIGH_SCORE="furniture_high_score",w.FURNITURE_INTERNAL_LINK="furniture_internal_link",w.FURNITURE_CUSTOM_STACK_HEIGHT="furniture_custom_stack_height",w.FURNITURE_YOUTUBE="furniture_youtube",w.FURNITURE_RENTABLE_SPACE="furniture_rentable_space",w.FURNITURE_CHANGE_STATE_WHEN_STEP_ON="furniture_change_state_when_step_on",w.FURNITURE_VIMEO="furniture_vimeo",w.FURNITURE_EDITABLE_INTERNAL_LINK="furniture_editable_internal_link",w.FURNITURE_EDITABLE_ROOM_LINK="furniture_editable_room_link",w.FURNITURE_CRAFTING_GIZMO="furniture_crafting_gizmo",w.ROOM="room",w.USER="user",w.BOT="bot",w.RENTABLE_BOT="rentable_bot",w.PET="pet",w.TILE_CURSOR="tile_cursor",w.SELECTION_ARROW="selection_arrow",w.GAME_SNOWBALL="game_snowball",w.GAME_SNOWSPLASH="game_snowsplash";class _e{}_e.OBJECT_UNDEFINED="OBJECT_UNDEFINED",_e.OBJECT_MOVE="OBJECT_MOVE",_e.OBJECT_PLACE="OBJECT_PLACE",_e.OBJECT_ROTATE_POSITIVE="OBJECT_ROTATE_POSITIVE",_e.OBJECT_ROTATE_NEGATIVE="OBJECT_ROTATE_NEGATIVE",_e.OBJECT_MOVE_TO="OBJECT_MOVE_TO",_e.OBJECT_PLACE_TO="OBJECT_PLACE_TO",_e.OBJECT_PICKUP="OBJECT_PICKUP",_e.OBJECT_PICKUP_BOT="OBJECT_PICKUP_BOT",_e.OBJECT_PICKUP_PET="OBJECT_PICKUP_PET",_e.OBJECT_EJECT="OBJECT_EJECT",_e.OBJECT_SAVE_STUFF_DATA="OBJECT_SAVE_STUFF_DATA";class hr{}hr.USER=1,hr.PET=2,hr.BOT=3,hr.RENTABLE_BOT=4;class me{static getTypeNumber(e){return me.AVATAR_TYPES[e]}static getTypeString(e){for(const t in me.AVATAR_TYPES)if(t&&me.AVATAR_TYPES[t]===e)return t;return null}static getRealType(e){switch(e){case me.BOT:case me.RENTABLE_BOT:return me.USER;default:return e}}}me.USER="user",me.PET="pet",me.BOT="bot",me.RENTABLE_BOT="rentable_bot",me.MONSTER_PLANT="monsterplant",me.AVATAR_TYPES={user:1,pet:2,bot:3,rentable_bot:4};class G{}G.FURNITURE_STATIC="furniture_static",G.FURNITURE_ANIMATED="furniture_animated",G.FURNITURE_RESETTING_ANIMATED="furniture_resetting_animated",G.FURNITURE_POSTER="furniture_poster",G.FURNITURE_EXTERNAL_IMAGE="furniture_external_image",G.FURNITURE_HABBOWHEEL="furniture_habbowheel",G.FURNITURE_VAL_RANDOMIZER="furniture_val_randomizer",G.FURNITURE_BOTTLE="furniture_bottle",G.FURNITURE_PLANET_SYSTEM="furniture_planet_system",G.FURNITURE_QUEUE_TILE="furniture_queue_tile",G.FURNITURE_PARTY_BEAMER="furniture_party_beamer",G.FURNITURE_CUBOID="furniture_cuboid",G.FURNITURE_GIFT_WRAPPED="furniture_gift_wrapped",G.FURNITURE_GIFT_WRAPPED_FIREWORKS="furniture_gift_wrapped_fireworks",G.FURNITURE_COUNTER_CLOCK="furniture_counter_clock",G.FURNITURE_WATER_AREA="furniture_water_area",G.FURNITURE_SCORE_BOARD="furniture_score_board",G.FURNITURE_FIREWORKS="furniture_fireworks",G.FURNITURE_BB="furniture_bb",G.FURNITURE_ISOMETRIC_BB="furniture_isometric_bb",G.FURNITURE_BG="furniture_bg",G.FURNITURE_STICKIE="furniture_stickie",G.FURNITURE_MANNEQUIN="furniture_mannequin",G.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized",G.FURNITURE_GUILD_ISOMETRIC_BADGE="furniture_guild_isometric_badge",G.FURNITURE_VOTE_COUNTER="furniture_vote_counter",G.FURNITURE_VOTE_MAJORITY="furniture_vote_majority",G.FURNITURE_SOUNDBLOCK="furniture_soundblock",G.FURNITURE_BADGE_DISPLAY="furniture_badge_display",G.FURNITURE_YOUTUBE="furniture_youtube",G.FURNITURE_BUILDER_PLACEHOLDER="furniture_builder_placeholder",G.ROOM="room",G.USER="user",G.PET_ANIMATED="pet_animated",G.BOT="bot",G.RENTABLE_BOT="rentable_bot",G.TILE_CURSOR="tile_cursor";class ti{constructor(e,t,s,i=null){this._id=e,this._location=t,this._targetLocation=s,this._movementType=i}get id(){return this._id}get location(){return this._location}get targetLocation(){return this._targetLocation}get movementType(){return this._movementType}}ti.MOVE="mv",ti.SLIDE="sld";class dc{}dc.KICKED_OUT_OF_ROOM=4008,dc.STRIP_LOCKED_FOR_TRADING=-13001;class _a{}_a.OLD_IDENTITY=0,_a.NEW_IDENTITY=1,_a.REAL_NOOB=2;class Fs{}Fs.NONE=0,Fs.GUEST=1,Fs.GUILD_MEMBER=2,Fs.GUILD_ADMIN=3,Fs.ROOM_OWNER=4,Fs.MODERATOR=5;class wi{static getLocalizationKey(e){switch(e){case wi.FREE_TRADING:return"${trading.mode.free}";case wi.ROOM_CONTROLLER_REQUIRED:return"${trading.mode.controller}";case wi.NO_TRADING:return"${trading.mode.not.allowed}"}return""}}wi.NO_TRADING=0,wi.ROOM_CONTROLLER_REQUIRED=1,wi.FREE_TRADING=2;class ur{}ur.SUPER_USER=9,ur.ADMINISTRATOR=8,ur.COMMUNITY=7,ur.PLAYER_SUPPORT=6,ur.MODERATOR=5,ur.EMPLOYEE=4,ur.BUS_PARTNER=3,ur.PARTNER=2,ur.CELEBRITY=1,ur.NONE=0,h.FurnitureType=void 0,function(r){r.FLOOR="S",r.WALL="I",r.EFFECT="E",r.BADGE="B",r.ROBOT="R",r.HABBO_CLUB="H",r.PET="P"}(h.FurnitureType||(h.FurnitureType={}));class Ks{}Ks.MATCH_ALL_PIXELS=-1,Ks.MATCH_OPAQUE_PIXELS=128,Ks.MATCH_NOTHING=256;class cs{}cs.DEFAULT=1,cs.ROOM_PLANE=2,cs.AVATAR=3,cs.AVATAR_OWN=4;class lg{}class y{constructor(e=0,t=0,s=0){this._x=e,this._y=t,this._z=s,this._length=NaN}static sum(e,t){return!e||!t?null:new y(e.x+t.x,e.y+t.y,e.z+t.z)}static dif(e,t){return!e||!t?null:new y(e.x-t.x,e.y-t.y,e.z-t.z)}static product(e,t){return e?new y(e.x*t,e.y*t,e.z*t):null}static dotProduct(e,t){return!e||!t?0:e.x*t.x+e.y*t.y+e.z*t.z}static crossProduct(e,t){return!e||!t?null:new y(e.y*t.z-e.z*t.y,e.z*t.x-e.x*t.z,e.x*t.y-e.y*t.x)}static scalarProjection(e,t){if(!e||!t)return-1;const s=t.length;return s>0?(e.x*t.x+e.y*t.y+e.z*t.z)/s:-1}static cosAngle(e,t){if(!e||!t)return 0;const s=e.length*t.length;return s?y.dotProduct(e,t)/s:0}static isEqual(e,t){return!(!e||!t||e.x!==t.x||e.y!==t.y||e.z!==t.z)}negate(){this._x=-this._x,this._y=-this._y,this._z=-this._z}add(e){e&&(this._x+=e.x,this._y+=e.y,this._z+=e.z,this._length=NaN)}subtract(e){e&&(this._x-=e.x,this._y-=e.y,this._z-=e.z,this._length=NaN)}multiply(e){this._x*=e,this._y*=e,this._z*=e,this._length=NaN}divide(e){e&&(this._x/=e,this._y/=e,this._z/=e,this._length=NaN)}assign(e){e&&(this._x=e.x,this._y=e.y,this._z=e.z,this._length=NaN)}get x(){return this._x}set x(e){this._x=e,this._length=NaN}get y(){return this._y}set y(e){this._y=e,this._length=NaN}get z(){return this._z}set z(e){this._z=e,this._length=NaN}get length(){return isNaN(this._length)&&(this._length=Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)),this._length}toString(){return`[Vector3d: ${this._x}, ${this._y}, ${this._z}]`}}class W{}W.MOUSE_CLICK="click",W.DOUBLE_CLICK="double_click",W.MOUSE_MOVE="mousemove",W.MOUSE_DOWN="mousedown",W.MOUSE_DOWN_LONG="mousedown_long",W.MOUSE_UP="mouseup",W.ROLL_OVER="mouseover",W.ROLL_OUT="mouseout",W.RIGHT_CLICK="contextmenu";class Io{}Io.TOUCH_START="touchstart",Io.TOUCH_MOVE="touchmove",Io.TOUCH_CANCEL="touchcancel",Io.TOUCH_END="touchend",Io.TOUCH_LONG="touchlong";class as{constructor(e){this._ordinal=e}get ordinal(){return this._ordinal}equals(e){return e&&e._ordinal==this._ordinal}}as.NONE=new as(0),as.WAVE=new as(1),as.BLOW=new as(2),as.LAUGH=new as(3),as.CRY=new as(4),as.IDLE=new as(5),as.JUMP=new as(6),as.RESPECT=new as(7);class Kt{}Kt.DUMMY="DUMMY",Kt.FRIEND_FURNITURE="FRIEND_FURNITURE",Kt.MONSTERPLANT_SEED="MONSTERPLANT_SEED",Kt.MYSTERY_BOX="MYSTERY_BOX",Kt.EFFECT_BOX="EFFECT_BOX",Kt.MYSTERY_TROPHY="MYSTERY_TROPHY",Kt.RANDOM_TELEPORT="RANDOM_TELEPORT",Kt.PURCHASABLE_CLOTHING="PURCHASABLE_CLOTHING",Kt.GENERIC_USABLE="GENERIC_USABLE";class To{}To.LOVE_LOCK=0,To.CARVE_A_TREE=1,To.FRIENDS_PORTRAIT=2,To.WILD_WEST_WANTED=3,To.HABBOWEEN=4;class ie{}ie.CHAT_WIDGET="RWE_CHAT_WIDGET",ie.INFOSTAND="RWE_INFOSTAND",ie.ME_MENU="RWE_ME_MENU",ie.CHAT_INPUT_WIDGET="RWE_CHAT_INPUT_WIDGET",ie.FURNI_PLACEHOLDER="RWE_FURNI_PLACEHOLDER",ie.FURNI_CREDIT_WIDGET="RWE_FURNI_CREDIT_WIDGET",ie.FURNI_STICKIE_WIDGET="RWE_FURNI_STICKIE_WIDGET",ie.FURNI_TROPHY_WIDGET="RWE_FURNI_TROPHY_WIDGET",ie.FURNI_LOVELOCK_WIDGET="RWE_FURNI_LOVELOCK_WIDGET",ie.FURNI_PRESENT_WIDGET="RWE_FURNI_PRESENT_WIDGET",ie.FURNI_ECOTRONBOX_WIDGET="RWE_FURNI_ECOTRONBOX_WIDGET",ie.FURNI_PET_PACKAGE_WIDGET="RWE_FURNI_PET_PACKAGE_WIDGET",ie.PLAYLIST_EDITOR_WIDGET="RWE_PLAYLIST_EDITOR_WIDGET",ie.DOORBELL="RWE_DOORBELL",ie.LOADINGBAR="RWE_LOADINGBAR",ie.ROOM_QUEUE="RWE_ROOM_QUEUE",ie.ROOM_POLL="RWE_ROOM_POLL",ie.ROOM_VOTE="RWE_ROOM_VOTE",ie.USER_CHOOSER="RWE_USER_CHOOSER",ie.FURNI_CHOOSER="RWE_FURNI_CHOOSER",ie.ROOM_DIMMER="RWE_ROOM_DIMMER",ie.FRIEND_REQUEST="RWE_FRIEND_REQUEST",ie.CLOTHING_CHANGE="RWE_CLOTHING_CHANGE",ie.CONVERSION_TRACKING="RWE_CONVERSION_TRACKING",ie.USER_NOTIFICATION="RWE_USER_NOTIFICATION",ie.FRIENDS_BAR="RWE_FRIENDS_BAR",ie.PURSE_WIDGET="RWE_PURSE_WIDGET",ie.AVATAR_INFO="RWE_AVATAR_INFO",ie.WELCOME_GIFT="RWE_WELCOME_GIFT",ie.SPAMWALL_POSTIT_WIDGET="RWE_SPAMWALL_POSTIT_WIDGET",ie.EFFECTS="RWE_EFFECTS",ie.MANNEQUIN="RWE_MANNEQUIN",ie.FURNITURE_CONTEXT_MENU="RWE_FURNITURE_CONTEXT_MENU",ie.LOCATION_WIDGET="RWE_LOCATION_WIDGET",ie.CAMERA="RWE_CAMERA",ie.ROOM_THUMBNAIL_CAMERA="RWE_ROOM_THUMBNAIL_CAMERA",ie.ROOM_BACKGROUND_COLOR="RWE_ROOM_BACKGROUND_COLOR",ie.CUSTOM_USER_NOTIFICATION="RWE_CUSTOM_USER_NOTIFICATION",ie.FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING="RWE_FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING",ie.FRIEND_FURNI_CONFIRM="RWE_FRIEND_FURNI_CONFIRM",ie.FRIEND_FURNI_ENGRAVING="RWE_FRIEND_FURNI_ENGRAVING",ie.HIGH_SCORE_DISPLAY="RWE_HIGH_SCORE_DISPLAY",ie.INTERNAL_LINK="RWE_INTERNAL_LINK",ie.CUSTOM_STACK_HEIGHT="RWE_CUSTOM_STACK_HEIGHT",ie.YOUTUBE="RWE_YOUTUBE",ie.RENTABLESPACE="RWE_RENTABLESPACE",ie.VIMEO="RWE_VIMEO",ie.ROOM_TOOLS="RWE_ROOM_TOOLS",ie.EXTERNAL_IMAGE="RWE_EXTERNAL_IMAGE",ie.WORD_QUIZZ="RWE_WORD_QUIZZ",ie.UI_HELP_BUBBLE="RWE_UI_HELP_BUBBLE",ie.ROOM_LINK="RWE_ROOM_LINK",ie.CRAFTING="RWE_CRAFTING",ie.ROOMGAME_CHECKERS="RWE_GAME_CHECKERS";class Ut{}Ut.INFOSTAND_EXTRA_PARAM="RWEIEP_INFOSTAND_EXTRA_PARAM",Ut.JUKEBOX="RWEIEP_JUKEBOX",Ut.USABLE_PRODUCT="RWEIEP_USABLE_PRODUCT",Ut.SONGDISK="RWEIEP_SONGDISK",Ut.CRACKABLE_FURNI="RWEIEP_CRACKABLE_FURNI",Ut.BRANDING_OPTIONS="RWEIEP_BRANDING_OPTIONS",Ut.USABLE="RWEIEP_USABLE";class fc{}fc.NOBODY=0,fc.CONTROLLER=1,fc.EVERYBODY=2;class xi{}xi.NORMAL=0,xi.GENERIC=1,xi.BOT=2;class Ss{constructor(){this._isDisposed=!1,this._isDisposing=!1}dispose(){this._isDisposed||this._isDisposing||(this._isDisposing=!0,this.onDispose(),this._isDisposed=!0,this._isDisposing=!1)}onDispose(){}get disposed(){return this._isDisposed}get isDisposing(){return this._isDisposing}}class ws extends Ss{constructor(){super(),this._listeners=new Map}onDispose(){this.removeAllListeners(),super.onDispose()}addEventListener(e,t){if(!e||!t)return;const s=this._listeners.get(e);if(!s){this._listeners.set(e,[t]);return}s.push(t)}removeEventListener(e,t){if(!e||!t)return;const s=this._listeners.get(e);if(!(!s||!s.length)){for(const[i,n]of s.entries())if(!(!n||n!==t)){s.splice(i,1),s.length||this._listeners.delete(e);return}}}dispatchEvent(e){return e?(Y.events("Dispatched Event",e.type),this.processEvent(e),!0):!1}processEvent(e){const t=this._listeners.get(e.type);if(!t||!t.length)return;const s=[];for(const i of t)i&&s.push(i);for(;s.length;){const i=s.shift();try{i(e)}catch(n){Y.error(n.stack);return}}}removeAllListeners(){this._listeners.clear()}}class Pr extends Ss{constructor(){super(),this._events=new ws,this._isLoaded=!1,this._isLoading=!1}init(){this._isLoaded||this._isLoading||this.isDisposing||(this._isLoading=!0,this.onInit(),this._isLoaded=!0,this._isLoading=!1)}onInit(){}onDispose(){this._events&&this._events.dispose(),super.onDispose()}reload(){this.dispose(),this.init()}get events(){return this._events}get isLoaded(){return this._isLoaded}get isLoading(){return this._isLoading}}class eO{constructor(e){this._value=e}get value(){return this._value}}class tO{constructor(e,t){this._header=e,this._buffer=t}readBytes(e){return this._buffer?this._buffer.readBytes(e):null}readByte(){return this._buffer?this._buffer.readByte():-1}readBoolean(){return this.readByte()===1}readShort(){return this._buffer?this._buffer.readShort():-1}readInt(){return this._buffer?this._buffer.readInt():-1}readFloat(){return this._buffer?this._buffer.readFloat():-1}readDouble(){return this._buffer?this._buffer.readDouble():-1}readString(){const e=this.readShort();return this._buffer.readBytes(e).toString("utf8")}get header(){return this._header}get bytesAvailable(){return this._buffer&&this._buffer.remaining()>0}}class sO{constructor(e){this._value=e}get value(){return this._value}}class rO{encode(e,t){const s=new Tf;s.writeShort(e);for(const n of t){let a=typeof n;switch(a==="object"&&(n===null?a="null":n instanceof eO?a="byte":n instanceof sO?a="short":n instanceof ArrayBuffer&&(a="arraybuffer")),a){case"undefined":case"null":s.writeShort(0);break;case"byte":s.writeByte(n.value);break;case"short":s.writeShort(n.value);break;case"number":s.writeInt(n);break;case"boolean":s.writeByte(n?1:0);break;case"string":n?s.writeString(n,!0):s.writeShort(0);break;case"arraybuffer":s.writeBytes(n);break}}const i=s.getBuffer();return i?new Tf().writeInt(i.byteLength).writeBytes(i):null}decode(e){if(!e||!e.dataBuffer||!e.dataBuffer.byteLength)return null;const t=[];for(;e.dataBuffer.byteLength&&!(e.dataBuffer.byteLength<4);){const s=new ph(e.dataBuffer),i=s.readInt();if(i>e.dataBuffer.byteLength-4)break;const n=s.readBytes(i);t.push(new tO(n.readShort(),n)),e.dataBuffer=e.dataBuffer.slice(i+4)}return t}}class v{constructor(e,t){this._callBack=e,this._parserClass=t,this._parser=null,this._connection=null}dispose(){this._callBack=null,this._parserClass=null,this._parser=null,this._connection=null}get callBack(){return this._callBack}get parserClass(){return this._parserClass}get parser(){return this._parser}set parser(e){this._parser=e}get connection(){return this._connection}set connection(e){this._connection=e}}class Ce{constructor(e){this._type=e}get type(){return this._type}}class Ct extends Ce{constructor(e,t,s){super(e),this._connection=t,this._originalEvent=event}get connection(){return this._connection}get originalEvent(){return this._originalEvent}}Ct.CONNECTION_OPENED="SCE_OPEN",Ct.CONNECTION_CLOSED="SCE_CLOSED",Ct.CONNECTION_ERROR="SCE_ERROR",Ct.CONNECTION_MESSAGE="SCE_MESSAGE";class da extends Ce{constructor(e,t){super(e),this._library=t}get library(){return this._library}}da.DOWNLOAD_COMPLETE="ARELE_DOWNLOAD_COMPLETE";class zh{}zh.AVATAR_RENDER_READY="AVATAR_RENDER_READY";class fa extends Ce{constructor(e,t){super(e),this._library=t}get library(){return this._library}}fa.DOWNLOAD_COMPLETE="ARLE_DOWNLOAD_COMPLETE";class gc extends Ce{constructor(e){super(e)}}gc.INITIALIZED="RCWM_INITIALIZED";class qt extends Ce{constructor(e,t){super(e),this._connection=t}get connection(){return this._connection}}qt.CONNECTION_ESTABLISHED="NCE_ESTABLISHED",qt.CONNECTION_CLOSED="NCE_CLOSED",qt.CONNECTION_ERROR="NCE_ERROR",qt.CONNECTION_HANDSHAKING="NCE_HANDSHAKING",qt.CONNECTION_HANDSHAKED="NCE_HANDSHAKED",qt.CONNECTION_HANDSHAKE_FAILED="NCE_HANDSHAKE_FAILED",qt.CONNECTION_AUTHENTICATED="NCE_AUTHENTICATED";class ga extends Ce{constructor(e){super(e)}}ga.LOADED="NLE_LOADED",ga.FAILED="NLE_FAILED";class si extends Ce{constructor(){super(si.SETTINGS_UPDATED)}clone(){const e=new si;return e._volumeSystem=this._volumeSystem,e._volumeFurni=this._volumeFurni,e._volumeTrax=this._volumeTrax,e._oldChat=this._oldChat,e._roomInvites=this._roomInvites,e._cameraFollow=this._cameraFollow,e._flags=this._flags,e._chatType=this._chatType,e}get volumeSystem(){return this._volumeSystem}set volumeSystem(e){this._volumeSystem=e}get volumeFurni(){return this._volumeFurni}set volumeFurni(e){this._volumeFurni=e}get volumeTrax(){return this._volumeTrax}set volumeTrax(e){this._volumeTrax=e}get oldChat(){return this._oldChat}set oldChat(e){this._oldChat=e}get roomInvites(){return this._roomInvites}set roomInvites(e){this._roomInvites=e}get cameraFollow(){return this._cameraFollow}set cameraFollow(e){this._cameraFollow=e}get flags(){return this._flags}set flags(e){this._flags=e}get chatType(){return this._chatType}set chatType(e){this._chatType=e}}si.SETTINGS_UPDATED="NSE_SETTINGS_UPDATED";class Xh extends Ce{constructor(e,t){super(e),this._sampleCode=t}get sampleCode(){return this._sampleCode}}Xh.PLAY_SOUND="NSOE_PLAY_SOUND";class Ec extends Ce{constructor(e){super(e)}get iconId(){return this._iconId}set iconId(e){this._iconId=e}get iconName(){return this._iconName}set iconName(e){this._iconName=e}}Ec.TOOLBAR_CLICK="NTE_TOOLBAR_CLICK",Ec.SELECT_OWN_AVATAR="NTE_SELECT_OWN_AVATAR";class Ro extends Ec{constructor(e,t,s){super(Ro.ANIMATE_ICON),this._image=e,this._x=t,this._y=s}get image(){return this._image}get x(){return this._x}get y(){return this._y}}Ro.ANIMATE_ICON="NTAIE_ANIMATE_ICON";class Ue extends Ce{constructor(e,t){super(e),this._roomId=t}get roomId(){return this._roomId}}Ue.INITIALIZED="REE_INITIALIZED",Ue.ENGINE_INITIALIZED="REE_ENGINE_INITIALIZED",Ue.OBJECTS_INITIALIZED="REE_OBJECTS_INITIALIZED",Ue.NORMAL_MODE="REE_NORMAL_MODE",Ue.GAME_MODE="REE_GAME_MODE",Ue.ROOM_ZOOMED="REE_ROOM_ZOOMED",Ue.DISPOSED="REE_DISPOSED";class Kh extends Ue{constructor(e,t,s,i){super(Kh.ROOM_COLOR,e),this._color=t,this._brightness=s,this._bgOnly=i}get color(){return this._color}get brightness(){return this._brightness}get bgOnly(){return this._bgOnly}}Kh.ROOM_COLOR="REE_ROOM_COLOR";class Nr extends Ce{constructor(e,t){super(e),this._contentType=t}get contentType(){return this._contentType}}Nr.RCLE_SUCCESS="RCLE_SUCCESS",Nr.RCLE_FAILURE="RCLE_FAILURE",Nr.RCLE_CANCEL="RCLE_CANCEL";class qh extends Ue{constructor(e,t,s){super(qh.ROOM_DRAG,e),this._offsetX=t,this._offsetY=s}get offsetX(){return this._offsetX}get offsetY(){return this._offsetY}}qh.ROOM_DRAG="RDE_ROOM_DRAG";class Qh extends Ue{constructor(e,t,s,i,n,a){super(Qh.ROOM_COLOR,e),this._state=t,this._presetId=s,this._effectId=i,this._color=n,this._brightness=a}get state(){return this._state}get presetId(){return this._presetId}get effectId(){return this._effectId}get color(){return this._color}get brightness(){return this._brightness}}Qh.ROOM_COLOR="REDSE_ROOM_COLOR";class ee extends Ue{constructor(e,t,s,i){super(e,t),this._objectId=s,this._category=i}get objectId(){return this._objectId}get category(){return this._category}}ee.SELECTED="REOE_SELECTED",ee.DESELECTED="REOE_DESELECTED",ee.ADDED="REOE_ADDED",ee.REMOVED="REOE_REMOVED",ee.PLACED="REOE_PLACED",ee.PLACED_ON_USER="REOE_PLACED_ON_USER",ee.CONTENT_UPDATED="REOE_CONTENT_UPDATED",ee.REQUEST_MOVE="REOE_REQUEST_MOVE",ee.REQUEST_ROTATE="REOE_REQUEST_ROTATE",ee.REQUEST_MANIPULATION="REOE_REQUEST_MANIPULATION",ee.MOUSE_ENTER="REOE_MOUSE_ENTER",ee.MOUSE_LEAVE="REOE_MOUSE_LEAVE",ee.DOUBLE_CLICK="REOE_DOUBLE_CLICK";class iO extends ee{constructor(e,t,s,i,n,a,o,u,l,d,c,_,f){super(e,t,s,i),this._wallLocation="",this._x=0,this._y=0,this._z=0,this._direction=0,this._placedInRoom=!1,this._placedOnFloor=!1,this._placedOnWall=!1,this._instanceData=null,this._wallLocation=n,this._x=a,this._y=o,this._z=u,this._direction=l,this._placedInRoom=d,this._placedOnFloor=c,this._placedOnWall=_,this._instanceData=f}get wallLocation(){return this._wallLocation}get x(){return this._x}get y(){return this._y}get z(){return this._z}get direction(){return this._direction}get placedInRoom(){return this._placedInRoom}get placedOnFloor(){return this._placedOnFloor}get placedOnWall(){return this._placedOnWall}get instanceData(){return this._instanceData}}class nO extends ee{constructor(e,t,s,i,n,a){super(e,t,s,i),this._droppedObjectId=n,this._droppedObjectCategory=a}get droppedObjectId(){return this._droppedObjectId}get droppedObjectCategory(){return this._droppedObjectCategory}}class Ea extends ee{constructor(e,t,s,i,n,a=1){super(e,t,s,i),this._soundId=n,this._pitch=a}get soundId(){return this._soundId}get pitch(){return this._pitch}}Ea.PLAY_SOUND="REOPSE_PLAY_SOUND",Ea.PLAY_SOUND_AT_PITCH="REOPSE_PLAY_SOUND_AT_PITCH";class Gi extends ee{}Gi.FURNI_CLICK="RERAE_FURNI_CLICK",Gi.FURNI_DOUBLE_CLICK="RERAE_FURNI_DOUBLE_CLICK",Gi.TOOLTIP_SHOW="RERAE_TOOLTIP_SHOW",Gi.TOOLTIP_HIDE="RERAE_TOOLTIP_HIDE";class _s extends ee{constructor(e,t,s,i,n,a=1){super(e,t,s,i),this._sampleId=n,this._pitch=a}get sampleId(){return this._sampleId}get pitch(){return this._pitch}}_s.ROOM_OBJECT_INITIALIZED="ROPSPE_ROOM_OBJECT_INITIALIZED",_s.ROOM_OBJECT_DISPOSED="ROPSPE_ROOM_OBJECT_DISPOSED",_s.PLAY_SAMPLE="ROPSPE_PLAY_SAMPLE",_s.CHANGE_PITCH="ROPSPE_CHANGE_PITCH";class H extends ee{constructor(e,t,s,i,n=null){super(e,t,s,i),this._widget=n}get widget(){return this._widget}get contextMenu(){return this._widget}}H.OPEN_WIDGET="RETWE_OPEN_WIDGET",H.CLOSE_WIDGET="RETWE_CLOSE_WIDGET",H.OPEN_FURNI_CONTEXT_MENU="RETWE_OPEN_FURNI_CONTEXT_MENU",H.CLOSE_FURNI_CONTEXT_MENU="RETWE_CLOSE_FURNI_CONTEXT_MENU",H.REQUEST_PLACEHOLDER="RETWE_REQUEST_PLACEHOLDER",H.REQUEST_CREDITFURNI="RETWE_REQUEST_CREDITFURNI",H.REQUEST_STACK_HEIGHT="RETWE_REQUEST_STACK_HEIGHT",H.REQUEST_EXTERNAL_IMAGE="RETWE_REQUEST_EXTERNAL_IMAGE",H.REQUEST_STICKIE="RETWE_REQUEST_STICKIE",H.REQUEST_PRESENT="RETWE_REQUEST_PRESENT",H.REQUEST_TROPHY="RETWE_REQUEST_TROPHY",H.REQUEST_TEASER="RETWE_REQUEST_TEASER",H.REQUEST_ECOTRONBOX="RETWE_REQUEST_ECOTRONBOX",H.REQUEST_DIMMER="RETWE_REQUEST_DIMMER",H.REMOVE_DIMMER="RETWE_REMOVE_DIMMER",H.REQUEST_CLOTHING_CHANGE="RETWE_REQUEST_CLOTHING_CHANGE",H.REQUEST_PLAYLIST_EDITOR="RETWE_REQUEST_PLAYLIST_EDITOR",H.REQUEST_MANNEQUIN="RETWE_REQUEST_MANNEQUIN",H.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG",H.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG",H.REQUEST_BACKGROUND_COLOR="RETWE_REQUEST_BACKGROUND_COLOR",H.REQUEST_MYSTERYBOX_OPEN_DIALOG="RETWE_REQUEST_MYSTERYBOX_OPEN_DIALOG",H.REQUEST_EFFECTBOX_OPEN_DIALOG="RETWE_REQUEST_EFFECTBOX_OPEN_DIALOG",H.REQUEST_MYSTERYTROPHY_OPEN_DIALOG="RETWE_REQUEST_MYSTERYTROPHY_OPEN_DIALOG",H.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING",H.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_FAILED",H.REQUEST_FRIEND_FURNITURE_CONFIRM="RETWE_REQUEST_FRIEND_FURNITURE_CONFIRM",H.REQUEST_FRIEND_FURNITURE_ENGRAVING="RETWE_REQUEST_FRIEND_FURNITURE_ENGRAVING",H.REQUEST_BADGE_DISPLAY_ENGRAVING="RETWE_REQUEST_BADGE_DISPLAY_ENGRAVING",H.REQUEST_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIGH_SCORE_DISPLAY",H.REQUEST_HIDE_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIDE_HIGH_SCORE_DISPLAY",H.REQUEST_INTERNAL_LINK="RETWE_REQUEST_INTERNAL_LINK",H.REQUEST_ROOM_LINK="RETWE_REQUEST_ROOM_LINK",H.REQUEST_YOUTUBE="RETWE_REQUEST_YOUTUBE";class Zh extends ee{constructor(e,t,s,i,n=-1,a=-1){super(e,t,s,i),this._inventoryStripId=n,this._furnitureTypeId=a}get inventoryStripId(){return this._inventoryStripId}get furnitureTypeId(){return this._furnitureTypeId}}Zh.USE_PRODUCT_FROM_ROOM="REUPE_USE_PRODUCT_FROM_ROOM",Zh.USE_PRODUCT_FROM_INVENTORY="REUPE_USE_PRODUCT_FROM_INVENTORY";class qs extends Ce{constructor(e,t){super(e),this._object=t}get object(){return this._object}get objectId(){return this._object?this._object.id:-1}get objectType(){return this._object?this._object.type:null}}class br extends qs{constructor(e,t,s,i=!0){super(e,t),this._badgeId=s,this._groupBadge=i}get badgeId(){return this._badgeId}get groupBadge(){return this._groupBadge}}br.LOAD_BADGE="ROBAE_LOAD_BADGE";class Qs extends qs{constructor(e,t){super(e,t)}}Qs.RODRE_CURRENT_USER_ID="RODRE_CURRENT_USER_ID",Qs.RODRE_URL_PREFIX="RODRE_URL_PREFIX";class Bi extends qs{constructor(e,t,s,i,n,a){super(Bi.DIMMER_STATE,e),this._state=t,this._presetId=s,this._effectId=i,this._color=n,this._brightness=a}get state(){return this._state}get presetId(){return this._presetId}get effectId(){return this._effectId}get color(){return this._color}get brightness(){return this._brightness}}Bi.DIMMER_STATE="RODSUE_DIMMER_STATE";class os extends qs{constructor(e,t){super(e,t)}}os.ADD_HOLE="ROFHO_ADD_HOLE",os.REMOVE_HOLE="ROFHO_REMOVE_HOLE";class B extends qs{}B.DICE_OFF="ROFCAE_DICE_OFF",B.DICE_ACTIVATE="ROFCAE_DICE_ACTIVATE",B.USE_HABBOWHEEL="ROFCAE_USE_HABBOWHEEL",B.STICKIE="ROFCAE_STICKIE",B.ENTER_ONEWAYDOOR="ROFCAE_ENTER_ONEWAYDOOR",B.SOUND_MACHINE_INIT="ROFCAE_SOUND_MACHINE_INIT",B.SOUND_MACHINE_START="ROFCAE_SOUND_MACHINE_START",B.SOUND_MACHINE_STOP="ROFCAE_SOUND_MACHINE_STOP",B.SOUND_MACHINE_DISPOSE="ROFCAE_SOUND_MACHINE_DISPOSE",B.JUKEBOX_INIT="ROFCAE_JUKEBOX_INIT",B.JUKEBOX_START="ROFCAE_JUKEBOX_START",B.JUKEBOX_MACHINE_STOP="ROFCAE_JUKEBOX_MACHINE_STOP",B.JUKEBOX_DISPOSE="ROFCAE_JUKEBOX_DISPOSE",B.MOUSE_BUTTON="ROFCAE_MOUSE_BUTTON",B.MOUSE_ARROW="ROFCAE_MOUSE_ARROW";class mc extends Ue{constructor(e,t,s,i,n,a){super(e,t),this._enable=s,this._hue=i,this._saturation=n,this._lightness=a}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}}mc.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR";class Hi extends qs{constructor(e,t,s,i,n,a){super(e,t),this._enable=s,this._hue=i,this._saturation=n,this._lightness=a}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}}Hi.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR";class re extends qs{constructor(e,t,s,i=!1,n=!1,a=!1,o=!1){super(e,t),this._eventId="",this._eventId=s,this._altKey=i,this._ctrlKey=n,this._shiftKey=a,this._buttonDown=o}get eventId(){return this._eventId}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get localX(){return this._localX}set localX(e){this._localX=e}get localY(){return this._localY}set localY(e){this._localY=e}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(e){this._spriteOffsetX=e}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(e){this._spriteOffsetY=e}}re.CLICK="ROE_MOUSE_CLICK",re.DOUBLE_CLICK="ROE_MOUSE_DOUBLE_CLICK",re.MOUSE_MOVE="ROE_MOUSE_MOVE",re.MOUSE_DOWN="ROE_MOUSE_DOWN",re.MOUSE_DOWN_LONG="ROE_MOUSE_DOWN_LONG",re.MOUSE_UP="ROE_MOUSE_UP",re.MOUSE_ENTER="ROE_MOUSE_ENTER",re.MOUSE_LEAVE="ROE_MOUSE_LEAVE";class hs extends qs{constructor(e,t){super(e,t)}}hs.POSITION_CHANGED="ROME_POSITION_CHANGED",hs.OBJECT_REMOVED="ROME_OBJECT_REMOVED";class ri extends B{constructor(e,t,s,i=1){super(e,t),this._soundId=s,this._pitch=i}get soundId(){return this._soundId}get pitch(){return this._pitch}}ri.PLAY_SOUND="ROPSIE_PLAY_SOUND",ri.PLAY_SOUND_AT_PITCH="ROPSIE_PLAY_SOUND_AT_PITCH";class We extends qs{constructor(e,t,s="",i=""){super(e,t),this._imageUrl="",this._clickUrl="",this._imageUrl=s,this._clickUrl=i}get imageUrl(){return this._imageUrl}get clickUrl(){return this._clickUrl}}We.ROOM_AD_LOAD_IMAGE="RORAE_ROOM_AD_LOAD_IMAGE",We.ROOM_AD_FURNI_CLICK="RORAE_ROOM_AD_FURNI_CLICK",We.ROOM_AD_FURNI_DOUBLE_CLICK="RORAE_ROOM_AD_FURNI_DOUBLE_CLICK",We.ROOM_AD_TOOLTIP_SHOW="RORAE_ROOM_AD_TOOLTIP_SHOW",We.ROOM_AD_TOOLTIP_HIDE="RORAE_ROOM_AD_TOOLTIP_HIDE";class ut extends qs{constructor(e,t,s,i=1){super(e,t),this._sampleId=s,this._pitch=i}get sampleId(){return this._sampleId}get pitch(){return this._pitch}}ut.ROOM_OBJECT_INITIALIZED="ROPSPE_ROOM_OBJECT_INITIALIZED",ut.ROOM_OBJECT_DISPOSED="ROPSPE_ROOM_OBJECT_DISPOSED",ut.PLAY_SAMPLE="ROPSPE_PLAY_SAMPLE",ut.CHANGE_PITCH="ROPSPE_CHANGE_PITCH";class ke extends ee{}ke.SOUND_MACHINE_INIT="ROSM_SOUND_MACHINE_INIT",ke.SOUND_MACHINE_SWITCHED_ON="ROSM_SOUND_MACHINE_SWITCHED_ON",ke.SOUND_MACHINE_SWITCHED_OFF="ROSM_SOUND_MACHINE_SWITCHED_OFF",ke.SOUND_MACHINE_DISPOSE="ROSM_SOUND_MACHINE_DISPOSE",ke.JUKEBOX_INIT="ROSM_JUKEBOX_INIT",ke.JUKEBOX_SWITCHED_ON="ROSM_JUKEBOX_SWITCHED_ON",ke.JUKEBOX_SWITCHED_OFF="ROSM_JUKEBOX_SWITCHED_OFF",ke.JUKEBOX_DISPOSE="ROSM_JUKEBOX_DISPOSE";class Me extends qs{constructor(e,t,s=0){super(e,t),this._state=s}get state(){return this._state}}Me.STATE_CHANGE="ROSCE_STATE_CHANGE",Me.STATE_RANDOM="ROSCE_STATE_RANDOM";class ii extends re{constructor(e,t,s,i,n,a,o=!1,u=!1,l=!1,d=!1){super(e,t,s,o,u,l,d),this._tileX=i,this._tileY=n,this._tileZ=a}get tileX(){return this._tileX}get tileY(){return this._tileY}get tileZ(){return this._tileZ}get tileXAsInt(){return Math.trunc(this._tileX+.499)}get tileYAsInt(){return Math.trunc(this._tileY+.499)}get tileZAsInt(){return Math.trunc(this._tileZ+.499)}}class ma extends re{constructor(e,t,s,i,n,a,o,u,l,d=!1,c=!1,_=!1,f=!1){super(e,t,s,d,c,_,f),this._wallLocation=new y,this._wallWd=new y,this._wallHt=new y,this._wallLocation.assign(i),this._wallWd.assign(n),this._wallHt.assign(a),this._x=o,this._y=u,this._direction=l}get wallLocation(){return this._wallLocation}get wallWidth(){return this._wallWd}get wallHeight(){return this._wallHt}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}class P extends qs{constructor(e,t){super(e,t)}}P.OPEN_WIDGET="ROWRE_OPEN_WIDGET",P.CLOSE_WIDGET="ROWRE_CLOSE_WIDGET",P.OPEN_FURNI_CONTEXT_MENU="ROWRE_OPEN_FURNI_CONTEXT_MENU",P.CLOSE_FURNI_CONTEXT_MENU="ROWRE_CLOSE_FURNI_CONTEXT_MENU",P.PLACEHOLDER="ROWRE_PLACEHOLDER",P.CREDITFURNI="ROWRE_CREDITFURNI",P.STACK_HEIGHT="ROWRE_STACK_HEIGHT",P.EXTERNAL_IMAGE="ROWRE_EXTERNAL_IMAGE",P.STICKIE="ROWRE_STICKIE",P.PRESENT="ROWRE_PRESENT",P.TROPHY="ROWRE_TROPHY",P.TEASER="ROWRE_TEASER",P.ECOTRONBOX="ROWRE_ECOTRONBOX",P.DIMMER="ROWRE_DIMMER",P.WIDGET_REMOVE_DIMMER="ROWRE_WIDGET_REMOVE_DIMMER",P.CLOTHING_CHANGE="ROWRE_CLOTHING_CHANGE",P.JUKEBOX_PLAYLIST_EDITOR="ROWRE_JUKEBOX_PLAYLIST_EDITOR",P.MANNEQUIN="ROWRE_MANNEQUIN",P.PET_PRODUCT_MENU="ROWRE_PET_PRODUCT_MENU",P.GUILD_FURNI_CONTEXT_MENU="ROWRE_GUILD_FURNI_CONTEXT_MENU",P.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG",P.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG",P.BACKGROUND_COLOR="ROWRE_BACKGROUND_COLOR",P.MYSTERYBOX_OPEN_DIALOG="ROWRE_MYSTERYBOX_OPEN_DIALOG",P.EFFECTBOX_OPEN_DIALOG="ROWRE_EFFECTBOX_OPEN_DIALOG",P.MYSTERYTROPHY_OPEN_DIALOG="ROWRE_MYSTERYTROPHY_OPEN_DIALOG",P.ACHIEVEMENT_RESOLUTION_OPEN="ROWRE_ACHIEVEMENT_RESOLUTION_OPEN",P.ACHIEVEMENT_RESOLUTION_ENGRAVING="ROWRE_ACHIEVEMENT_RESOLUTION_ENGRAVING",P.ACHIEVEMENT_RESOLUTION_FAILED="ROWRE_ACHIEVEMENT_RESOLUTION_FAILED",P.FRIEND_FURNITURE_CONFIRM="ROWRE_FRIEND_FURNITURE_CONFIRM",P.FRIEND_FURNITURE_ENGRAVING="ROWRE_FRIEND_FURNITURE_ENGRAVING",P.BADGE_DISPLAY_ENGRAVING="ROWRE_BADGE_DISPLAY_ENGRAVING",P.HIGH_SCORE_DISPLAY="ROWRE_HIGH_SCORE_DISPLAY",P.HIDE_HIGH_SCORE_DISPLAY="ROWRE_HIDE_HIGH_SCORE_DISPLAY",P.INERNAL_LINK="ROWRE_INTERNAL_LINK",P.ROOM_LINK="ROWRE_ROOM_LINK",P.YOUTUBE="ROWRE_YOUTUBE";class aO{constructor(e,t,s,i,n,a,o=0,u=0,l=!1,d=!1,c=!1,_=!1){this._type=e,this._eventId=t,this._canvasId=s,this._spriteTag=i,this._screenX=n,this._screenY=a,this._localX=o,this._localY=u,this._ctrlKey=l,this._altKey=d,this._shiftKey=c,this._buttonDown=_,this._spriteOffsetX=0,this._spriteOffsetY=0}get type(){return this._type}get eventId(){return this._eventId}get canvasId(){return this._canvasId}get spriteTag(){return this._spriteTag}get screenX(){return this._screenX}get screenY(){return this._screenY}get localX(){return this._localX}get localY(){return this._localY}get ctrlKey(){return this._ctrlKey}get altKey(){return this._altKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(e){this._spriteOffsetX=e}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(e){this._spriteOffsetY=e}}class oO extends Ce{constructor(e){super(e)}}class vo extends oO{constructor(e,t){super(e),this._targetLocation=t}get targetLocation(){return this._targetLocation}}vo.ROAME_MOVE_TO="ROAME_MOVE_TO";class pc extends Ue{constructor(e,t,s=!1,i=!1){super(pc.ROOM_ZOOM,e),this._level=t,this._forceFlip=s,this._asDelta=i}get level(){return this._level}get forceFlip(){return this._forceFlip}get asDelta(){return this._asDelta}}pc.ROOM_ZOOM="REE_ROOM_ZOOM";class yn extends Ce{constructor(e,t){super(yn.IMAGE_READY),this._badgeId=e,this._image=t}get badgeId(){return this._badgeId}get image(){return this._image}}yn.IMAGE_READY="BIME_BADGE_IMAGE_READY";class Jh extends Ce{constructor(e,t){super(Jh.MYSTERY_BOX_KEYS_UPDATE),this._boxColor=e,this._keyColor=t}get boxColor(){return this._boxColor}get keyColor(){return this._keyColor}}Jh.MYSTERY_BOX_KEYS_UPDATE="mbke_update";class Ic extends Ce{constructor(){super(Ic.PERKS_UPDATED)}}Ic.PERKS_UPDATED="PUE_perks_updated";class ce extends Ce{constructor(e,t,s=!0){super(e),this._session=t,this._openLandingView=s}get session(){return this._session}get openLandingView(){return this._openLandingView}}ce.CREATED="RSE_CREATED",ce.STARTED="RSE_STARTED",ce.ENDED="RSE_ENDED",ce.ROOM_DATA="RSE_ROOM_DATA";class Pe extends ce{constructor(e,t,s,i,n,a=0,o=null,u=-1){super(e,t),this._objectId=s,this._message=i,this._chatType=n,this._links=o,this._extraParam=u,this._style=a}get objectId(){return this._objectId}get message(){return this._message}get chatType(){return this._chatType}get links(){return this._links}get extraParam(){return this._extraParam}get style(){return this._style}}Pe.CHAT_EVENT="RSCE_CHAT_EVENT",Pe.FLOOD_EVENT="RSCE_FLOOD_EVENT",Pe.CHAT_TYPE_SPEAK=0,Pe.CHAT_TYPE_WHISPER=1,Pe.CHAT_TYPE_SHOUT=2,Pe.CHAT_TYPE_RESPECT=3,Pe.CHAT_TYPE_PETRESPECT=4,Pe.CHAT_TYPE_HAND_ITEM_RECEIVED=5,Pe.CHAT_TYPE_PETTREAT=6,Pe.CHAT_TYPE_PETREVIVE=7,Pe.CHAT_TYPE_PET_REBREED_FERTILIZE=8,Pe.CHAT_TYPE_PET_SPEED_FERTILIZE=9,Pe.CHAT_TYPE_MUTE_REMAINING=10;class $h extends ce{constructor(e,t,s,i,n,a){super($h.CONFIRM_PET_BREEDING,e),this._nestId=t,this._pet1=s,this._pet2=i,this._rarityCategories=n,this._resultPetTypeId=a}get nestId(){return this._nestId}get pet1(){return this._pet1}get pet2(){return this._pet2}get rarityCategories(){return this._rarityCategories}get resultPetTypeId(){return this._resultPetTypeId}}$h.CONFIRM_PET_BREEDING="RSPFUE_CONFIRM_PET_BREEDING";class eu extends ce{constructor(e,t,s){super(eu.RSPFUE_CONFIRM_PET_BREEDING_RESULT,e),this._breedingNestStuffId=t,this._result=s}get breedingNestStuffId(){return this._breedingNestStuffId}get result(){return this._result}}eu.RSPFUE_CONFIRM_PET_BREEDING_RESULT="RSPFUE_CONFIRM_PET_BREEDING_RESULT";class tu extends ce{constructor(e,t,s){super(tu.RSDE_DANCE,e),this._roomIndex=t,this._danceId=s}get roomIndex(){return this._roomIndex}get danceId(){return this._danceId}}tu.RSDE_DANCE="RSDE_DANCE";class hO{constructor(e,t,s,i){this._id=e,this._type=t,this._color=s,this._brightness=i}get id(){return this._id}get type(){return this._type}get color(){return this._color}get brightness(){return this._brightness}}class Tc extends ce{constructor(e,t){super(e,t),this._selectedPresetId=0,this._presets=[]}storePreset(e,t,s,i){this._presets[e-1]=new hO(e,t,s,i)}getPreset(e){return e<0||e>=this._presets.length?null:this._presets[e]}get presetCount(){return this._presets.length}get selectedPresetId(){return this._selectedPresetId}set selectedPresetId(e){this._selectedPresetId=e}}Tc.ROOM_DIMMER_PRESETS="RSDPE_PRESETS";class ni extends ce{constructor(e,t,s){super(e,t),this._userName="",this._userName=s}get userName(){return this._userName}}ni.DOORBELL="RSDE_DOORBELL",ni.RSDE_REJECTED="RSDE_REJECTED",ni.RSDE_ACCEPTED="RSDE_ACCEPTED";class tt extends ce{constructor(e,t,s=null){super(e,t),this._message=s}get message(){return this._message}}tt.RSEME_KICKED="RSEME_KICKED",tt.RSEME_PETS_FORBIDDEN_IN_HOTEL="RSEME_PETS_FORBIDDEN_IN_HOTEL",tt.RSEME_PETS_FORBIDDEN_IN_FLAT="RSEME_PETS_FORBIDDEN_IN_FLAT",tt.RSEME_MAX_PETS="RSEME_MAX_PETS",tt.RSEME_MAX_NUMBER_OF_OWN_PETS="RSEME_MAX_NUMBER_OF_OWN_PETS",tt.RSEME_NO_FREE_TILES_FOR_PET="RSEME_NO_FREE_TILES_FOR_PET",tt.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET="RSEME_SELECTED_TILE_NOT_FREE_FOR_PET",tt.RSEME_BOTS_FORBIDDEN_IN_HOTEL="RSEME_BOTS_FORBIDDEN_IN_HOTEL",tt.RSEME_BOTS_FORBIDDEN_IN_FLAT="RSEME_BOTS_FORBIDDEN_IN_FLAT",tt.RSEME_BOT_LIMIT_REACHED="RSEME_BOT_LIMIT_REACHED",tt.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT="RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT",tt.RSEME_BOT_NAME_NOT_ACCEPTED="RSEME_BOT_NAME_NOT_ACCEPTED";class su extends ce{constructor(e,t,s,i,n){super(su.FAVOURITE_GROUP_UPDATE,e),this._roomIndex=t,this._habboGroupId=s,this._habboGroupName=n,this._status=i}get roomIndex(){return this._roomIndex}get habboGroupId(){return this._habboGroupId}get habboGroupName(){return this._habboGroupName}get status(){return this._status}}su.FAVOURITE_GROUP_UPDATE="RSFGUE_FAVOURITE_GROUP_UPDATE";class ru extends ce{constructor(e,t,s,i){super(ru.RSFRE_FRIEND_REQUEST,e),this._requestId=0,this._userId=0,this._requestId=t,this._userId=s,this._userName=i}get requestId(){return this._requestId}get userId(){return this._userId}get userName(){return this._userName}}ru.RSFRE_FRIEND_REQUEST="RSFRE_FRIEND_REQUEST";class iu extends ce{constructor(e,t,s){super(iu.NEST_BREEDING_SUCCESS,e),this._petId=t,this._rarityCategory=s}get rarityCategory(){return this._rarityCategory}get petId(){return this._petId}}iu.NEST_BREEDING_SUCCESS="RSPFUE_NEST_BREEDING_SUCCESS";class nu extends ce{constructor(e,t,s,i){super(nu.PET_BREEDING,e),this._state=t,this._ownPetId=s,this._otherPetId=i}get state(){return this._state}get ownPetId(){return this._ownPetId}get otherPetId(){return this._otherPetId}}nu.PET_BREEDING="RSPFUE_PET_BREEDING";class au extends ce{constructor(e,t,s){super(au.PET_BREEDING_RESULT,e),this._resultData=t,this._otherResultData=s}get resultData(){return this._resultData}get otherResultData(){return this._otherResultData}}au.PET_BREEDING_RESULT="RSPFUE_PET_BREEDING_RESULT";class Rc extends ce{constructor(e,t,s,i){super(Rc.PET_COMMANDS,e),this._petId=t,this._allCommandIds=s,this._enabledCommandIds=i}get id(){return this._petId}get commands(){return this._allCommandIds}get enabledCommands(){return this._enabledCommandIds}}Rc.PET_COMMANDS="RSPIUE_ENABLED_PET_COMMANDS";class ou extends ce{constructor(e,t,s){super(ou.PET_FIGURE_UPDATE,e),this._petId=t,this._figure=s}get id(){return this._petId}get figure(){return this._figure}}ou.PET_FIGURE_UPDATE="RSPFUE_PET_FIGURE_UPDATE";class hu extends ce{constructor(e,t){super(hu.PET_INFO,e),this._petInfo=t}get petInfo(){return this._petInfo}}hu.PET_INFO="RSPIUE_PET_INFO";class uu extends ce{constructor(e,t,s){super(uu.PET_LEVEL_UPDATE,e),this._petId=t,this._level=s}get petId(){return this._petId}get level(){return this._level}}uu.PET_LEVEL_UPDATE="RSPLUE_PET_LEVEL_UPDATE";class pa extends ce{constructor(e,t,s,i,n,a){super(e,t),this._objectId=-1,this._nameValidationStatus=0,this._nameValidationInfo=null,this._objectId=s,this._figureData=i,this._nameValidationStatus=n,this._nameValidationInfo=a}get objectId(){return this._objectId}get figureData(){return this._figureData}get nameValidationStatus(){return this._nameValidationStatus}get nameValidationInfo(){return this._nameValidationInfo}}pa.RSOPPE_OPEN_PET_PACKAGE_REQUESTED="RSOPPE_OPEN_PET_PACKAGE_REQUESTED",pa.RSOPPE_OPEN_PET_PACKAGE_RESULT="RSOPPE_OPEN_PET_PACKAGE_RESULT";class lu extends ce{constructor(e,t,s,i,n,a){super(lu.PET_STATUS_UPDATE,e),this._petId=t,this._canBreed=s,this._canHarvest=i,this._canRevive=n,this._hasBreedingPermission=a}get petId(){return this._petId}get canBreed(){return this._canBreed}get canHarvest(){return this._canHarvest}get canRevive(){return this._canRevive}get hasBreedingPermission(){return this._hasBreedingPermission}}lu.PET_STATUS_UPDATE="RSPFUE_PET_STATUS_UPDATE";class ai extends ce{constructor(e,t,s){super(e,t),this._id=-1,this._numQuestions=0,this._startMessage="",this._endMessage="",this._questionArray=null,this._npsPoll=!1,this._id=s}get id(){return this._id}get headline(){return this._headline}set headline(e){this._headline=e}get summary(){return this._summary}set summary(e){this._summary=e}get numQuestions(){return this._numQuestions}set numQuestions(e){this._numQuestions=e}get startMessage(){return this._startMessage}set startMessage(e){this._startMessage=e}get endMessage(){return this._endMessage}set endMessage(e){this._endMessage=e}get questionArray(){return this._questionArray}set questionArray(e){this._questionArray=e}get npsPoll(){return this._npsPoll}set npsPoll(e){this._npsPoll=e}}ai.OFFER="RSPE_POLL_OFFER",ai.ERROR="RSPE_POLL_ERROR",ai.CONTENT="RSPE_POLL_CONTENT";class vc extends ce{constructor(e,t,s,i,n,a,o,u,l){super(e,t),this._classId=0,this._itemType="",this._placedItemId=0,this._placedItemType="",this._classId=s,this._itemType=i,this._productCode=n,this._placedItemId=a,this._placedItemType=o,this._placedInRoom=u,this._petFigureString=l}get classId(){return this._classId}get itemType(){return this._itemType}get productCode(){return this._productCode}get placedItemId(){return this._placedItemId}get placedInRoom(){return this._placedInRoom}get placedItemType(){return this._placedItemType}get petFigureString(){return this._petFigureString}}vc.RSPE_PRESENT_OPENED="RSPE_PRESENT_OPENED";class Oc extends ce{constructor(e,t){super(e,t)}}Oc.RSDUE_ALLOW_PETS="RSDUE_ALLOW_PETS";class Cn extends ce{constructor(e,t,s,i=!1){super(Cn.QUEUE_STATUS,e),this._name=t,this._target=s,this._queues=new Map,this._isActive=i}get isActive(){return this._isActive}get queueSetName(){return this._name}get queueSetTarget(){return this._target}get queueTypes(){return Array.from(this._queues.keys())}getQueueSize(e){return this._queues.get(e)}addQueue(e,t){this._queues.set(e,t)}}Cn.QUEUE_STATUS="RSQE_QUEUE_STATUS",Cn.QUEUE_TYPE_CLUB="c",Cn.QUEUE_TYPE_NORMAL="d",Cn.QUEUE_TARGET_VISITOR=2,Cn.QUEUE_TARGET_SPECTATOR=1;class Sc extends ce{constructor(e,t){super(e,t)}}Sc.SPECTATOR_MODE="RSSME_SPECTATOR_MODE";class cu extends ce{constructor(e,t,s){super(cu.RSUBE_BADGES,e),this._userId=0,this._badges=[],this._userId=t,this._badges=s}get userId(){return this._userId}get badges(){return this._badges}}cu.RSUBE_BADGES="RSUBE_BADGES";class _u extends ce{constructor(e,t){super(_u.USER_DATA_UPDATED,e),this._addedUsers=t}get addedUsers(){return this._addedUsers}}_u.USER_DATA_UPDATED="RMUDUE_USER_DATA_UPDATED";class du extends ce{constructor(e,t,s,i,n,a){super(du.USER_FIGURE,e),this._roomIndex=0,this._figure="",this._gender="",this._customInfo="",this._roomIndex=t,this._figure=s,this._gender=i,this._customInfo=n,this._achievementScore=a}get roomIndex(){return this._roomIndex}get figure(){return this._figure}get gender(){return this._gender}get customInfo(){return this._customInfo}get activityPoints(){return this._achievementScore}}du.USER_FIGURE="RSUBE_FIGURE";class Ac extends Ce{constructor(e,t){super(Ac.UTRE_USER_TAGS_RECEIVED),this._userId=e,this._tags=t}get userId(){return this._userId}get tags(){return this._tags}}Ac.UTRE_USER_TAGS_RECEIVED="UTRE_USER_TAGS_RECEIVED";class Ia extends ce{constructor(e,t,s,i,n=null,a=0){super(e,t),this._question="",this._SafeStr_7654=0,this._choices=[],this._SafeStr_7651=[],this._question=s,this._choices=i,this._SafeStr_7651=n,this._SafeStr_7651==null&&(this._SafeStr_7651=[]),this._SafeStr_7654=a}get question(){return this._question}get choices(){return this._choices.slice()}get _SafeStr_4173(){return this._SafeStr_7651.slice()}get _SafeStr_4174(){return this._SafeStr_7654}}Ia.VOTE_QUESTION="RSPE_VOTE_QUESTION",Ia.VOTE_RESULT="RSPE_VOTE_RESULT";class oi extends ce{constructor(e,t,s=-1){super(e,t),this._id=-1,this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null,this._userId=-1,this._id=s}get id(){return this._id}get pollType(){return this._pollType}set pollType(e){this._pollType=e}get pollId(){return this._pollId}set pollId(e){this._pollId=e}get questionId(){return this._questionId}set questionId(e){this._questionId=e}get duration(){return this._duration}set duration(e){this._duration=e}get question(){return this._question}set question(e){this._question=e}get userId(){return this._userId}set userId(e){this._userId=e}get value(){return this._value}set value(e){this._value=e}get answerCounts(){return this._answerCounts}set answerCounts(e){this._answerCounts=e}}oi.QUESTION="RWPUW_NEW_QUESTION",oi.FINISHED="RWPUW_QUESION_FINSIHED",oi.ANSWERED="RWPUW_QUESTION_ANSWERED";class fu extends Ce{constructor(e){super(fu.UPDATED),this._uiFlags=e}get uiFlags(){return this._uiFlags}}fu.UPDATED="APUE_UPDATED";class Oo extends Ce{constructor(e){super(Oo.UNUE_NAME_UPDATED),this._name=e}get name(){return this._name}}Oo.UNUE_NAME_UPDATED="unue_name_updated";class uO{constructor(){this._messageIdByEvent=new Map,this._messageIdByComposer=new Map,this._messageInstancesById=new Map}dispose(){this._messageIdByEvent.clear(),this._messageIdByComposer.clear(),this._messageInstancesById.clear()}registerMessages(e){for(const[t,s]of e.events)this.registerMessageEventClass(t,s);for(const[t,s]of e.composers)this.registerMessageComposerClass(t,s)}registerMessageEventClass(e,t){!e||!t||this._messageIdByEvent.set(t,e)}registerMessageComposerClass(e,t){!e||!t||this._messageIdByComposer.set(t,e)}registerMessageEvent(e){if(!e)return;const t=this.getEventId(e);if(!t)return;let s=this._messageInstancesById.get(t);(!s||!s.length)&&(s=[],this._messageInstancesById.set(t,s)),s.push(e)}removeMessageEvent(e){if(!e)return;const t=this.getEventId(e);if(!t)return;const s=this._messageInstancesById.get(t);if(s){for(const[i,n]of s.entries())if(n&&n===e){s.splice(i,1),s.length===0&&this._messageInstancesById.delete(t),n.dispose();return}}}getEvents(e){if(!e)return;const t=this._messageInstancesById.get(e);if(t)return t}getEventId(e){if(!e)return-1;const t=e instanceof v?e.constructor:e,s=this._messageIdByEvent.get(t);return s||-1}getComposerId(e){if(!e)return-1;const t=this._messageIdByComposer.get(e.constructor);return t||-1}}class lO extends ws{constructor(e,t){super(),this._communicationManager=e,this._stateListener=t,this._socket=null,this._messages=new uO,this._codec=new rO,this._dataBuffer=null,this._isReady=!1,this._pendingClientMessages=[],this._pendingServerMessages=[],this._isAuthenticated=!1,this.onOpen=this.onOpen.bind(this),this.onClose=this.onClose.bind(this),this.onError=this.onError.bind(this),this.onMessage=this.onMessage.bind(this)}init(e){this._stateListener&&this._stateListener.connectionInit(e),this.createSocket(e)}onDispose(){super.onDispose(),this.destroySocket(),this._communicationManager=null,this._stateListener=null,this._messages=null,this._codec=null,this._dataBuffer=null}onReady(){this._isReady||(this._isReady=!0,this._pendingServerMessages&&this._pendingServerMessages.length&&this.processWrappers(...this._pendingServerMessages),this._pendingClientMessages&&this._pendingClientMessages.length&&this.send(...this._pendingClientMessages),this._pendingServerMessages=[],this._pendingClientMessages=[])}createSocket(e){e&&(this.destroySocket(),this._dataBuffer=new ArrayBuffer(0),this._socket=new WebSocket(e),this._socket.addEventListener(zs.CONNECTION_OPENED,this.onOpen),this._socket.addEventListener(zs.CONNECTION_CLOSED,this.onClose),this._socket.addEventListener(zs.CONNECTION_ERROR,this.onError),this._socket.addEventListener(zs.CONNECTION_MESSAGE,this.onMessage))}destroySocket(){this._socket&&(this._socket.removeEventListener(zs.CONNECTION_OPENED,this.onOpen),this._socket.removeEventListener(zs.CONNECTION_CLOSED,this.onClose),this._socket.removeEventListener(zs.CONNECTION_ERROR,this.onError),this._socket.removeEventListener(zs.CONNECTION_MESSAGE,this.onMessage),this._socket.readyState===WebSocket.OPEN&&this._socket.close(),this._socket=null)}onOpen(e){this.dispatchConnectionEvent(Ct.CONNECTION_OPENED,e)}onClose(e){this.dispatchConnectionEvent(Ct.CONNECTION_CLOSED,e)}onError(e){this.dispatchConnectionEvent(Ct.CONNECTION_ERROR,e)}onMessage(e){if(!e)return;const t=new FileReader;t.readAsArrayBuffer(e.data),t.onloadend=()=>{this._dataBuffer=this.concatArrayBuffers(this._dataBuffer,t.result),this.processReceivedData()}}dispatchConnectionEvent(e,t){this.dispatchEvent(new Ct(e,this,t))}authenticated(){this._isAuthenticated=!0}send(...e){if(this.disposed||!e)return!1;if(e=[...e],this._isAuthenticated&&!this._isReady)return this._pendingClientMessages||(this._pendingClientMessages=[]),this._pendingClientMessages.push(...e),!1;for(const t of e){if(!t)continue;const s=this._messages.getComposerId(t);if(s===-1){Y.packets("Unknown Composer",t.constructor.name);continue}const i=t.getMessageArray(),n=this._codec.encode(s,i);if(!n){Y.packets("Encoding Failed",t.constructor.name);continue}Y.packets("OutgoingComposer",s,t.constructor.name,i),this.write(n.getBuffer())}return!0}write(e){this._socket.readyState===WebSocket.OPEN&&this._socket.send(e)}processReceivedData(){try{this.processData()}catch(e){Y.error(e)}}processData(){const e=this.splitReceivedMessages();if(!(!e||!e.length)){if(this._isAuthenticated&&!this._isReady){this._pendingServerMessages||(this._pendingServerMessages=[]),this._pendingServerMessages.push(...e);return}this.processWrappers(...e)}}processWrappers(...e){if(!(!e||!e.length))for(const t of e){if(!t)continue;const s=this.getMessagesForWrapper(t);!s||!s.length||(Y.packets("IncomingMessage",t.header,s[0].constructor.name,s[0].parser),this.handleMessages(...s))}}splitReceivedMessages(){return!this._dataBuffer||!this._dataBuffer.byteLength?null:this._codec.decode(this)}concatArrayBuffers(e,t){const s=new Uint8Array(e.byteLength+t.byteLength);return s.set(new Uint8Array(e),0),s.set(new Uint8Array(t),e.byteLength),s.buffer}getMessagesForWrapper(e){if(!e)return null;const t=this._messages.getEvents(e.header);if(!t||!t.length){Y.packets("IncomingMessage",e.header,"UNREGISTERED",e);return}try{const s=new t[0].parserClass;if(!s||!s.flush()||!s.parse(e))return null;for(const i of t)i.parser=s}catch(s){return Y.error("Error parsing message",s,t[0].constructor.name),null}return t}handleMessages(...e){e=[...e];for(const t of e)t&&(t.connection=this,t.callBack&&t.callBack(t))}registerMessages(e){e&&this._messages.registerMessages(e)}addMessageEvent(e){!e||!this._messages||this._messages.registerMessageEvent(e)}removeMessageEvent(e){!e||!this._messages||this._messages.removeMessageEvent(e)}get isAuthenticated(){return this._isAuthenticated}get dataBuffer(){return this._dataBuffer}set dataBuffer(e){this._dataBuffer=e}}class cO extends Ss{constructor(){super(),this._connections=[]}onDispose(){if(!(!this._connections||!this._connections.length))for(const e of this._connections.values())e&&e.dispose()}createConnection(e=null){const t=new lO(this,e);if(t)return this._connections.push(t),t}update(e){let t=0;for(;t<this._connections.length;){const s=this._connections[t];if(s.processReceivedData(),this.disposed)return;s.disposed?this._connections.splice(t,1):t++}}}class ki extends Ce{constructor(e){super(e)}}ki.LOADED="NCE_LOADED",ki.FAILED="NCE_FAILED";class _O extends Pr{constructor(){super(),this._definitions=new Map,this._config=[],this._pendingUrls=[],this._missingKeys=[],this.onConfigurationLoaded=this.onConfigurationLoaded.bind(this)}onInit(){ue.parseConfiguration(this.getDefaultConfig(),!0),this._pendingUrls=ue.getValue("config.urls").slice(),this.loadNextConfiguration()}loadNextConfiguration(){if(!this._pendingUrls.length){this.dispatchConfigurationEvent(ki.LOADED);return}this.loadConfigurationFromUrl(this._pendingUrls[0])}loadConfigurationFromUrl(e){if(!e||e===""){this.dispatchConfigurationEvent(ki.FAILED);return}fetch(e).then(t=>t.json()).then(t=>this.onConfigurationLoaded(t,e)).catch(t=>this.onConfigurationFailed(t))}onConfigurationLoaded(e,t){if(e){if(ue.parseConfiguration(e)){const s=this._pendingUrls.indexOf(t);s>=0&&this._pendingUrls.splice(s,1),this.loadNextConfiguration();return}this.dispatchConfigurationEvent(ki.FAILED)}}onConfigurationFailed(e){this.dispatchConfigurationEvent(ki.FAILED)}dispatchConfigurationEvent(e){this.events&&this.events.dispatchEvent(new ki(e))}getDefaultConfig(){return NitroConfig}}class hi{static sayHello(){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){const e=[`
 %c %c %c Nitro ${hi.UI_VERSION} - Renderer ${hi.RENDERER_VERSION} %c %c %c https://discord.nitrodev.co %c %c 

`,"background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;","color: #ffffff; background: #000000; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #000000; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;"];self.console.log(...e)}else self.console&&self.console.log(`Nitro ${hi.UI_VERSION} - Renderer ${hi.RENDERER_VERSION} `)}}hi.RENDERER_VERSION="1.6.6",hi.UI_VERSION="";class dO extends Ss{constructor(){super(),hi.sayHello(),this._configuration=new _O,this._communication=new cO}onDispose(){this._communication&&(this._communication.dispose(),this._communication=null)}get configuration(){return this._configuration}get communication(){return this._communication}}class fO{constructor(e){this._id=parseInt(e.id),this._value=parseInt(e.id),this._prevents=e.prevents||[],this._preventHeadTurn=e.preventHeadTurn||!1,this._isAnimated=!0,e.animated!==void 0&&e.animated===!1&&(this._isAnimated=!1)}get id(){return this._id}get value(){return this._value}get prevents(){return this._prevents}get preventHeadTurn(){return this._preventHeadTurn}get isAnimated(){return this._isAnimated}}class gO{constructor(e){if(this._id=e.id,this._state=e.state,this._precedence=e.precedence,this._activePartSet=e.activePartSet,this._assetPartDefinition=e.assetPartDefinition,this._lay=e.lay,this._geometryType=e.geometryType,this._isMain=e.main||!1,this._isDefault=e.isDefault||!1,this._isAnimation=e.animation||!1,this._startFromFrameZero=e.startFromFrameZero||!1,this._prevents=e.prevents||[],this._preventHeadTurn=e.preventHeadTurn||!1,this._types=new Map,this._params=new Map,this._defaultParameterValue="",this._canvasOffsets=null,e.params&&e.params.length>0)for(const t of e.params)t&&(t.id==="default"?this._defaultParameterValue=t.value:this._params.set(t.id,t.value));if(e.types&&e.types.length>0)for(const t of e.types){if(!t)continue;const s=new fO(t);this._types.set(s.id,s)}}setOffsets(e,t,s){this._canvasOffsets||(this._canvasOffsets=new Map);let i=this._canvasOffsets.get(e);i||(i=new Map,this._canvasOffsets.set(e,i)),i.set(t,s)}getOffsets(e,t){if(!this._canvasOffsets)return null;const s=this._canvasOffsets.get(e);return s?s.get(t):null}getType(e){if(!e)return null;const t=this._types.get(parseInt(e));return t||null}getParameterValue(e){if(!e)return"";const t=this._params.get(e);return t||this._defaultParameterValue}getPrevents(e){return this._prevents.concat(this.getTypePrevents(e))}getTypePrevents(e){if(!e)return[];const t=this._types.get(parseInt(e));return t?t.prevents:[]}getPreventHeadTurn(e){if(!e)return this._preventHeadTurn;const t=this.getType(e);return t?t.preventHeadTurn:this._preventHeadTurn}isAnimated(e){if(!e)return!0;const t=this.getType(e);return t?t.isAnimated:!0}get id(){return this._id}get state(){return this._state}get precedence(){return this._precedence}get activePartSet(){return this._activePartSet}get assetPartDefinition(){return this._assetPartDefinition}get lay(){return this._lay}get geometryType(){return this._geometryType}get isMain(){return this._isMain}get isDefault(){return this._isDefault}get isAnimation(){return this._isAnimation}get startFromFrameZero(){return this._startFromFrameZero}get prevents(){return this._prevents}get preventHeadTurn(){return this._preventHeadTurn}get params(){return this._params}}class yc{constructor(e,t="",s=0){this._actionType=e||"",this._actionParameter=t||"",this._definition=null,this._startFrame=s||0,this._overridingAction=null}dispose(){this._actionType=null,this._actionParameter=null,this._definition=null}get id(){return this._definition?this._definition.id+"_"+this._actionParameter:""}get actionType(){return this._actionType}get actionParameter(){return this._actionParameter}set actionParameter(e){this._actionParameter=e}get definition(){return this._definition}set definition(e){this._definition=e}get startFrame(){return this._startFrame}get overridingAction(){return this._overridingAction}set overridingAction(e){this._overridingAction=e}}class EO{constructor(e,t){this._assets=e,this._actions=new Map,this._defaultAction=null,this.updateActions(t)}updateActions(e){if(e){for(const t of e.actions){if(!t||!t.state)continue;const s=new gO(t);this._actions.set(s.state,s)}e.actionOffsets&&this.parseActionOffsets(e.actionOffsets)}}parseActionOffsets(e){if(!(!e||!e.length))for(const t of e){const s=this._actions.get(t.action);if(s)for(const i of t.offsets){const n=i.size||"",a=i.direction;if(n===""||a===void 0)continue;const o=i.x||0,u=i.y||0,l=i.z||0;s.setOffsets(n,a,[o,u,l])}}}getActionDefinition(e){if(!e)return null;for(const t of this._actions.values())if(!(!t||t.id!==e))return t;return null}getActionDefinitionWithState(e){const t=this._actions.get(e);return t||null}getDefaultAction(){if(this._defaultAction)return this._defaultAction;for(const e of this._actions.values())if(!(!e||!e.isDefault))return this._defaultAction=e,e;return null}getCanvasOffsets(e,t,s){let i=[];for(const n of e){if(!n)continue;const a=this._actions.get(n.actionType),o=a&&a.getOffsets(t,s);o&&(i=o)}return i}sortActions(e){if(!e)return null;e=this.filterActions(e);const t=[];for(const s of e){if(!s)continue;const i=this._actions.get(s.actionType);i&&(s.definition=i,t.push(s))}return t.sort(this.sortByPrecedence),t}filterActions(e){let t=[];const s=[];for(const i of e){if(!i)continue;const n=this._actions.get(i.actionType);n&&(t=t.concat(n.getPrevents(i.actionParameter)))}for(const i of e){if(!i)continue;let n=i.actionType;i.actionType==="fx"&&(n=n+("."+i.actionParameter)),!(t.indexOf(n)>=0)&&s.push(i)}return s}sortByPrecedence(e,t){if(!e||!t)return 0;const s=e.definition.precedence,i=t.definition.precedence;return s<i?1:s>i?-1:0}}class mO{constructor(e,t){this._name=e,this._link=t.link,this._flipH=t.flipH,this._flipV=t.flipV}get name(){return this._name}get link(){return this._link}get flipH(){return this._flipH}get flipV(){return this._flipV}}class pO{constructor(e,t){this._avatarRenderManager=e,this._aliases=new Map,this._assets=t,this._missingAssetNames=[]}dispose(){this._assets=null,this._aliases=null}reset(){this.init()}init(){for(const e of this._assets.collections.values()){if(!e)continue;const t=e.data&&e.data.aliases;if(t)for(const s in t){const i=t[s];i&&this._aliases.set(s,new mO(s,i))}}}hasAlias(e){return!!this._aliases.get(e)}getAssetName(e){let t=e,s=5;for(;this.hasAlias(t)&&s>=0;)t=this._aliases.get(t).link,s--;return t}getAsset(e){if(!this._assets)return null;e=this.getAssetName(e);const t=this._assets.getAsset(e);return t||null}}class IO{constructor(e){this._id=e.id||"",this._align=e.align||"",this._base=e.base||"",this._ink=e.ink||0,this._blend=0;const t=e.blend;t&&t.length>0&&(this._blend=parseInt(t),this._blend>1&&(this._blend=this._blend/100))}get id(){return this._id}get align(){return this._align}get base(){return this._base}get ink(){return this._ink}get blend(){return this._blend}get isBlended(){return this._blend!==1}}class lr{constructor(e,t,s){if(this._id=e.id,this._animationFrame=e.frame||0,this._dx=e.dx||0,this._dy=e.dy||0,this._dz=e.dz||0,this._directionOffset=e.dd||0,this._type=t,this._base=e.base||"",this._items=new Map,e.items)for(const i of e.items)this._items.set(i.id,i.base);this._base!==""&&this.baseAsInt().toString(),s&&(this._action=new yc(s.state,this.base),this._action.definition=s)}get items(){return this._items}baseAsInt(){let e=0,t=0;for(;t<this._base.length;)e=e+this._base.charCodeAt(t),t++;return e}get id(){return this._id}get animationFrame(){return this._animationFrame}get dx(){return this._dx}get dy(){return this._dy}get dz(){return this._dz}get dd(){return this._directionOffset}get type(){return this._type}get base(){return this._base}get action(){return this._action}}lr.BODYPART="bodypart",lr.FX="fx";class TO{constructor(e){this._ink=e.ink;let t=e.foreground,s=e.background;t=t.replace("#",""),s=s.replace("#",""),this._foreGround=parseInt(t,16),this._backGround=parseInt(s,16),this._colorTransform=null,this._rgb=parseInt(t,16),this._r=this._rgb>>16&255,this._g=this._rgb>>8&255,this._b=this._rgb>>0&255,this._redMultiplier=this._r/255*1,this._greenMultiplier=this._g/255*1,this._blueMultiplier=this._b/255*1,this._alphaMultiplier=1,this._paletteIsGrayscale=!0,this._ink===37&&(this._alphaMultiplier=.5,this._paletteIsGrayscale=!1),this._colorTransform=new Wv({red:this._r/255,green:this._g/255,blue:this._b/255,alpha:this._alphaMultiplier}),this._colorMap=this.generatePaletteMapForGrayscale(this._backGround,this._foreGround)}get ink(){return this._ink}get colorTransform(){return this._colorTransform}get reds(){return this._colorMap.get("reds")}get greens(){return this._colorMap.get("greens")}get blues(){return this._colorMap.get("blues")}get alphas(){return this._colorMap.get("alphas")}get paletteIsGrayscale(){return this._paletteIsGrayscale}generatePaletteMapForGrayscale(e,t){const s=e>>24&255,i=e>>16&255,n=e>>8&255,a=e>>0&255,o=t>>24&255,u=t>>16&255,l=t>>8&255,d=t>>0&255,c=(o-s)/255,_=(u-i)/255,f=(l-n)/255,g=(d-a)/255,I=new Map,p=[],R=[],S=[];let O=s,A=i,C=n,M=a;for(let N=0;N<256;N++)A==i&&C==n&&M==a&&(O=0),O=O+c,A=A+_,C=C+f,M=M+g,p.push(O<<24|A<<16|C<<8|M),R.push(O<<24|A<<16|C<<8|M),S.push(O<<24|A<<16|C<<8|M);return I.set("alphas",p),I.set("reds",p),I.set("greens",R),I.set("blues",S),I}}class RO{constructor(e){this._offset=e.offset}get offset(){return this._offset}}class vO{constructor(e,t){this._animation=e,this._id=t.id,this._ink=t.ink,this._member=t.member,this._hasStaticY=!!t.staticY,this._hasDirections=!!t.directions,this._dx=[],this._dy=[],this._dz=[];const s=t.directionList;if(s&&s.length)for(const i of s){const n=i.id;n!==void 0&&(this._dx[n]=i.dx||0,this._dy[n]=i.dy||0,this._dz[n]=i.dz||0)}}getDirectionOffsetX(e){return e<this._dx.length?this._dx[e]:0}getDirectionOffsetY(e){return e<this._dy.length?this._dy[e]:0}getDirectionOffsetZ(e){return e<this._dz.length?this._dz[e]:0}get animation(){return this._animation}get id(){return this._id}get ink(){return this._ink}get member(){return this._member}get hasDirections(){return this._hasDirections}get hasStaticY(){return this._hasStaticY}}class Ta{constructor(e,t){if(this._id=t.name,this._description=this._id,this._frames=[],this._spriteData=null,this._avatarData=null,this._directionData=null,this._removeData=null,this._addData=null,this._overriddenActions=null,this._overrideFrames=null,this._resetOnToggle=t.resetOnToggle||!1,t.sprites&&t.sprites.length){this._spriteData=[];for(const s of t.sprites)this._spriteData.push(new vO(this,s))}if(t.avatars&&t.avatars.length&&(this._avatarData=new TO(t.avatars[0])),t.directions&&t.directions.length&&(this._directionData=new RO(t.directions[0])),t.removes&&t.removes.length){this._removeData=[];for(const s of t.removes)this._removeData.push(s.id)}if(t.adds&&t.adds.length){this._addData=[];for(const s of t.adds)this._addData.push(new IO(s))}if(t.overrides&&t.overrides.length){this._overrideFrames=new Map,this._overriddenActions=new Map;for(const s of t.overrides){const i=s.name,n=s.override;this._overriddenActions.set(n,i);const a=[];this.parseFrames(a,s.frames,e),this._overrideFrames.set(i,a)}}this.parseFrames(this._frames,t.frames,e)}parseFrames(e,t,s){if(!(!t||!t.length))for(const i of t){let n=1;i.repeats&&i.repeats>1&&(n=i.repeats);let a=0;for(;a<n;){const o=[];if(i.bodyparts&&i.bodyparts.length)for(const u of i.bodyparts){const l=s.getActionDefinition(u.action),d=new lr(u,lr.BODYPART,l);o.push(d)}if(i.fxs&&i.fxs.length)for(const u of i.fxs){const l=s.getActionDefinition(u.action),d=new lr(u,lr.FX,l);o.push(d)}e.push(o),a++}}}frameCount(e=null){if(!e)return this._frames.length;if(this._overrideFrames){const t=this._overrideFrames.get(e);if(t)return t.length}return 0}hasOverriddenActions(){return this._overriddenActions?this._overriddenActions.size>0:!1}overriddenActionNames(){if(!this._overriddenActions)return null;const e=[];for(const t of this._overriddenActions.keys())e.push(t);return e}overridingAction(e){return this._overriddenActions?this._overriddenActions.get(e):null}getFrame(e,t=null){e<0&&(e=0);let s=[];if(!t)this._frames.length>0&&(s=this._frames[e%this._frames.length]);else{const i=this._overrideFrames.get(t);i&&i.length>0&&(s=i[e%i.length])}return s}getAnimatedBodyPartIds(e,t=null){const s=[];for(const i of this.getFrame(e,t))if(i.type===lr.BODYPART)s.push(i.id);else if(i.type===lr.FX&&this._addData&&this._addData.length)for(const n of this._addData)n.id===i.id&&s.push(n.align);return s}getLayerData(e,t,s=null){for(const i of this.getFrame(e,s)){if(i.id===t)return i;if(i.type===lr.FX&&this._addData&&this._addData.length){for(const n of this._addData)if(n.align===t&&n.id===i.id)return i}}return null}hasAvatarData(){return this._avatarData!==null}hasDirectionData(){return this._directionData!==null}hasAddData(){return this._addData!==null}getAddData(e){if(this._addData){for(const t of this._addData)if(t.id===e)return t}return null}get id(){return this._id}get spriteData(){return this._spriteData||Ta.EMPTY_ARRAY}get avatarData(){return this._avatarData}get directionData(){return this._directionData}get removeData(){return this._removeData||Ta.EMPTY_ARRAY}get addData(){return this._addData||Ta.EMPTY_ARRAY}toString(){return this._description}get resetOnToggle(){return this._resetOnToggle}}Ta.EMPTY_ARRAY=[];class OO{constructor(){this._animations=new Map}registerAnimation(e,t){if(!t)return!1;const s=t[Object.keys(t)[0]],i=new Ta(e,s);return this._animations.set(s.name,i),!0}getAnimation(e){const t=this._animations.get(e);return t||null}getLayerData(e,t,s){const i=this.getAnimation(e);return i?i.getLayerData(t,s):null}get animations(){return this._animations}}class As extends ws{constructor(e,t,s,i){super(),this._state=As.NOT_LOADED,this._libraryName=e,this._revision=t,this._downloadUrl=i,this._assets=s,this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName),this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision),this._assets.getCollection(this._libraryName)&&(this._state=As.LOADED)}downloadAsset(){return mt(this,void 0,void 0,function*(){if(!this._assets||this._state===As.LOADING||this._state===As.LOADED)return;if(this._assets.getCollection(this._libraryName)){this._state=As.LOADED,this.dispatchEvent(new fa(fa.DOWNLOAD_COMPLETE,this));return}this._state=As.LOADING,(yield this._assets.downloadAsset(this._downloadUrl))&&(this._state=As.LOADED,this.dispatchEvent(new fa(fa.DOWNLOAD_COMPLETE,this)))})}get libraryName(){return this._libraryName}get isLoaded(){return this._state===As.LOADED}}As.DOWNLOAD_COMPLETE="AADL_DOWNLOAD_COMPLETE",As.NOT_LOADED=0,As.LOADING=1,As.LOADED=2;class cr extends ws{constructor(e,t){super(),this._assets=e,this._structure=t,this._missingMandatoryLibs=ue.getValue("avatar.mandatory.libraries"),this._figureMap=new Map,this._pendingContainers=[],this._figureListeners=new Map,this._incompleteFigures=new Map,this._pendingDownloadQueue=[],this._currentDownloads=[],this._libraryNames=[],this._isReady=!1,this.onLibraryLoaded=this.onLibraryLoaded.bind(this),this.onAvatarRenderReady=this.onAvatarRenderReady.bind(this),this.loadFigureMap(),this._structure.renderManager.events.addEventListener(zh.AVATAR_RENDER_READY,this.onAvatarRenderReady)}loadFigureMap(){const e=new XMLHttpRequest;try{e.open("GET",ue.getValue("avatar.figuremap.url")),e.send(),e.onloadend=t=>{if(e.responseText){const s=JSON.parse(e.responseText);this.processFigureMap(s.libraries),this.processMissingLibraries(),this._isReady=!0,this.dispatchEvent(new Ce(cr.DOWNLOADER_READY))}},e.onerror=t=>{throw new Error("invalid_avatar_figure_map")}}catch(t){Y.error(t)}}processFigureMap(e){if(e)for(const t of e){if(!t)continue;const s=t.id,i=t.revision||"";if(this._libraryNames.indexOf(s)>=0)continue;this._libraryNames.push(s);const n=new As(s,i,this._assets,ue.getValue("avatar.asset.url"));n.addEventListener(fa.DOWNLOAD_COMPLETE,this.onLibraryLoaded);for(const a of t.parts){const o=a.id,l=a.type+":"+o;let d=this._figureMap.get(l);d||(d=[]),d.push(n),this._figureMap.set(l,d)}}}onAvatarRenderReady(e){if(e){for(const[t,s]of this._pendingContainers)this.downloadAvatarFigure(t,s);this._pendingContainers=[]}}onLibraryLoaded(e){if(!e||!e.library)return;const t=[];for(const[i,n]of this._incompleteFigures.entries()){let a=!0;for(const o of n)if(!(!o||o.isLoaded)){a=!1;break}if(a){t.push(i);const o=this._figureListeners.get(i);if(o)for(const u of o)!u||u.disposed||u.resetFigure(i);this._figureListeners.delete(i),this.dispatchEvent(new Ce(cr.LIBRARY_LOADED))}}for(const i of t)i&&this._incompleteFigures.delete(i);let s=0;for(;s<this._currentDownloads.length;){const i=this._currentDownloads[s];i&&i.libraryName===e.library.libraryName&&this._currentDownloads.splice(s,1),s++}}processMissingLibraries(){const e=this._missingMandatoryLibs.slice();for(const t of e){if(!t)continue;const s=this._figureMap.get(t);if(s)for(const i of s)i&&this.downloadLibrary(i)}}isAvatarFigureContainerReady(e){return!this._isReady||!this._structure.renderManager.isReady?!1:!this.getAvatarFigurePendingLibraries(e).length}getAvatarFigurePendingLibraries(e){const t=[];if(!e||!this._structure)return t;const s=this._structure.figureData;if(!s)return t;const i=e.getPartTypeIds();for(const n of i){const a=s.getSetType(n);if(!a)continue;const o=a.getPartSet(e.getPartSetId(n));if(o)for(const u of o.parts){if(!u)continue;const l=u.type+":"+u.id,d=this._figureMap.get(l);if(d!==void 0)for(const c of d)!c||c.isLoaded||t.indexOf(c)>=0||t.push(c)}}return t}downloadAvatarFigure(e,t){if(!this._isReady||!this._structure.renderManager.isReady){this._pendingContainers.push([e,t]);return}const s=e.getFigureString(),i=this.getAvatarFigurePendingLibraries(e);if(i&&i.length){if(t&&!t.disposed){let n=this._figureListeners.get(s);n||(n=[],this._figureListeners.set(s,n)),n.push(t)}this._incompleteFigures.set(s,i);for(const n of i)n&&this.downloadLibrary(n)}else t&&!t.disposed&&t.resetFigure(s)}downloadLibrary(e){!e||e.isLoaded||this._pendingDownloadQueue.indexOf(e)>=0||this._currentDownloads.indexOf(e)>=0||(this._pendingDownloadQueue.push(e),this.processDownloadQueue())}processDownloadQueue(){for(;this._pendingDownloadQueue.length;)this._pendingDownloadQueue[0].downloadAsset(),this._currentDownloads.push(this._pendingDownloadQueue.shift())}}cr.DOWNLOADER_READY="AADM_DOWNLOADER_READY",cr.LIBRARY_LOADED="AADM_LIBRARY_LOADED",cr.MAX_DOWNLOADS=2;class gu{constructor(e){this._parts=new Map,this.parseFigure(e)}getPartTypeIds(){return this.partSets().keys()}hasPartType(e){return!!this.partSets().get(e)}getPartSetId(e){const t=this.partSets().get(e);return t?t.get("setid"):0}getPartColorIds(e){const t=this.partSets().get(e);return t?t.get("colorids"):null}updatePart(e,t,s){const i=new Map;i.set("type",e),i.set("setid",t),i.set("colorids",s);const n=this.partSets();n.delete(e),n.set(e,i)}removePart(e){this.partSets().delete(e)}getFigureString(){const e=[];for(const t of this.partSets().keys()){if(!t)continue;let s=[];s.push(t),s.push(this.getPartSetId(t)),s=s.concat(this.getPartColorIds(t)),e.push(s.join("-"))}return e.join(".")}partSets(){return this._parts||(this._parts=new Map),this._parts}parseFigure(e){e||(e="");for(const t of e.split(".")){const s=t.split("-");if(s.length>=2){const i=s[0],n=parseInt(s[1]),a=[];let o=2;for(;o<s.length;)a.push(parseInt(s[o])),o++;this.updatePart(i,n,a)}}}}/*!
 * @pixi/filter-color-matrix - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/filter-color-matrix is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var cg=function(r,e){return cg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var i in s)s.hasOwnProperty(i)&&(t[i]=s[i])},cg(r,e)};function Lq(r,e){cg(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Uq=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`,Cc=function(r){Lq(e,r);function e(){var t=this,s={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return t=r.call(this,RK,Uq,s)||this,t.alpha=1,t}return e.prototype._loadMatrix=function(t,s){s===void 0&&(s=!1);var i=t;s&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i},e.prototype._multiply=function(t,s,i){return t[0]=s[0]*i[0]+s[1]*i[5]+s[2]*i[10]+s[3]*i[15],t[1]=s[0]*i[1]+s[1]*i[6]+s[2]*i[11]+s[3]*i[16],t[2]=s[0]*i[2]+s[1]*i[7]+s[2]*i[12]+s[3]*i[17],t[3]=s[0]*i[3]+s[1]*i[8]+s[2]*i[13]+s[3]*i[18],t[4]=s[0]*i[4]+s[1]*i[9]+s[2]*i[14]+s[3]*i[19]+s[4],t[5]=s[5]*i[0]+s[6]*i[5]+s[7]*i[10]+s[8]*i[15],t[6]=s[5]*i[1]+s[6]*i[6]+s[7]*i[11]+s[8]*i[16],t[7]=s[5]*i[2]+s[6]*i[7]+s[7]*i[12]+s[8]*i[17],t[8]=s[5]*i[3]+s[6]*i[8]+s[7]*i[13]+s[8]*i[18],t[9]=s[5]*i[4]+s[6]*i[9]+s[7]*i[14]+s[8]*i[19]+s[9],t[10]=s[10]*i[0]+s[11]*i[5]+s[12]*i[10]+s[13]*i[15],t[11]=s[10]*i[1]+s[11]*i[6]+s[12]*i[11]+s[13]*i[16],t[12]=s[10]*i[2]+s[11]*i[7]+s[12]*i[12]+s[13]*i[17],t[13]=s[10]*i[3]+s[11]*i[8]+s[12]*i[13]+s[13]*i[18],t[14]=s[10]*i[4]+s[11]*i[9]+s[12]*i[14]+s[13]*i[19]+s[14],t[15]=s[15]*i[0]+s[16]*i[5]+s[17]*i[10]+s[18]*i[15],t[16]=s[15]*i[1]+s[16]*i[6]+s[17]*i[11]+s[18]*i[16],t[17]=s[15]*i[2]+s[16]*i[7]+s[17]*i[12]+s[18]*i[17],t[18]=s[15]*i[3]+s[16]*i[8]+s[17]*i[13]+s[18]*i[18],t[19]=s[15]*i[4]+s[16]*i[9]+s[17]*i[14]+s[18]*i[19]+s[19],t},e.prototype._colorMatrix=function(t){var s=new Float32Array(t);return s[4]/=255,s[9]/=255,s[14]/=255,s[19]/=255,s},e.prototype.brightness=function(t,s){var i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,s)},e.prototype.tint=function(t,s){var i=t>>16&255,n=t>>8&255,a=t&255,o=[i/255,0,0,0,0,0,n/255,0,0,0,0,0,a/255,0,0,0,0,0,1,0];this._loadMatrix(o,s)},e.prototype.greyscale=function(t,s){var i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,s)},e.prototype.blackAndWhite=function(t){var s=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(s,t)},e.prototype.hue=function(t,s){t=(t||0)/180*Math.PI;var i=Math.cos(t),n=Math.sin(t),a=Math.sqrt,o=1/3,u=a(o),l=i+(1-i)*o,d=o*(1-i)-u*n,c=o*(1-i)+u*n,_=o*(1-i)+u*n,f=i+o*(1-i),g=o*(1-i)-u*n,I=o*(1-i)-u*n,p=o*(1-i)+u*n,R=i+o*(1-i),S=[l,d,c,0,0,_,f,g,0,0,I,p,R,0,0,0,0,0,1,0];this._loadMatrix(S,s)},e.prototype.contrast=function(t,s){var i=(t||0)+1,n=-.5*(i-1),a=[i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0];this._loadMatrix(a,s)},e.prototype.saturate=function(t,s){t===void 0&&(t=0);var i=t*2/3+1,n=(i-1)*-.5,a=[i,n,n,0,0,n,i,n,0,0,n,n,i,0,0,0,0,0,1,0];this._loadMatrix(a,s)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){var s=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(s,t)},e.prototype.sepia=function(t){var s=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(s,t)},e.prototype.technicolor=function(t){var s=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(s,t)},e.prototype.polaroid=function(t){var s=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(s,t)},e.prototype.toBGR=function(t){var s=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(s,t)},e.prototype.kodachrome=function(t){var s=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(s,t)},e.prototype.browni=function(t){var s=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(s,t)},e.prototype.vintage=function(t){var s=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(s,t)},e.prototype.colorTone=function(t,s,i,n,a){t=t||.2,s=s||.15,i=i||16770432,n=n||3375104;var o=(i>>16&255)/255,u=(i>>8&255)/255,l=(i&255)/255,d=(n>>16&255)/255,c=(n>>8&255)/255,_=(n&255)/255,f=[.3,.59,.11,0,0,o,u,l,t,0,d,c,_,s,0,o-d,u-c,l-_,0,0];this._loadMatrix(f,a)},e.prototype.night=function(t,s){t=t||.1;var i=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(i,s)},e.prototype.predator=function(t,s){var i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,s)},e.prototype.lsd=function(t){var s=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(s,t)},e.prototype.reset=function(){var t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)},Object.defineProperty(e.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(so);Cc.prototype.grayscale=Cc.prototype.greyscale;class SO{constructor(){this._cache=new Map,this.setLastAccessTime(ve())}dispose(){if(this.debugInfo("[dispose]"),!!this._cache){for(const e of this._cache.values())e&&e.dispose();this._cache.clear()}}getDirectionCache(e){const t=this._cache.get(e.toString());return t||null}updateDirectionCache(e,t){this._cache.set(e.toString(),t)}setLastAccessTime(e){this._lastAccessTime=e}getLastAccessTime(){return this._lastAccessTime}debugInfo(e){}}class _g{constructor(){this._cache=new Map}setAction(e,t){this._currentAction||(this._currentAction=e);const s=this.getActionCache(this._currentAction);s&&s.setLastAccessTime(t),this._currentAction=e}dispose(){if(!this._disposed){if(!this._cache)return;this.disposeActions(0,2147483647),this._cache.clear(),this._cache=null,this._disposed=!0}}disposeActions(e,t){if(!(!this._cache||this._disposed))for(const[s,i]of this._cache.entries()){if(!i)continue;const n=i.getLastAccessTime();t-n>=e&&(i.dispose(),this._cache.delete(s))}}getAction(){return this._currentAction}setDirection(e){this._currentDirection=e}getDirection(){return this._currentDirection}getActionCache(e=null){return this._currentAction?(e||(e=this._currentAction),e.overridingAction?this._cache.get(e.overridingAction):this._cache.get(e.id)):null}updateActionCache(e,t){e.overridingAction?this._cache.set(e.overridingAction,t):this._cache.set(e.id,t)}debugInfo(e){}}class AO{constructor(e,t,s){this._image=e,this._regPoint=t,this._offset=new k(0,0),this._regPoint=t,this._isCacheable=s,this.cleanPoints()}dispose(){this._image&&this._image.destroy({children:!0}),this._image=null,this._regPoint=null,this._offset=null}cleanPoints(){}setRegPoint(e){this._regPoint=e,this.cleanPoints()}get image(){return this._image}set image(e){this._image&&this._image!==e&&this._image.destroy({children:!0}),this._image=e}get regPoint(){const e=this._regPoint.clone();return e.x+=this._offset.x,e.y+=this._offset.y,e}set offset(e){this._offset=e,this.cleanPoints()}get isCacheable(){return this._isCacheable}}class yO{constructor(e){this._partList=e,this._images=new Map}dispose(){for(const e of this._images.values())e&&e.dispose();this._images=null}getPartList(){return this._partList}getImageContainer(e){const t=this._images.get(this.getCacheKey(e));return t||null}updateImageContainer(e,t){const s=this.getCacheKey(t),i=this._images.get(s);i&&i.dispose(),this._images.set(s,e)}getCacheKey(e){let t="";for(const s of this._partList)t+=s.getCacheableKey(e)+"/";return t}debugInfo(e){}}class dg{constructor(e,t,s,i,n,a=null){this._texture=e,this._container=a,this._rect=t,this._regPoint=s,this._flipH=i,this._colorTransform=n,i&&(this._regPoint.x=-this._regPoint.x+t.width)}dispose(){this._texture=null,this._regPoint=null,this._colorTransform=null}get texture(){return this._texture}get container(){return this._container}get rect(){return this._rect}get regPoint(){return this._regPoint}get flipH(){return this._flipH}get colorTransform(){return this._colorTransform}get offsetRect(){return new he(-this._regPoint.x,-this._regPoint.y,this._rect.width,this._rect.height)}}class fg{constructor(e,t,s,i){this._structure=e,this._avatar=t,this._assets=s,this._scale=i,this._cache=new Map,this._canvas=null,this._disposed=!1,this._unionImages=[],this._matrix=new Ye,this._serverRenderData=[]}dispose(){if(!this._disposed){if(this._structure=null,this._avatar=null,this._assets=null,this._canvas=null,this._disposed=!0,this._cache){for(const e of this._cache.values())e&&e.dispose();this._cache=null}if(this._unionImages){for(const e of this._unionImages)e&&e.dispose();this._unionImages=[]}}}disposeInactiveActions(e=6e4){const t=ve();if(this._cache)for(const s of this._cache.values())s&&s.disposeActions(e,t)}resetBodyPartCache(e){if(this._cache)for(const t of this._cache.values())t&&t.setAction(e,0)}setDirection(e,t){const s=this._structure.getBodyPartsUnordered(e);if(s)for(const i of s){const n=this.getBodyPartCache(i);n&&n.setDirection(t)}}setAction(e,t){const s=this._structure.getActiveBodyPartIds(e,this._avatar);for(const i of s){const n=this.getBodyPartCache(i);n&&n.setAction(e,t)}}setGeometryType(e){if(this._geometryType!==e){if(this._geometryType===or.SITTING&&e===or.VERTICAL||this._geometryType===or.VERTICAL&&e===or.SITTING||this._geometryType===or.SNOWWARS_HORIZONTAL&&(e=or.SNOWWARS_HORIZONTAL)){this._geometryType=e,this._canvas=null;return}this.disposeInactiveActions(0),this._geometryType=e,this._canvas=null}}getImageContainer(e,t,s=!1){let i=this.getBodyPartCache(e);i||(i=new _g,this._cache.set(e,i));let n=i.getDirection(),a=i.getAction(),o=t;a.definition.startFromFrameZero&&(o-=a.startFrame);let u=a,l=[],d=new Map;const c=new k;if(!(!a||!a.definition)&&a.definition.isAnimation){let p=n;const R=this._structure.getAnimation(a.definition.state+"."+a.actionParameter),S=t-a.startFrame;if(R){const O=R.getLayerData(S,e,a.overridingAction);O&&(p=n+O.dd,O.dd<0?p<0?p=8+p:p>7&&(p=8-p):p<0?p=p+8:p>7&&(p=p-8),this._scale===Cr.LARGE?(c.x=O.dx,c.y=O.dy):(c.x=O.dx/2,c.y=O.dy/2),o=O.animationFrame,O.action&&(a=O.action),O.type===lr.BODYPART?(O.action!=null&&(u=O.action),n=p):O.type===lr.FX&&(n=p),d=O.items),l=R.removeData}}let _=i.getActionCache(u);(!_||s)&&(_=new SO,i.updateActionCache(u,_));let f=_.getDirectionCache(n);if(!f||s){const p=this._structure.getParts(e,this._avatar.getFigure(),u,this._geometryType,n,l,this._avatar,d);f=new yO(p),_.updateDirectionCache(n,f)}let g=f.getImageContainer(o);if(!g||s){const p=f.getPartList();if(g=this.renderBodyPart(n,p,o,a,s),g&&!s)g.isCacheable&&f.updateImageContainer(g,o);else return null}const I=this._structure.getFrameBodyPartOffset(u,n,o,e);return c.x+=I.x,c.y+=I.y,g.offset=c,g}getServerRenderData(){return this._serverRenderData=[],this._serverRenderData}getBodyPartCache(e){let t=this._cache.get(e);return t||(t=new _g,this._cache.set(e,t)),t}renderBodyPart(e,t,s,i,n=!1){if(!t||!t.length||!this._canvas&&(this._canvas=this._structure.getCanvas(this._scale,this._geometryType),!this._canvas))return null;const a=yr.DIRECTION_IS_FLIPPED[e]||!1;let o=i.definition.assetPartDefinition,u=!0,l=t.length-1;for(;l>=0;){const g=t[l];let I=16777215;if(!(e==7&&(g.partType==="fc"||g.partType==="ey"))&&!(g.partType==="ri"&&!g.partId)){const p=g.partId,R=g.getFrameDefinition(s);let S=g.partType,O=0;R?(O=R.number,R.assetPartDefinition&&R.assetPartDefinition!==""&&(o=R.assetPartDefinition)):O=g.getFrameIndex(s);let A=e,C=!1;a&&(o==="wav"&&(S===le.LEFT_HAND||S===le.LEFT_SLEEVE||S===le.LEFT_COAT_SLEEVE)||o==="drk"&&(S===le.RIGHT_HAND||S===le.RIGHT_SLEEVE||S===le.RIGHT_COAT_SLEEVE)||o==="blw"&&S===le.RIGHT_HAND||o==="sig"&&S===le.LEFT_HAND||o==="respect"&&S===le.LEFT_HAND||S===le.RIGHT_HAND_ITEM||S===le.LEFT_HAND_ITEM||S===le.CHEST_PRINT?C=!0:(e===4?A=2:e===5?A=1:e===6&&(A=0),g.flippedPartType!==S&&(S=g.flippedPartType)));let M=this._scale+"_"+o+"_"+S+"_"+p+"_"+A+"_"+O,N=this._assets.getAsset(M);if(N||(M=this._scale+"_std_"+S+"_"+p+"_"+A+"_0",N=this._assets.getAsset(M)),N){const L=N.texture;if(!L||!L.valid||!L.baseTexture)u=!1;else{g.isColorable&&g.color&&(I=g.color.rgb);const b=new k(-N.x,-N.y);if(C&&(b.x=b.x+(this._scale===Cr.LARGE?65:31)),n){const D=new lg;D.name=this._assets.getAssetName(M),D.x=-b.x-33,D.y=-b.y,D.z=this._serverRenderData.length*-1e-4,D.width=N.rectangle.width,D.height=N.rectangle.height,D.flipH=C,o==="lay"&&(D.x=D.x+53),a&&(D.flipH=!D.flipH,D.flipH?D.x=-D.x-L.width:D.x=D.x+65),g.isColorable&&(D.color=`${I}`),this._serverRenderData.push(D)}this._unionImages.push(new dg(L,N.rectangle,b,C,I))}}}l--}if(!this._unionImages.length)return null;const d=this.createUnionImage(this._unionImages,a),c=this._scale===Cr.LARGE?this._canvas.height-16:this._canvas.height-8,_=new k(-d.regPoint.x,c-d.regPoint.y);a&&o!=="lay"&&(_.x=_.x+(this._scale===Cr.LARGE?67:31));let f=this._unionImages.length-1;for(;f>=0;){const g=this._unionImages.pop();g&&g.dispose(),f--}return new AO(d.container,_,u)}convertColorToHex(e){let t=(e*255).toString(16);return t.length<2&&(t="0"+t),t}createUnionImage(e,t){const s=new he;for(const o of e)o&&s.enlarge(o.offsetRect);const i=new k(-s.x,-s.y),n=new nr,a=new ot(Re.EMPTY);a.width=s.width,a.height=s.height,n.addChild(a);for(const o of e){if(!o)continue;const u=o.texture,l=o.colorTransform,d=!(t&&o.flipH)&&(t||o.flipH),c=i.clone();c.x-=o.regPoint.x,c.y-=o.regPoint.y,t&&(c.x=n.width-(c.x+o.rect.width)),d?(this._matrix.a=-1,this._matrix.tx=o.rect.x+o.rect.width+c.x,this._matrix.ty=c.y-o.rect.y):(this._matrix.a=1,this._matrix.tx=c.x-o.rect.x,this._matrix.ty=c.y-o.rect.y);const _=new ot(u);_.tint=l,_.transform.setFromMatrix(this._matrix),n.addChild(_)}return new dg(null,n.getLocalBounds(),i,t,null,n)}}fg.DEFAULT_MAX_CACHE_STORAGE_TIME_MS=6e4;class Mt{constructor(e,t,s,i,n,a=null){this._frameCounter=0,this._directionOffset=0,this._isAnimating=!1,this._animationHasResetOnToggle=!1,this._actionsSorted=!1,this._fullImageCacheSize=5,this._isCachedImage=!1,this._useFullImageCache=!1,this._effectIdInUse=-1,this._cachedBodyPartsDirection=-1,this._cachedBodyPartsGeometryType=null,this._cachedBodyPartsAvatarSet=null,this._canvasOffsets=[],this._actions=[],this._cachedBodyParts=[],this._changes=!0,this._disposed=!1,this._effectManager=n,this._structure=e,this._assets=t,this._scale=i,this._effectListener=a,this._scale==null&&(this._scale=Cr.LARGE),s==null&&(s=new gu("hr-893-45.hd-180-2.ch-210-66.lg-270-82.sh-300-91.wa-2007-.ri-1-")),this._figure=s,this._cache=new fg(this._structure,this,this._assets,this._scale),this.setDirection(Mt.DEFAULT_AVATAR_SET,Mt.DEFAULT_DIRECTION),this._actions=[],this._defaultAction=new yc(F.POSTURE_STAND),this._defaultAction.definition=this._structure.getActionDefinition(Mt.DEFAULT_ACTION),this.resetActions(),this._fullImageCache=new Ot,this._animationFrameCount=0}getServerRenderData(){return this.getAvatarPartsForCamera(rs.FULL),this._cache.getServerRenderData()}dispose(){if(!this._disposed){if(this._structure=null,this._assets=null,this._mainAction=null,this._figure=null,this._avatarSpriteData=null,this._actions=null,this._image&&(this._image.destroy(),this._image=null),this._cache&&(this._cache.dispose(),this._cache=null),this._fullImageCache){for(const e of this._fullImageCache.getValues())e&&e.destroy();this._fullImageCache=null}this._image=null,this._canvasOffsets=null,this._disposed=!0}}get disposed(){return this._disposed}getFigure(){return this._figure}getScale(){return this._scale}getPartColor(e){return this._structure.getPartColor(this._figure,e)}setDirection(e,t){t=t+this._directionOffset,t<yr.MIN_DIRECTION&&(t=yr.MAX_DIRECTION+(t+1)),t>yr.MAX_DIRECTION&&(t=t-(yr.MAX_DIRECTION+1)),this._structure.isMainAvatarSet(e)&&(this._mainDirection=t),(e===rs.HEAD||e===rs.FULL)&&(e===rs.HEAD&&this.isHeadTurnPreventedByAction()&&(t=this._mainDirection),this._headDirection=t),this._cache.setDirection(e,t),this._changes=!0}setDirectionAngle(e,t){this.setDirection(e,Math.floor(t/45))}getSprites(){return this._sprites}getCanvasOffsets(){return this._canvasOffsets}getLayerData(e){return this._structure.getBodyPartData(e.animation.id,this._frameCounter,e.id)}updateAnimationByFrames(e=1){this._frameCounter+=e,this._changes=!0}resetAnimationFrameCounter(){this._frameCounter=0,this._changes=!0}getFullImageCacheKey(){if(!this._useFullImageCache)return null;if(this._sortedActions.length==1&&this._mainDirection==this._headDirection)return this._mainDirection+this._currentActionsString+this._frameCounter%4;if(this._sortedActions.length==2)for(const e of this._sortedActions){if(e.actionType=="fx"&&(e.actionParameter=="33"||e.actionParameter=="34"||e.actionParameter=="35"||e.actionParameter=="36"))return this._mainDirection+this._currentActionsString+0;if(e.actionType=="fx"&&(e.actionParameter=="38"||e.actionParameter=="39"))return this._mainDirection+"_"+this._headDirection+this._currentActionsString+this._frameCounter%11;if(e.actionType==="dance"&&(e.actionParameter==="1"||e.actionParameter==="2"||e.actionParameter==="3"||e.actionParameter==="4")){let t=this._frameCounter%8;return e.actionParameter==="3"&&(t=this._frameCounter%10),e.actionParameter==="4"&&(t=this._frameCounter%16),this._mainDirection+e.actionType+e.actionParameter+t}}return null}getBodyParts(e,t,s){return(s!=this._cachedBodyPartsDirection||t!=this._cachedBodyPartsGeometryType||e!=this._cachedBodyPartsAvatarSet)&&(this._cachedBodyPartsDirection=s,this._cachedBodyPartsGeometryType=t,this._cachedBodyPartsAvatarSet=e,this._cachedBodyParts=this._structure.getBodyParts(e,t,s)),this._cachedBodyParts}getAvatarPartsForCamera(e){let t;if(this._mainAction==null||this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType)==null)return;const i=this.getBodyParts(e,this._mainAction.definition.geometryType,this._mainDirection);let n=i.length-1;for(;n>=0;)t=i[n],this._cache.getImageContainer(t,this._frameCounter,!0),n--}getImage(e,t,s=1,i=!0){if(!this._changes)return this._image;if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const n=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!n)return null;this._image&&(this._image.width!==n.width||this._image.height!==n.height)&&(this._reusableTexture&&(this._reusableTexture.destroy(!0),this._reusableTexture=null),this._image=null,this._isCachedImage=!1);const a=this.getBodyParts(e,this._mainAction.definition.geometryType,this._mainDirection);this._image=null;const o=new nr;let u=!0,l=a.length-1;for(;l>=0;){const d=a[l],c=this._cache.getImageContainer(d,this._frameCounter);if(c){const _=c.image;if(!_)return o.destroy({children:!0}),null;u=u&&c.isCacheable;const f=c.regPoint.clone();if(f){f.x+=n.offset.x,f.y+=n.offset.y,f.x+=n.regPoint.x,f.y+=n.regPoint.y;const g=new nr;g.addChild(_),g&&(g.position.set(f.x,f.y),o.addChild(g))}}l--}return this._avatarSpriteData&&(o.filters||(o.filters=[]),this._avatarSpriteData.colorTransform&&o.filters.push(this._avatarSpriteData.colorTransform),this._avatarSpriteData.paletteIsGrayscale&&(this.convertToGrayscale(o),o.filters.push(new Ys(this._avatarSpriteData.reds,Ys.CHANNEL_RED)))),i?(this._reusableTexture?(_t.instance.renderer.render(o,{renderTexture:this._reusableTexture,clear:!0}),this._reusableTexture.baseTexture.hitMap=null):this._reusableTexture=Je.generateTexture(o,new he(0,0,n.width,n.height)),this._reusableTexture?(this._image=this._reusableTexture,this._changes=!1,this._image):null):Je.generateTexture(o,new he(0,0,n.width,n.height))}applyPalette(e,t=[],s=[],i=[]){const n=Je.generateCanvas(e),a=n.getContext("2d"),o=a.getImageData(0,0,n.width,n.height),u=o.data;for(let d=0;d<u.length;d+=4){if(t.length==256){let c=t[u[d]];c===void 0&&(c=0),u[d]=c>>16&255,u[d+1]=c>>8&255,u[d+2]=c&255}if(s.length==256){let c=s[u[d+1]];c===void 0&&(c=0),u[d]=c>>16&255,u[d+1]=c>>8&255,u[d+2]=c&255}if(i.length==256){let c=s[u[d+2]];c===void 0&&(c=0),u[d]=c>>16&255,u[d+1]=c>>8&255,u[d+2]=c&255}}a.putImageData(o,0,0);const l=new Ze(Re.from(n));return _t.instance.renderer.render(l,{renderTexture:e,clear:!0}),e}getImageAsSprite(e,t=1){if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const s=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!s)return null;const i=this.getBodyParts(e,this._mainAction.definition.geometryType,this._mainDirection),n=new ot,a=new ot(Re.EMPTY);a.width=s.width,a.height=s.height,n.addChild(a);let o=i.length-1;for(;o>=0;){const u=i[o],l=this._cache.getImageContainer(u,this._frameCounter);if(l){const d=l.image;if(!d)return n.destroy({children:!0}),null;const c=l.regPoint.clone();if(c){c.x+=s.offset.x,c.y+=s.offset.y,c.x+=s.regPoint.x,c.y+=s.regPoint.y;const _=new nr;_.addChild(d),_.position.set(c.x,c.y),n.addChild(_)}}o--}return n}getCroppedImage(e,t=1){if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const s=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!s)return null;const i=this.getBodyParts(e,this._mainAction.definition.geometryType,this._mainDirection),n=new nr;let a=i.length-1;for(;a>=0;){const l=i[a],d=this._cache.getImageContainer(l,this._frameCounter);if(d){const c=d.image;if(!c)return n.destroy({children:!0}),null;const _=d.regPoint.clone();if(_){_.x+=s.offset.x,_.y+=s.offset.y,_.x+=s.regPoint.x,_.y+=s.regPoint.y;const f=new nr;f.addChild(c),f&&(f.position.set(_.x,_.y),n.addChild(f))}}a--}const o=Je.generateTexture(n,new he(0,0,s.width,s.height)),u=Je.generateImage(o);return u||null}getFullImage(e){const t=this._fullImageCache.getValue(e);return t?(t.valid||(this._fullImageCache.remove(e),t.destroy(!0)),t):null}cacheFullImage(e,t){const s=this._fullImageCache.getValue(e);if(s&&(this._fullImageCache.remove(e),s.destroy(!0)),this._fullImageCache.length===this._fullImageCacheSize){const i=this._fullImageCache.getKey(0);i&&this._fullImageCache.remove(i).destroy(!0)}this._fullImageCache.add(e,t)}getAsset(e){return this._assets.getAsset(e)}getDirection(){return this._mainDirection}initActionAppends(){this._actions=[],this._actionsSorted=!1,this._currentActionsString="",this._useFullImageCache=!1}endActionAppends(){if(this.sortActions()){for(const e of this._sortedActions)e.actionType===F.EFFECT&&(this._effectManager.isAvatarEffectReady(parseInt(e.actionParameter))||this._effectManager.downloadAvatarEffect(parseInt(e.actionParameter),this));this.resetActions(),this.setActionsToParts()}}appendAction(e,...t){let s="";switch(this._actionsSorted=!1,t&&t.length>0&&(s=t[0]),s!=null&&(s=s.toString()),e){case F.POSTURE:switch(s){case F.POSTURE_LAY:case F.POSTURE_WALK:case F.POSTURE_STAND:case F.POSTURE_SWIM:case F.POSTURE_FLOAT:case F.POSTURE_SIT:case F.SNOWWAR_RUN:case F.SNOWWAR_DIE_FRONT:case F.SNOWWAR_DIE_BACK:case F.SNOWWAR_PICK:case F.SNOWWAR_THROW:(s===F.POSTURE_LAY||s===F.POSTURE_LAY||s===F.POSTURE_LAY)&&(s===F.POSTURE_LAY&&(this._mainDirection==0?this.setDirection(rs.FULL,4):this.setDirection(rs.FULL,2)),this._useFullImageCache=!0,this._useFullImageCache=!0),this.addActionData(s);break}break;case F.GESTURE:switch(s){case F.GESTURE_AGGRAVATED:case F.GESTURE_SAD:case F.GESTURE_SMILE:case F.GESTURE_SURPRISED:this.addActionData(s);break}break;case F.EFFECT:case F.DANCE:case F.TALK:case F.EXPRESSION_WAVE:case F.SLEEP:case F.SIGN:case F.EXPRESSION_RESPECT:case F.EXPRESSION_BLOW_A_KISS:case F.EXPRESSION_LAUGH:case F.EXPRESSION_CRY:case F.EXPRESSION_IDLE:case F.EXPRESSION_SNOWBOARD_OLLIE:case F.EXPRESSION_SNOWBORD_360:case F.EXPRESSION_RIDE_JUMP:s===F.EFFECT&&(s==="33"||s==="34"||s==="35"||s==="36"||s==="38"||s==="39")&&(this._useFullImageCache=!0),this.addActionData(e,s);break;case F.CARRY_OBJECT:case F.USE_OBJECT:{const i=this._structure.getActionDefinitionWithState(e);i&&(s=i.getParameterValue(s)),this.addActionData(e,s);break}}return!0}addActionData(e,t=""){let s;this._actions||(this._actions=[]);let i=0;for(;i<this._actions.length;){if(s=this._actions[i],s.actionType==e&&s.actionParameter==t)return;i++}this._actions.push(new yc(e,t,this._frameCounter))}isAnimating(){return this._isAnimating||this._animationFrameCount>1}resetActions(){return this._animationHasResetOnToggle=!1,this._isAnimating=!1,this._sprites=[],this._avatarSpriteData=null,this._directionOffset=0,this._structure.removeDynamicItems(this),this._mainAction=this._defaultAction,this._mainAction.definition=this._defaultAction.definition,this.resetBodyPartCache(this._defaultAction),!0}isHeadTurnPreventedByAction(){let e,t;if(this._sortedActions==null)return!1;for(const s of this._sortedActions)e=this._structure.getActionDefinitionWithState(s.actionType),e!=null&&e.getPreventHeadTurn(s.actionParameter)&&(t=!0);return t}sortActions(){let e,t,s;if(this._currentActionsString="",this._sortedActions=this._structure.sortActions(this._actions),this._animationFrameCount=this._structure.maxFrames(this._sortedActions),!this._sortedActions)this._canvasOffsets=[0,0,0],this._lastActionsString!==""&&(s=!0,this._lastActionsString="");else{this._canvasOffsets=this._structure.getCanvasOffsets(this._sortedActions,this._scale,this._mainDirection);for(const i of this._sortedActions)if(this._currentActionsString=this._currentActionsString+(i.actionType+i.actionParameter),i.actionType===F.EFFECT){const n=parseInt(i.actionParameter);this._effectIdInUse!==n&&(e=!0),this._effectIdInUse=n,t=!0}t||(this._effectIdInUse>-1&&(e=!0),this._effectIdInUse=-1),e&&this._cache.disposeInactiveActions(0),this._lastActionsString!=this._currentActionsString&&(s=!0,this._lastActionsString=this._currentActionsString)}return this._actionsSorted=!0,s}setActionsToParts(){if(!this._sortedActions==null)return;const e=ve(),t=[];for(const s of this._sortedActions)t.push(s.actionType);for(const s of this._sortedActions)if(s&&s.definition&&s.definition.isAnimation){const i=this._structure.getAnimation(s.definition.state+"."+s.actionParameter);if(i&&i.hasOverriddenActions()){const n=i.overriddenActionNames();if(n)for(const a of n)t.indexOf(a)>=0&&(s.overridingAction=i.overridingAction(a))}i&&i.resetOnToggle&&(this._animationHasResetOnToggle=!0)}for(const s of this._sortedActions)if(!(!s||!s.definition)&&(s.definition.isAnimation&&s.actionParameter===""&&(s.actionParameter="1"),this.setActionToParts(s,e),s.definition.isAnimation)){this._isAnimating=s.definition.isAnimated(s.actionParameter);const i=this._structure.getAnimation(s.definition.state+"."+s.actionParameter);i&&(this._sprites=this._sprites.concat(i.spriteData),i.hasDirectionData()&&(this._directionOffset=i.directionData.offset),i.hasAvatarData()&&(this._avatarSpriteData=i.avatarData))}}setActionToParts(e,t){e==null||e.definition==null||e.definition.assetPartDefinition!=""&&(e.definition.isMain&&(this._mainAction=e,this._cache.setGeometryType(e.definition.geometryType)),this._cache.setAction(e,t),this._changes=!0)}resetBodyPartCache(e){e&&e.definition.assetPartDefinition!==""&&(e.definition.isMain&&(this._mainAction=e,this._cache.setGeometryType(e.definition.geometryType)),this._cache.resetBodyPartCache(e),this._changes=!0)}get avatarSpriteData(){return this._avatarSpriteData}convertToGrayscale(e,t="CHANNELS_EQUAL"){let s=.33,i=.33,n=.33;switch(t){case Mt.CHANNELS_UNIQUE:s=.3,i=.59,n=.11;break;case Mt.CHANNELS_RED:s=1,i=0,n=0;break;case Mt.CHANNELS_GREEN:s=0,i=1,n=0;break;case Mt.CHANNELS_BLUE:s=0,i=0,n=1;break;case Mt.CHANNELS_DESATURATED:s=.3086,i=.6094,n=.082;break}const a=new Cc;return a.matrix=[s,i,n,0,0,s,i,n,0,0,s,i,n,0,0,0,0,0,1,0],e.filters.push(a),e}errorThis(e){}logThis(e){}isPlaceholder(){return!1}forceActionUpdate(){this._lastActionsString=""}get animationHasResetOnToggle(){return this._animationHasResetOnToggle}get mainAction(){return this._mainAction.actionType}resetEffect(e){e===this._effectIdInUse&&(this.resetActions(),this.setActionsToParts(),this._animationHasResetOnToggle=!0,this._changes=!0,this._effectListener&&this._effectListener.resetEffect(e))}}Mt.CHANNELS_EQUAL="CHANNELS_EQUAL",Mt.CHANNELS_UNIQUE="CHANNELS_UNIQUE",Mt.CHANNELS_RED="CHANNELS_RED",Mt.CHANNELS_GREEN="CHANNELS_GREEN",Mt.CHANNELS_BLUE="CHANNELS_BLUE",Mt.CHANNELS_DESATURATED="CHANNELS_DESATURATED",Mt.DEFAULT_ACTION="Default",Mt.DEFAULT_DIRECTION=2,Mt.DEFAULT_AVATAR_SET=rs.FULL;class Eu{constructor(e){this._number=e.number,this._assetPartDefinition=e.assetPartDefinition||null}get number(){return this._number}get assetPartDefinition(){return this._assetPartDefinition}}class CO{constructor(e){if(this._frames=[],e.frames&&e.frames.length>0)for(const t of e.frames){if(!t)continue;this._frames.push(new Eu(t));let s=t.repeats||0;if(s>1)for(;--s>0;)this._frames.push(this._frames[this._frames.length-1])}}get frames(){return this._frames}}class Vi{constructor(e){if(this._id=e.id,this._actionParts=new Map,this._bodyPartOffsets=new Map,this._frameCount=0,this._frameIndexes=[],e.parts&&e.parts.length>0)for(const t of e.parts){if(!t)continue;const s=new CO(t);this._actionParts.set(t.setType,s),this._frameCount=Math.max(this._frameCount,s.frames.length)}if(e.offsets&&e.offsets.frames&&e.offsets.frames.length>0)for(const t of e.offsets.frames){if(!t)continue;const s=t.id;this._frameCount=Math.max(this._frameCount,s);const i=new Map;if(this._bodyPartOffsets.set(s,i),t.directions&&t.directions.length>0)for(const n of t.directions){if(!n)continue;const a=n.id,o=new Map;if(i.set(a,o),n.bodyParts&&n.bodyParts.length>0)for(const u of n.bodyParts){if(!u)continue;const l=u.id;let d=0,c=0;u.dx!==void 0&&(d=u.dx),u.dy!==void 0&&(c=u.dy),o.set(l,new k(d,c))}}if(this._frameIndexes.push(s),t.repeats!==void 0){let n=t.repeats||0;if(n>1)for(;--n>0;)this._frameIndexes.push(s)}}}getPart(e){if(!e)return null;const t=this._actionParts.get(e);return t||null}getFrameBodyPartOffset(e,t,s){const i=t%this._frameIndexes.length,n=this._frameIndexes[i],a=this._bodyPartOffsets.get(n);if(!a)return Vi.DEFAULT_OFFSET;const o=a.get(e);if(!o)return Vi.DEFAULT_OFFSET;const u=o.get(s);return u||Vi.DEFAULT_OFFSET}get id(){return this._id}get parts(){return this._actionParts}get frameCount(){return this._frameCount}}Vi.DEFAULT_OFFSET=new k(0,0);class MO{constructor(){this._actions=new Map}parse(e){if(e&&e.length>0)for(const t of e){if(!t)continue;const s=new Vi(t);this._actions.set(s.id,s)}return!0}appendJSON(e){for(const t of e.action)this._actions.set(t.id,new Vi(t));return!0}getAction(e){const t=this._actions.get(e.id);return t||null}getFrameCount(e){const t=this.getAction(e);return t?t.frameCount:0}}class PO{constructor(e,t){this._id=e.id,this._width=e.width,this._height=e.height,this._offset=new k(e.dx,e.dy),t==Cr.LARGE?this._regPoint=new k((this._width-64)/2,0):this._regPoint=new k((this._width-32)/2,0)}get width(){return this._width}get height(){return this._height}get offset(){return this._offset}get id(){return this._id}get regPoint(){return this._regPoint}}class So extends ws{constructor(e,t){super(),this._dataReceiver=t,this.download(e)}download(e){const t=new XMLHttpRequest;try{t.open("GET",e),t.send(),t.onloadend=s=>{const i=t.responseText;if(!i||!i.length)throw new Error("invalid_figure_data");this._dataReceiver&&this._dataReceiver.appendJSON(JSON.parse(i)),this.dispatchEvent(new Ce(So.AVATAR_STRUCTURE_DONE))},t.onerror=s=>{throw new Error("invalid_avatar_figure_data")}}catch(s){Y.error(s)}}}So.AVATAR_STRUCTURE_DONE="AVATAR_STRUCTURE_DONE";class NO{constructor(e){if(!e)throw new Error("invalid_data");this._id=e.id,this._type=e.type,this._index=e.index,this._colorLayerIndex=e.colorindex,this._paletteMapId=-1,this._breed=-1}dispose(){}get id(){return this._id}get type(){return this._type}get breed(){return this._breed}get index(){return this._index}get colorLayerIndex(){return this._colorLayerIndex}get paletteMap(){return this._paletteMapId}}class bO{constructor(e,t){if(!e||!t)throw new Error("invalid_data");this._id=t.id,this._type=e,this._gender=t.gender,this._clubLevel=t.club,this._isColorable=t.colorable,this._isSelectable=t.selectable,this._parts=[],this._hiddenLayers=[],this._isPreSelectable=t.preselectable,this._isSellable=t.sellable;for(const s of t.parts){const i=new NO(s),n=this.getPartIndex(i);n!==-1?this._parts.splice(n,0,i):this._parts.push(i)}if(t.hiddenLayers)for(const s of t.hiddenLayers)this._hiddenLayers.push(s.partType)}dispose(){for(const e of this._parts)e.dispose();this._parts=null,this._hiddenLayers=null}getPartIndex(e){const t=this._parts.length;if(!t)return-1;for(let s=0;s<t;s++){const i=this._parts[s];if(i&&!(i.type!==e.type||i.index>e.index))return s}return-1}getPart(e,t){for(const s of this._parts)if(!(s.type!==e||s.id!==t))return s;return null}get id(){return this._id}get type(){return this._type}get gender(){return this._gender}get clubLevel(){return this._clubLevel}get isColorable(){return this._isColorable}get isSelectable(){return this._isSelectable}get parts(){return this._parts}get hiddenLayers(){return this._hiddenLayers}get isPreSelectable(){return this._isPreSelectable}get isSellable(){return this._isSellable}}class DO{constructor(e){if(!e)throw new Error("invalid_data");this._id=e.id,this._index=e.index,this._clubLevel=e.club||0,this._isSelectable=e.selectable,this._rgb=parseInt("0x"+e.hexCode,16)}get id(){return this._id}get index(){return this._index}get clubLevel(){return this._clubLevel}get isSelectable(){return this._isSelectable}get rgb(){return this._rgb}}class gg{constructor(e){if(!e)throw new Error("invalid_data");this._id=e.id,this._colors=new Ot,this.append(e)}append(e){for(const t of e.colors){const s=new DO(t);this._colors.add(t.id.toString(),s)}}getColor(e){return e===void 0||e<0?null:this._colors.getValue(e.toString())||null}get id(){return this._id}get colors(){return this._colors}}class Mc{constructor(e){if(!e)throw new Error("invalid_data");this._type=e.type,this._paletteId=e.paletteId,this._isMandatory={},this._isMandatory.F=[e.mandatory_f_0,e.mandatory_f_1],this._isMandatory.M=[e.mandatory_m_0,e.mandatory_m_1],this._partSets=new Ot,this.append(e)}dispose(){for(const e of this._partSets.getValues())e.dispose();this._partSets=null}cleanUp(e){for(const t of e.sets){const s=t.id.toString(),i=this._partSets.getValue(s);i&&(i.dispose(),this._partSets.remove(s))}}append(e){if(!(!e||!e.sets))for(const t of e.sets)this._partSets.add(t.id.toString(),new bO(this._type,t))}getDefaultPartSet(e){for(const t of this._partSets.getValues())if(t&&t.clubLevel===0&&(t.gender===e||t.gender==="U"))return t;return null}getPartSet(e){return this._partSets.getValue(e.toString())}get type(){return this._type}get paletteID(){return this._paletteId}isMandatory(e,t){return this._isMandatory[e.toUpperCase()][Math.min(t,1)]}optionalFromClubLevel(e){return this._isMandatory[e.toUpperCase()].indexOf(!1)}get partSets(){return this._partSets}}class LO{constructor(){this._palettes=new Map,this._setTypes=new Map}dispose(){}parse(e){if(!e)return!1;for(const t of e.palettes){const s=new gg(t);s&&this._palettes.set(s.id.toString(),s)}for(const t of e.setTypes){const s=new Mc(t);s&&this._setTypes.set(s.type,s)}return!0}injectJSON(e){for(const t of e.setTypes){const s=this._setTypes.get(t.type);s?s.cleanUp(t):this._setTypes.set(t.type,new Mc(t))}this.appendJSON(e)}appendJSON(e){if(!e)return!1;for(const t of e.palettes){const s=t.id.toString(),i=this._palettes.get(s);i?i.append(t):this._palettes.set(s,new gg(t))}for(const t of e.setTypes){const s=t.type,i=this._setTypes.get(s);i?i.append(t):this._setTypes.set(s,new Mc(t))}return!1}getMandatorySetTypeIds(e,t){const s=[];for(const i of this._setTypes.values())!i||!i.isMandatory(e,t)||s.push(i.type);return s}getDefaultPartSet(e,t){const s=this._setTypes.get(e);return s?s.getDefaultPartSet(t):null}getSetType(e){return this._setTypes.get(e)||null}getPalette(e){return this._palettes.get(e.toString())||null}getFigurePartSet(e){for(const t of this._setTypes.values()){const s=t.getPartSet(e);if(s)return s}return null}}class Eg{constructor(e){if(this._id=e.id,this._parts=[],e.activeParts&&e.activeParts.length>0)for(const t of e.activeParts)t&&this._parts.push(t.setType)}get parts(){return this._parts}}class Pc{constructor(e){if(!e)throw new Error("invalid_data");this._setType=e.setType,this._flippedSetType=e.flippedSetType||null,this._removeSetType=e.removeSetType||null,this._appendToFigure=!1,this._staticId=-1}hasStaticId(){return this._staticId>=0}get staticId(){return this._staticId}set staticId(e){this._staticId=e}get setType(){return this._setType}get flippedSetType(){return this._flippedSetType}set flippedSetType(e){this._flippedSetType=e}get removeSetType(){return this._removeSetType}get appendToFigure(){return this._appendToFigure}set appendToFigure(e){this._appendToFigure=e}}class UO{constructor(){this._parts=new Map,this._activePartSets=new Map}parse(e){if(e.partSet&&e.partSet.length>0)for(const t of e.partSet)t&&this._parts.set(t.setType,new Pc(t));if(e.activePartSets&&e.activePartSets.length>0)for(const t of e.activePartSets)t&&this._activePartSets.set(t.id,new Eg(t));return!0}appendJSON(e){if(e.partSet&&e.partSet.length>0)for(const t of e.partSet)t&&this._parts.set(t.setType,new Pc(t));if(e.activePartSets&&e.activePartSets.length>0)for(const t of e.activePartSets)t&&this._activePartSets.set(t.id,new Eg(t));return!1}getActiveParts(e){const t=this._activePartSets.get(e.activePartSet);return t?t.parts:[]}getPartDefinition(e){const t=this._parts.get(e);return t||null}addPartDefinition(e){const t=e.setType;let s=this._parts.get(t);return s||(s=new Pc(e),this._parts.set(t,s)),s}getActivePartSet(e){const t=this._activePartSets.get(e.activePartSet);return t||null}get parts(){return this._parts}get activePartSets(){return this._activePartSets}}class Nc{constructor(e,t,s,i,n,a,o,u,l="",d=!1,c=1){this._bodyPartId=e,this._partType=t,this._partId=s,this._color=i,this._frames=n,this._action=a,this._isColorable=o,this._paletteMapId=u,this._flippedPartType=l,this._isBlendable=d,this._blendTransform=null,this._partType==="ey"&&(this._isColorable=!1)}getFrameIndex(e){if(!this._frames||!this._frames.length)return 0;const t=e%this._frames.length;return this._frames[t]instanceof Eu?this._frames[t].number:t}getFrameDefinition(e){const t=e%this._frames.length;return this._frames&&this._frames.length>t&&this._frames[t]instanceof Eu?this._frames[t]:null}getCacheableKey(e){const t=e%this._frames.length;if(this._frames&&this._frames.length>t&&this._frames[t]instanceof Eu){const s=this._frames[t];return this.partId+":"+s.assetPartDefinition+":"+s.number}return this.partId+":"+t}get bodyPartId(){return this._bodyPartId}get partType(){return this._partType}get partId(){return this._partId}get color(){return this._color}get action(){return this._action}get isColorable(){return this._isColorable}set isColorable(e){this._isColorable=e}get paletteMapId(){return this._paletteMapId}get flippedPartType(){return this._flippedPartType}get isBlendable(){return this._isBlendable}toString(){return[this._bodyPartId,this._partType,this._partId].join(":")}}class de{constructor(){this._gender="M",this._avatarEffectType=-1}loadAvatarData(e,t){this._data=new Map,this._colors=new Map,this._gender=t,this.parseFigureString(e)}dispose(){this._data=null,this._colors=null,this._isDisposed=!0}get disposed(){return this._isDisposed}parseFigureString(e){if(e)for(const t of e.split(".")){const s=t.split("-");if(s.length>0){const i=s[0],n=parseInt(s[1]),a=[];let o=2;for(;o<s.length;)a.push(parseInt(s[o])),o++;a.length||a.push(0),this.savePartSetId(i,n,!1),this.savePartSetColourId(i,a,!1)}}}hasSetType(e){return!!this._data.get(e)}getPartSetId(e){return this.hasSetType(e)?this._data.get(e):-1}getColourIds(e){return this._colors.get(e)?this._colors.get(e):[]}getFigureString(){let e="";const t=[];for(const[i,n]of this._data.entries()){let a=i+"-"+n;const o=this._colors.get(i);if(o)for(const u of o)a=a+("-"+u);t.push(a)}let s=0;for(;s<t.length;)e=e+t[s],s<t.length-1&&(e=e+"."),s++;return e}savePartData(e,t,s,i=!1){this.savePartSetId(e,t,i),this.savePartSetColourId(e,s,i)}savePartSetId(e,t,s=!0){switch(e){case de.HD:case de.HAIR:case de.HAT:case de.HEAD_ACCESSORIES:case de.EYE_ACCESSORIES:case de.FACE_ACCESSORIES:case de.SHIRT:case de.JACKET:case de.CHEST_ACCESSORIES:case de.CHEST_PRINTS:case de.TROUSERS:case de.SHOES:case de.TROUSER_ACCESSORIES:t>=0?this._data.set(e,t):this._data.delete(e)}}savePartSetColourId(e,t,s=!0){switch(e){case de.HD:case de.HAIR:case de.HAT:case de.HEAD_ACCESSORIES:case de.EYE_ACCESSORIES:case de.FACE_ACCESSORIES:case de.SHIRT:case de.JACKET:case de.CHEST_ACCESSORIES:case de.CHEST_PRINTS:case de.TROUSERS:case de.SHOES:case de.TROUSER_ACCESSORIES:this._colors.set(e,t);return}}getFigureStringWithFace(e){const t=[de.HD];let s="";const i=[];for(const a of t){const o=this._colors.get(a);if(o){let u=this._data.get(a);a===de.HD&&(u=e);let l=a+"-"+u;if(u>=0){let d=0;for(;d<o.length;)l=l+("-"+o[d]),d++}i.push(l)}}let n=0;for(;n<i.length;)s=s+i[n],n<i.length-1&&(s=s+"."),n++;return s}get gender(){return this._gender}}de.MALE="M",de.FEMALE="F",de.UNISEX="U",de.SCALE="h",de.STD="std",de.DEFAULT_FRAME="0",de.HD="hd",de.HAIR="hr",de.HAT="ha",de.HEAD_ACCESSORIES="he",de.EYE_ACCESSORIES="ea",de.FACE_ACCESSORIES="fa",de.JACKET="cc",de.SHIRT="ch",de.CHEST_ACCESSORIES="ca",de.CHEST_PRINTS="cp",de.TROUSERS="lg",de.SHOES="sh",de.TROUSER_ACCESSORIES="wa",de.BLOCKED_FX_TYPES=[28,29,30,33,34,35,36,37,38,39,40,41,42,43,68];class Fq{constructor(e){this._data=[],this._maxSize=e,this._index=0}reset(){this._data=[],this._index=0}addValue(e){this._data.length<this._maxSize?this._data.push(e):this._data[this._index]=e,this._index=(this._index+1)%this._maxSize}getMax(){let e=Number.MIN_VALUE,t=0;for(;t<this._maxSize;)this._data[t]>e&&(e=this._data[t]),t++;return e}getMin(){let e=Number.MAX_VALUE,t=0;for(;t<this._maxSize;)this._data[t]<e&&(e=this._data[t]),t++;return e}}class St{constructor(e,t){this._location=e,this._direction=t}get location(){return this._location}get direction(){return this._direction}}class mu extends Ss{constructor(){super(),this._object=null,this._events=null,this._time=0}initialize(e){}onDispose(){this._object=null}update(e){this._time=e}processUpdateMessage(e){!e||!this._object||(this._object.setLocation(e.location),this._object.setDirection(e.direction))}getEventTypes(){return[]}mergeTypes(e,t){const s=e.concat();for(const i of t)!i||s.indexOf(i)>=0||s.push(i);return s}mouseEvent(e,t){}useObject(){}setObject(e){if(this._object!==e){if(this._object&&this._object.setLogic(null),!e){this.dispose(),this._object=null;return}this._object=e,this._object.setLogic(this)}}tearDown(){}get object(){return this._object}get eventDispatcher(){return this._events}set eventDispatcher(e){this._events=e}get widget(){return null}get contextMenu(){return null}get time(){return this._time}}class mg{constructor(){this._map=new Map,this._updateCounter=0}dispose(){this._map.clear(),this._updateCounter=0}getValue(e){return this._map.get(e)}setValue(e,t){this._map.has(e)&&this._map.get(e)===t||(this._map.set(e,t),this._updateCounter++)}removeKey(e){e&&(this._map.delete(e),this._updateCounter++)}get updateCounter(){return this._updateCounter}}class pu extends Ss{constructor(e,t,s){super(),this._id=e,this._instanceId=pu.OBJECT_COUNTER++,this._type=s,this._model=new mg,this._location=new y,this._direction=new y,this._states=[],this._visualization=null,this._logic=null,this._pendingLogicMessages=[],this._updateCounter=0,this._isReady=!1;let i=t-1;for(;i>=0;)this._states[i]=0,i--}onDispose(){this._pendingLogicMessages=[],this.setVisualization(null),this.setLogic(null),this._model&&this._model.dispose(),super.onDispose()}getLocation(){return this._location}setLocation(e){e&&(e.x===this._location.x&&e.y===this._location.y&&e.z===this._location.z||(this._location.x=e.x,this._location.y=e.y,this._location.z=e.z,this._updateCounter++))}getDirection(){return this._direction}setDirection(e){e&&(e.x===this._direction.x&&e.y===this._direction.y&&e.z===this._direction.z||(this._direction.x=(e.x%360+360)%360,this._direction.y=(e.y%360+360)%360,this._direction.z=(e.z%360+360)%360,this._updateCounter++))}getState(e=0){return e>=0&&e<this._states.length?this._states[e]:-1}setState(e,t=0){return t>=0&&t<this._states.length?(this._states[t]!==e&&(this._states[t]=e,this._updateCounter++),!0):!1}setVisualization(e){this._visualization!==e&&(this._visualization&&this._visualization.dispose(),this._visualization=e,this._visualization&&(this._visualization.object=this))}setLogic(e){if(this._logic===e)return;const t=this._logic;if(t&&(this._logic=null,t.setObject(null)),this._logic=e,this._logic)for(this._logic.setObject(this);this._pendingLogicMessages.length;){const s=this._pendingLogicMessages.shift();this._logic.processUpdateMessage(s)}}processUpdateMessage(e){if(this._logic)return this._logic.processUpdateMessage(e);this._pendingLogicMessages.push(e)}tearDown(){this._logic&&this._logic.tearDown()}get id(){return this._id}get instanceId(){return this._instanceId}get type(){return this._type}get model(){return this._model}get visualization(){return this._visualization}get mouseHandler(){return this._logic}get logic(){return this._logic}get location(){return this._location}get direction(){return this._direction}get updateCounter(){return this._updateCounter}set updateCounter(e){this._updateCounter=e}get isReady(){return this._isReady}set isReady(e){this._isReady=e}}pu.OBJECT_COUNTER=0;class Ao{constructor(){this._id=Ao.SPRITE_COUNTER++,this._name="",this._type="",this._spriteType=cs.DEFAULT,this._texture=null,this._container=null,this._width=0,this._height=0,this._offsetX=0,this._offsetY=0,this._flipH=!1,this._flipV=!1,this._direction=0,this._alpha=255,this._blendMode=se.NORMAL,this._color=16777215,this._relativeDepth=0,this._varyingDepth=!1,this._libraryAssetName="",this._clickHandling=!1,this._visible=!0,this._tag="",this._posture=null,this._alphaTolerance=Ks.MATCH_OPAQUE_PIXELS,this._filters=[],this._updateCounter=0,this._updateContainer=!1}dispose(){this._texture=null,this._width=0,this._height=0}get id(){return this._id}set id(e){this._id=e}get name(){return this._name}set name(e){this._name!==e&&(this._name=e,this._updateCounter++)}get type(){return this._type}set type(e){this._type=e}get spriteType(){return this._spriteType}set spriteType(e){this._spriteType=e}get texture(){return this._texture}set texture(e){this._texture!==e&&(e&&(this._width=e.width,this._height=e.height),this._texture=e,this._updateCounter++)}get container(){return this._container}set container(e){this._container!==e&&(this.texture=Re.EMPTY,e&&(this._width=e.width,this._height=e.height),this._container=e,this._updateCounter++,this._updateContainer=!0)}get width(){return this._width}get height(){return this._height}get offsetX(){return this._offsetX}set offsetX(e){this._offsetX!==e&&(this._offsetX=e,this._updateCounter++)}get offsetY(){return this._offsetY}set offsetY(e){this._offsetY!==e&&(this._offsetY=e,this._updateCounter++)}get flipH(){return this._flipH}set flipH(e){this._flipH!==e&&(this._flipH=e,this._updateCounter++)}get flipV(){return this._flipV}set flipV(e){this._flipV!==e&&(this._flipV=e,this._updateCounter++)}get direction(){return this._direction}set direction(e){this._direction=e}get alpha(){return this._alpha}set alpha(e){e=e&255,this._alpha!==e&&(this._alpha=e,this._updateCounter++)}get blendMode(){return this._blendMode}set blendMode(e){this._blendMode!==e&&(this._blendMode=e,this._updateCounter++)}get color(){return this._color}set color(e){e=e&16777215,this._color!==e&&(this._color=e,this._updateCounter++)}get relativeDepth(){return this._relativeDepth}set relativeDepth(e){this._relativeDepth!==e&&(this._relativeDepth=e,this._updateCounter++)}get varyingDepth(){return this._varyingDepth}set varyingDepth(e){e!==this._varyingDepth&&(this._varyingDepth=e,this._updateCounter++)}get libraryAssetName(){return this._libraryAssetName}set libraryAssetName(e){this._libraryAssetName=e}get clickHandling(){return this._clickHandling}set clickHandling(e){this._clickHandling=e}get visible(){return this._visible}set visible(e){this._visible!==e&&(this._visible=e,this._updateCounter++)}get tag(){return this._tag}set tag(e){this._tag!==e&&(this._tag=e,this._updateCounter++)}get posture(){return this._posture}set posture(e){this._posture!==e&&(this._posture=e,this._updateCounter++)}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(e){this._alphaTolerance!==e&&(this._alphaTolerance=e,this._updateCounter++)}get filters(){return this._filters}set filters(e){this._filters=e,this._updateCounter++}get updateCounter(){return this._updateCounter}get updateContainer(){return this._updateContainer}set updateContainer(e){this._updateContainer=e}}Ao.SPRITE_COUNTER=0;class Mn{constructor(){this._id=Mn.VISUALIZATION_COUNTER++,this._object=null,this._asset=null,this._sprites=[],this._scale=-1,this._updateObjectCounter=-1,this._updateModelCounter=-1,this._updateSpriteCounter=-1}initialize(e){return!1}update(e,t,s,i){}reset(){this._scale=-1}dispose(){if(this._sprites){for(;this._sprites.length;){const e=this._sprites[0];e&&e.dispose(),this._sprites.pop()}this._sprites=null}this._object=null,this._asset=null}getSprite(e){return e>=0&&e<this._sprites.length?this._sprites[e]:null}getSpriteList(){return null}createSprite(){return this.createSpriteAtIndex(this._sprites.length)}createSpriteAtIndex(e){const t=new Ao;return e>=this._sprites.length?this._sprites.push(t):this._sprites.splice(e,0,t),t}createSprites(e){for(;this._sprites.length>e;){const t=this._sprites[this._sprites.length-1];t&&t.dispose(),this._sprites.pop()}for(;this._sprites.length<e;)this._sprites.push(new Ao)}get image(){return this.getImage(0,-1)}getImage(e,t){const s=this.getBoundingRectangle();if(s.width*s.height===0)return null;const i=this.totalSprites,n=[];let a=0;for(;a<i;){const l=this.getSprite(a);l&&l.visible&&l.texture&&n.push(l),a++}n.sort((l,d)=>d.relativeDepth-l.relativeDepth);const o=new nr;for(a=0;a<n.length;){const l=n[a],d=l.texture;if(d){const c=new ot(d);c.alpha=l.alpha/255,c.tint=l.color,c.x=l.offsetX,c.y=l.offsetY,c.blendMode=l.blendMode,c.filters=l.filters,l.flipH&&(c.scale.x=-1),l.flipV&&(c.scale.y=-1),o.addChild(c)}a++}const u=Je.generateTexture(o);return u||null}getBoundingRectangle(){const e=this.totalSprites,t=new he;let s=0;for(;s<e;){const i=this.getSprite(s);if(i&&i.texture&&i.visible){const n=i.flipH?-i.width+i.offsetX:i.offsetX,a=i.flipV?-i.height+i.offsetY:i.offsetY,o=new k(n,a);s===0?(t.x=o.x,t.y=o.y,t.width=i.width,t.height=i.height):(o.x<t.x&&(t.x=o.x),o.y<t.y&&(t.y=o.y),o.x+i.width>t.right&&(t.width=o.x+i.width-t.x),o.y+i.height>t.bottom&&(t.height=o.y+i.height-t.y))}s++}return t}get instanceId(){return this._id}get object(){return this._object}set object(e){this._object=e}get asset(){return this._asset}set asset(e){this._asset&&this._asset.removeReference(),this._asset=e,this._asset&&this._asset.addReference()}get sprites(){return this._sprites}get totalSprites(){return this._sprites.length}get updateObjectCounter(){return this._updateObjectCounter}set updateObjectCounter(e){this._updateObjectCounter=e}get updateModelCounter(){return this._updateModelCounter}set updateModelCounter(e){this._updateModelCounter=e}get updateSpriteCounter(){return this._updateSpriteCounter}set updateSpriteCounter(e){this._updateSpriteCounter=e}get spriteCount(){return this._sprites.length}}Mn.VISUALIZATION_COUNTER=0;class FO{constructor(e){this._roomObjectVariableAccurateZ=e||"",this._location=new y,this._screenLocation=new y,this._locationChanged=!1,this._geometryUpdateId=-1,this._objectUpdateId=-1}dispose(){this._screenLocation=null}updateLocation(e,t){if(!e||!t)return null;let s=!1;const i=e.getLocation();if((t.updateId!==this._geometryUpdateId||e.updateCounter!==this._objectUpdateId)&&(this._objectUpdateId=e.updateCounter,(t.updateId!==this._geometryUpdateId||i.x!==this._location.x||i.y!==this._location.y||i.z!==this._location.z)&&(this._geometryUpdateId=t.updateId,this._location.assign(i),s=!0)),this._locationChanged=s,this._locationChanged){const n=t.getScreenPosition(i);if(!n)return null;const a=e.model.getValue(this._roomObjectVariableAccurateZ);if(isNaN(a)||a===0){const o=new y(Math.round(i.x),Math.round(i.y),i.z);if(o.x!==i.x||o.y!==i.y){const u=t.getScreenPosition(o);this._screenLocation.assign(n),u&&(this._screenLocation.z=u.z)}else this._screenLocation.assign(n)}else this._screenLocation.assign(n);this._screenLocation.x=Math.round(this._screenLocation.x),this._screenLocation.y=Math.round(this._screenLocation.y)}return this._screenLocation}get locationChanged(){return this._locationChanged}}class wO{constructor(){this._sprites=[],this._updateId1=-1,this._updateId2=-1,this._isEmpty=!1}get spriteCount(){return this._sprites.length}get isEmpty(){return this._isEmpty}dispose(){this.setSpriteCount(0)}addSprite(e){this._sprites.push(e)}getSprite(e){return this._sprites[e]}get sprites(){return this._sprites}needsUpdate(e,t){return e===this._updateId1&&t===this._updateId2?!1:(this._updateId1=e,this._updateId2=t,!0)}setSpriteCount(e){if(e<this._sprites.length){let t=e;for(;t<this._sprites.length;){const s=this._sprites[t];s&&s.dispose(),t++}this._sprites.splice(e,this._sprites.length-e)}this._isEmpty=!this._sprites.length}}class xO{constructor(e){this._location=new FO(e),this._sprites=new wO}get location(){return this._location}get sprites(){return this._sprites}dispose(){this._location&&(this._location.dispose(),this._location=null),this._sprites&&(this._sprites.dispose(),this._sprites=null)}get objectId(){return this._objectId}set objectId(e){this._objectId=e}}class yo{constructor(e){this._data=new Map,this._roomObjectVariableAccurateZ=e}dispose(){if(this._data){for(const[e,t]of this._data.entries())t&&(this._data.delete(e),t.dispose());this._data=null}}getObjectCache(e){let t=this._data.get(e);return t||(t=new xO(this._roomObjectVariableAccurateZ),this._data.set(e,t)),t}removeObjectCache(e){const t=this._data.get(e);t&&(this._data.delete(e),t.dispose())}getSortableSpriteList(){const e=[];for(const t of this._data.values()){if(!t)continue;const s=t.sprites&&t.sprites.sprites;if(!(!s||!s.length)){for(const i of s)if(i&&i.sprite.spriteType!==cs.ROOM_PLANE&&i.sprite.name!==""){const n=new lg;n.objectId=t.objectId,n.x=i.x,n.y=i.y,n.z=i.z,n.name=i.sprite.name||"",n.flipH=i.sprite.flipH,n.alpha=i.sprite.alpha,n.color=i.sprite.color.toString(),n.blendMode=i.sprite.blendMode.toString(),n.width=i.sprite.width,n.height=i.sprite.height,n.type=i.sprite.type,n.posture=i.sprite.posture;const a=this.isSkewedSprite(i.sprite);a&&(n.skew=i.sprite.direction%4===0?-.5:.5),(a||i.name.indexOf("%image.library.url%")>=0||i.name.indexOf("%group.badge.url%")>=0)&&n.width<=yo.MAX_SIZE_FOR_AVG_COLOR&&n.height<=yo.MAX_SIZE_FOR_AVG_COLOR&&i.sprite.name.indexOf("external_image_wallitem")===0&&(n.frame=!0),e.push(n)}}}return!e||!e.length?null:e}isSkewedSprite(e){return e.type?e.type.indexOf("external_image_wallitem")===0&&e.tag==="THUMBNAIL"||e.type.indexOf("guild_forum")===0&&e.tag==="THUMBNAIL":!1}getPlaneSortableSprites(){const e=[];for(const t of this._data.values())for(const s of t.sprites.sprites)s.sprite.spriteType===cs.ROOM_PLANE&&e.push(s);return e}}yo.MAX_SIZE_FOR_AVG_COLOR=200;/*!
 * @pixi/graphics - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/graphics is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ji;(function(r){r.MITER="miter",r.BEVEL="bevel",r.ROUND="round"})(ji||(ji={}));var Pn;(function(r){r.BUTT="butt",r.ROUND="round",r.SQUARE="square"})(Pn||(Pn={}));var Iu={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(r,e){if(e===void 0&&(e=20),!this.adaptive||!r||isNaN(r))return e;var t=Math.ceil(r/this.maxLength);return t<this.minSegments?t=this.minSegments:t>this.maxSegments&&(t=this.maxSegments),t}},GO=function(){function r(){this.color=16777215,this.alpha=1,this.texture=Re.WHITE,this.matrix=null,this.visible=!1,this.reset()}return r.prototype.clone=function(){var e=new r;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},r.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=Re.WHITE,this.matrix=null,this.visible=!1},r.prototype.destroy=function(){this.texture=null,this.matrix=null},r}();/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var pg=function(r,e){return pg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var i in s)s.hasOwnProperty(i)&&(t[i]=s[i])},pg(r,e)};function Ig(r,e){pg(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function BO(r,e){var t,s;e===void 0&&(e=!1);var i=r.length;if(!(i<6)){for(var n=0,a=0,o=r[i-2],u=r[i-1];a<i;a+=2){var l=r[a],d=r[a+1];n+=(l-o)*(d+u),o=l,u=d}if(!e&&n>0||e&&n<=0)for(var c=i/2,a=c+c%2;a<i;a+=2){var _=i-a-2,f=i-a-1,g=a,I=a+1;t=[r[g],r[_]],r[_]=t[0],r[g]=t[1],s=[r[I],r[f]],r[f]=s[0],r[I]=s[1]}}}var HO={build:function(r){r.points=r.shape.points.slice()},triangulate:function(r,e){var t=r.points,s=r.holes,i=e.points,n=e.indices;if(t.length>=6){BO(t,!1);for(var a=[],o=0;o<s.length;o++){var u=s[o];BO(u.points,!0),a.push(t.length/2),t=t.concat(u.points)}var l=wI(t,a,2);if(!l)return;for(var d=i.length/2,o=0;o<l.length;o+=3)n.push(l[o]+d),n.push(l[o+1]+d),n.push(l[o+2]+d);for(var o=0;o<t.length;o++)i.push(t[o])}}},bc={build:function(r){var e=r.points,t,s,i,n,a,o;if(r.type===Wt.CIRC){var u=r.shape;t=u.x,s=u.y,a=o=u.radius,i=n=0}else if(r.type===Wt.ELIP){var l=r.shape;t=l.x,s=l.y,a=l.width,o=l.height,i=n=0}else{var d=r.shape,c=d.width/2,_=d.height/2;t=d.x+c,s=d.y+_,a=o=Math.max(0,Math.min(d.radius,Math.min(c,_))),i=c-a,n=_-o}if(!(a>=0&&o>=0&&i>=0&&n>=0)){e.length=0;return}var f=Math.ceil(2.3*Math.sqrt(a+o)),g=f*8+(i?4:0)+(n?4:0);if(e.length=g,g!==0){if(f===0){e.length=8,e[0]=e[6]=t+i,e[1]=e[3]=s+n,e[2]=e[4]=t-i,e[5]=e[7]=s-n;return}var I=0,p=f*4+(i?2:0)+2,R=p,S=g;{var O=i+a,A=n,C=t+O,M=t-O,N=s+A;if(e[I++]=C,e[I++]=N,e[--p]=N,e[--p]=M,n){var L=s-A;e[R++]=M,e[R++]=L,e[--S]=L,e[--S]=C}}for(var b=1;b<f;b++){var D=Math.PI/2*(b/f),O=i+Math.cos(D)*a,A=n+Math.sin(D)*o,C=t+O,M=t-O,N=s+A,L=s-A;e[I++]=C,e[I++]=N,e[--p]=N,e[--p]=M,e[R++]=M,e[R++]=L,e[--S]=L,e[--S]=C}{var O=i,A=n+o,C=t+O,M=t-O,N=s+A,L=s-A;e[I++]=C,e[I++]=N,e[--S]=L,e[--S]=C,i&&(e[I++]=M,e[I++]=N,e[--S]=L,e[--S]=M)}}},triangulate:function(r,e){var t=r.points,s=e.points,i=e.indices;if(t.length!==0){var n=s.length/2,a=n,o,u;if(r.type!==Wt.RREC){var l=r.shape;o=l.x,u=l.y}else{var d=r.shape;o=d.x+d.width/2,u=d.y+d.height/2}var c=r.matrix;s.push(r.matrix?c.a*o+c.c*u+c.tx:o,r.matrix?c.b*o+c.d*u+c.ty:u),n++,s.push(t[0],t[1]);for(var _=2;_<t.length;_+=2)s.push(t[_],t[_+1]),i.push(n++,a,n);i.push(a+1,a,n)}}},wq={build:function(r){var e=r.shape,t=e.x,s=e.y,i=e.width,n=e.height,a=r.points;a.length=0,a.push(t,s,t+i,s,t+i,s+n,t,s+n)},triangulate:function(r,e){var t=r.points,s=e.points,i=s.length/2;s.push(t[0],t[1],t[2],t[3],t[6],t[7],t[4],t[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}};function Co(r,e,t){var s=e-r;return r+s*t}function Dc(r,e,t,s,i,n,a){a===void 0&&(a=[]);for(var o=20,u=a,l=0,d=0,c=0,_=0,f=0,g=0,I=0,p=0;I<=o;++I)p=I/o,l=Co(r,t,p),d=Co(e,s,p),c=Co(t,i,p),_=Co(s,n,p),f=Co(l,c,p),g=Co(d,_,p),!(I===0&&u[u.length-2]===f&&u[u.length-1]===g)&&u.push(f,g);return u}var xq={build:function(r){if(Po.nextRoundedRectBehavior){bc.build(r);return}var e=r.shape,t=r.points,s=e.x,i=e.y,n=e.width,a=e.height,o=Math.max(0,Math.min(e.radius,Math.min(n,a)/2));t.length=0,o?(Dc(s,i+o,s,i,s+o,i,t),Dc(s+n-o,i,s+n,i,s+n,i+o,t),Dc(s+n,i+a-o,s+n,i+a,s+n-o,i+a,t),Dc(s+o,i+a,s,i+a,s,i+a-o,t)):t.push(s,i,s+n,i,s+n,i+a,s,i+a)},triangulate:function(r,e){if(Po.nextRoundedRectBehavior){bc.triangulate(r,e);return}for(var t=r.points,s=e.points,i=e.indices,n=s.length/2,a=wI(t,null,2),o=0,u=a.length;o<u;o+=3)i.push(a[o]+n),i.push(a[o+1]+n),i.push(a[o+2]+n);for(var o=0,u=t.length;o<u;o++)s.push(t[o],t[++o])}};function kO(r,e,t,s,i,n,a,o){var u=r-t*i,l=e-s*i,d=r+t*n,c=e+s*n,_,f;a?(_=s,f=-t):(_=-s,f=t);var g=u+_,I=l+f,p=d+_,R=c+f;return o.push(g,I),o.push(p,R),2}function Ra(r,e,t,s,i,n,a,o){var u=t-r,l=s-e,d=Math.atan2(u,l),c=Math.atan2(i-r,n-e);o&&d<c?d+=Math.PI*2:!o&&d>c&&(c+=Math.PI*2);var _=d,f=c-d,g=Math.abs(f),I=Math.sqrt(u*u+l*l),p=(15*g*Math.sqrt(I)/Math.PI>>0)+1,R=f/p;if(_+=R,o){a.push(r,e),a.push(t,s);for(var S=1,O=_;S<p;S++,O+=R)a.push(r,e),a.push(r+Math.sin(O)*I,e+Math.cos(O)*I);a.push(r,e),a.push(i,n)}else{a.push(t,s),a.push(r,e);for(var S=1,O=_;S<p;S++,O+=R)a.push(r+Math.sin(O)*I,e+Math.cos(O)*I),a.push(r,e);a.push(i,n),a.push(r,e)}return p*2}function Gq(r,e){var t=r.shape,s=r.points||t.points.slice(),i=e.closePointEps;if(s.length!==0){var n=r.lineStyle,a=new k(s[0],s[1]),o=new k(s[s.length-2],s[s.length-1]),u=t.type!==Wt.POLY||t.closeStroke,l=Math.abs(a.x-o.x)<i&&Math.abs(a.y-o.y)<i;if(u){s=s.slice(),l&&(s.pop(),s.pop(),o.set(s[s.length-2],s[s.length-1]));var d=(a.x+o.x)*.5,c=(o.y+a.y)*.5;s.unshift(d,c),s.push(d,c)}var _=e.points,f=s.length/2,g=s.length,I=_.length/2,p=n.width/2,R=p*p,S=n.miterLimit*n.miterLimit,O=s[0],A=s[1],C=s[2],M=s[3],N=0,L=0,b=-(A-M),D=O-C,x=0,q=0,$=Math.sqrt(b*b+D*D);b/=$,D/=$,b*=p,D*=p;var Te=n.alignment,j=(1-Te)*2,Q=Te*2;u||(n.cap===Pn.ROUND?g+=Ra(O-b*(j-Q)*.5,A-D*(j-Q)*.5,O-b*j,A-D*j,O+b*Q,A+D*Q,_,!0)+2:n.cap===Pn.SQUARE&&(g+=kO(O,A,b,D,j,Q,!0,_))),_.push(O-b*j,A-D*j),_.push(O+b*Q,A+D*Q);for(var oe=1;oe<f-1;++oe){O=s[(oe-1)*2],A=s[(oe-1)*2+1],C=s[oe*2],M=s[oe*2+1],N=s[(oe+1)*2],L=s[(oe+1)*2+1],b=-(A-M),D=O-C,$=Math.sqrt(b*b+D*D),b/=$,D/=$,b*=p,D*=p,x=-(M-L),q=C-N,$=Math.sqrt(x*x+q*q),x/=$,q/=$,x*=p,q*=p;var $t=C-O,Gt=A-M,K=C-N,ae=L-M,De=$t*K+Gt*ae,je=Gt*K-ae*$t,Le=je<0;if(Math.abs(je)<.001*Math.abs(De)){_.push(C-b*j,M-D*j),_.push(C+b*Q,M+D*Q),De>=0&&(n.join===ji.ROUND?g+=Ra(C,M,C-b*j,M-D*j,C-x*j,M-q*j,_,!1)+4:g+=2,_.push(C-x*Q,M-q*Q),_.push(C+x*j,M+q*j));continue}var Be=(-b+O)*(-D+M)-(-b+C)*(-D+A),Xe=(-x+N)*(-q+M)-(-x+C)*(-q+L),ht=($t*Xe-K*Be)/je,gt=(ae*Be-Gt*Xe)/je,es=(ht-C)*(ht-C)+(gt-M)*(gt-M),bt=C+(ht-C)*j,Et=M+(gt-M)*j,Bt=C-(ht-C)*Q,jt=M-(gt-M)*Q,vi=Math.min($t*$t+Gt*Gt,K*K+ae*ae),Oi=Le?j:Q,ll=vi+Oi*Oi*R,AZ=es<=ll;AZ?n.join===ji.BEVEL||es/R>S?(Le?(_.push(bt,Et),_.push(C+b*Q,M+D*Q),_.push(bt,Et),_.push(C+x*Q,M+q*Q)):(_.push(C-b*j,M-D*j),_.push(Bt,jt),_.push(C-x*j,M-q*j),_.push(Bt,jt)),g+=2):n.join===ji.ROUND?Le?(_.push(bt,Et),_.push(C+b*Q,M+D*Q),g+=Ra(C,M,C+b*Q,M+D*Q,C+x*Q,M+q*Q,_,!0)+4,_.push(bt,Et),_.push(C+x*Q,M+q*Q)):(_.push(C-b*j,M-D*j),_.push(Bt,jt),g+=Ra(C,M,C-b*j,M-D*j,C-x*j,M-q*j,_,!1)+4,_.push(C-x*j,M-q*j),_.push(Bt,jt)):(_.push(bt,Et),_.push(Bt,jt)):(_.push(C-b*j,M-D*j),_.push(C+b*Q,M+D*Q),n.join===ji.ROUND?Le?g+=Ra(C,M,C+b*Q,M+D*Q,C+x*Q,M+q*Q,_,!0)+2:g+=Ra(C,M,C-b*j,M-D*j,C-x*j,M-q*j,_,!1)+2:n.join===ji.MITER&&es/R<=S&&(Le?(_.push(Bt,jt),_.push(Bt,jt)):(_.push(bt,Et),_.push(bt,Et)),g+=2),_.push(C-x*j,M-q*j),_.push(C+x*Q,M+q*Q),g+=2)}O=s[(f-2)*2],A=s[(f-2)*2+1],C=s[(f-1)*2],M=s[(f-1)*2+1],b=-(A-M),D=O-C,$=Math.sqrt(b*b+D*D),b/=$,D/=$,b*=p,D*=p,_.push(C-b*j,M-D*j),_.push(C+b*Q,M+D*Q),u||(n.cap===Pn.ROUND?g+=Ra(C-b*(j-Q)*.5,M-D*(j-Q)*.5,C-b*j,M-D*j,C+b*Q,M+D*Q,_,!1)+2:n.cap===Pn.SQUARE&&(g+=kO(C,M,b,D,j,Q,!1,_)));for(var yZ=e.indices,CZ=Iu.epsilon*Iu.epsilon,oe=I;oe<g+I-2;++oe)O=_[oe*2],A=_[oe*2+1],C=_[(oe+1)*2],M=_[(oe+1)*2+1],N=_[(oe+2)*2],L=_[(oe+2)*2+1],!(Math.abs(O*(M-L)+C*(L-A)+N*(A-M))<CZ)&&yZ.push(oe,oe+1,oe+2)}}function Bq(r,e){var t=0,s=r.shape,i=r.points||s.points,n=s.type!==Wt.POLY||s.closeStroke;if(i.length!==0){var a=e.points,o=e.indices,u=i.length/2,l=a.length/2,d=l;for(a.push(i[0],i[1]),t=1;t<u;t++)a.push(i[t*2],i[t*2+1]),o.push(d,d+1),d++;n&&o.push(d,l)}}function VO(r,e){r.lineStyle.native?Bq(r,e):Gq(r,e)}var jO=function(){function r(){}return r.curveTo=function(e,t,s,i,n,a){var o=a[a.length-2],u=a[a.length-1],l=u-t,d=o-e,c=i-t,_=s-e,f=Math.abs(l*_-d*c);if(f<1e-8||n===0)return(a[a.length-2]!==e||a[a.length-1]!==t)&&a.push(e,t),null;var g=l*l+d*d,I=c*c+_*_,p=l*c+d*_,R=n*Math.sqrt(g)/f,S=n*Math.sqrt(I)/f,O=R*p/g,A=S*p/I,C=R*_+S*d,M=R*c+S*l,N=d*(S+O),L=l*(S+O),b=_*(R+A),D=c*(R+A),x=Math.atan2(L-M,N-C),q=Math.atan2(D-M,b-C);return{cx:C+e,cy:M+t,radius:n,startAngle:x,endAngle:q,anticlockwise:d*c>_*l}},r.arc=function(e,t,s,i,n,a,o,u,l){for(var d=o-a,c=Iu._segmentsCount(Math.abs(d)*n,Math.ceil(Math.abs(d)/ch)*40),_=d/(c*2),f=_*2,g=Math.cos(_),I=Math.sin(_),p=c-1,R=p%1/p,S=0;S<=p;++S){var O=S+R*S,A=_+a+f*O,C=Math.cos(A),M=-Math.sin(A);l.push((g*C+I*M)*n+s,(g*-M+I*C)*n+i)}},r}(),Hq=function(){function r(){}return r.curveLength=function(e,t,s,i,n,a,o,u){for(var l=10,d=0,c=0,_=0,f=0,g=0,I=0,p=0,R=0,S=0,O=0,A=0,C=e,M=t,N=1;N<=l;++N)c=N/l,_=c*c,f=_*c,g=1-c,I=g*g,p=I*g,R=p*e+3*I*c*s+3*g*_*n+f*o,S=p*t+3*I*c*i+3*g*_*a+f*u,O=C-R,A=M-S,C=R,M=S,d+=Math.sqrt(O*O+A*A);return d},r.curveTo=function(e,t,s,i,n,a,o){var u=o[o.length-2],l=o[o.length-1];o.length-=2;var d=Iu._segmentsCount(r.curveLength(u,l,e,t,s,i,n,a)),c=0,_=0,f=0,g=0,I=0;o.push(u,l);for(var p=1,R=0;p<=d;++p)R=p/d,c=1-R,_=c*c,f=_*c,g=R*R,I=g*R,o.push(f*u+3*_*R*e+3*c*g*s+I*n,f*l+3*_*R*t+3*c*g*i+I*a)},r}(),kq=function(){function r(){}return r.curveLength=function(e,t,s,i,n,a){var o=e-2*s+n,u=t-2*i+a,l=2*s-2*e,d=2*i-2*t,c=4*(o*o+u*u),_=4*(o*l+u*d),f=l*l+d*d,g=2*Math.sqrt(c+_+f),I=Math.sqrt(c),p=2*c*I,R=2*Math.sqrt(f),S=_/I;return(p*g+I*_*(g-R)+(4*f*c-_*_)*Math.log((2*I+S+g)/(S+R)))/(4*p)},r.curveTo=function(e,t,s,i,n){for(var a=n[n.length-2],o=n[n.length-1],u=Iu._segmentsCount(r.curveLength(a,o,e,t,s,i)),l=0,d=0,c=1;c<=u;++c){var _=c/u;l=a+(e-a)*_,d=o+(t-o)*_,n.push(l+(e+(s-e)*_-l)*_,d+(t+(i-t)*_-d)*_)}},r}(),Vq=function(){function r(){this.reset()}return r.prototype.begin=function(e,t,s){this.reset(),this.style=e,this.start=t,this.attribStart=s},r.prototype.end=function(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start},r.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},r}(),va,Tg=(va={},va[Wt.POLY]=HO,va[Wt.CIRC]=bc,va[Wt.ELIP]=bc,va[Wt.RECT]=wq,va[Wt.RREC]=xq,va),YO=[],Lc=[],WO=function(){function r(e,t,s,i){t===void 0&&(t=null),s===void 0&&(s=null),i===void 0&&(i=null),this.points=[],this.holes=[],this.shape=e,this.lineStyle=s,this.fillStyle=t,this.matrix=i,this.type=e.type}return r.prototype.clone=function(){return new r(this.shape,this.fillStyle,this.lineStyle,this.matrix)},r.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},r}(),Mo=new k,jq=function(r){Ig(e,r);function e(){var t=r.call(this)||this;return t.closePointEps=1e-4,t.boundsPadding=0,t.uvsFloat32=null,t.indicesUint16=null,t.batchable=!1,t.points=[],t.colors=[],t.uvs=[],t.indices=[],t.textureIds=[],t.graphicsData=[],t.drawCalls=[],t.batchDirty=-1,t.batches=[],t.dirty=0,t.cacheDirty=-1,t.clearDirty=0,t.shapeIndex=0,t._bounds=new xh,t.boundsDirty=-1,t}return Object.defineProperty(e.prototype,"bounds",{get:function(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Lc.push(this.drawCalls[t]);this.drawCalls.length=0;for(var t=0;t<this.batches.length;t++){var s=this.batches[t];s.reset(),YO.push(s)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,s,i,n){s===void 0&&(s=null),i===void 0&&(i=null),n===void 0&&(n=null);var a=new WO(t,s,i,n);return this.graphicsData.push(a),this.dirty++,this},e.prototype.drawHole=function(t,s){if(s===void 0&&(s=null),!this.graphicsData.length)return null;var i=new WO(t,null,null,s),n=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=n.lineStyle,n.holes.push(i),this.dirty++,this},e.prototype.destroy=function(){r.prototype.destroy.call(this);for(var t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var s=this.graphicsData,i=0;i<s.length;++i){var n=s[i];if(n.fillStyle.visible&&n.shape&&(n.matrix?n.matrix.applyInverse(t,Mo):Mo.copyFrom(t),n.shape.contains(Mo.x,Mo.y))){var a=!1;if(n.holes)for(var o=0;o<n.holes.length;o++){var u=n.holes[o];if(u.shape.contains(Mo.x,Mo.y)){a=!0;break}}if(!a)return!0}}return!1},e.prototype.updateBatches=function(){if(!this.graphicsData.length){this.batchable=!0;return}if(this.validateBatching()){this.cacheDirty=this.dirty;var t=this.uvs,s=this.graphicsData,i=null,n=null;this.batches.length>0&&(i=this.batches[this.batches.length-1],n=i.style);for(var a=this.shapeIndex;a<s.length;a++){this.shapeIndex++;var o=s[a],u=o.fillStyle,l=o.lineStyle,d=Tg[o.type];d.build(o),o.matrix&&this.transformPoints(o.points,o.matrix),(u.visible||l.visible)&&this.processHoles(o.holes);for(var c=0;c<2;c++){var _=c===0?u:l;if(_.visible){var f=_.texture.baseTexture,g=this.indices.length,I=this.points.length/2;f.wrapMode=Ai.REPEAT,c===0?this.processFill(o):this.processLine(o);var p=this.points.length/2-I;p!==0&&(i&&!this._compareStyles(n,_)&&(i.end(g,I),i=null),i||(i=YO.pop()||new Vq,i.begin(_,g,I),this.batches.push(i),n=_),this.addUvs(this.points,t,_.texture,I,p,_.matrix))}}}var R=this.indices.length,S=this.points.length/2;if(i&&i.end(R,S),this.batches.length===0){this.batchable=!0;return}var O=S>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&O===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=O?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}},e.prototype._compareStyles=function(t,s){return!(!t||!s||t.texture.baseTexture!==s.texture.baseTexture||t.color+t.alpha!==s.color+s.alpha||!!t.native!=!!s.native)},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,s=this.graphicsData.length;t<s;t++){var i=this.graphicsData[t],n=i.fillStyle,a=i.lineStyle;if(n&&!n.texture.baseTexture.valid||a&&!a.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,s=0,i=t.length;s<i;s++)for(var n=t[s],a=0;a<n.size;a++){var o=n.start+a;this.indicesUint16[o]=this.indicesUint16[o]-n.attribStart}},e.prototype.isBatchable=function(){if(this.points.length>65535*2)return!1;for(var t=this.batches,s=0;s<t.length;s++)if(t[s].style.native)return!1;return this.points.length<e.BATCHABLE_SIZE*2},e.prototype.buildDrawCalls=function(){for(var t=++Qe._globalBatch,s=0;s<this.drawCalls.length;s++)this.drawCalls[s].texArray.clear(),Lc.push(this.drawCalls[s]);this.drawCalls.length=0;var i=this.colors,n=this.textureIds,a=Lc.pop();a||(a=new df,a.texArray=new ff),a.texArray.count=0,a.start=0,a.size=0,a.type=Hr.TRIANGLES;var o=0,u=null,l=0,d=!1,c=Hr.TRIANGLES,_=0;this.drawCalls.push(a);for(var s=0;s<this.batches.length;s++){var f=this.batches[s],g=8,I=f.style,p=I.texture.baseTexture;d!==!!I.native&&(d=!!I.native,c=d?Hr.LINES:Hr.TRIANGLES,u=null,o=g,t++),u!==p&&(u=p,p._batchEnabled!==t&&(o===g&&(t++,o=0,a.size>0&&(a=Lc.pop(),a||(a=new df,a.texArray=new ff),this.drawCalls.push(a)),a.start=_,a.size=0,a.texArray.count=0,a.type=c),p.touched=1,p._batchEnabled=t,p._batchLocation=o,p.wrapMode=Ai.REPEAT,a.texArray.elements[a.texArray.count++]=p,o++)),a.size+=f.size,_+=f.size,l=p._batchLocation,this.addColors(i,I.color,I.alpha,f.attribSize,f.attribStart),this.addTextureIds(n,l,f.attribSize,f.attribStart)}Qe._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,s=this.uvs,i=this.colors,n=this.textureIds,a=new ArrayBuffer(t.length*3*4),o=new Float32Array(a),u=new Uint32Array(a),l=0,d=0;d<t.length/2;d++)o[l++]=t[d*2],o[l++]=t[d*2+1],o[l++]=s[d*2],o[l++]=s[d*2+1],u[l++]=i[d],o[l++]=n[d];this._buffer.update(a),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){if(t.holes.length)HO.triangulate(t,this);else{var s=Tg[t.type];s.triangulate(t,this)}},e.prototype.processLine=function(t){VO(t,this);for(var s=0;s<t.holes.length;s++)VO(t.holes[s],this)},e.prototype.processHoles=function(t){for(var s=0;s<t.length;s++){var i=t[s],n=Tg[i.type];n.build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,s){for(var i=0;i<t.length/2;i++){var n=t[i*2],a=t[i*2+1];t[i*2]=s.a*n+s.c*a+s.tx,t[i*2+1]=s.b*n+s.d*a+s.ty}},e.prototype.addColors=function(t,s,i,n,a){a===void 0&&(a=0);var o=(s>>16)+(s&65280)+((s&255)<<16),u=LT(o,i);t.length=Math.max(t.length,a+n);for(var l=0;l<n;l++)t[a+l]=u},e.prototype.addTextureIds=function(t,s,i,n){n===void 0&&(n=0),t.length=Math.max(t.length,n+i);for(var a=0;a<i;a++)t[n+a]=s},e.prototype.addUvs=function(t,s,i,n,a,o){o===void 0&&(o=null);for(var u=0,l=s.length,d=i.frame;u<a;){var c=t[(n+u)*2],_=t[(n+u)*2+1];if(o){var f=o.a*c+o.c*_+o.tx;_=o.b*c+o.d*_+o.ty,c=f}u++,s.push(c/d.width,_/d.height)}var g=i.baseTexture;(d.width<g.width||d.height<g.height)&&this.adjustUvs(s,i,l,a)},e.prototype.adjustUvs=function(t,s,i,n){for(var a=s.baseTexture,o=1e-6,u=i+n*2,l=s.frame,d=l.width/a.width,c=l.height/a.height,_=l.x/l.width,f=l.y/l.height,g=Math.floor(t[i]+o),I=Math.floor(t[i+1]+o),p=i+2;p<u;p+=2)g=Math.min(g,Math.floor(t[p]+o)),I=Math.min(I,Math.floor(t[p+1]+o));_-=g,f-=I;for(var p=i;p<u;p+=2)t[p]=(t[p]+_)*d,t[p+1]=(t[p+1]+f)*c},e.BATCHABLE_SIZE=100,e}(dR),Yq=function(r){Ig(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.width=0,t.alignment=.5,t.native=!1,t.cap=Pn.BUTT,t.join=ji.MITER,t.miterLimit=10,t}return e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},e.prototype.reset=function(){r.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},e}(GO),Wq=new Float32Array(3),Rg={},Po=function(r){Ig(e,r);function e(t){t===void 0&&(t=null);var s=r.call(this)||this;return s.shader=null,s.pluginName="batch",s.currentPath=null,s.batches=[],s.batchTint=-1,s.batchDirty=-1,s.vertexData=null,s._fillStyle=new GO,s._lineStyle=new Yq,s._matrix=null,s._holeMode=!1,s.state=Eh.for2d(),s._geometry=t||new jq,s._geometry.refCount++,s._transformID=-1,s.tint=16777215,s.blendMode=se.NORMAL,s}return Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return this.finishPoly(),new e(this._geometry)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),e.prototype.lineStyle=function(t,s,i,n,a){return t===void 0&&(t=null),s===void 0&&(s=0),i===void 0&&(i=1),n===void 0&&(n=.5),a===void 0&&(a=!1),typeof t=="number"&&(t={width:t,color:s,alpha:i,alignment:n,native:a}),this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){t=Object.assign({width:0,texture:Re.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:Pn.BUTT,join:ji.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();var s=t.width>0&&t.alpha>0;return s?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:s},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,s=this.currentPath.points.length;s>2&&(this.drawShape(this.currentPath),this.currentPath=new _h,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[s-2],t[s-1]))}else this.currentPath=new _h,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,s){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=s,this},e.prototype.lineTo=function(t,s){this.currentPath||this.moveTo(0,0);var i=this.currentPath.points,n=i[i.length-2],a=i[i.length-1];return(n!==t||a!==s)&&i.push(t,s),this},e.prototype._initCurve=function(t,s){t===void 0&&(t=0),s===void 0&&(s=0),this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[t,s]):this.moveTo(t,s)},e.prototype.quadraticCurveTo=function(t,s,i,n){this._initCurve();var a=this.currentPath.points;return a.length===0&&this.moveTo(0,0),kq.curveTo(t,s,i,n,a),this},e.prototype.bezierCurveTo=function(t,s,i,n,a,o){return this._initCurve(),Hq.curveTo(t,s,i,n,a,o,this.currentPath.points),this},e.prototype.arcTo=function(t,s,i,n,a){this._initCurve(t,s);var o=this.currentPath.points,u=jO.curveTo(t,s,i,n,a,o);if(u){var l=u.cx,d=u.cy,c=u.radius,_=u.startAngle,f=u.endAngle,g=u.anticlockwise;this.arc(l,d,c,_,f,g)}return this},e.prototype.arc=function(t,s,i,n,a,o){if(o===void 0&&(o=!1),n===a)return this;!o&&a<=n?a+=ch:o&&n<=a&&(n+=ch);var u=a-n;if(u===0)return this;var l=t+Math.cos(n)*i,d=s+Math.sin(n)*i,c=this._geometry.closePointEps,_=this.currentPath?this.currentPath.points:null;if(_){var f=Math.abs(_[_.length-2]-l),g=Math.abs(_[_.length-1]-d);f<c&&g<c||_.push(l,d)}else this.moveTo(l,d),_=this.currentPath.points;return jO.arc(l,d,t,s,i,n,a,o,_),this},e.prototype.beginFill=function(t,s){return t===void 0&&(t=0),s===void 0&&(s=1),this.beginTextureFill({texture:Re.WHITE,color:t,alpha:s})},e.prototype.beginTextureFill=function(t){t=Object.assign({texture:Re.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var s=t.alpha>0;return s?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:s},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,s,i,n){return this.drawShape(new he(t,s,i,n))},e.prototype.drawRoundedRect=function(t,s,i,n,a){return this.drawShape(new K6(t,s,i,n,a))},e.prototype.drawCircle=function(t,s,i){return this.drawShape(new z6(t,s,i))},e.prototype.drawEllipse=function(t,s,i,n){return this.drawShape(new X6(t,s,i,n))},e.prototype.drawPolygon=function(){for(var t=arguments,s=[],i=0;i<arguments.length;i++)s[i]=t[i];var n,a=!0,o=s[0];o.points?(a=o.closeStroke,n=o.points):Array.isArray(s[0])?n=s[0]:n=s;var u=new _h(n);return u.closeStroke=a,this.drawShape(u),this},e.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return t.length===1&&t[0].shape.type===Wt.RECT&&!t[0].matrix&&!t[0].holes.length&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)},e.prototype._render=function(t){this.finishPoly();var s=this._geometry;s.updateBatches(),s.batchable?(this.batchDirty!==s.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this._geometry,s=this.blendMode,i=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(t.points);for(var n=0;n<i;n++){var a=t.batches[n],o=a.style.color,u=new Float32Array(this.vertexData.buffer,a.attribStart*4*2,a.attribSize*2),l=new Float32Array(t.uvsFloat32.buffer,a.attribStart*4*2,a.attribSize*2),d=new Uint16Array(t.indicesUint16.buffer,a.start*2,a.size),c={vertexData:u,blendMode:s,indices:d,uvs:l,_batchRGB:Nl(o),_tintRGB:o,_texture:a.style.texture,alpha:a.style.alpha,worldAlpha:1};this.batches[n]=c}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var s=0,i=this.batches.length;s<i;s++){var n=this.batches[s];n.worldAlpha=this.worldAlpha*n.alpha,t.plugins[this.pluginName].render(n)}}},e.prototype._renderDirect=function(t){var s=this._resolveDirectShader(t),i=this._geometry,n=this.tint,a=this.worldAlpha,o=s.uniforms,u=i.drawCalls;o.translationMatrix=this.transform.worldTransform,o.tint[0]=(n>>16&255)/255*a,o.tint[1]=(n>>8&255)/255*a,o.tint[2]=(n&255)/255*a,o.tint[3]=a,t.shader.bind(s),t.geometry.bind(i,s),t.state.set(this.state);for(var l=0,d=u.length;l<d;l++)this._renderDrawCallDirect(t,i.drawCalls[l])},e.prototype._renderDrawCallDirect=function(t,s){for(var i=s.texArray,n=s.type,a=s.size,o=s.start,u=i.count,l=0;l<u;l++)t.texture.bind(i.elements[l],l);t.geometry.draw(n,a,o)},e.prototype._resolveDirectShader=function(t){var s=this.shader,i=this.pluginName;if(!s){if(!Rg[i]){for(var n=t.plugins[i].MAX_TEXTURES,a=new Int32Array(n),o=0;o<n;o++)a[o]=o;var u={tint:new Float32Array([1,1,1,1]),translationMatrix:new Ye,default:ea.from({uSamplers:a},!0)},l=t.plugins[i]._shader.program;Rg[i]=new ta(l,u)}s=Rg[i]}return s},e.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var s=t.bounds,i=s.minX,n=s.minY,a=s.maxX,o=s.maxY;this._bounds.addFrame(this.transform,i,n,a,o)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=Nl(this.tint,Wq),s=0;s<this.batches.length;s++){var i=this.batches[s],n=i._batchRGB,a=t[0]*n[0]*255,o=t[1]*n[1]*255,u=t[2]*n[2]*255,l=(a<<16)+(o<<8)+(u|0);i._tintRGB=(l>>16)+(l&65280)+((l&255)<<16)}}},e.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var s=this.transform.worldTransform,i=s.a,n=s.b,a=s.c,o=s.d,u=s.tx,l=s.ty,d=this._geometry.points,c=this.vertexData,_=0,f=0;f<d.length;f+=2){var g=d[f],I=d[f+1];c[_++]=i*g+a*I+u,c[_++]=o*I+n*g+l}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(t){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,r.prototype.destroy.call(this,t)},e.nextRoundedRectBehavior=!1,e._TEMP_POINT=new k,e}(Zr);class Zs{static hex2rgb(e,t=[]){return t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(e&255)/255,t}static hex2rgba(e,t=[]){return t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(e&255)/255,t[3]=e&255,t}static rgb2hex(e){return(e[0]*255<<16)+(e[1]*255<<8)+(e[2]*255|0)}static rgba2hex(e){return(e[0]*255<<16)+(e[1]*255<<8)+(e[2]*255|0)+(e[3]|0)}static rgbStringToHex(e){const t=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return"#"+Zs.getHex(t[1])+Zs.getHex(t[2])+Zs.getHex(t[3])}static getHex(e){return isNaN(e)?"00":Zs.HEX_DIGITS[(e-e%16)/16]+Zs.HEX_DIGITS[e%16]}static int2rgb(e){e>>>=0;const t=e&255,s=(e&65280)>>>8;return"rgba("+[(e&16711680)>>>16,s,t,1].join(",")+")"}static rgbToHSL(e){const t=(e>>16&255)/255,s=(e>>8&255)/255,i=(e&255)/255,n=Math.max(t,s,i),a=Math.min(t,s,i),o=n-a;let u=0,l=0,d=0;o==0?u=0:n==t?s>i?u=60*(s-i)/o:u=60*(s-i)/o+360:n==s?u=60*(i-t)/o+120:n==i&&(u=60*(t-s)/o+240),l=.5*(n+a),o==0?d=0:l<=.5?d=o/l*.5:d=o/(1-l)*.5;const c=Math.round(u/360*255),_=Math.round(d*255),f=Math.round(l*255);return(c<<16)+(_<<8)+f}static hslToRGB(e){let t,s,i,n,a;const o=(e>>16&255)/255,u=(e>>8&255)/255,l=(e&255)/255;let d=0,c=0,_=0;u>0?(t=0,s=0,l<.5?t=l*(1+u):t=l+u-l*u,s=2*l-t,i=o+1/3,n=o,a=o-1/3,i<0?i=i+1:i>1&&i--,n<0?n=n+1:n>1&&n--,a<0?a=a+1:a>1&&a--,i*6<1?d=s+(t-s)*6*i:i*2<1?d=t:i*3<2?d=s+(t-s)*6*(2/3-i):d=s,n*6<1?c=s+(t-s)*6*n:n*2<1?c=t:n*3<2?c=s+(t-s)*6*(2/3-n):c=s,a*6<1?_=s+(t-s)*6*a:a*2<1?_=t:a*3<2?_=s+(t-s)*6*(2/3-a):_=s):(d=l,c=l,_=l);const f=Math.round(d*255),g=Math.round(c*255),I=Math.round(_*255);return(f<<16)+(g<<8)+I}static rgb2xyz(e){let t=(e>>16&255)/255,s=(e>>8&255)/255,i=(e>>0&255)/255;return t>.04045?t=Math.pow((t+.055)/1.055,2.4):t=t/12.92,s>.04045?s=Math.pow((s+.055)/1.055,2.4):s=s/12.92,i>.04045?i=Math.pow((i+.055)/1.055,2.4):i=i/12.92,t=t*100,s=s*100,i=i*100,new y(t*.4124+s*.3576+i*.1805,t*.2126+s*.7152+i*.0722,t*.0193+s*.1192+i*.9505)}static xyz2CieLab(e){let t=e.x/95.047,s=e.y/100,i=e.z/108.883;return t>.008856?t=Math.pow(t,1/3):t=7.787*t+16/116,s>.008856?s=Math.pow(s,1/3):s=7.787*s+16/116,i>.008856?i=Math.pow(i,1/3):i=7.787*i+16/116,new y(116*s-16,500*(t-s),200*(s-i))}static rgb2CieLab(e){return Zs.xyz2CieLab(Zs.rgb2xyz(e))}static colorize(e,t){if(t===4294967295)return e;let s=t>>16&255,i=t>>8&255,n=t&255;return s=(e>>16&255)*s/255,i=(e>>8&255)*i/255,n=(e&255)*n/255,(e&&4278190080)|s<<16|i<<8|n}}Zs.HEX_DIGITS=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];class vg{constructor(e){e<0&&(e=0),this._reservedNumbers=[],this._freeNumbers=[];let t=0;for(;t<e;)this._freeNumbers.push(t),t++}dispose(){this._reservedNumbers=null,this._freeNumbers=null}reserveNumber(){if(this._freeNumbers.length>0){const e=this._freeNumbers.pop();return this._reservedNumbers.push(e),e}return-1}freeNumber(e){const t=this._reservedNumbers.indexOf(e);t>=0&&(this._reservedNumbers.splice(t,1),this._freeNumbers.push(e))}}class zq{static sum(e,t){return new k(e.x+t.x,e.y+t.y)}static sub(e,t){return new k(e.x-t.x,e.y-t.y)}static mul(e,t){return new k(e.x*t,e.y*t)}}class zO{static getFlipHBitmapData(e){if(!e)return null;const t=Je.createRenderTexture(e.width,e.height),s=new Ye;return s.scale(-1,1),s.translate(e.width,0),_t.instance.renderer.render(new Ze(e),{renderTexture:t,clear:!0,transform:s}),t}static getFlipVBitmapData(e){if(!e)return null;const t=new Ye;t.scale(1,-1),t.translate(0,e.height);const s=new Po;return s.beginTextureFill({texture:e,matrix:t}).drawRect(0,0,e.width,e.height).endFill(),Je.generateTexture(s)}static getFlipHVBitmapData(e){if(!e)return null;const t=new Ye;t.scale(-1,-1),t.translate(e.width,e.height);const s=new Po;return s.beginTextureFill({texture:e,matrix:t}).drawRect(0,0,e.width,e.height).endFill(),Je.generateTexture(s)}}class ne{static init(e,t){ne._currentDelta=0,ne._startDelayMs=e,ne._effectDurationMs=t,ne._initializationTimeMs=ve(),ne._state=ne.STATE_START_DELAY}static turnVisualizationOn(){if(ne._state===ne.STATE_NOT_INITIALIZED||ne._state===ne.STATE_OVER)return;const e=ve()-ne._initializationTimeMs;if(e>ne._startDelayMs+ne._effectDurationMs){ne._state=ne.STATE_OVER;return}if(ne._visualizationOn=!0,e<ne._startDelayMs){ne._state=ne.STATE_START_DELAY;return}ne._state=ne.STATE_RUNNING,ne._currentDelta=(e-ne._startDelayMs)/ne._effectDurationMs}static turnVisualizationOff(){ne._visualizationOn=!1}static isVisualizationOn(){return ne._visualizationOn&&ne.isRunning()}static isRunning(){return ne._state===ne.STATE_START_DELAY||ne._state===ne.STATE_RUNNING}static getDelta(e=0,t=1){return Math.min(Math.max(ne._currentDelta,e),t)}static get totalRunningTime(){return ne._startDelayMs+ne._effectDurationMs}}ne.STATE_NOT_INITIALIZED=0,ne.STATE_START_DELAY=1,ne.STATE_RUNNING=2,ne.STATE_OVER=3,ne._state=ne.STATE_NOT_INITIALIZED,ne._visualizationOn=!1,ne._currentDelta=0,ne._initializationTimeMs=0,ne._startDelayMs=20*1e3,ne._effectDurationMs=2e3;class ys{constructor(e,t,s,i=null){this._updateId=0,this._scale=1,this._x_scale=1,this._y_scale=1,this._z_scale=1,this._x_scale_internal=1,this._y_scale_internal=1,this._z_scale_internal=1,this._clipNear=-500,this._clipFar=500,this._displacements=null,this.scale=e,this._x=new y,this._y=new y,this._z=new y,this._directionAxis=new y,this._location=new y,this._direction=new y,this._depth=new y,this._x_scale_internal=1,this._y_scale_internal=1,this.x_scale=1,this.y_scale=1,this._z_scale_internal=Math.sqrt(1/2)/Math.sqrt(3/4),this.z_scale=1,this.location=new y(s.x,s.y,s.z),this.direction=new y(t.x,t.y,t.z),i!=null?this.setDepthVector(i):this.setDepthVector(t),this._displacements=new Map}static getIntersectionVector(e,t,s,i){const n=y.dotProduct(t,i);if(Math.abs(n)<1e-5)return null;const a=y.dif(e,s),o=-y.dotProduct(i,a)/n;return y.sum(e,y.product(t,o))}get updateId(){return this._updateId}get scale(){return this._scale/Math.sqrt(.5)}set scale(e){e<=1&&(e=1),e=e*Math.sqrt(.5),e!=this._scale&&(this._scale=e,this._updateId++)}get directionAxis(){return this._directionAxis}get location(){return this._location.assign(this._loc),this._location.x=this._location.x*this._x_scale,this._location.y=this._location.y*this._y_scale,this._location.z=this._location.z*this._z_scale,this._location}set location(e){if(e==null)return;this._loc==null&&(this._loc=new y);const t=this._loc.x,s=this._loc.y,i=this._loc.z;this._loc.assign(e),this._loc.x=this._loc.x/this._x_scale,this._loc.y=this._loc.y/this._y_scale,this._loc.z=this._loc.z/this._z_scale,(this._loc.x!=t||this._loc.y!=s||this._loc.z!=i)&&this._updateId++}get direction(){return this._direction}set direction(e){let t,s,i,n,a;if(e==null)return;this._dir==null&&(this._dir=new y);const o=this._dir.x,u=this._dir.y,l=this._dir.z;this._dir.assign(e),this._direction.assign(e),(this._dir.x!=o||this._dir.y!=u||this._dir.z!=l)&&this._updateId++;const d=new y(0,1,0),c=new y(0,0,1),_=new y(1,0,0),f=e.x/180*Math.PI,g=e.y/180*Math.PI,I=e.z/180*Math.PI,p=Math.cos(f),R=Math.sin(f),S=y.sum(y.product(d,p),y.product(_,-R)),O=new y(c.x,c.y,c.z),A=y.sum(y.product(d,R),y.product(_,p)),C=Math.cos(g),M=Math.sin(g),N=new y(S.x,S.y,S.z),L=y.sum(y.product(O,C),y.product(A,M)),b=y.sum(y.product(O,-M),y.product(A,C));I!=0?(t=Math.cos(I),s=Math.sin(I),i=y.sum(y.product(N,t),y.product(L,s)),n=y.sum(y.product(N,-s),y.product(L,t)),a=new y(b.x,b.y,b.z),this._x.assign(i),this._y.assign(n),this._z.assign(a),this._directionAxis.assign(this._z)):(this._x.assign(N),this._y.assign(L),this._z.assign(b),this._directionAxis.assign(this._z))}set x_scale(e){this._x_scale!=e*this._x_scale_internal&&(this._x_scale=e*this._x_scale_internal,this._updateId++)}set y_scale(e){this._y_scale!=e*this._y_scale_internal&&(this._y_scale=e*this._y_scale_internal,this._updateId++)}set z_scale(e){this._z_scale!=e*this._z_scale_internal&&(this._z_scale=e*this._z_scale_internal,this._updateId++)}dispose(){this._x=null,this._y=null,this._z=null,this._loc=null,this._dir=null,this._directionAxis=null,this._location=null,this._displacements!=null&&(this._displacements.clear(),this._displacements=null)}setDisplacement(e,t){let s,i;e==null||t==null||this._displacements!=null&&(s=Math.trunc(Math.round(e.x))+"_"+Math.trunc(Math.round(e.y))+"_"+Math.trunc(Math.round(e.z)),this._displacements.delete(s),i=new y,i.assign(t),this._displacements.set(s,i),this._updateId++)}getDisplacenent(e){let t;return this._displacements!=null?(t=Math.trunc(Math.round(e.x))+"_"+Math.trunc(Math.round(e.y))+"_"+Math.trunc(Math.round(e.z)),this._displacements.get(t)):null}setDepthVector(e){let t,s,i;const n=new y(0,1,0),a=new y(0,0,1),o=new y(1,0,0),u=e.x/180*Math.PI,l=e.y/180*Math.PI,d=e.z/180*Math.PI,c=Math.cos(u),_=Math.sin(u),f=y.sum(y.product(n,c),y.product(o,-_)),g=new y(a.x,a.y,a.z),I=y.sum(y.product(n,_),y.product(o,c)),p=Math.cos(l),R=Math.sin(l),S=new y(f.x,f.y,f.z),O=y.sum(y.product(g,p),y.product(I,R)),A=y.sum(y.product(g,-R),y.product(I,p));d!=0?(t=Math.cos(d),s=Math.sin(d),y.sum(y.product(S,t),y.product(O,s)),y.sum(y.product(S,-s),y.product(O,t)),i=new y(A.x,A.y,A.z),this._depth.assign(i)):this._depth.assign(A),this._updateId++}adjustLocation(e,t){if(e==null||this._z==null)return;const s=y.product(this._z,-t),i=new y(e.x+s.x,e.y+s.y,e.z+s.z);this.location=i}getCoordinatePosition(e){if(e==null)return null;const t=y.scalarProjection(e,this._x),s=y.scalarProjection(e,this._y),i=y.scalarProjection(e,this._z);return new y(t,s,i)}getScreenPosition(e){let t=y.dif(e,this._loc);t.x=t.x*this._x_scale,t.y=t.y*this._y_scale,t.z=t.z*this._z_scale;let s=y.scalarProjection(t,this._depth);if(s<this._clipNear||s>this._clipFar)return null;let i=y.scalarProjection(t,this._x),n=-y.scalarProjection(t,this._y);i=i*this._scale,n=n*this._scale;const a=this.getDisplacenent(e);return a!=null&&(t=y.dif(e,this._loc),t.add(a),t.x=t.x*this._x_scale,t.y=t.y*this._y_scale,t.z=t.z*this._z_scale,s=y.scalarProjection(t,this._depth)),t.x=i,t.y=n,t.z=s,t}getScreenPoint(e){const t=this.getScreenPosition(e);return t==null?null:new k(t.x,t.y)}getPlanePosition(e,t,s,i){let n,a;const o=e.x/this._scale,u=-e.y/this._scale,l=y.product(this._x,o);l.add(y.product(this._y,u));const d=new y(this._loc.x*this._x_scale,this._loc.y*this._y_scale,this._loc.z*this._z_scale);d.add(l);const c=this._z,_=new y(t.x*this._x_scale,t.y*this._y_scale,t.z*this._z_scale),f=new y(s.x*this._x_scale,s.y*this._y_scale,s.z*this._z_scale),g=new y(i.x*this._x_scale,i.y*this._y_scale,i.z*this._z_scale),I=y.crossProduct(f,g),p=new y;return p.assign(ys.getIntersectionVector(d,c,_,I)),p!=null?(p.subtract(_),n=y.scalarProjection(p,s)/f.length*s.length,a=y.scalarProjection(p,i)/g.length*i.length,new k(n,a)):null}performZoom(){this.isZoomedIn()?this.scale=ys.SCALE_ZOOMED_OUT:this.scale=ys.SCALE_ZOOMED_IN}isZoomedIn(){return this.scale==ys.SCALE_ZOOMED_IN}performZoomOut(){this.scale=ys.SCALE_ZOOMED_OUT}performZoomIn(){this.scale=ys.SCALE_ZOOMED_IN}}ys.SCALE_ZOOMED_IN=64,ys.SCALE_ZOOMED_OUT=32;class Oa{static makeRoomPreviewerId(e){return(e&65535)+Oa.PREVIEW_ROOM_ID_BASE}static isRoomPreviewerId(e){return e>=Oa.PREVIEW_ROOM_ID_BASE}}Oa.PREVIEW_ROOM_ID_BASE=2147418112;class _r{static init(e,t){this._SafeStr_4513=0,this._SafeStr_4515=e,this._SafeStr_4516=t,this._SafeStr_4514=ve(),this._SafeStr_448=1}static turnVisualizationOn(){if(this._SafeStr_448===0||this._SafeStr_448===3)return;this._SafeStr_4524||(this._SafeStr_4524=setTimeout(()=>this.turnVisualizationOff(),this._SafeStr_4516));const e=ve()-this._SafeStr_4514;if(e>this._SafeStr_4515+this._SafeStr_4516){this._SafeStr_448=3;return}if(this._SafeStr_4512=!0,e<this._SafeStr_4515){this._SafeStr_448=1;return}this._SafeStr_448=2,this._SafeStr_4513=(e-this._SafeStr_4515)/this._SafeStr_4516}static turnVisualizationOff(){this._SafeStr_4512=!1,clearTimeout(this._SafeStr_4524),this._SafeStr_4524=null}static isVisualizationOn(){return this._SafeStr_4512&&this.isRunning()}static isRunning(){return this._SafeStr_448===1||this._SafeStr_448===2}}_r.STATE_NOT_INITIALIZED=0,_r.STATE_START_DELAY=1,_r.STATE_RUNNING=2,_r.STATE_OVER=3,_r._SafeStr_448=0,_r._SafeStr_4512=!1,_r._SafeStr_4513=0,_r._SafeStr_4514=0,_r._SafeStr_4515=2e4,_r._SafeStr_4516=5e3;class dr{static init(e,t){this._SafeStr_4513=0,this._SafeStr_4515=e,this._SafeStr_4516=t,this._SafeStr_4514=ve(),this._SafeStr_448=1}static turnVisualizationOn(){if(this._SafeStr_448===0||this._SafeStr_448===3)return;this._SafeStr_4524||(this._SafeStr_4524=setTimeout(()=>this.turnVisualizationOff(),this._SafeStr_4516));const e=ve()-this._SafeStr_4514;if(e>this._SafeStr_4515+this._SafeStr_4516){this._SafeStr_448=3;return}if(this._SafeStr_4512=!0,e<this._SafeStr_4515){this._SafeStr_448=1;return}this._SafeStr_448=2,this._SafeStr_4513=(e-this._SafeStr_4515)/this._SafeStr_4516}static turnVisualizationOff(){this._SafeStr_4512=!1,clearTimeout(this._SafeStr_4524),this._SafeStr_4524=null}static isVisualizationOn(){return this._SafeStr_4512&&this.isRunning()}static isRunning(){return this._SafeStr_448===1||this._SafeStr_448===2}}dr.STATE_NOT_INITIALIZED=0,dr.STATE_START_DELAY=1,dr.STATE_RUNNING=2,dr.STATE_OVER=3,dr._SafeStr_448=0,dr._SafeStr_4512=!1,dr._SafeStr_4514=0,dr._SafeStr_4515=2e4,dr._SafeStr_4516=5e3;class XO{static hex2int(e){return parseInt(e,16)}static inkToBlendMode(e){return e=="ADD"||e==33?se.ADD:e=="SUBTRACT"?se.SUBTRACT:e=="DARKEN"?se.DARKEN:se.NORMAL}}class Tu extends Ze{constructor(e=null){super(e),this._offsetX=0,this._offsetY=0,this._tag="",this._alphaTolerance=128,this._varyingDepth=!1,this._clickHandling=!1,this._pairedSpriteId=-1,this._pairedSpriteUpdateCounter=-1}needsUpdate(e,t){return this._pairedSpriteId===e&&this._pairedSpriteUpdateCounter===t?!1:(this._pairedSpriteId=e,this._pairedSpriteUpdateCounter=t,!0)}calculateVertices(){this.texture.orig&&super.calculateVertices()}setTexture(e){e||(e=Re.EMPTY),e!==this.texture&&(e===Re.EMPTY&&(this._pairedSpriteId=-1,this._pairedSpriteUpdateCounter=-1),this.texture=e)}containsPoint(e){return Tu.containsPoint(this,e)}static containsPoint(e,t){if(!e||!t||e.alphaTolerance>255||!(e instanceof Ze))return!1;if(e.texture===Re.EMPTY||e.blendMode!==se.NORMAL)return;const s=e.texture,i=s.baseTexture;if(!s||!i||!i.valid)return!1;const n=t.x*e.scale.x,a=t.y*e.scale.y;if(!e.getLocalBounds().contains(n,a)||!i.hitMap&&!Tu.generateHitMap(i))return!1;const o=i.hitMap;let u=n+s.frame.x,l=a+s.frame.y;s.trim&&(u-=s.trim.x,l-=s.trim.y),u=Math.round(u)*i.resolution,l=Math.round(l)*i.resolution;const d=u+l*i.realWidth,c=d%32,_=d/32|0;return(o[_]&1<<c)!==0}static generateHitMap(e){if(!e)return!1;const t=new Re(e),s=new Ze(t),i=Je.getPixels(s),n=e.width,a=e.height,o=new Uint32Array(Math.ceil(n*a/32)),u=Ks.MATCH_OPAQUE_PIXELS;for(let l=0;l<n*a;l++){const d=l%32,c=l/32|0;i[l*4+3]>=u&&(o[c]=o[c]|1<<d)}return e.hitMap=o,s.destroy(),t.destroy(),!0}get offsetX(){return this._offsetX}set offsetX(e){this._offsetX=e}get offsetY(){return this._offsetY}set offsetY(e){this._offsetY=e}get tag(){return this._tag}set tag(e){this._tag=e}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(e){this._alphaTolerance=e}get varyingDepth(){return this._varyingDepth}set varyingDepth(e){this._varyingDepth=e}get clickHandling(){return this._clickHandling}set clickHandling(e){this._clickHandling=e}}class KO{constructor(){this._objectId="",this._spriteTag=""}get objectId(){return this._objectId}set objectId(e){this._objectId=e}get spriteTag(){return this._spriteTag}set spriteTag(e){this._spriteTag=e}}class Ru{constructor(){this._name="",this._sprite=null,this._x=0,this._y=0,this._z=0}dispose(){this._z=-Ru.Z_INFINITY,this._sprite=null}get name(){return this._name}set name(e){this._name=e}get sprite(){return this._sprite}set sprite(e){this._sprite=e}get x(){return this._x}set x(e){this._x=e}get y(){return this._y}set y(e){this._y=e}get z(){return this._z}set z(e){this._z=e}}Ru.Z_INFINITY=1e8;class qO{constructor(e,t,s,i,n){this._SafeStr_4507=!1,this._rotation=0,this._rotationOrigin=null,this._rotationRodLength=0,this._SafeStr_795=0,this._id=t,this._container=e,this._geometry=new ys(n,new y(-135,30,0),new y(11,11,5),new y(-135,.5,0)),this._animationFPS=X.instance.getConfiguration("system.fps.animation",24),this._renderTimestamp=0,this._totalTimeRunning=0,this._lastFrame=0,this._master=null,this._display=null,this._mask=null,this._sortableSprites=[],this._spriteCount=0,this._activeSpriteCount=0,this._spritePool=[],this._skipObjectUpdate=!1,this._runningSlow=!1,this._width=0,this._height=0,this._renderedWidth=0,this._renderedHeight=0,this._screenOffsetX=0,this._screenOffsetY=0,this._mouseLocation=new k,this._mouseOldX=0,this._mouseOldY=0,this._mouseCheckCount=0,this._mouseSpriteWasHit=!1,this._mouseActiveObjects=new Map,this._eventCache=new Map,this._eventId=0,this._scale=1,this._restrictsScaling=!1,this._noSpriteVisibilityChecking=!1,this._usesExclusionRectangles=!1,this._usesMask=!0,this._canvasUpdated=!1,this._objectCache=new yo(this._container.roomObjectVariableAccurateZ),this._mouseListener=null,this.setupCanvas(),this.initialize(s,i)}setupCanvas(){if(this._master||(this._master=new ot,this._master.interactiveChildren=!1),!this._display){const e=new nr;this._master.addChild(e),this._display=e}}dispose(){if(this.cleanSprites(0,!0),this._geometry&&(this._geometry.dispose(),this._geometry=null),this._mask&&(this._mask=null),this._objectCache&&(this._objectCache.dispose(),this._objectCache=null),this._master){for(;this._master.children.length;)this._master.removeChildAt(0).destroy();this._master.parent&&this._master.parent.removeChild(this._master),this._master.destroy(),this._master=null}if(this._display=null,this._sortableSprites=[],this._mouseActiveObjects&&(this._mouseActiveObjects.clear(),this._mouseActiveObjects=null),this._spritePool){for(const e of this._spritePool)this.cleanSprite(e,!0);this._spritePool=[]}this._eventCache&&(this._eventCache.clear(),this._eventCache=null),this._mouseListener=null}initialize(e,t){if(e=e<1?1:e,t=t<1?1:t,this._usesMask&&(this._mask?this._mask.clear().beginFill(16711680).drawRect(0,0,e,t).endFill():(this._mask=new Po().beginFill(16711680).drawRect(0,0,e,t).endFill(),this._master&&(this._master.addChild(this._mask),this._display&&(this._display.mask=this._mask)))),this._master){if(this._master.hitArea){const s=this._master.hitArea;s.width=e,s.height=t}else this._master.hitArea=new he(0,0,e,t);if(this._master.filterArea){const s=this._master.filterArea;s.width=e,s.height=t}else this._master.filterArea=new he(0,0,e,t)}this._width=e,this._height=t}setMask(e){e&&!this._usesMask?(this._usesMask=!0,this._mask&&this._mask.parent!==this._master&&(this._master.addChild(this._mask),this._display.mask=this._mask)):!e&&this._usesMask&&(this._usesMask=!1,this._mask&&this._mask.parent===this._master&&(this._master.removeChild(this._mask),this._display.mask=null))}setScale(e,t=null,s=null,i=!1,n=!1){!this._master||!this._display||this._restrictsScaling&&!i||(t||(t=new k(this._width/2,this._height/2)),s||(s=t),t=this._display.toLocal(t),n?this._scale*=e:this._scale=e,this.screenOffsetX=s.x-t.x*this._scale,this.screenOffsetY=s.y-t.y*this._scale)}render(e,t=!1){if(this._canvasUpdated=!1,this._totalTimeRunning+=Jr().deltaTime,this._totalTimeRunning===this._renderTimestamp||(e===-1&&(e=this._renderTimestamp+1),!this._container||!this._geometry))return;(this._width!==this._renderedWidth||this._height!==this._renderedHeight)&&(t=!0),(this._display.x!==this._screenOffsetX||this._display.y!==this._screenOffsetY)&&(this._display.position.set(this._screenOffsetX,this._screenOffsetY),t=!0),this._display.scale.x!==this._scale&&(this._display.scale.set(this._scale),t=!0),this.doMagic();const s=Math.round(this._totalTimeRunning/(60/this._animationFPS));let i=!1;s!==this._lastFrame&&(this._lastFrame=s,i=!0);let n=0;const a=this._container.objects;if(a.size)for(const u of a.values())u&&(n=n+this.renderObject(u,u.instanceId.toString(),e,t,i,n));this._sortableSprites.sort((u,l)=>l.z-u.z),n<this._sortableSprites.length&&this._sortableSprites.splice(n);let o=0;for(;o<n;){const u=this._sortableSprites[o];u&&u.sprite&&this.renderSprite(o,u),o++}this.cleanSprites(n),(t||i)&&(this._canvasUpdated=!0),this._renderTimestamp=this._totalTimeRunning,this._renderedWidth=this._width,this._renderedHeight=this._height}skipSpriteVisibilityChecking(){this._noSpriteVisibilityChecking=!0,this.render(-1,!0)}resumeSpriteVisibilityChecking(){this._noSpriteVisibilityChecking=!1}getSortableSpriteList(){return this._objectCache.getSortableSpriteList()}getPlaneSortableSprites(){return this._objectCache.getPlaneSortableSprites()}removeFromCache(e){this._objectCache.removeObjectCache(e)}renderObject(e,t,s,i,n,a){if(!e)return 0;const o=e.visualization;if(!o)return this.removeFromCache(t),0;const u=this.getCacheItem(t);u.objectId=e.instanceId;const l=u.location,d=u.sprites,c=l.updateLocation(e,this._geometry);if(!c)return this.removeFromCache(t),0;if(n&&o.update(this._geometry,s,!d.isEmpty||i,this._skipObjectUpdate&&this._runningSlow),l.locationChanged&&(i=!0),!d.needsUpdate(o.instanceId,o.updateSpriteCounter)&&!i)return d.spriteCount;let _=c.x,f=c.y,g=c.z;_>0?g=g+_*12e-8:g=g+-_*12e-8,_=_+Math.trunc(this._width/2),f=f+Math.trunc(this._height/2);let I=0;for(const p of o.sprites.values()){if(!p||!p.visible)continue;const R=p.texture,S=R&&R.baseTexture;if(!R||!S)continue;const O=_+p.offsetX+this._screenOffsetX,A=f+p.offsetY+this._screenOffsetY;if(p.flipH){const M=_+-(R.width+-p.offsetX)+this._screenOffsetX;if(!this.isSpriteVisible(M,A,R.width,R.height))continue}else if(p.flipV){const M=f+-(R.height+-p.offsetY)+this._screenOffsetY;if(!this.isSpriteVisible(O,M,R.width,R.height))continue}else if(!this.isSpriteVisible(O,A,R.width,R.height))continue;let C=d.getSprite(I);C||(C=new Ru,d.addSprite(C),this._sortableSprites.push(C),C.name=t),C.sprite=p,(p.spriteType===cs.AVATAR||p.spriteType===cs.AVATAR_OWN)&&(C.sprite.libraryAssetName="avatar_"+e.id),C.x=O-this._screenOffsetX,C.y=A-this._screenOffsetY,C.z=g+p.relativeDepth+37e-12*a,I++,a++}return d.setSpriteCount(I),this._canvasUpdated=!0,I}getExtendedSprite(e){if(e<0||e>=this._spriteCount)return null;const t=this._display.getChildAt(e);return t||null}getExtendedSpriteIdentifier(e){return e?e.name:""}renderSprite(e,t){if(e>=this._spriteCount)return this.createAndAddSprite(t),!0;if(!t)return!1;const s=t.sprite,i=this.getExtendedSprite(e);if(!s||!i)return!1;if(i.varyingDepth!==s.varyingDepth)return i.varyingDepth&&!s.varyingDepth?(this._display.removeChildAt(e),this._spritePool.push(i),this.renderSprite(e,t)):(this.createAndAddSprite(t,e),!0);if(i.needsUpdate(s.id,s.updateCounter)||ne.isVisualizationOn()){i.tag=s.tag,i.alphaTolerance=s.alphaTolerance,i.name=t.name,i.varyingDepth=s.varyingDepth,i.clickHandling=s.clickHandling,i.filters=s.filters;const n=s.alpha/255;i.alpha!==n&&(i.alpha=n),i.tint!==s.color&&(i.tint=s.color),i.blendMode!==s.blendMode&&(i.blendMode=s.blendMode),i.texture!==s.texture&&i.setTexture(s.texture),s.updateContainer&&(i.children.length===1&&i.removeChildAt(0),i.addChild(s.container),s.updateContainer=!1),s.flipH?i.scale.x!==-1&&(i.scale.x=-1):i.scale.x!==1&&(i.scale.x=1),s.flipV?i.scale.y!==-1&&(i.scale.y=-1):i.scale.y!==1&&(i.scale.y=1),this.updateEnterRoomEffect(i,s)}return i.x!==t.x&&(i.x=t.x),i.y!==t.y&&(i.y=t.y),i.offsetX=s.offsetX,i.offsetY=s.offsetY,!0}createAndAddSprite(e,t=-1){const s=e.sprite;if(!s)return;let i=null;this._spritePool.length>0&&(i=this._spritePool.pop()),i||(i=new Tu),i.children.length&&i.removeChildren(),i.tag=s.tag,i.alphaTolerance=s.alphaTolerance,i.alpha=s.alpha/255,i.tint=s.color,i.x=e.x,i.y=e.y,i.offsetX=s.offsetX,i.offsetY=s.offsetY,i.name=s.name,i.varyingDepth=s.varyingDepth,i.clickHandling=s.clickHandling,i.blendMode=s.blendMode,i.filters=s.filters,i.setTexture(s.texture),s.updateContainer&&(i.addChild(s.container),s.updateContainer=!1),s.flipH&&(i.scale.x=-1),s.flipV&&(i.scale.y=-1),this.updateEnterRoomEffect(i,s),t<0||t>=this._spriteCount?(this._display.addChild(i),this._spriteCount++):this._display.addChildAt(i,t),this._activeSpriteCount++}cleanSprites(e,t=!1){if(this._display){if(e<0&&(e=0),e<this._activeSpriteCount||!this._activeSpriteCount){let s=this._spriteCount-1;for(;s>=e;)this.cleanSprite(this.getExtendedSprite(s),t),s--}this._activeSpriteCount=e}}updateEnterRoomEffect(e,t){if(!(!ne.isVisualizationOn()||!t))switch(t.spriteType){case cs.AVATAR_OWN:return;case cs.ROOM_PLANE:e.alpha=ne.getDelta(.9);return;case cs.AVATAR:e.alpha=ne.getDelta(.5);return;default:e.alpha=ne.getDelta(.1)}}cleanSprite(e,t){e&&(t?(e.parent&&e.parent.removeChild(e),e.destroy({children:!0})):e.setTexture(null))}update(){this._mouseCheckCount,this._mouseCheckCount=0,this._eventId++}setMouseListener(e){this._mouseListener=e}getCacheItem(e){return this._objectCache.getObjectCache(e)}isSpriteVisible(e,t,s,i){return!!(this._noSpriteVisibilityChecking||(e=(e-this._screenOffsetX)*this._scale+this._screenOffsetX,t=(t-this._screenOffsetY)*this._scale+this._screenOffsetY,s=s*this._scale,i=i*this._scale,e<this._width&&e+s>=0&&t<this._height&&t+i>=0&&!this._usesExclusionRectangles))}handleMouseEvent(e,t,s,i,n,a,o){return e=e-this._screenOffsetX,t=t-this._screenOffsetY,this._mouseLocation.x=e/this._scale,this._mouseLocation.y=t/this._scale,this._mouseCheckCount>0&&s==W.MOUSE_MOVE?this._mouseSpriteWasHit:(this._mouseSpriteWasHit=this.checkMouseHits(Math.trunc(e/this._scale),Math.trunc(t/this._scale),s,i,n,a,o),this._mouseCheckCount++,this._mouseSpriteWasHit)}checkMouseHits(e,t,s,i=!1,n=!1,a=!1,o=!1){const u=[];let l=!1,d=null,c=this._activeSpriteCount-1;for(;c>=0;){const g=this.getExtendedSprite(c);if(g&&g.containsPoint(new k(e-g.x,t-g.y))&&!(g.clickHandling&&(s===W.MOUSE_CLICK||s===W.DOUBLE_CLICK))){const I=this.getExtendedSpriteIdentifier(g);if(u.indexOf(I)===-1){const p=g.tag;let R=this._mouseActiveObjects.get(I);R&&R.spriteTag!==p&&(d=this.createMouseEvent(0,0,0,0,W.ROLL_OUT,R.spriteTag,i,n,a,o),this.bufferMouseEvent(d,I)),s===W.MOUSE_MOVE&&(!R||R.spriteTag!==p)?d=this.createMouseEvent(e,t,e-g.x,t-g.y,W.ROLL_OVER,p,i,n,a,o):(d=this.createMouseEvent(e,t,e-g.x,t-g.y,s,p,i,n,a,o),d.spriteOffsetX=g.offsetX,d.spriteOffsetY=g.offsetY),R||(R=new KO,R.objectId=I,this._mouseActiveObjects.set(I,R)),R.spriteTag=p,(s!==W.MOUSE_MOVE||e!==this._mouseOldX||t!==this._mouseOldY)&&this.bufferMouseEvent(d,I),u.push(I)}l=!0}c--}const _=[];for(const g of this._mouseActiveObjects.keys())g&&_.push(g);let f=0;for(;f<_.length;){const g=_[f];u.indexOf(g)>=0&&(_[f]=null),f++}for(f=0;f<_.length;){const g=_[f];if(g!==null){const I=this._mouseActiveObjects.get(g);I&&this._mouseActiveObjects.delete(g);const p=this.createMouseEvent(0,0,0,0,W.ROLL_OUT,I.spriteTag,i,n,a,o);this.bufferMouseEvent(p,g)}f++}return this.processMouseEvents(),this._mouseOldX=e,this._mouseOldY=t,l}createMouseEvent(e,t,s,i,n,a,o,u,l,d){const c=e-this._width/2,_=t-this._height/2,f=`canvas_${this._id}`;return new aO(n,f+"_"+this._eventId,f,a,c,_,s,i,u,o,l,d)}bufferMouseEvent(e,t){!e||!this._eventCache||(this._eventCache.delete(t),this._eventCache.set(t,e))}processMouseEvents(){if(!(!this._container||!this._eventCache)){for(const[e,t]of this._eventCache.entries()){if(!this._eventCache)return;if(!t)continue;const s=this._container.getRoomObject(parseInt(e));if(s)if(this._mouseListener)this._mouseListener.processRoomCanvasMouseEvent(t,s,this._geometry);else{const i=s.mouseHandler;i&&i.mouseEvent(t,this._geometry)}}this._eventCache&&this._eventCache.clear()}}getDisplayAsTexture(){this._noSpriteVisibilityChecking=!0;const e=this._scale,t=this._screenOffsetX,s=this._screenOffsetY;this.setScale(1,null,null,!0),this._screenOffsetX=0,this._screenOffsetY=0,this.render(-1,!0),this._display.mask=null;const i=this._display.getBounds(),n=kt.create({width:this._display.width,height:this._display.height});return _t.instance.renderer.render(this._display,{renderTexture:n,clear:!0,transform:new Ye(1,0,0,1,-i.x,-i.y)}),this._display.mask=this._mask,this._noSpriteVisibilityChecking=!1,this.setScale(e,null,null,!0),this._screenOffsetX=t,this._screenOffsetY=s,n}doMagic(){const e=this.geometry;if(this._rotation!==0){let t=this._effectDirection;e.direction=new y(t.x+this._rotation,t.y,t.z),t=e.direction,e.setDepthVector(new y(t.x,t.y,5));const s=new y;s.assign(this._rotationOrigin),s.x=s.x+this._rotationRodLength*Math.cos((t.x+180)/180*3.14159265358979)*Math.cos(t.y/180*3.14159265358979),s.y=s.y+this._rotationRodLength*Math.sin((t.x+180)/180*3.14159265358979)*Math.cos(t.y/180*3.14159265358979),s.z=s.z+this._rotationRodLength*Math.sin(t.y/180*3.14159265358979),e.location=s,this._effectLocation=new y,this._effectLocation.assign(s),this._effectDirection=new y,this._effectDirection.assign(e.direction)}if(dr.isVisualizationOn()&&!this._SafeStr_4507?this.changeShaking():!dr.isVisualizationOn()&&this._SafeStr_4507&&this.changeShaking(),_r.isVisualizationOn()&&this.changeRotation(),this._SafeStr_4507){this._SafeStr_795++;const t=this._effectDirection,s=y.sum(t,new y(Math.sin(this._SafeStr_795*5/180*3.14159265358979)*2,Math.sin(this._SafeStr_795/180*3.14159265358979)*5,Math.sin(this._SafeStr_795*10/180*3.14159265358979)*2));e.direction=s}else this._SafeStr_795=0,e.direction=this._effectDirection}changeShaking(){if(this._SafeStr_4507=!this._SafeStr_4507,this._SafeStr_4507){const e=this.geometry.direction;this._effectDirection=new y(e.x,e.y,e.z)}}changeRotation(){if(this._SafeStr_4507)return;const e=this.geometry;if(e){if(this._rotation===0){const t=e.location,s=e.directionAxis;this._effectLocation=new y,this._effectLocation.assign(t),this._effectDirection=new y,this._effectDirection.assign(e.direction);const i=ys.getIntersectionVector(t,s,new y(0,0,0),new y(0,0,1));i!==null&&(this._rotationOrigin=new y(i.x,i.y,i.z),this._rotationRodLength=y.dif(i,t).length,this._rotation=1);return}this._rotation=0,e.location=this._effectLocation,e.direction=this._effectDirection,e.setDepthVector(new y(this._effectDirection.x,this._effectDirection.y,5))}}moveLeft(){if(this._rotation!==0){this._rotation===1?this._rotation=-1:this._rotation=this._rotation-1;return}const e=this.geometry,t=(e.direction.x-90)/180*3.14159265358979;e.location=y.sum(e.location,new y(Math.cos(t)*Math.sqrt(2),Math.sin(t)*Math.sqrt(2)))}moveRight(){if(this._rotation!==0){this._rotation===-1?this._rotation=1:this._rotation=this._rotation+1;return}const e=this.geometry,t=(e.direction.x+90)/180*3.14159265358979;e.location=y.sum(e.location,new y(Math.cos(t)*Math.sqrt(2),Math.sin(t)*Math.sqrt(2)))}moveUp(){if(this._rotation!==0)return;const e=this.geometry,t=e.direction.x/180*3.14159265358979;e.location=y.sum(e.location,new y(Math.cos(t)*Math.sqrt(2),Math.sin(t)*Math.sqrt(2)))}moveDown(){if(this._rotation!==0)return;const e=this.geometry,t=(e.direction.x+180)/180*3.14159265358979;e.location=y.sum(e.location,new y(Math.cos(t)*Math.sqrt(2),Math.sin(t)*Math.sqrt(2)))}get id(){return this._id}get geometry(){return this._geometry}get master(){return this._master}get display(){return this._display}get screenOffsetX(){return this._screenOffsetX}set screenOffsetX(e){e=Math.trunc(e),this._mouseLocation.x=this._mouseLocation.x-(e-this._screenOffsetX),this._screenOffsetX=e}get screenOffsetY(){return this._screenOffsetY}set screenOffsetY(e){e=Math.trunc(e),this._mouseLocation.y=this._mouseLocation.y-(e-this._screenOffsetY),this._screenOffsetY=e}get scale(){return this._scale}get width(){return this._width*this._scale}get height(){return this._height*this._scale}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(e){this._restrictsScaling=e}get canvasUpdated(){return this._canvasUpdated}set canvasUpdated(e){this._canvasUpdated=e}}class QO{constructor(){this._objects=new Map,this._canvases=new Map,this._disposed=!1,this._roomObjectVariableAccurateZ=null}dispose(){if(!this._disposed){if(this._canvases){for(const[e,t]of this._canvases.entries())this._canvases.delete(e),t&&t.dispose();this._canvases=null}this._objects&&(this._objects=null),this._disposed=!0}}reset(){this._objects.clear()}getInstanceId(e){return e?e.instanceId:-1}getRoomObject(e){return this._objects.get(e)}addObject(e){e&&this._objects.set(this.getInstanceId(e),e)}removeObject(e){const t=this.getInstanceId(e);this._objects.delete(t);for(const s of this._canvases.values()){if(!s)continue;s.removeFromCache(t.toString())}}render(e,t=!1){if(!(!this._canvases||!this._canvases.size))for(const s of this._canvases.values())s&&s.render(e,t)}update(e,t=!1){if(!(!this._canvases||!this._canvases.size)){this.render(e,t);for(const s of this._canvases.values())s&&s.update()}}getCanvas(e){const t=this._canvases.get(e);return t||null}createCanvas(e,t,s,i){const n=this._canvases.get(e);if(n)return n.initialize(t,s),n.geometry&&(n.geometry.scale=i),n;const a=this.createSpriteCanvas(e,t,s,i);if(a)return this._canvases.set(e,a),a}createSpriteCanvas(e,t,s,i){return new qO(this,e,t,s,i)}removeCanvas(e){const t=this._canvases.get(e);t&&(this._canvases.delete(e),t.dispose())}get objects(){return this._objects}get disposed(){return this._disposed}get roomObjectVariableAccurateZ(){return this._roomObjectVariableAccurateZ}set roomObjectVariableAccurateZ(e){this._roomObjectVariableAccurateZ=e}}class ZO{createRenderer(){return new QO}}class JO extends Ss{constructor(e,t){super(),this._id=e,this._container=t,this._renderer=null,this._managers=new Map,this._updateCategories=[],this._model=new mg}onDispose(){this.removeAllManagers(),this.destroyRenderer(),this._container=null,this._model.dispose()}setRenderer(e){if(e!==this._renderer&&(this._renderer&&this.destroyRenderer(),this._renderer=e,!!this._renderer&&(this._renderer.reset(),this._managers.size)))for(const t of this._managers.values()){if(!t)continue;const s=t.objects;if(s.length)for(const i of s.getValues())i&&this._renderer.addObject(i)}}destroyRenderer(){this._renderer&&(this._renderer.dispose(),this._renderer=null)}getManager(e){const t=this._managers.get(e);return t||null}getManagerOrCreate(e){let t=this.getManager(e);return t||(t=this._container.createRoomObjectManager(e),t?(this._managers.set(e,t),t):null)}getTotalObjectsForManager(e){const t=this.getManager(e);return t?t.totalObjects:0}getRoomObject(e,t){const s=this.getManager(t);if(!s)return null;const i=s.getObject(e);return i||null}getRoomObjectsForCategory(e){const t=this.getManager(e);return t?t.objects.getValues():[]}getRoomObjectByIndex(e,t){const s=this.getManager(t);if(!s)return null;const i=s.getObjectByIndex(e);return i||null}createRoomObject(e,t,s,i){const n=this.getManagerOrCreate(i);if(!n)return null;const a=n.createObject(e,t,s);return a?(this._renderer&&this._renderer.addObject(a),a):null}createRoomObjectAndInitalize(e,t,s){return this._container?this._container.createRoomObjectAndInitalize(this._id,e,t,s):null}removeRoomObject(e,t){const s=this.getManager(t);if(!s)return;const i=s.getObject(e);i&&(i.tearDown(),this._renderer&&this._renderer.removeObject(i),s.removeObject(e))}removeAllManagers(){for(const e of this._managers.values())if(e){if(this._renderer){const t=e.objects;if(t.length)for(const s of t.getValues())s&&this._renderer.removeObject(s)}e.dispose()}this._managers.clear()}addUpdateCategory(e){this._updateCategories.indexOf(e)>=0||this._updateCategories.push(e)}removeUpdateCategory(e){const t=this._updateCategories.indexOf(e);t!==-1&&this._updateCategories.splice(t,1)}update(e,t=!1){for(const s of this._updateCategories){const i=this.getManager(s);if(!i)continue;const n=i.objects;if(n.length)for(const a of n.getValues()){if(!a)continue;const o=a.logic;o&&o.update(e)}}this._renderer&&this._renderer.update(e,t)}hasUninitializedObjects(){for(const e of this._managers.values())if(e){for(const t of e.objects.getValues())if(t&&!t.isReady)return!0}return!1}get id(){return this._id}get container(){return this._container}get renderer(){return this._renderer}get managers(){return this._managers}get model(){return this._model}}class No{constructor(e,t,s,i,n,a,o){this._layerTags=[],this._primaryColor=e&16777215,this._secondaryColor=t&16777215,this._breed=s,this._tag=i>-1&&i<No.COLOR_TAGS.length?No.COLOR_TAGS[i]:"",this._id=n,this._isMaster=a,this._layerTags=o}get primaryColor(){return this._primaryColor}get secondaryColor(){return this._secondaryColor}get breed(){return this._breed}get tag(){return this._tag}get id(){return this._id}get isMaster(){return this._isMaster}get layerTags(){return this._layerTags}}No.COLOR_TAGS=["Null","Black","White","Grey","Red","Orange","Pink","Green","Lime","Blue","Light-Blue","Dark-Blue","Yellow","Brown","Dark-Brown","Beige","Cyan","Purple","Gold"];class Ne{constructor(){this._stateEvents=null,this._sessionDataManager=null,this._waitingForSessionDataManager=!1,this._iconListener=null,this._collections=new Map,this._gifCollections=new Map,this._images=new Map,this._events=new Map,this._activeObjects={},this._activeObjectTypes=new Map,this._activeObjectTypeIds=new Map,this._objectTypeAdUrls=new Map,this._wallItems={},this._wallItemTypes=new Map,this._wallItemTypeIds=new Map,this._furniRevisions=new Map,this._pets={},this._petColors=new Map,this._objectAliases=new Map,this._objectOriginalNames=new Map,this._pendingContentTypes=[],this._dataInitialized=!1}initialize(e){this._stateEvents=e,this.setFurnitureData();for(const[t,s]of ue.getValue("pet.types").entries())this._pets[s]=t}dispose(){}setSessionDataManager(e){this._sessionDataManager=e,this._waitingForSessionDataManager&&(this._waitingForSessionDataManager=!1,this.setFurnitureData())}loadFurnitureData(){this.setFurnitureData()}setFurnitureData(){if(!this._sessionDataManager){this._waitingForSessionDataManager=!0;return}const e=this._sessionDataManager.getAllFurnitureData(this);e&&(this._sessionDataManager.removePendingFurniDataListener(this),this.processFurnitureData(e),this._stateEvents.dispatchEvent(new Ce(Ne.LOADER_READY)))}processFurnitureData(e){if(e)for(const t of e){if(!t)continue;const s=t.id;let i=t.className;t.hasIndexedColor&&(i=i+"*"+t.colorIndex);const n=t.revision,a=t.adUrl;a&&a.length>0&&this._objectTypeAdUrls.set(i,a);let o=t.className;t.type===h.FurnitureType.FLOOR?(this._activeObjectTypes.set(s,i),this._activeObjectTypeIds.set(i,s),this._activeObjects[o]||(this._activeObjects[o]=1)):t.type===h.FurnitureType.WALL&&(o==="post.it"&&(i="post_it",o="post_it"),o==="post.it.vd"&&(i="post_it_vd",o="post_id_vd"),this._wallItemTypes.set(s,i),this._wallItemTypeIds.set(i,s),this._wallItems[o]||(this._wallItems[o]=1));const u=this._furniRevisions.get(o);n>u&&(this._furniRevisions.delete(o),this._furniRevisions.set(o,n))}}getFurnitureFloorNameForTypeId(e){const t=this._activeObjectTypes.get(e);return this.removeColorIndex(t)}getFurnitureWallNameForTypeId(e,t=null){let s=this._wallItemTypes.get(e);return s==="poster"&&t!==null&&(s=s+t),this.removeColorIndex(s)}getFurnitureFloorColorIndex(e){const t=this._activeObjectTypes.get(e);return t?this.getColorIndexFromName(t):-1}getFurnitureWallColorIndex(e){const t=this._wallItemTypes.get(e);return t?this.getColorIndexFromName(t):-1}getColorIndexFromName(e){if(!e)return-1;const t=e.indexOf("*");return t===-1?0:parseInt(e.substr(t+1))}removeColorIndex(e){if(!e)return null;const t=e.indexOf("*");return t===-1?e:e.substr(0,t)}getRoomObjectAdUrl(e){const t=this._objectTypeAdUrls.get(e);return t||""}getPetColorResult(e,t){const s=this._petColors.get(e);return s?s.get(t):null}getPetColorResultsForTag(e,t){const s=this._petColors.get(e),i=[];if(s)for(const n of s.values())n.tag===t&&i.push(n);return i}getCollection(e){if(!e)return null;const t=this._collections.get(e);if(!t){const s=Ws().getCollection(e);return s?(this._collections.set(e,s),s):null}return t}getGifCollection(e){return e&&this._gifCollections.get(e)||null}getImage(e){if(!e)return null;const t=this._images.get(e);if(!t)return null;const s=new Image;return s.src=t.src,s}addAssetToCollection(e,t,s,i=!0){const n=this.getCollection(e);return n?n.addAsset(t,s,i,0,0,!1,!1):!1}createGifCollection(e,t,s){if(!e||!t||!s)return null;const i=new $v(e,t,s);return this._gifCollections.set(e,i),i}createCollection(e,t){if(!e||!t)return null;const s=new la(e,t);this._collections.set(s.name,s);const i=this._pets[s.name];if(i!==void 0){const n=s.getPaletteNames(),a=new Map;for(const o of n){const u=s.getPalette(o),l=e.palettes[o],d=u.primaryColor,c=u.secondaryColor,_=l.breed!==void 0?l.breed:0,f=l.colorTag!==void 0?l.colorTag:-1,g=l.master!==void 0?l.master:!1,I=l.tags!==void 0?l.tags:[];a.set(parseInt(o),new No(d,c,_,f,o,g,I))}this._petColors.set(i,a)}}getPlaceholderName(e){switch(this.getCategoryForType(e)){case U.FLOOR:return Ne.PLACE_HOLDER;case U.WALL:return Ne.PLACE_HOLDER_WALL;default:return this._pets[e]!==void 0?Ne.PLACE_HOLDER_PET:Ne.PLACE_HOLDER_DEFAULT}}getCategoryForType(e){return e?this._activeObjects[e]!==void 0?U.FLOOR:this._wallItems[e]!==void 0?U.WALL:this._pets[e]!==void 0?U.UNIT:e.indexOf("poster")===0?U.WALL:e==="room"?U.ROOM:e===me.USER||e===me.PET||e===me.BOT||e===me.RENTABLE_BOT?U.UNIT:e===Ne.TILE_CURSOR||e===Ne.SELECTION_ARROW?U.CURSOR:U.MINIMUM:U.MINIMUM}getPetNameForType(e){return ue.getValue("pet.types")[e]||null}isLoaderType(e){return e=me.getRealType(e),e!==G.USER}downloadImage(e,t,s,i=null){let n=null,a=[];if(t&&t.indexOf(",")>=0&&(n=t,t=n.split(",")[0]),n?a=this.getAssetUrls(n,s,!0):a=this.getAssetUrls(t,s,!0),a&&a.length){const o=a[0],u=new Image;return u.src=o,u.onload=()=>{u.onerror=null,this._images.set([t,s].join("_"),u),this._iconListener.onRoomContentLoaded(e,[t,s].join("_"),!0)},u.onerror=()=>{u.onload=null,Y.error("Failed to download asset",o),this._iconListener.onRoomContentLoaded(e,[t,s].join("_"),!1)},!0}return!1}downloadAsset(e,t){var s;return mt(this,void 0,void 0,function*(){const i=(s=this.getAssetUrls(e))===null||s===void 0?void 0:s[0];if(!(!i||!i.length)&&!(this._pendingContentTypes.indexOf(e)>=0||this.getOrRemoveEventDispatcher(e))){this._pendingContentTypes.push(e),this._events.set(e,t);try{const n=yield fetch(i);let a="application/octet-stream";switch(n.headers.has("Content-Type")&&(a=n.headers.get("Content-Type")),a){case"application/octet-stream":{const o=new _o(yield n.arrayBuffer());yield this.processAsset(o.baseTexture,o.jsonFile);const u=this._events.get(e);if(!u)return;u.dispatchEvent(new Nr(Nr.RCLE_SUCCESS,e));break}default:throw new Error}}catch{t.dispatchEvent(new Nr(Nr.RCLE_FAILURE,e))}}})}processAsset(e,t){return mt(this,void 0,void 0,function*(){const s=t.spritesheet;if(!e||!s||!Object.keys(s).length){this.createCollection(t,null);return}const i=()=>mt(this,void 0,void 0,function*(){const n=new Kl(e,s);yield n.parse(),this.createCollection(t,n)});e.valid?yield i():yield new Promise((n,a)=>{e.once("update",()=>mt(this,void 0,void 0,function*(){return yield i(),n()}))})})}setAssetAliasName(e,t){this._objectAliases.set(e,t),this._objectOriginalNames.set(t,e)}getAssetAliasName(e){const t=this._objectAliases.get(e);return t||e}getAssetOriginalName(e){const t=this._objectOriginalNames.get(e);return t||e}getAssetUrls(e,t=null,s=!1){switch(e){case Ne.PLACE_HOLDER:return[this.getAssetUrlWithGenericBase(Ne.PLACE_HOLDER)];case Ne.PLACE_HOLDER_WALL:return[this.getAssetUrlWithGenericBase(Ne.PLACE_HOLDER_WALL)];case Ne.PLACE_HOLDER_PET:return[this.getAssetUrlWithGenericBase(Ne.PLACE_HOLDER_PET)];case Ne.ROOM:return[this.getAssetUrlWithGenericBase("room")];case Ne.TILE_CURSOR:return[this.getAssetUrlWithGenericBase(Ne.TILE_CURSOR)];case Ne.SELECTION_ARROW:return[this.getAssetUrlWithGenericBase(Ne.SELECTION_ARROW)];default:{const i=this.getCategoryForType(e);if(i===U.FLOOR||i===U.WALL){const n=this.getAssetAliasName(e);let a=s?this.getAssetUrlWithFurniIconBase(n):this.getAssetUrlWithFurniBase(e);if(s){const o=t&&t!==""&&this._activeObjectTypeIds.has(n+"*"+t);a=a.replace(/%param%/gi,o?"_"+t:"")}return[a]}return i===U.UNIT?[this.getAssetUrlWithPetBase(e)]:null}}}getAssetIconUrl(e,t){let s=null,i=[];return e&&e.indexOf(",")>=0&&(s=e,e=s.split(",")[0]),s?i=this.getAssetUrls(s,t,!0):i=this.getAssetUrls(e,t,!0),i&&i.length?i[0]:null}getAssetUrlWithGenericBase(e){return ue.getValue("generic.asset.url").replace(/%libname%/gi,e)}getAssetUrlWithFurniBase(e){return ue.getValue("furni.asset.url").replace(/%libname%/gi,e)}getAssetUrlWithFurniIconBase(e){return ue.getValue("furni.asset.icon.url").replace(/%libname%/gi,e)}getAssetUrlWithPetBase(e){return ue.getValue("pet.asset.url").replace(/%libname%/gi,e)}setRoomObjectRoomId(e,t){const s=e&&e.model;s&&s.setValue(T.OBJECT_ROOM_ID,t)}getOrRemoveEventDispatcher(e,t=!1){const s=this._events.get(e);return t&&this._events.delete(e),s}setIconListener(e){this._iconListener=e}}Ne.PLACE_HOLDER="place_holder",Ne.PLACE_HOLDER_WALL="place_holder_wall",Ne.PLACE_HOLDER_PET="place_holder_pet",Ne.PLACE_HOLDER_DEFAULT=Ne.PLACE_HOLDER,Ne.ROOM="room",Ne.TILE_CURSOR="tile_cursor",Ne.SELECTION_ARROW="selection_arrow",Ne.LOADER_READY="RCL_LOADER_READY",Ne.MANDATORY_LIBRARIES=[Ne.PLACE_HOLDER,Ne.PLACE_HOLDER_WALL,Ne.PLACE_HOLDER_PET,Ne.ROOM,Ne.TILE_CURSOR,Ne.SELECTION_ARROW];class $O{constructor(){this._objects=new Ot,this._objectsPerType=new Ot}dispose(){this.removeAllObjects()}getObject(e){const t=this._objects.getValue(e);return t||null}getObjectByIndex(e){const t=this._objects.getWithIndex(e);return t||null}createObject(e,t,s){const i=new pu(e,t,s);return this.addObject(e,s,i)}addObject(e,t,s){if(this._objects.getValue(e))return s.dispose(),null;this._objects.add(e,s);const i=this.getTypeMap(t);return i&&i.add(e,s),s}removeObject(e){const t=this._objects.remove(e);if(t){const s=this.getTypeMap(t.type);s&&s.remove(t.id),t.dispose()}}removeAllObjects(){let e=0;for(;e<this._objects.length;){const t=this._objects.getWithIndex(e);t&&t.dispose(),e++}for(this._objects.reset(),e=0;e<this._objectsPerType.length;){const t=this._objectsPerType.getWithIndex(e);t&&t.dispose(),e++}this._objectsPerType.reset()}getTypeMap(e,t=!0){let s=this._objectsPerType.getValue(e);return!s&&t&&(s=new Ot,this._objectsPerType.add(e,s)),s}get objects(){return this._objects}get totalObjects(){return this._objects.length}}class ds extends Pr{constructor(e,t,s){super(),this._state=ds.ROOM_MANAGER_LOADED,this._rooms=new Map,this._contentLoader=null,this._updateCategories=[],this._listener=e,this._visualizationFactory=t,this._logicFactory=s,this._initialLoadList=[],this._pendingContentTypes=[],this._skipContentProcessing=!1,this._disposed=!1,this.onRoomContentLoadedEvent=this.onRoomContentLoadedEvent.bind(this),this.events.addEventListener(Nr.RCLE_SUCCESS,this.onRoomContentLoadedEvent),this.events.addEventListener(Nr.RCLE_FAILURE,this.onRoomContentLoadedEvent),this.events.addEventListener(Nr.RCLE_CANCEL,this.onRoomContentLoadedEvent)}onInit(){if(this._state>=ds.ROOM_MANAGER_INITIALIZING||!this._contentLoader)return;const e=Ne.MANDATORY_LIBRARIES;for(const t of e)t&&this._initialLoadList.indexOf(t)===-1&&(this._contentLoader.downloadAsset(t,this.events),this._initialLoadList.push(t));this._state=ds.ROOM_MANAGER_INITIALIZING}getRoomInstance(e){const t=this._rooms.get(e);return t||null}createRoomInstance(e){if(this._rooms.get(e))return null;const t=new JO(e,this);if(this._rooms.set(t.id,t),this._updateCategories.length)for(const s of this._updateCategories)t.addUpdateCategory(s);return t}removeRoomInstance(e){const t=this._rooms.get(e);return t?(this._rooms.delete(e),t.dispose(),!0):!1}createRoomObjectAndInitalize(e,t,s,i){const n=this.getRoomInstance(e);if(!n)return null;let a=s,o=s,u=s,l=null,d=!1;if(this._contentLoader.isLoaderType(s)){if(l=this._contentLoader.getCollection(s),!l&&(d=!0,this._contentLoader.downloadAsset(s,this.events),u=this._contentLoader.getPlaceholderName(s),l=this._contentLoader.getCollection(u),!l))return null;a=l.data.visualizationType,o=l.data.logicType}const c=n.createRoomObject(t,1,s,i);if(!c)return null;if(this._visualizationFactory){const _=this._visualizationFactory.getVisualization(a);if(!_)return n.removeRoomObject(t,i),null;_.asset=l;const f=this._visualizationFactory.getVisualizationData(u,a,l&&l.data||null);if(!f||!_.initialize(f))return n.removeRoomObject(t,i),null;c.setVisualization(_)}if(this._logicFactory){const _=this._logicFactory.getLogic(o);c.setLogic(_),_&&_.initialize(l&&l.data||null)}return d||(c.isReady=!0),this._contentLoader.setRoomObjectRoomId(c,e),c}reinitializeRoomObjectsByType(e){if(!e||!this._contentLoader||!this._visualizationFactory||!this._logicFactory)return;const t=this._contentLoader.getCollection(e);if(!t)return;const s=t.data.visualizationType,i=t.data.logicType,n=this._visualizationFactory.getVisualizationData(e,s,t.data);for(const a of this._rooms.values())if(a){for(const[o,u]of a.managers.entries())if(u)for(const l of u.objects.getValues()){if(!l||l.type!==e)continue;const d=this._visualizationFactory.getVisualization(s);if(d)if(d.asset=t,!n||!d.initialize(n))u.removeObject(l.id);else{l.setVisualization(d);const c=this._logicFactory.getLogic(i);l.setLogic(c),c&&c.initialize(t.data),l.isReady=!0,this._listener&&this._listener.objectInitialized(a.id,l.id,o)}else u.removeObject(l.id)}}}addUpdateCategory(e){if(!(this._updateCategories.indexOf(e)>=0)&&(this._updateCategories.push(e),!!this._rooms.size))for(const s of this._rooms.values())s&&s.addUpdateCategory(e)}removeUpdateCategory(e){const t=this._updateCategories.indexOf(e);if(t!==-1&&(this._updateCategories.splice(t,1),!!this._rooms.size))for(const s of this._rooms.values())s&&s.removeUpdateCategory(e)}setContentLoader(e){this._contentLoader&&this._contentLoader.dispose(),this._contentLoader=e}processPendingContentTypes(e){if(this._skipContentProcessing){this._skipContentProcessing=!1;return}for(;this._pendingContentTypes.length;){const t=this._pendingContentTypes.shift();if(!this._contentLoader.getCollection(t)){this._listener&&this._listener.initalizeTemporaryObjectsByType(t,!1),Y.log("Invalid Collection",t);continue}this.reinitializeRoomObjectsByType(t),this._listener&&this._listener.initalizeTemporaryObjectsByType(t,!0),this._initialLoadList.length>0&&this.removeFromInitialLoad(t)}}removeFromInitialLoad(e){if(!(!e||this._state===ds.ROOM_MANAGER_ERROR))if(this._contentLoader||(this._state=ds.ROOM_MANAGER_ERROR),this._contentLoader.getCollection(e)){const t=this._initialLoadList.indexOf(e);t>=0&&this._initialLoadList.splice(t,1),this._initialLoadList.length||(this._state=ds.ROOM_MANAGER_INITIALIZED,this._listener&&this._listener.onRoomEngineInitalized(!0))}else this._state=ds.ROOM_MANAGER_ERROR,this._listener&&this._listener.onRoomEngineInitalized(!1)}onRoomContentLoadedEvent(e){if(!this._contentLoader)return;const t=e.contentType;this._pendingContentTypes.indexOf(t)>=0||this._pendingContentTypes.push(t)}update(e,t=!1){if(this.processPendingContentTypes(e),!!this._rooms.size)for(const s of this._rooms.values())s&&s.update(e,t)}createRoomObjectManager(e){return new $O}get rooms(){return this._rooms}get disposed(){return this._disposed}}ds.ROOM_MANAGER_ERROR=-1,ds.ROOM_MANAGER_LOADING=0,ds.ROOM_MANAGER_LOADED=1,ds.ROOM_MANAGER_INITIALIZING=2,ds.ROOM_MANAGER_INITIALIZED=3,ds.CONTENT_PROCESSING_TIME_LIMIT_MILLISECONDS=40;class eS{constructor(e,t=-1,s=null,i=null,n=null){this._minLevel=-1,this._texture=null,this._colorMatrix=null,this._blendMode=null,this._name=e,this._minLevel=t,this._texture=s,this._colorMatrix=i,this._blendMode=n}get name(){return this._name}get texture(){return this._texture}set texture(e){this._texture=e}get colorMatrix(){return this._colorMatrix}set colorMatrix(e){this._colorMatrix=e}get blendMode(){return this._blendMode}set blendMode(e){this._blendMode=e}get minLevel(){return this._minLevel}}class tS{constructor(){this._effects=new Map,this._events=new ws,this._isLoaded=!1}init(){if(this._isLoaded)return;this._isLoaded=!0;const e=ue.getValue("image.library.url")+"Habbo-Stories/",t=ue.getValue("camera.available.effects");for(const s of t){if(!s.enabled)continue;const i=new eS(s.name,s.minLevel);s.colorMatrix.length?i.colorMatrix=s.colorMatrix:(i.texture=Re.from(e+s.name+".png"),i.blendMode=s.blendMode),this._effects.set(i.name,i)}this.events.dispatchEvent(new gc(gc.INITIALIZED))}applyEffects(e,t,s){const i=new nr,n=new ot(e);i.addChild(n),s&&n.scale.set(2);for(const a of t){const o=a.effect;if(o)if(o.colorMatrix){const u=new Cc;u.matrix=o.colorMatrix,u.alpha=a.alpha,n.filters||(n.filters=[]),n.filters.push(u)}else{const u=new ot(o.texture);u.alpha=a.alpha,u.blendMode=o.blendMode,i.addChild(u)}}return Je.generateImage(i)}get effects(){return this._effects}get events(){return this._events}get isLoaded(){return this._isLoaded}}class Xq{constructor(e,t){this._effect=e,this._alpha=t}get effect(){return this._effect}get alpha(){return this._alpha}}class sS{flush(){return this._canShowInterstitial=!1,!0}parse(e){return e?(this._canShowInterstitial=e.readBoolean(),!0):!1}get canShowInterstitial(){return this._canShowInterstitial}}class rS{flush(){return this._errorCode=0,this._filteredText=null,!0}parse(e){return e?(this._errorCode=e.readInt(),this._filteredText=e.readString(),!0):!1}get errorCode(){return this._errorCode}get filteredText(){return this._filteredText}}class iS{flush(){return this._isOpen=!1,this._onShutdown=!1,this._isAuthenticUser=!1,!0}parse(e){return e?(this._isOpen=e.readBoolean(),this._onShutdown=e.readBoolean(),e.bytesAvailable&&(this._isAuthenticUser=e.readBoolean()),!0):!1}get isOpen(){return this._isOpen}get onShutdown(){return this._onShutdown}get isAuthenticUser(){return this._isAuthenticUser}}class nS{flush(){return this._isOpen=!1,this._minutesUntilChange=0,!0}parse(e){return e?(this._isOpen=e.readInt()>0,this._minutesUntilChange=e.readInt(),!0):!1}get isOpen(){return this._isOpen}get minutesUntilChange(){return this._minutesUntilChange}}class aS{flush(){return this._openHour=0,this._openMinute=0,!0}parse(e){return e?(this._openHour=e.readInt(),this._openMinute=e.readInt(),!0):!1}get openHour(){return this._openHour}get openMinute(){return this._openMinute}}class oS{flush(){return this._openHour=0,this._openMinute=0,this._userThrownOutAtClose=!1,!0}parse(e){return e?(this._openHour=e.readInt(),this._openMinute=e.readInt(),this._userThrownOutAtClose=e.readBoolean(),!0):!1}get openHour(){return this._openHour}get openMinute(){return this._openMinute}get userThrowOutAtClose(){return this._userThrownOutAtClose}}class hS{flush(){return this._minutes=0,!0}parse(e){return e?(this._minutes=e.readInt(),!0):!1}get openMinute(){return this._minutes}}class uS{flush(){return this._isInMaintenance=!1,this._minutesUntilMaintenance=0,this._duration=15,!0}parse(e){return e?(this._isInMaintenance=e.readBoolean(),this._minutesUntilMaintenance=e.readInt(),e.bytesAvailable&&(this._duration=e.readInt()),!0):!1}get isInMaintenance(){return this._isInMaintenance}get minutesUntilMaintenance(){return this._minutesUntilMaintenance}get duration(){return this._duration}}class lS{flush(){return this._resultCode=-1,this._name="",this._nameSuggestions=[],!0}parse(e){if(!e)return!1;this._resultCode=e.readInt(),this._name=e.readString();let t=e.readInt();for(;t>0;)this._nameSuggestions.push(e.readString()),t--;return!0}get resultCode(){return this._resultCode}get name(){return this._name}get nameSuggestions(){return this._nameSuggestions}}class cS{flush(){return this._resultCode=-1,this._name="",this._nameSuggestions=[],!0}parse(e){if(!e)return!1;this._resultCode=e.readInt(),this._name=e.readString();let t=e.readInt();for(;t>0;)this._nameSuggestions.push(e.readString()),t--;return!0}get resultCode(){return this._resultCode}get name(){return this._name}get nameSuggestions(){return this._nameSuggestions}}class _S{flush(){return this._figure="",this._gender="",!0}parse(e){return e?(this._figure=e.readString(),this._gender=e.readString(),this._gender&&(this._gender=this._gender.toUpperCase()),!0):!1}get figure(){return this._figure}get gender(){return this._gender}}class dS{constructor(e){this._slotId=e.readInt(),this._figureString=e.readString(),this._gender=e.readString()}get slotId(){return this._slotId}get figureString(){return this._figureString}get gender(){return this._gender}}class fS{flush(){return this._state=0,this._outfits=[],!0}parse(e){if(!e)return!1;this._state=e.readInt();let t=e.readInt();for(;t>0;)this._outfits.push(new dS(e)),t--;return!0}get state(){return this._state}get outfits(){return this._outfits}}class Uc{constructor(e){if(!e)throw new Error("invalid_parser");this._id=e.readInt(),this._name=e.readString(),this._motto=e.readString(),this._gender=e.readString(),this._figure=e.readString()}get id(){return this._id}get name(){return this._name}get motto(){return this._motto}get figure(){return this._figure}get gender(){return this._gender}}class gS{flush(){return this._item=null,this._openInventory=!1,!0}parse(e){return e?(this._item=new Uc(e),this._openInventory=e.readBoolean(),!0):!1}get item(){return this._item}openInventory(){return this._openInventory}}class ES{flush(){return this._items=null,!0}parse(e){this._items=new Map;let t=e.readInt();for(;t>0;){const s=new Uc(e);this._items.set(s.id,s),t--}return!0}get items(){return this._items}}class mS{flush(){return this._boughtAsGift=!1,this._item=null,!0}parse(e){return e?(this._boughtAsGift=e.readBoolean(),this._item=new Uc(e),!0):!1}get boughtAsGift(){return this._boughtAsGift}get item(){return this._item}}class pS{flush(){return this._itemId=0,!0}parse(e){return e?(this._itemId=e.readInt(),!0):!1}get itemId(){return this._itemId}}class IS{constructor(e){this._name=e.readString(),this._id=e.readInt(),this._consequence=e.readString()}get name(){return this._name}get id(){return this._id}get consequence(){return this._consequence}}class TS{constructor(e){this._topics=[],this._name=e.readString();let t=e.readInt();for(;t>0;)this._topics.push(new IS(e)),t--}dispose(){this._disposed||(this._disposed=!0,this._topics=null)}get disposed(){return this._disposed}get name(){return this._name}get topics(){return this._topics}}class RS{constructor(e){this._tradeLockInfo="",this._machineBanInfo="",this._name=e.readString(),this._sanctionLengthInHours=e.readInt(),this._probationDays=e.readInt(),this._avatarOnly=e.readBoolean(),e.bytesAvailable&&(this._tradeLockInfo=e.readString()),e.bytesAvailable&&(this._machineBanInfo=e.readString())}get name(){return this._name}get sanctionLengthInHours(){return this._sanctionLengthInHours}get avatarOnly(){return this._avatarOnly}get tradeLockInfo(){return this._tradeLockInfo}get machineBanInfo(){return this._machineBanInfo}}class vS{flush(){return this._issueId=-1,this._accountId=1,this._sanctionType=null,!0}parse(e){return e?(this._issueId=e.readInt(),this._accountId=e.readInt(),this._sanctionType=new RS(e),!0):!1}get issueId(){return this._issueId}get accountId(){return this._accountId}get sanctionType(){return this._sanctionType}}class OS{flush(){return this._callForHelpCategories=null,!0}parse(e){if(!e)return!1;this._callForHelpCategories=[];let t=e.readInt();for(;t>0;)this._callForHelpCategories.push(new TS(e)),t--;return!0}get callForHelpCategories(){return this._callForHelpCategories}}class SS{flush(){return this._isSanctionNew=!1,this._isSanctionActive=!1,this._sanctionName=null,this._sanctionLengthHours=0,this._sanctionReason=null,this._sanctionCreationTime=null,this._probationHoursLeft=0,this._nextSanctionName=null,this._nextSanctionLengthHours=0,this._hasCustomMute=!1,this._tradeLockExpiryTime=null,!0}parse(e){return e?(this._isSanctionNew=e.readBoolean(),this._isSanctionActive=e.readBoolean(),this._sanctionName=e.readString(),this._sanctionLengthHours=e.readInt(),e.readInt(),this._sanctionReason=e.readString(),this._sanctionCreationTime=e.readString(),this._probationHoursLeft=e.readInt(),this._nextSanctionName=e.readString(),this._nextSanctionLengthHours=e.readInt(),e.readInt(),this._hasCustomMute=e.readBoolean(),e.bytesAvailable&&(this._tradeLockExpiryTime=e.readString()),!0):!1}get isSanctionNew(){return this._isSanctionNew}get isSanctionActive(){return this._isSanctionActive}get sanctionName(){return this._sanctionName}get sanctionLengthHours(){return this._sanctionLengthHours}get sanctionReason(){return this._sanctionReason}get sanctionCreationTime(){return this._sanctionCreationTime}get probationHoursLeft(){return this._probationHoursLeft}get nextSanctionName(){return this._nextSanctionName}get nextSanctionLengthHours(){return this._nextSanctionLengthHours}get hasCustomMute(){return this._hasCustomMute}get tradeLockExpiryTime(){return this._tradeLockExpiryTime}}class AS{constructor(){this._ok=!1,this._secondsToWait=0}flush(){return this._ok=!1,this._secondsToWait=0,this._extraDataId=null,!0}parse(e){return e?(this._ok=e.readBoolean(),this._secondsToWait=e.readInt(),this._ok&&e.bytesAvailable&&(this._extraDataId=e.readString()),!0):!1}get ok(){return this._ok}get secondsToWait(){return this._secondsToWait}get extraDataId(){return this._extraDataId}}class yS{flush(){return!0}parse(e){return!!e}}class CS{flush(){return this._roomType=null,this._roomId=-1,!0}parse(e){return e?(this._roomType=e.readString(),this._roomId=e.readInt(),!0):!1}get roomType(){return this._roomType}get roomId(){return this._roomId}}class MS{flush(){return this._url="",!0}parse(e){return e?(this._url=e.readString(),!0):!1}get url(){return this._url}}class PS{constructor(){this._ok=!1,this._errorReason=null}flush(){return this._ok=!1,this._errorReason=null,!0}parse(e){return e?(this._ok=e.readBoolean(),this._errorReason=e.readString(),!0):!1}get ok(){return this._ok}get errorReason(){return this._errorReason}}class NS{constructor(){this._creditPrice=0,this._ducketPrice=0,this._publishDucketPrice=0}flush(){return this._creditPrice=0,this._ducketPrice=0,this._publishDucketPrice=0,!0}parse(e){return e?(this._creditPrice=e.readInt(),this._ducketPrice=e.readInt(),e.bytesAvailable&&(this._publishDucketPrice=e.readInt()),!0):!1}get creditPrice(){return this._creditPrice}get ducketPrice(){return this._ducketPrice}get publishDucketPrice(){return this._publishDucketPrice}}class bS{constructor(){this._ok=!0,this._renderLimitHit=!1}flush(){return this._ok=!0,this._renderLimitHit=!1,!0}parse(e){return e?(e.bytesAvailable&&(this._ok=e.readBoolean(),this._renderLimitHit=e.readBoolean()),!0):!1}get ok(){return this._ok}get isRenderLimitHit(){return this._renderLimitHit}}class Fc{parse(e){if(!e)return!1;this._campaignName=e.readString(),this._campaignImage=e.readString(),this._currentDay=e.readInt(),this._campaignDays=e.readInt(),this._openedDays=[];let t=e.readInt();for(let s=0;s<t;s++)this._openedDays.push(e.readInt());this._missedDays=[],t=e.readInt();for(let s=0;s<t;s++)this._missedDays.push(e.readInt());return!0}clone(){const e=new Fc;return e.campaignDays=this._campaignDays,e.campaignImage=this._campaignImage,e.campaignName=this._campaignName,e.currentDay=this._currentDay,e.missedDays=this._missedDays,e.openedDays=this._openedDays,e}get campaignName(){return this._campaignName}set campaignName(e){this._campaignName=e}get campaignImage(){return this._campaignImage}set campaignImage(e){this._campaignImage=e}get currentDay(){return this._currentDay}set currentDay(e){this._currentDay=e}get campaignDays(){return this._campaignDays}set campaignDays(e){this._campaignDays=e}get openedDays(){return this._openedDays}set openedDays(e){this._openedDays=e}get missedDays(){return this._missedDays}set missedDays(e){this._missedDays=e}}class DS{flush(){return this._calendarData=null,!0}parse(e){return e?(this._calendarData=new Fc,this._calendarData.parse(e),!0):!1}get calendarData(){return this._calendarData}}class LS{flush(){return this._doorOpened=!1,this._productName=null,this._customImage=null,this._furnitureClassName=null,!0}parse(e){return e?(this._doorOpened=e.readBoolean(),this._productName=e.readString(),this._customImage=e.readString(),this._furnitureClassName=e.readString(),!0):!1}get doorOpened(){return this._doorOpened}get productName(){return this._productName}get customImage(){return this._customImage}get furnitureClassName(){return this._furnitureClassName}}class US{flush(){return this._totalCoinsForBonus=-1,this._coinsStillRequiredToBuy=-1,this._productType="",this._productClassId=-1,!0}parse(e){return e?(this._productType=e.readString(),this._productClassId=e.readInt(),this._totalCoinsForBonus=e.readInt(),this._coinsStillRequiredToBuy=e.readInt(),!0):!1}get totalCoinsForBonus(){return this._totalCoinsForBonus}get coinsStillRequiredToBuy(){return this._coinsStillRequiredToBuy}get productType(){return this._productType}get productClassId(){return this._productClassId}}class FS{flush(){return this._furniCount=0,!0}parse(e){return e?(this._furniCount=e.readInt(),!0):!1}get furniCount(){return this._furniCount}}class wS{flush(){return this._secondsLeft=0,this._furniLimit=0,this._maxFurniLimit=0,this._secondsLeftWithGrace=0,!0}parse(e){return e?(this._secondsLeft=e.readInt(),this._furniLimit=e.readInt(),this._maxFurniLimit=e.readInt(),e.bytesAvailable?this._secondsLeftWithGrace=e.readInt():this._secondsLeftWithGrace=this._secondsLeft,!0):!1}get secondsLeft(){return this._secondsLeft}get furniLimit(){return this._furniLimit}get maxFurniLimit(){return this._maxFurniLimit}get secondsLeftWithGrace(){return this._secondsLeftWithGrace}}class xS{constructor(e){this._maxPurchaseSize=e.readInt(),this._bundleSize=e.readInt(),this._bundleDiscountSize=e.readInt(),this._bonusThreshold=e.readInt(),this._additionalBonusDiscountThresholdQuantities=[];let t=e.readInt();for(;t>0;)this._additionalBonusDiscountThresholdQuantities.push(e.readInt()),t--}get maxPurchaseSize(){return this._maxPurchaseSize}get bundleSize(){return this._bundleSize}get bundleDiscountSize(){return this._bundleDiscountSize}get bonusThreshold(){return this._bonusThreshold}get additionalBonusDiscountThresholdQuantities(){return this._additionalBonusDiscountThresholdQuantities}}class GS{flush(){return this._bundleDiscountRuleset=null,!0}parse(e){return e?(this._bundleDiscountRuleset=new xS(e),!0):!1}get bundleDiscountRuleset(){return this._bundleDiscountRuleset}}class wc{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._visible=!1,this._icon=0,this._pageId=-1,this._pageName=null,this._localization=null,this._children=[],this._offerIds=[],!0}parse(e){if(!e)return!1;this._visible=e.readBoolean(),this._icon=e.readInt(),this._pageId=e.readInt(),this._pageName=e.readString(),this._localization=e.readString();let t=e.readInt();for(;t>0;)this._offerIds.push(e.readInt()),t--;let s=e.readInt();for(;s>0;)this._children.push(new wc(e)),s--;return!0}get visible(){return this._visible}get icon(){return this._icon}get pageId(){return this._pageId}get pageName(){return this._pageName}get localization(){return this._localization}get children(){return this._children}get offerIds(){return this._offerIds}}class BS{flush(){return this._root=null,!0}parse(e){return e?(this._root=new wc(e),this._newAdditionsAvailable=e.readBoolean(),this._catalogType=e.readString(),!0):!1}get root(){return this._root}get newAdditionsAvailable(){return this._newAdditionsAvailable}get catalogType(){return this._catalogType}}class HS{constructor(e){this._images=[],this._texts=[];let t=e.readInt();for(;t>0;)this._images.push(e.readString()),t--;let s=e.readInt();for(;s>0;)this._texts.push(e.readString()),s--}get images(){return this._images}get texts(){return this._texts}}class kS{flush(){return this._pageName=null,this._pageId=0,this._secondsToExpiry=0,this._image=null,!0}parse(e){return e?(this._pageId=e.readInt(),this._pageName=e.readString(),this._secondsToExpiry=e.readInt(),this._image=e.readString(),!0):!1}get pageName(){return this._pageName}get pageId(){return this._pageId}get secondsToExpiry(){return this._secondsToExpiry}get image(){return this._image}}class Dr{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._productType=null,this._furniClassId=-1,this._extraParam=null,this._productCount=0,this._uniqueLimitedItem=!1,this._uniqueLimitedItemSeriesSize=0,this._uniqueLimitedItemsLeft=0,!0}parse(e){switch(this._productType=e.readString(),this._productType){case Dr.B:return this._extraParam=e.readString(),this._productCount=1,!0;default:return this._furniClassId=e.readInt(),this._extraParam=e.readString(),this._productCount=e.readInt(),this._uniqueLimitedItem=e.readBoolean(),this._uniqueLimitedItem&&(this._uniqueLimitedItemSeriesSize=e.readInt(),this._uniqueLimitedItemsLeft=e.readInt()),!0}}get productType(){return this._productType}get furniClassId(){return this._furniClassId}get extraParam(){return this._extraParam}get productCount(){return this._productCount}get uniqueLimitedItem(){return this._uniqueLimitedItem}get uniqueLimitedSeriesSize(){return this._uniqueLimitedItemSeriesSize}get uniqueLimitedItemsLeft(){return this._uniqueLimitedItemsLeft}}Dr.I="i",Dr.S="s",Dr.E="e",Dr.B="b";class vu{constructor(e){this._offerId=e.readInt(),this._localizationId=e.readString(),this._rent=e.readBoolean(),this._priceCredits=e.readInt(),this._priceActivityPoints=e.readInt(),this._priceActivityPointsType=e.readInt(),this._giftable=e.readBoolean(),this._products=[];let t=e.readInt();for(;t>0;)this._products.push(new Dr(e)),t--;this._clubLevel=e.readInt(),this._bundlePurchaseAllowed=e.readBoolean(),this._isPet=e.readBoolean(),this._previewImage=e.readString()}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get isPet(){return this._isPet}get previewImage(){return this._previewImage}get products(){return this._products}}class Yi{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._type=-1,this._position=null,this._itemName=null,this._itemPromoImage=null,this._catalogPageLocation=null,this._productCode=null,this._productOfferId=0,this._expirationTime=0,!0}parse(e){if(!e)return!1;switch(this._position=e.readInt(),this._itemName=e.readString(),this._itemPromoImage=e.readString(),this._type=e.readInt(),this._type){case Yi.ITEM_CATALOGUE_PAGE:this._catalogPageLocation=e.readString();break;case Yi.ITEM_PRODUCT_OFFER:this._productOfferId=e.readInt();break;case Yi.ITEM_IAP:this._productCode=e.readString();break}const t=e.readInt();return this._expirationTime=t>0?t*1e3+ve():0,!0}get type(){return this._type}get position(){return this._position}get itemName(){return this._itemName}get itemPromoImage(){return this._itemPromoImage}get catalogPageLocation(){return this._catalogPageLocation}get productCode(){return this._productCode}get productOfferId(){return this._productOfferId}get expirationTime(){return this._expirationTime}}Yi.ITEM_CATALOGUE_PAGE=0,Yi.ITEM_PRODUCT_OFFER=1,Yi.ITEM_IAP=2;class VS{flush(){return this._pageId=-1,this._catalogType=null,this._layoutCode=null,this._localization=null,this._offers=[],this._offerId=-1,this._acceptSeasonCurrencyAsCredits=!1,this._frontPageItems=[],!0}parse(e){if(!e)return!1;this._pageId=e.readInt(),this._catalogType=e.readString(),this._layoutCode=e.readString(),this._localization=new HS(e);let t=e.readInt();for(;t>0;)this._offers.push(new vu(e)),t--;if(this._offerId=e.readInt(),this._acceptSeasonCurrencyAsCredits=e.readBoolean(),e.bytesAvailable){let s=e.readInt();for(;s>0;)this._frontPageItems.push(new Yi(e)),s--}return!0}get pageId(){return this._pageId}get catalogType(){return this._catalogType}get layoutCode(){return this._layoutCode}get localization(){return this._localization}get offers(){return this._offers}get offerId(){return this._offerId}get acceptSeasonCurrencyAsCredits(){return this._acceptSeasonCurrencyAsCredits}get frontPageItems(){return this._frontPageItems}}class jS{flush(){return this._pageName=null,this._secondsToExpiry=0,this._image=null,!0}parse(e){return e?(this._pageName=e.readString(),this._secondsToExpiry=e.readInt(),this._image=e.readString(),!0):!1}get pageName(){return this._pageName}get secondsToExpiry(){return this._secondsToExpiry}get image(){return this._image}}class YS{flush(){return this._instantlyRefreshCatalogue=!1,this._newFurniDataHash=null,!0}parse(e){return e?(this._instantlyRefreshCatalogue=e.readBoolean(),e.bytesAvailable&&(this._newFurniDataHash=e.readString()),!0):!1}get instantlyRefreshCatalogue(){return this._instantlyRefreshCatalogue}get newFurniDataHash(){return this._newFurniDataHash}}class WS{constructor(e){this._offerId=e.readInt(),this._isVip=e.readBoolean(),this._daysRequired=e.readInt(),this._isSelectable=e.readBoolean()}get offerId(){return this._offerId}get isVip(){return this._isVip}get isSelectable(){return this._isSelectable}get daysRequired(){return this._daysRequired}}class zS{flush(){return!0}parse(e){if(!e)return!1;this._offers=[],this._giftData=new Map,this._daysUntilNextGift=e.readInt(),this._giftsAvailable=e.readInt();const t=e.readInt();for(let i=0;i<t;i++)this._offers.push(new vu(e));const s=e.readInt();for(let i=0;i<s;i++){const n=new WS(e);this._giftData.set(n.offerId,n)}return!0}get offers(){return this._offers}get daysUntilNextGift(){return this._daysUntilNextGift}get giftsAvailable(){return this._giftsAvailable}set giftsAvailable(e){this._giftsAvailable=e}getOfferExtraData(e){return e?this._giftData.get(e):null}get giftData(){return this._giftData}}class XS{flush(){return this._productCode=null,this._products=[],!0}parse(e){if(!e)return!1;this._productCode=e.readString();let t=e.readInt();for(;t>0;)this._products.push(new Dr(e)),t--;return!0}get productCode(){return this._productCode}get products(){return this._products}}class Og{constructor(e){if(!e)throw new Error("invalid_wrapper");this._offerId=e.readInt(),this._productCode=e.readString(),e.readBoolean(),this._priceCredits=e.readInt(),this._priceActivityPoints=e.readInt(),this._priceActivityPointsType=e.readInt(),this._vip=e.readBoolean(),this._months=e.readInt(),this._extraDays=e.readInt(),this._giftable=e.readBoolean(),this._daysLeftAfterPurchase=e.readInt(),this._year=e.readInt(),this._month=e.readInt(),this._day=e.readInt()}get offerId(){return this._offerId}get productCode(){return this._productCode}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get vip(){return this._vip}get months(){return this._months}get extraDays(){return this._extraDays}get daysLeftAfterPurchase(){return this._daysLeftAfterPurchase}get year(){return this._year}get month(){return this._month}get day(){return this._day}get giftable(){return this._giftable}}class KS extends Og{constructor(e){super(e),this._originalPrice=e.readInt(),this._originalActivityPointPrice=e.readInt(),this._originalActivityPointType=e.readInt(),this._subscriptionDaysLeft=e.readInt()}get originalPrice(){return this._originalPrice*this.months}get originalActivityPointPrice(){return this._originalActivityPointPrice*this.months}get originalActivityPointType(){return this._originalActivityPointType}get discountCreditAmount(){return this._originalPrice*this.months-this.priceCredits}get discountActivityPointAmount(){return this.originalActivityPointPrice*this.months-this.priceActivityPoints}get subscriptionDaysLeft(){return this._subscriptionDaysLeft}}class qS{flush(){return this._available=!1,this._pricePointUrl=null,this._market=null,this._lengthInDays=0,!0}parse(e){return e?(this._pricePointUrl=e.readString(),this._pricePointUrl!==""&&(this._available=!0),this._market=e.readString(),this._lengthInDays=e.readInt(),!0):!1}get available(){return this._available}get pricePointUrl(){return this._pricePointUrl}get market(){return this._market}get lengthInDays(){return this._lengthInDays}}class QS{constructor(e){this._stuffId=e.readInt(),this._charges=e.readInt(),this._SafeStr_6935=e.readInt(),this._SafeStr_6936=e.readInt(),this._SafeStr_6518=e.readInt(),this._SafeStr_7875=e.readInt()}get stuffId(){return this._stuffId}get charges(){return this._charges}get _SafeStr_5946(){return this._SafeStr_6935}get _SafeStr_5944(){return this._SafeStr_6936}get _SafeStr_7876(){return this._SafeStr_7875}get _SafeStr_5945(){return this._SafeStr_6518}}class ZS{flush(){return this._fireworkChargeData=null,!0}parse(e){return e?(this._fireworkChargeData=new QS(e),!0):!1}get fireworkChargeData(){return this._fireworkChargeData}}class JS{flush(){return!0}parse(e){return!!e}}class $S{constructor(){this._isEnabled=!1,this._price=null,this._giftWrappers=null,this._boxTypes=null,this._ribbonTypes=null,this._giftFurnis=null}flush(){return this._boxTypes=null,this._giftFurnis=null,this._giftWrappers=null,this._ribbonTypes=null,this._isEnabled=null,this._price=null,!0}parse(e){if(!e)return!1;const t=[],s=[],i=[],n=[];this._isEnabled=e.readBoolean(),this._price=e.readInt();let a=e.readInt(),o=0;for(;o<a;)t.push(e.readInt()),o++;for(a=e.readInt(),o=0;o<a;)s.push(e.readInt()),o++;for(a=e.readInt(),o=0;o<a;)i.push(e.readInt()),o++;for(a=e.readInt(),o=0;o<a;)n.push(e.readInt()),o++;return this._giftWrappers=t,this._ribbonTypes=i,this._giftFurnis=n,this._boxTypes=s,!0}get giftWrappers(){return this._giftWrappers}get ribbonTypes(){return this._ribbonTypes}get giftFurnis(){return this._giftFurnis}get boxTypes(){return this._boxTypes}get isEnabled(){return this._isEnabled}get price(){return this._price}}class eA{flush(){return this._offer=null,!0}parse(e){return e?(this._offer=new KS(e),!0):!1}get offer(){return this._offer}}class tA{flush(){return this._offers=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._offers.push(new Og(e)),t--;return!0}get offers(){return this._offers}}class sA{flush(){return this._offerId=0,this._isGiftable=!1,!0}parse(e){return e?(this._offerId=e.readInt(),this._isGiftable=e.readBoolean(),!0):!1}get offerId(){return this._offerId}get isGiftable(){return this._isGiftable}}class rA{flush(){return!0}parse(e){return!!e}}class iA{flush(){return this._appearsInSeconds=-1,this._pageId=-1,this._offerId=-1,this._productType="",!0}parse(e){return e?(this._appearsInSeconds=e.readInt(),this._pageId=e.readInt(),this._offerId=e.readInt(),this._productType=e.readString(),!0):!1}get appearsInSeconds(){return this._appearsInSeconds}get pageId(){return this._pageId}get offerId(){return this._offerId}get productType(){return this._productType}}class nA{constructor(){this._notEnoughCredits=!1,this._notEnoughActivityPoints=!1,this._activityPointType=0}flush(){return this._notEnoughCredits=!1,this._notEnoughActivityPoints=!1,this._activityPointType=0,!0}parse(e){return e?(this._notEnoughCredits=e.readBoolean(),this._notEnoughActivityPoints=e.readBoolean(),e.bytesAvailable&&(this._activityPointType=e.readInt()),!0):!1}get notEnoughCredits(){return this._notEnoughCredits}get notEnoughActivityPoints(){return this._notEnoughActivityPoints}get activityPointType(){return this._activityPointType}}class aA{flush(){return this._offer=null,!0}parse(e){return e?(this._offer=new vu(e),!0):!1}get offer(){return this._offer}}class oA{flush(){return this._code=0,!0}parse(e){return e?(this._code=e.readInt(),!0):!1}get code(){return this._code}}class hA{flush(){return this._code=0,!0}parse(e){return e?(this._code=e.readInt(),!0):!1}get code(){return this._code}}class uA{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._offerId=-1,this._localizationId=null,this._rent=!1,this._priceCredits=0,this._priceActivityPoints=0,this._priceActivityPointsType=0,this._clubLevel=0,this._giftable=!1,this._bundlePurchaseAllowed=!1,this._products=[],!0}parse(e){if(!e)return!1;this._offerId=e.readInt(),this._localizationId=e.readString(),this._rent=e.readBoolean(),this._priceCredits=e.readInt(),this._priceActivityPoints=e.readInt(),this._priceActivityPointsType=e.readInt(),this._giftable=e.readBoolean();let t=e.readInt();for(;t>0;)this._products.push(new Dr(e)),t--;return this._clubLevel=e.readInt(),this._bundlePurchaseAllowed=e.readBoolean(),!0}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get products(){return this._products}}class lA{flush(){return this._offer=null,!0}parse(e){return e?(this._offer=new uA(e),!0):!1}get offer(){return this._offer}}class cA{flush(){return this._clubLevel=0,this._securityLevel=0,this._isAmbassador=!1,!0}parse(e){return e?(this._clubLevel=e.readInt(),this._securityLevel=e.readInt(),this._isAmbassador=e.readBoolean(),!0):!1}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}}class Ou{flush(){return!0}parse(e){return e?(this._status=e.readInt(),!0):!1}get status(){return this._status}}Ou.SAFETY_LOCK_STATUS_LOCKED=0,Ou.SAFETY_LOCK_STATUS_UNLOCKED=1;class _A{flush(){return this._result=-1,this._validationInfo="",!0}parse(e){return e?(this._result=e.readInt(),this._validationInfo=e.readString(),!0):!1}get result(){return this._result}get validationInfo(){return this._validationInfo}}class Sg{flush(){return this._result=-1,!0}parse(e){return e?(this._result=e.readInt(),!0):!1}get result(){return this._result}}Sg.EMAIL_STATUS_OK=0;class dA{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._relationshipStatusType=Sn.NONE,this._friendCount=0,this._randomFriendId=0,this._randomFriendFigure=null,this._randomFriendName=null,!0}parse(e){return e?(this._relationshipStatusType=e.readInt(),this._friendCount=e.readInt(),this._randomFriendId=e.readInt(),this._randomFriendName=e.readString(),this._randomFriendFigure=e.readString(),!0):!1}get relationshipStatusType(){return this._relationshipStatusType}get friendCount(){return this._friendCount}get randomFriendId(){return this._randomFriendId}get randomFriendName(){return this._randomFriendName}get randomFriendFigure(){return this._randomFriendFigure}}class fA{flush(){return this._userId=0,this._relationshipStatusMap=null,!0}parse(e){if(!e)return!1;this._userId=e.readInt(),this._relationshipStatusMap=new Ot;const t=e.readInt();for(let s=0;s<t;s++){const i=new dA(e);this._relationshipStatusMap.add(i.relationshipStatusType,i)}return!0}get userId(){return this._userId}get relationshipStatusMap(){return this._relationshipStatusMap}}class gA{flush(){return this._userId=null,this._badges=[],!0}parse(e){if(!e)return!1;this._userId=e.readInt();let t=e.readInt();for(;t>0;){e.readInt();const s=e.readString();this._badges.push(s),t--}return!0}get userId(){return this._userId}get badges(){return this._badges}}class Kq{flush(){return this._figure=null,this._gender=null,!0}parse(e){return e?(this._figure=e.readString(),this._gender=e.readString(),!0):!1}get figure(){return this._figure}get gender(){return this._gender}}class EA{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._userId=0,this._username=null,this._figure=null,this._gender=null,this._motto=null,this._realName=null,this._directMail=!1,this._respectsReceived=0,this._respectsRemaining=0,this._respectsPetRemaining=0,this._streamPublishingAllowed=!1,this._lastAccessDate=null,this._canChangeName=!1,this._safetyLocked=!1,!0}parse(e){return e?(this._userId=e.readInt(),this._username=e.readString(),this._figure=e.readString(),this._gender=e.readString(),this._motto=e.readString(),this._realName=e.readString(),this._directMail=e.readBoolean(),this._respectsReceived=e.readInt(),this._respectsRemaining=e.readInt(),this._respectsPetRemaining=e.readInt(),this._streamPublishingAllowed=e.readBoolean(),this._lastAccessDate=e.readString(),this._canChangeName=e.readBoolean(),this._safetyLocked=e.readBoolean(),!0):!1}get userId(){return this._userId}get username(){return this._username}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get realName(){return this._realName}get directMail(){return this._directMail}get respectsReceived(){return this._respectsReceived}get respectsRemaining(){return this._respectsRemaining}get respectsPetRemaining(){return this._respectsPetRemaining}get streamPublishingAllowed(){return this._streamPublishingAllowed}get lastAccessedDate(){return this._lastAccessDate}get canChangeName(){return this._canChangeName}get safetyLocked(){return this._safetyLocked}}class mA{flush(){return this._userInfo=null,!0}parse(e){return!(!e||(this._userInfo=new EA(e),!this._userInfo))}get userInfo(){return this._userInfo}}class pA{flush(){return this._webId=-1,this._id=-1,this._newName="",!0}parse(e){return e?(this._webId=e.readInt(),this._id=e.readInt(),this._newName=e.readString(),!0):!1}get webId(){return this._webId}get id(){return this._id}get newName(){return this._newName}}class Ag{constructor(e){this._groupId=e.readInt(),this._groupName=e.readString(),this._badgeCode=e.readString(),this._colorA=e.readString(),this._colorB=e.readString(),this._favourite=e.readBoolean(),this._ownerId=e.readInt(),this._hasForum=e.readBoolean()}get groupId(){return this._groupId}get groupName(){return this._groupName}get badgeCode(){return this._badgeCode}get colorA(){return this._colorA}get colorB(){return this._colorB}get favourite(){return this._favourite}get ownerId(){return this._ownerId}get hasForum(){return this._hasForum}}class IA{flush(){return this._id=0,this._username=null,this._figure=null,this._motto=null,this._registration=null,this._achievementPoints=0,this._friendsCount=0,this._isMyFriend=!1,this._requestSent=!1,this._isOnline=!1,this._groups=[],this._secondsSinceLastVisit=0,this._openProfileWindow=!1,!0}parse(e){if(!e)return!1;this._id=e.readInt(),this._username=e.readString(),this._figure=e.readString(),this._motto=e.readString(),this._registration=e.readString(),this._achievementPoints=e.readInt(),this._friendsCount=e.readInt(),this._isMyFriend=e.readBoolean(),this._requestSent=e.readBoolean(),this._isOnline=e.readBoolean();const t=e.readInt();for(let s=0;s<t;s++)this._groups.push(new Ag(e));return this._secondsSinceLastVisit=e.readInt(),this._openProfileWindow=e.readBoolean(),!0}get id(){return this._id}get username(){return this._username}get figure(){return this._figure}get motto(){return this._motto}get registration(){return this._registration}get achievementPoints(){return this._achievementPoints}get friendsCount(){return this._friendsCount}get isMyFriend(){return this._isMyFriend}get requestSent(){return this._requestSent}get isOnline(){return this._isOnline}get groups(){return this._groups}get secondsSinceLastVisit(){return this._secondsSinceLastVisit}get openProfileWindow(){return this._openProfileWindow}}class TA{flush(){return this._volumeSystem=0,this._volumeFurni=0,this._volumeTrax=0,this._oldChat=!1,this._roomInvites=!1,this._cameraFollow=!1,this._flags=0,this._chatType=0,!0}parse(e){return e?(this._volumeSystem=e.readInt(),this._volumeFurni=e.readInt(),this._volumeTrax=e.readInt(),this._oldChat=e.readBoolean(),this._roomInvites=e.readBoolean(),this._cameraFollow=e.readBoolean(),this._flags=e.readInt(),this._chatType=e.readInt(),!0):!1}get volumeSystem(){return this._volumeSystem}get volumeFurni(){return this._volumeFurni}get volumeTrax(){return this._volumeTrax}get oldChat(){return this._oldChat}get roomInvites(){return this._roomInvites}get cameraFollow(){return this._cameraFollow}get flags(){return this._flags}get chatType(){return this._chatType}}class RA{flush(){return this._roomUnitId=-1,this._tags=[],!0}parse(e){if(!e)return!1;this._roomUnitId=e.readInt();let t=e.readInt();for(;t>0;)this._tags.push(e.readString()),t--;return!0}get roomUnitId(){return this._roomUnitId}get tags(){return this._tags}}class vA{flush(){return this._email=null,this._isVerified=!1,this._allowChange=!1,!0}parse(e){return e?(this._email=e.readString(),this._isVerified=e.readBoolean(),this._allowChange=e.readBoolean(),!0):!1}get email(){return this._email}get isVerified(){return this._isVerified}get allowChange(){return this._allowChange}}class OA{flush(){return this._userId=-1,!0}parse(e){return e?(this._userId=e.readInt(),!0):!1}get userId(){return this._userId}}class SA{flush(){return this._groupId=-1,!0}parse(e){return e?(this._groupId=e.readInt(),!0):!1}get groupId(){return this._groupId}}class AA{flush(){return this._groupId=-1,this._requester=null,!0}parse(e){return e?(this._groupId=e.readInt(),this._requester=new $s(e),!0):!1}get groupId(){return this._groupId}get requester(){return this._requester}}class yg{flush(){return this._reason=-1,!0}parse(e){return e?(this._reason=e.readInt(),!0):!1}get reason(){return this._reason}}yg.INSUFFICIENT_SUBSCRIPTION_LEVEL=2;class yA{flush(){return this._guildId=-1,this._reason=-1,!0}parse(e){return e?(this._guildId=e.readInt(),this._reason=e.readInt(),!0):!1}get guildId(){return this._guildId}get reason(){return this._reason}}class CA{flush(){return this._groups=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._groups.push(new Ag(e)),t--;return!0}get groups(){return this._groups}}class MA{flush(){return this._badges=new Map,!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const s=e.readInt(),i=e.readString();this._badges.set(s,i),t--}return!0}get badges(){return this._badges}}class Cg{flush(){return this._reason=-1,!0}parse(e){return e?(this._reason=e.readInt(),!0):!1}get reason(){return this._reason}}Cg.INSUFFICIENT_SUBSCRIPTION_LEVEL=4;class PA{flush(){return this._ignoredUsers=[],!0}parse(e){if(!e)return!1;this._ignoredUsers=[];let t=e.readInt();for(;t>0;)this._ignoredUsers.push(e.readString()),t--;return!0}get ignoredUsers(){return this._ignoredUsers}}class NA{flush(){return this._result=-1,this._name=null,!0}parse(e){return e?(this._result=e.readInt(),this._name=e.readString(),!0):!1}get result(){return this._result}get name(){return this._name}}class bA{flush(){return this._link=null,!0}parse(e){return e?(this._link=e.readString(),!0):!1}get link(){return this._link}}class DA{flush(){return this._credits=null,!0}parse(e){return e?(this._credits=e.readString(),!0):!1}get credits(){return this._credits}}class LA{flush(){return this._currencies=new Map,!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._currencies.set(e.readInt(),e.readInt()),t--;return!0}get currencies(){return this._currencies}}class bo{flush(){return this._productName=null,this._daysToPeriodEnd=0,this._memberPeriods=0,this._periodsSubscribedAhead=0,this._responseType=0,this._hasEverBeenMember=!1,this._isVip=!1,this._pastClubDays=0,this._pastVipDays=0,this._minutesUntilExpiration=0,this._minutesSinceLastModified=0,!0}parse(e){return e?(this._productName=e.readString(),this._daysToPeriodEnd=e.readInt(),this._memberPeriods=e.readInt(),this._periodsSubscribedAhead=e.readInt(),this._responseType=e.readInt(),this._hasEverBeenMember=e.readBoolean(),this._isVip=e.readBoolean(),this._pastClubDays=e.readInt(),this._pastVipDays=e.readInt(),this._minutesUntilExpiration=e.readInt(),e.bytesAvailable&&(this._minutesSinceLastModified=e.readInt()),!0):!1}get productName(){return this._productName}get daysToPeriodEnd(){return this._daysToPeriodEnd}get memberPeriods(){return this._memberPeriods}get periodsSubscribedAhead(){return this._periodsSubscribedAhead}get responseType(){return this._responseType}get hasEverBeenMember(){return this._hasEverBeenMember}get isVip(){return this._isVip}get pastClubDays(){return this._pastClubDays}get pastVipDays(){return this._pastVipDays}get minutesUntilExpiration(){return this._minutesUntilExpiration}get minutesSinceLastModified(){return this._minutesSinceLastModified}}bo.RESPONSE_TYPE_LOGIN=1,bo.RESPONSE_TYPE_PURCHASE=2,bo.RESPONSE_TYPE_DISCOUNT_AVAILABLE=3,bo.RESPONSE_TYPE_CITIZENSHIP_DISCOUNT=4;class Sa{constructor(e){if(this._unseen=0,!e)throw new Error("invalid_parser");this._achievementId=e.readInt(),this._level=e.readInt(),this._badgeId=e.readString(),this._scoreAtStartOfLevel=e.readInt(),this._scoreLimit=Math.max(1,e.readInt()),this._levelRewardPoints=e.readInt(),this._levelRewardPointType=e.readInt(),this._currentPoints=e.readInt(),this._finalLevel=e.readBoolean(),this._category=e.readString(),this._subCategory=e.readString(),this._levelCount=e.readInt(),this._displayMethod=e.readInt()}get achievementId(){return this._achievementId}get badgeId(){return this._badgeId}get level(){return this._level}get scoreAtStartOfLevel(){return this._scoreAtStartOfLevel}get scoreLimit(){return this._scoreLimit-this._scoreAtStartOfLevel}get levelRewardPoints(){return this._levelRewardPoints}get levelRewardPointType(){return this._levelRewardPointType}get currentPoints(){return this._currentPoints-this._scoreAtStartOfLevel}get finalLevel(){return this._finalLevel}get category(){return this._category}get subCategory(){return this._subCategory}get levelCount(){return this._levelCount}get firstLevelAchieved(){return this._level>1||this._finalLevel}setMaxProgress(){this._currentPoints=this._scoreLimit}get displayMethod(){return this._displayMethod}get progress(){return this._currentPoints}get toNextProgress(){return this._scoreLimit}set unseen(e){this._unseen=e}get unseen(){return this._unseen}reset(e){this._achievementId=e._achievementId,this._level=e._level,this._badgeId=e._badgeId,this._scoreAtStartOfLevel=e._scoreAtStartOfLevel,this._scoreLimit=e._scoreLimit,this._levelRewardPoints=e._levelRewardPoints,this._levelRewardPointType=e._levelRewardPointType,this._currentPoints=e._currentPoints,this._finalLevel=e._finalLevel,this._category=e.category,this._subCategory=e._subCategory,this._levelCount=e._levelCount,this._displayMethod=e._displayMethod}}Sa.DISPLAY_METHOD_OBSOLETE=-1,Sa.DISPLAY_METHOD_SHOW_LEVEL_PROGRESS=0,Sa.DISPLAY_METHOD_NEVER_SHOW_PROGRESS=1,Sa.DISPLAY_METHOD_SHOW_TOTAL_PROGRESS=2;class UA{flush(){return this._achievement=null,!0}parse(e){return e?(this._achievement=new Sa(e),!0):!1}get achievement(){return this._achievement}}class Su{constructor(e){this._achievementId=e.readInt(),this._level=e.readInt(),this._badgeId=e.readString(),this._requiredLevel=e.readInt(),this._state=e.readInt()}dispose(){this._achievementId=0,this._level=0,this._badgeId="",this._requiredLevel=0}get achievementId(){return this._achievementId}get level(){return this._level}get badgeId(){return this._badgeId}get requiredLevel(){return this._requiredLevel}get enabled(){return this._state===Su.STATE_SELECTABLE}get state(){return this._state}}Su.STATE_SELECTABLE=0;class FA{flush(){return this._achievements=[],this._defaultCategory=null,!0}parse(e){if(!e)return!1;this._achievements=[];let t=e.readInt();for(;t>0;)this._achievements.push(new Sa(e)),t--;return this._defaultCategory=e.readString(),!0}get achievements(){return this._achievements}get defaultCategory(){return this._defaultCategory}}class wA{flush(){return this._score=0,!0}parse(e){return e?(this._score=e.readInt(),!0):!1}get score(){return this._score}}class xA{get type(){return this._type}set type(e){this._type=e}get subType(){return this._subType}set subType(e){this._subType=e}get duration(){return this._duration}set duration(e){this._duration=e}get inactiveEffectsInInventory(){return this._inactiveEffectsInInventory}set inactiveEffectsInInventory(e){this._inactiveEffectsInInventory=e}get secondsLeftIfActive(){return this._secondsLeftIfActive}set secondsLeftIfActive(e){this._secondsLeftIfActive=e}get isPermanent(){return this._permanent}set isPermanent(e){this._permanent=e}}class GA{flush(){return this._type=0,this._duration=0,this._isPermanent=!1,!0}parse(e){return e?(this._type=e.readInt(),this._duration=e.readInt(),this._isPermanent=e.readBoolean(),!0):!1}get type(){return this._type}get duration(){return this._duration}get isPermanent(){return this._isPermanent}}class BA{flush(){return this._type=0,this._subType=0,this._duration=0,this._permanent=!1,!0}parse(e){return e?(this._type=e.readInt(),this._subType=e.readInt(),this._duration=e.readInt(),this._permanent=e.readBoolean(),!0):!1}get type(){return this._type}get subType(){return this._subType}get duration(){return this._duration}get isPermanent(){return this._permanent}}class HA{flush(){return this._type=0,!0}parse(e){return e?(this._type=e.readInt(),!0):!1}get type(){return this._type}}class kA{flush(){return this._type=0,!0}parse(e){return e?(this._type=e.readInt(),!0):!1}get type(){return this._type}}class VA{flush(){return this._effects=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const s=new xA;s.type=e.readInt(),s.subType=e.readInt(),s.duration=e.readInt(),s.inactiveEffectsInInventory=e.readInt(),s.secondsLeftIfActive=e.readInt(),s.isPermanent=e.readBoolean(),this._effects.push(s),t--}return!0}get effects(){return this._effects}}class jA{constructor(e,t){if(!t)throw new Error("invalid_parser");this._badgeId="ACH_"+e+t.readInt(),this._limit=t.readInt()}get badgeId(){return this._badgeId}get limit(){return this._limit}}class YA{flush(){return this._data=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const s=e.readString(),i=e.readInt();let n=0;for(;n<i;)this._data.push(new jA(s,e)),n++;t--}return!0}get data(){return this._data}}class WA{flush(){return this._badgeId=0,this._badgeCode=null,!0}parse(e){return e?(this._badgeId=e.readInt(),this._badgeCode=e.readString(),!0):!1}get badgeId(){return this._badgeId}get badgeCode(){return this._badgeCode}}class zA{flush(){return this._allBadgeCodes=[],this._activeBadgeCodes=null,this._badgeIds=null,!0}parse(e){if(!e)return!1;this._allBadgeCodes=[],this._activeBadgeCodes=[],this._badgeIds=new Ot;let t=e.readInt();for(;t>0;){const s=e.readInt(),i=e.readString();this._badgeIds.add(i,s),this._allBadgeCodes.push(i),t--}for(t=e.readInt();t>0;){e.readInt();const s=e.readString();this._activeBadgeCodes.push(s),t--}return!0}getBadgeId(e){return this._badgeIds.getValue(e)}getAllBadgeCodes(){return this._allBadgeCodes}getActiveBadgeCodes(){return this._activeBadgeCodes}}class XA{flush(){return!0}parse(e){return e?(this._requestCode=e.readString(),this._fulfilled=e.readBoolean(),!0):!1}get requestCode(){return this._requestCode}get fulfilled(){return this._fulfilled}}class KA{flush(){return this._figureSetIds=[],this._boundFurnitureNames=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._figureSetIds.push(e.readInt()),t--;let s=e.readInt();for(;s>0;)this._boundFurnitureNames.push(e.readString()),s--;return!0}get figureSetIds(){return this._figureSetIds}get boundsFurnitureNames(){return this._boundFurnitureNames}}class qA{flush(){return this._itemId=0,!0}parse(e){return e?(this._itemId=e.readInt(),!0):!1}get itemId(){return this._itemId}}class QA{flush(){return this._itemId=0,!0}parse(e){return e?(this._itemId=e.readInt(),!0):!1}get itemId(){return this._itemId}}class Do{flush(){return this._reason=0,this._parameter="",!0}parse(e){return e?(this._reason=e.readInt(),this._parameter=e.readString(),!0):!1}get reason(){return this._reason}get parameter(){return this._parameter}}Do.REASON_FULL=1,Do.REASON_CLOSED=2,Do.REASON_QUEUE_ERROR=3,Do.REASON_BANNED=4;class ZA{flush(){return this._userName=null,!0}parse(e){return e?(this._userName=e.readString(),!0):!1}get userName(){return this._userName}}class JA{flush(){return!0}parse(e){return!!e}}class $A{flush(){return!0}parse(e){return!!e}}class ey{flush(){return this._controllerLevel=Fs.NONE,!0}parse(e){return e?(this._controllerLevel=e.readInt(),!0):!1}get controllerLevel(){return this._controllerLevel}}class ty{flush(){return!0}parse(e){return!!e}}class sy{flush(){return this._roomId=0,!0}parse(e){return e?(this._roomId=e.readInt(),!0):!1}get roomId(){return this._roomId}}class ry{flush(){return this._botId=-1,this._commandId=-1,this._data="",!0}parse(e){return e?(this._botId=e.readInt(),this._commandId=e.readInt(),this._data=e.readString(),!0):!1}get botId(){return this._botId}get commandId(){return this._commandId}get data(){return this._data}}class iy{flush(){return this._botId=-1,!0}parse(e){return e?(this._botId=e.readInt(),!0):!1}get botId(){return this._botId}}class ny{constructor(e){this._id=e.readInt(),this._data=e.readString()}get id(){return this._id}get data(){return this._data}}class ay{flush(){return this._botId=-1,this._skillList=[],!0}parse(e){if(!e)return!1;this._botId=e.readInt();let t=e.readInt();for(;t>0;)this._skillList.push(new ny(e)),t--;return!0}get botId(){return this._botId}get skillList(){return this._skillList}}class oy{constructor(e){this._userId=e.readInt(),this._userName=e.readString()}get userId(){return this._userId}get userName(){return this._userName}}class hy{flush(){return this._roomId=0,this._bannedUsers=[],!0}parse(e){if(!e)return!1;this._roomId=e.readInt();let t=e.readInt();for(;t>0;)this._bannedUsers.push(new oy(e)),t--;return!0}get roomId(){return this._roomId}get bannedUsers(){return this._bannedUsers}}class uy{constructor(e){this._userId=e.readInt(),this._userName=e.readString()}get userId(){return this._userId}get userName(){return this._userName}get selected(){return this._selected}set selected(e){this._selected=e}}class ly{flush(){return this._roomId=0,this._data=null,!0}parse(e){return e?(this._roomId=e.readInt(),this._data=new uy(e),!0):!1}get roomId(){return this._roomId}get data(){return this._data}}class cy{flush(){return this._roomId=0,this._userId=0,!0}parse(e){return e?(this._roomId=e.readInt(),this._userId=e.readInt(),!0):!1}get roomId(){return this._roomId}get userId(){return this._userId}}class _y{flush(){return this._roomId=0,this._users=new Map,!0}parse(e){if(!e)return!1;this._roomId=e.readInt();let t=e.readInt();for(;t>0;){const s=e.readInt(),i=e.readString();this._users.set(s,i),t--}return!0}get roomId(){return this._roomId}get users(){return this._users}}class dy{flush(){return!0}parse(e){return e?(this._isMuted=e.readBoolean(),!0):!1}get isMuted(){return this._isMuted}}class fy{flush(){return this._roomId=0,!0}parse(e){return e?(this._roomId=e.readInt(),!0):!1}get roomId(){return this._roomId}}class Cs{constructor(e){if(!e)throw new Error("invalid_wrapper");this._mode=e.readInt(),this._weight=e.readInt(),this._speed=e.readInt(),this._distance=e.readInt(),this._protection=e.readInt()}get mode(){return this._mode}get weight(){return this._weight}get speed(){return this._speed}get distance(){return this._distance}get protection(){return this._protection}}Cs.CHAT_MODE_FREE_FLOW=0,Cs.CHAT_MODE_LINE_BY_LINE=1,Cs.CHAT_BUBBLE_WIDTH_WIDE=0,Cs.CHAT_BUBBLE_WIDTH_NORMAL=1,Cs.CHAT_BUBBLE_WIDTH_THIN=2,Cs.CHAT_SCROLL_SPEED_FAST=0,Cs.CHAT_SCROLL_SPEED_NORMAL=1,Cs.CHAT_SCROLL_SPEED_SLOW=2,Cs.FLOOD_FILTER_STRICT=0,Cs.FLOOD_FILTER_NORMAL=1,Cs.FLOOD_FILTER_LOOSE=2;class Lo{constructor(e){this._allowMute=e.readInt(),this._allowKick=e.readInt(),this._allowBan=e.readInt()}get allowMute(){return this._allowMute}get allowKick(){return this._allowKick}get allowBan(){return this._allowBan}}Lo.MODERATION_LEVEL_NONE=0,Lo.MODERATION_LEVEL_USER_WITH_RIGHTS=1,Lo.MODERATION_LEVEL_ALL=2;class Vt{constructor(){this._roomId=-1,this._name=null,this._description=null,this._doorMode=Vt.DOORMODE_OPEN,this._categoryId=-1,this._maximumVisitors=0,this._maximumVisitorsLimit=0,this._tags=[],this._tradeMode=Vt.TRADEMODE_NOT_ALLOWED,this._allowPets=!1,this._allowFoodConsume=!1,this._allowWalkThrough=!1,this._hideWalls=!1,this._wallThickness=0,this._floorThickness=0,this._controllersById=new Map,this._controllerList=null,this._highlightedUserId=-1,this._bannedUsersById=new Map,this._bannedUsersList=null,this._roomModerationSettings=null,this._chatSettings=null,this._allowNavigatorDynamicCats=!1}static from(e){const t=new Vt;return t._roomId=e._roomId,t._name=e._name,t._description=e._description,t._doorMode=e._doorMode,t._categoryId=e._categoryId,t._maximumVisitors=e._maximumVisitors,t._maximumVisitorsLimit=e._maximumVisitorsLimit,t._tags=e._tags,t._tradeMode=e._tradeMode,t._allowPets=e._allowPets,t._allowFoodConsume=e._allowFoodConsume,t._allowWalkThrough=e._allowWalkThrough,t._hideWalls=e._hideWalls,t._wallThickness=e._wallThickness,t._floorThickness=e._floorThickness,t._controllersById=e._controllersById,t._controllerList=e._controllerList,t._highlightedUserId=e._highlightedUserId,t._bannedUsersById=e._bannedUsersById,t._bannedUsersList=e._bannedUsersList,t._roomModerationSettings=e._roomModerationSettings,t._chatSettings=e._chatSettings,t._allowNavigatorDynamicCats=e._allowNavigatorDynamicCats,t}static getDoorModeLocalizationKey(e){switch(e){case Vt.DOORMODE_OPEN:return"${navigator.door.mode.open}";case Vt.DOORMODE_CLOSED:return"${navigator.door.mode.closed}";case Vt.DOORMODE_PASSWORD:return"${navigator.door.mode.password}";case Vt.DOORMODE_INVISIBLE:return"${navigator.door.mode.invisible}";case Vt.DOORMODE_NOOBS_ONLY:return"${navigator.door.mode.noobs_only}"}return""}get tradeMode(){return this._tradeMode}set tradeMode(e){this._tradeMode=e}get allowPets(){return this._allowPets}set allowPets(e){this._allowPets=e}get allowFoodConsume(){return this._allowFoodConsume}set allowFoodConsume(e){this._allowFoodConsume=e}get allowWalkThrough(){return this._allowWalkThrough}set allowWalkThrough(e){this._allowWalkThrough=e}get hideWalls(){return this._hideWalls}set hideWalls(e){this._hideWalls=e}get wallThickness(){return this._wallThickness}set wallThickness(e){this._wallThickness=e}get floorThickness(){return this._floorThickness}set floorThickness(e){this._floorThickness=e}get roomId(){return this._roomId}set roomId(e){this._roomId=e}get name(){return this._name}set name(e){this._name=e}get description(){return this._description}set description(e){this._description=e}get doorMode(){return this._doorMode}set doorMode(e){this._doorMode=e}get categoryId(){return this._categoryId}set categoryId(e){this._categoryId=e}get maximumVisitors(){return this._maximumVisitors}set maximumVisitors(e){this._maximumVisitors=e}get maximumVisitorsLimit(){return this._maximumVisitorsLimit}set maximumVisitorsLimit(e){this._maximumVisitorsLimit=e}get tags(){return this._tags}set tags(e){this._tags=e}setFlatController(e,t){this._controllersById.set(e,t),this._controllerList=null,this._highlightedUserId=e}get roomModerationSettings(){return this._roomModerationSettings}set roomModerationSettings(e){this._roomModerationSettings=e}get controllersById(){return this._controllersById}set controllersById(e){this._controllersById=e}get controllerList(){if(!this._controllerList){this._controllerList=[];for(const e of this._controllersById.values())this._controllerList.push(e);this._controllerList.sort((e,t)=>e.userName.localeCompare(t.userName))}return this._controllerList}get highlightedUserId(){return this._highlightedUserId}setBannedUser(e,t){this._bannedUsersById.set(e,t),this._bannedUsersList=null}get bannedUsersById(){return this._bannedUsersById}get bannedUsersList(){if(!this._bannedUsersList){this._bannedUsersList=[];for(const e of this._bannedUsersById.values())this._bannedUsersList.push(e);this._bannedUsersList.sort((e,t)=>e.userName.localeCompare(t.userName))}return this._bannedUsersList}get chatSettings(){return this._chatSettings}set chatSettings(e){this._chatSettings=e}get allowNavigatorDynamicCats(){return this._allowNavigatorDynamicCats}set allowNavigatorDynamicCats(e){this._allowNavigatorDynamicCats=e}}Vt.DOORMODE_OPEN=0,Vt.DOORMODE_CLOSED=1,Vt.DOORMODE_PASSWORD=2,Vt.DOORMODE_INVISIBLE=3,Vt.DOORMODE_NOOBS_ONLY=4,Vt.TRADEMODE_NOT_ALLOWED=0,Vt.TRADEMODE_WITH_CONTROLLER=1,Vt.TRADEMODE_ALLOWED=2;class gy{flush(){return this._roomSettingsData=null,!0}parse(e){if(!e)return!1;this._roomSettingsData=new Vt,this._roomSettingsData.roomId=e.readInt(),this._roomSettingsData.name=e.readString(),this._roomSettingsData.description=e.readString(),this._roomSettingsData.doorMode=e.readInt(),this._roomSettingsData.categoryId=e.readInt(),this._roomSettingsData.maximumVisitors=e.readInt(),this._roomSettingsData.maximumVisitorsLimit=e.readInt(),this._roomSettingsData.tags=[];let t=e.readInt();for(;t>0;)this._roomSettingsData.tags.push(e.readString()),t--;return this._roomSettingsData.tradeMode=e.readInt(),this._roomSettingsData.allowPets=e.readInt()===1,this._roomSettingsData.allowFoodConsume=e.readInt()===1,this._roomSettingsData.allowWalkThrough=e.readInt()===1,this._roomSettingsData.hideWalls=e.readInt()===1,this._roomSettingsData.wallThickness=e.readInt(),this._roomSettingsData.floorThickness=e.readInt(),this._roomSettingsData.chatSettings=new Cs(e),this._roomSettingsData.allowNavigatorDynamicCats=e.readBoolean(),this._roomSettingsData.roomModerationSettings=new Lo(e),!0}get data(){return this._roomSettingsData}}class Ey{flush(){return this._roomId=0,this._code=0,!0}parse(e){return e?(this._roomId=e.readInt(),this._code=e.readInt(),!0):!1}get roomId(){return this._roomId}get code(){return this._code}}class my{flush(){return this._roomId=0,!0}parse(e){return e?(this._roomId=e.readInt(),!0):!1}get roomId(){return this._roomId}}class Ms{flush(){return this._roomId=0,this._code=0,this._message=null,!0}parse(e){return e?(this._roomId=e.readInt(),this._code=e.readInt(),this._message=e.readString(),!0):!1}get roomId(){return this._roomId}get code(){return this._code}get message(){return this._message}}Ms.ERROR_ROOM_NOT_FOUND=1,Ms.ERROR_NOT_OWNER=2,Ms.ERROR_INVALID_DOOR_MODE=3,Ms.ERROR_INVALID_USER_LIMIT=4,Ms.ERROR_INVALID_PASSWORD=5,Ms.ERROR_INVALID_CATEGORY=6,Ms.ERROR_INVALID_NAME=7,Ms.ERROR_UNACCEPTABLE_NAME=8,Ms.ERROR_INVALID_DESCRIPTION=9,Ms.ERROR_UNACCEPTABLE_DESCRIPTION=10,Ms.ERROR_INVALID_TAG=11,Ms.ERROR_NON_USER_CHOOSABLE_TAG=12,Ms.ERROR_TOO_MANY_CHARACTERS_IN_TAG=13;class py{flush(){return this._selectionType=0,!0}parse(e){return e?(this._selectionType=e.readInt(),!0):!1}get selectionType(){return this._selectionType}}class Iy{flush(){return this._roomId=0,this._userId=0,!0}parse(e){return e?(this._roomId=e.readInt(),this._userId=e.readInt(),!0):!1}get roomId(){return this._roomId}get userId(){return this._userId}}class Ty{flush(){return this._chat=null,!0}parse(e){return e?(this._chat=new Cs(e),!0):!1}get chat(){return this._chat}}class It{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._roomId=0,this._roomName=null,this._ownerId=0,this._ownerName=null,this._doorMode=0,this._userCount=0,this._maxUserCount=0,this._description=null,this._tradeMode=2,this._score=0,this._ranking=0,this._categoryId=0,this._totalStars=0,this._groupId=0,this._groupName=null,this._groupBadge=null,this._tags=[],this._bitMask=0,this._thumbnail=null,this._allowPets=!1,this._showOwner=!0,this._displayAd=!1,this._adName=null,this._adDescription=null,this._adExpiresIn=0,this._allInRoomMuted=!1,this._canMute=!1,this._officialRoomPicRef=null,!0}parse(e){return e?(this._roomId=e.readInt(),this._roomName=e.readString(),this._ownerId=e.readInt(),this._ownerName=e.readString(),this._doorMode=e.readInt(),this._userCount=e.readInt(),this._maxUserCount=e.readInt(),this._description=e.readString(),this._tradeMode=e.readInt(),this._score=e.readInt(),this._ranking=e.readInt(),this._categoryId=e.readInt(),this.parseTags(e),this.parseBitMask(e),!0):!1}parseTags(e){if(!e)return!1;this._tags=[];let t=e.readInt();for(;t>0;)this._tags.push(e.readString()),t--;return!0}parseBitMask(e){return e?(this._bitMask=e.readInt(),this._bitMask&It.THUMBNAIL_BITMASK&&(this._officialRoomPicRef=e.readString()),this._bitMask&It.GROUPDATA_BITMASK&&(this._groupId=e.readInt(),this._groupName=e.readString(),this._groupBadge=e.readString()),this._bitMask&It.ROOMAD_BITMASK&&(this._adName=e.readString(),this._adDescription=e.readString(),this._adExpiresIn=e.readInt()),this._showOwner=(this._bitMask&It.SHOWOWNER_BITMASK)>0,this._allowPets=(this._bitMask&It.ALLOW_PETS_BITMASK)>0,this._displayAd=(this._bitMask&It.DISPLAY_ROOMAD_BITMASK)>0,this._thumbnail=null,!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}set roomName(e){this._roomName=e}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get doorMode(){return this._doorMode}get userCount(){return this._userCount}get maxUserCount(){return this._maxUserCount}get description(){return this._description}get tradeMode(){return this._tradeMode}get score(){return this._score}get ranking(){return this._ranking}get categoryId(){return this._categoryId}get tags(){return this._tags}get officialRoomPicRef(){return this._officialRoomPicRef}get habboGroupId(){return this._groupId}get groupName(){return this._groupName}get groupBadgeCode(){return this._groupBadge}get roomAdName(){return this._adName}get roomAdDescription(){return this._adDescription}get roomAdExpiresInMin(){return this._adExpiresIn}get showOwner(){return this._showOwner}get allowPets(){return this._allowPets}get displayRoomEntryAd(){return this._displayAd}get canMute(){return this._canMute}set canMute(e){this._canMute=e}get allInRoomMuted(){return this._allInRoomMuted}set allInRoomMuted(e){this._allInRoomMuted=e}}It.THUMBNAIL_BITMASK=1,It.GROUPDATA_BITMASK=2,It.ROOMAD_BITMASK=4,It.SHOWOWNER_BITMASK=8,It.ALLOW_PETS_BITMASK=16,It.DISPLAY_ROOMAD_BITMASK=32,It.OPEN_STATE=0,It.DOORBELL_STATE=1,It.PASSWORD_STATE=2,It.INVISIBLE_STATE=3,It.NOOB_STATE=4;class Ry{flush(){return this._roomId=0,this._isOwner=!1,!0}parse(e){return e?(this._roomId=e.readInt(),this._isOwner=e.readBoolean(),!0):!1}get roomId(){return this._roomId}get isOwner(){return this._isOwner}}class vy{flush(){return this._totalLikes=0,this._canLike=!1,!0}parse(e){return e?(this._totalLikes=e.readInt(),this._canLike=e.readBoolean(),!0):!1}get totalLikes(){return this._totalLikes}get canLike(){return this._canLike}}class Oy{flush(){return this._roomIndex=-1,this._groupId=-1,this._status=0,this._groupName=null,!0}parse(e){return e?(this._roomIndex=e.readInt(),this._groupId=e.readInt(),this._status=e.readInt(),this._groupName=e.readString(),!0):!1}get roomIndex(){return this._roomIndex}get groupId(){return this._groupId}get status(){return this._status}get groupName(){return this._groupName}}class Sy{constructor(e,t,s){this._id=0,this._state=0,this._id=e,this._state=t,this._data=s}get id(){return this._id}get state(){return this._state}get data(){return this._data}}class Ay{flush(){return this._code=0,!0}parse(e){return e?(this._code=e.readInt(),!0):!1}get count(){return this._code}}class yy{flush(){return this._itemId=0,this._value=0,!0}parse(e){return e?(this._itemId=e.readInt(),this._value=e.readInt(),!0):!1}get itemId(){return this._itemId}get value(){return this._value}}class Wi{flush(){return this._itemId=0,this._data=null,!0}parse(e){return e?(this._itemId=parseInt(e.readString()),this._data=Wi.parseObjectData(e),!0):!1}static parseObjectData(e){if(!e)return null;const t=Fi.getData(e.readInt());return t?(t.parseWrapper(e),t):null}get furnitureId(){return this._itemId}get objectData(){return this._data}}class xc{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._itemId=0,this._spriteId=0,this._spriteName=null,this._x=0,this._y=0,this._direction=0,this._z=0,this._stackHeight=0,this._extra=0,this._data=null,this._state=0,this._expires=0,this._usagePolicy=0,this._userId=0,this._username=null,!0}parse(e){return e?(this._itemId=e.readInt(),this._spriteId=e.readInt(),this._x=e.readInt(),this._y=e.readInt(),this._direction=e.readInt()%8*45,this._z=parseFloat(e.readString()),this._stackHeight=parseFloat(e.readString()),this._extra=e.readInt(),this._data=Wi.parseObjectData(e),this._state=parseFloat(this._data&&this._data.getLegacyString())||0,this._expires=e.readInt(),this._usagePolicy=e.readInt(),this._userId=e.readInt(),this._username=null,this._spriteId<0&&(this._spriteName=e.readString()),!0):!1}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}get z(){return isNaN(this._z)?0:this._z}get stackHeight(){return isNaN(this._stackHeight)?0:this._stackHeight}get extra(){return this._extra}get data(){return this._data}get state(){return this._state}get expires(){return this._expires}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(e){this._username=e}get spriteName(){return this._spriteName}set spriteName(e){this._spriteName=e}}class Cy{flush(){return this._item=null,!0}parse(e){return e?(this._item=new xc(e),this._item.username=e.readString(),!0):!1}get item(){return this._item}}class My{flush(){return this._owners=new Map,this._items=[],!0}parse(e){if(!e||!this.parseOwners(e))return!1;let t=e.readInt();for(;t>0;){const s=new xc(e);if(!s)continue;const i=this._owners.get(s.userId);i&&(s.username=i),this._items.push(s),t--}return!0}parseOwners(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._owners.set(e.readInt(),e.readString()),t--;return!0}get owners(){return this._owners}get items(){return this._items}}class Py{flush(){return this._itemId=0,this._isExpired=!0,this._userId=0,this._delay=0,!0}parse(e){return e?(this._itemId=parseInt(e.readString()),this._isExpired=e.readBoolean(),this._userId=e.readInt(),this._delay=e.readInt(),!0):!1}get itemId(){return this._itemId}get isExpired(){return this._isExpired}get userId(){return this._userId}get delay(){return this._delay}}class Ny{flush(){return this._item=null,!0}parse(e){return e?(this._item=new xc(e),!0):!1}get item(){return this._item}}class by{flush(){return this._isWallItem=!1,this._furniTypeName=null,this._buyout=!1,this._priceInCredits=-1,this._priceInActivityPoints=-1,this._activityPointType=-1,!0}parse(e){return e?(this._isWallItem=e.readBoolean(),this._furniTypeName=e.readString(),this._buyout=e.readBoolean(),this._priceInCredits=e.readInt(),this._priceInActivityPoints=e.readInt(),this._activityPointType=e.readInt(),!0):!1}get isWallItem(){return this._isWallItem}get furniTypeName(){return this._furniTypeName}get buyout(){return this._buyout}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}}class Dy{flush(){return this._aliases=new Map,!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._aliases.set(e.readString(),e.readString()),t--;return!0}get aliases(){return this._aliases}}class Ly{flush(){return this._furniId=-1,this._height=0,!0}parse(e){return e?(this._furniId=e.readInt(),this._height=e.readInt()/100,!0):!1}get furniId(){return this._furniId}get height(){return this._height}}class Uy{flush(){return this._objectId=0,this._guildId=0,this._guildName=null,this._guildHomeRoomId=0,this._userIsMember=!1,this._guildHasReadableForum=!1,!0}parse(e){return e?(this._objectId=e.readInt(),this._guildId=e.readInt(),this._guildName=e.readString(),this._guildHomeRoomId=e.readInt(),this._userIsMember=e.readBoolean(),this._guildHasReadableForum=e.readBoolean(),!0):!1}get objectId(){return this._objectId}get guildId(){return this._guildId}get guildName(){return this._guildName}get guildHomeRoomId(){return this._guildHomeRoomId}get userIsMember(){return this._userIsMember}get guildHasReadableForum(){return this._guildHasReadableForum}}class Fy{flush(){return this._itemId=0,this._data="",!0}parse(e){return e?(this._itemId=parseInt(e.readString()),this._data=e.readString(),!0):!1}get furnitureId(){return this._itemId}get data(){return this._data}}class wy{get furniId(){return this._furniId}flush(){return this._furniId=-1,!0}parse(e){return this._furniId=e.readInt(),!0}}class xy{get furniId(){return this._furniId}flush(){return this._furniId=-1,!0}parse(e){return this._furniId=e.readInt(),!0}}class Gy{get furniId(){return this._furniId}get start(){return this._start}flush(){return this._furniId=-1,this._start=!1,!0}parse(e){return this._furniId=e.readInt(),this._start=e.readBoolean(),!0}}class By{flush(){return this._itemId=0,this._state=0,!0}parse(e){return e?(this._itemId=e.readInt(),this._state=e.readInt(),!0):!1}get itemId(){return this._itemId}get state(){return this._state}}class Hy{flush(){return!0}parse(e){return e?(this._reason=e.readInt(),!0):!1}get reason(){return this._reason}}class ky{flush(){return!0}parse(e){return e?(this._expiryTime=e.readInt(),!0):!1}get expiryTime(){return this._expiryTime}}class fr{flush(){return this._rented=!1,this._renterId=-1,this._renterName=null,this._canRent=!1,this._canRentErrorCode=-1,this._timeRemaining=-1,this._price=-1,!0}parse(e){return e?(this._rented=e.readBoolean(),this._canRentErrorCode=e.readInt(),this._canRent=this._canRentErrorCode===0,this._renterId=e.readInt(),this._renterName=e.readString(),this._timeRemaining=e.readInt(),this._price=e.readInt(),this._rented||(this._renterId=-1,this._renterName=""),!0):!1}get rented(){return this._rented}get renterId(){return this._renterId}get renterName(){return this._renterName}get canRent(){return this._canRent}get price(){return this._price}get timeRemaining(){return this._timeRemaining}get canRentErrorCode(){return this._canRentErrorCode}}fr.SPACE_ALREADY_RENTED=100,fr.SPACE_EXTEND_NOT_RENTED=101,fr.SPACE_EXTEND_NOT_RENTED_BY_YOU=102,fr.CAN_RENT_ONLY_ONE_SPACE=103,fr.NOT_ENOUGH_CREDITS=200,fr.NOT_ENOUGH_PIXELS=201,fr.CANT_RENT_NO_PERMISSION=202,fr.CANT_RENT_NO_HABBO_CLUB=203,fr.CANT_RENT=300,fr.CANT_RENT_GENERIC=400;class Vy{flush(){return this._itemId=-1,this._location="",!0}parse(e){return e?(this._itemId=e.readInt(),this._location=e.readString(),!0):!1}get itemId(){return this._itemId}get location(){return this._location}}class jy{constructor(e,t,s,i){this.id=e,this.type=t,this.color=s,this.brightness=i}}class Yy{constructor(){this._selectedPresetId=0,this._presets=[]}flush(){return this._presets=[],!0}parse(e){const t=e.readInt();this._selectedPresetId=e.readInt();for(let s=0;s<t;s++){const i=e.readInt(),n=e.readInt(),a=parseInt(e.readString().substr(1),16),o=e.readInt();this._presets.push(new jy(i,n,a,o))}return!0}getPreset(e){return e<0||e>=this.presetCount?null:this._presets[e]}get presetCount(){return this._presets.length}get selectedPresetId(){return this._selectedPresetId}}class Wy{flush(){return this._roomId=-1,this._roomName=null,this._messageCount=-1,!0}parse(e){return e?(this._roomId=e.readInt(),this._roomName=e.readString(),this._messageCount=e.readInt(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}get messageCount(){return this._messageCount}}class Gc{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._itemId=0,this._spriteId=0,this._location=null,this._stuffData=null,this._state=0,this._secondsToExpiration=0,this._usagePolicy=-1,this._userId=0,this._username=null,this._width=0,this._height=0,this._localX=0,this._localY=0,this._y=0,this._z=0,this._direction=null,this._isOldFormat=!1,!0}parse(e){if(!e)return!1;this._itemId=parseInt(e.readString()),this._spriteId=e.readInt(),this._location=e.readString(),this._stuffData=e.readString(),this._secondsToExpiration=e.readInt(),this._usagePolicy=e.readInt(),this._userId=e.readInt(),this._username=null;const t=parseFloat(this._stuffData);if(isNaN(t)||(this._state=Math.trunc(t)),this._location.indexOf(":")===0){this._isOldFormat=!1;let s=this._location.split(" ");if(s.length>=3){let i=s[0],n=s[1];const a=s[2];if(i.length>3&&n.length>2&&(i=i.substr(3),n=n.substr(2),s=i.split(","),s.length>=2)){const o=parseInt(s[0]),u=parseInt(s[1]);if(s=n.split(","),s.length>=2){const l=parseInt(s[0]),d=parseInt(s[1]);this._width=o,this._height=u,this._localX=l,this._localY=d,this._direction=a}}}}else this._isOldFormat=!0;return!0}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get wallPosition(){return this._location}get stuffData(){return this._stuffData}get state(){return this._state}get secondsToExpiration(){return this._secondsToExpiration}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(e){this._username=e}get width(){return this._width}get height(){return this._height}get localX(){return this._localX}get localY(){return this._localY}get direction(){return this._direction}get isOldFormat(){return this._isOldFormat}}class zy{flush(){return this._item=null,!0}parse(e){return e?(this._item=new Gc(e),this._item.username=e.readString(),!0):!1}get item(){return this._item}}class Xy{flush(){return this._owners=new Map,this._items=[],!0}parse(e){if(!e||!this.parseOwners(e))return!1;let t=e.readInt();for(;t>0;){const s=new Gc(e);if(!s)continue;const i=this._owners.get(s.userId);i&&(s.username=i),this._items.push(s),t--}return!0}parseOwners(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._owners.set(e.readInt(),e.readString()),t--;return!0}get owners(){return this._owners}get items(){return this._items}}class Ky{flush(){return this._itemId=0,this._userId=0,!0}parse(e){return e?(this._itemId=parseInt(e.readString()),this._userId=e.readInt(),!0):!1}get itemId(){return this._itemId}get userId(){return this._userId}}class qy{flush(){return this._item=null,!0}parse(e){return e?(this._item=new Gc(e),!0):!1}get item(){return this._item}}class Qy{flush(){return this._email=null,this._isVerified=!1,this._allowChange=!1,this._furniId=-1,this._requestedByUser=!1,!0}parse(e){return e?(this._email=e.readString(),this._isVerified=e.readBoolean(),this._allowChange=e.readBoolean(),this._furniId=e.readInt(),this._requestedByUser=e.readBoolean(),!0):!1}get email(){return this._email}get isVerified(){return this._isVerified}get allowChange(){return this._allowChange}get furniId(){return this._furniId}get requestedByUser(){return this._requestedByUser}}class Zy{parse(e){return this._furniId=e.readInt(),this._commandId=e.readInt(),!0}flush(){return this._furniId=-1,this._commandId=-1,!0}get furniId(){return this._furniId}get commandId(){return this._commandId}}class Jy{constructor(e,t,s){this._video=e,this._title=t,this._description=s}get video(){return this._video}get title(){return this._title}get description(){return this._description}}class $y{flush(){return this._furniId=-1,this._playlists=null,this._selectedPlaylistId=null,!0}parse(e){this._furniId=e.readInt();const t=e.readInt();this._playlists=[];for(let s=0;s<t;s++)this._playlists.push(new Jy(e.readString(),e.readString(),e.readString()));return this._selectedPlaylistId=e.readString(),!0}get furniId(){return this._furniId}get playlists(){return this._playlists}get selectedPlaylistId(){return this._selectedPlaylistId}}class eC{flush(){return!0}parse(e){return this._furniId=e.readInt(),this._videoId=e.readString(),this._startAtSeconds=e.readInt(),this._endAtSeconds=e.readInt(),this._state=e.readInt(),!0}get furniId(){return this._furniId}get videoId(){return this._videoId}get state(){return this._state}get startAtSeconds(){return this._startAtSeconds}get endAtSeconds(){return this._endAtSeconds}}class tC{flush(){return this._objects=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const s=e.readInt(),i=Wi.parseObjectData(e),n=parseFloat(i.getLegacyString());this._objects.push(new Sy(s,n,i)),t--}return!0}get objects(){return this._objects}}class sC{flush(){return this._rollerId=0,this._itemsRolling=[],this._unitRolling=null,!0}parse(e){if(!e)return!1;const t=e.readInt(),s=e.readInt(),i=e.readInt(),n=e.readInt();let a=e.readInt();for(;a>0;){const c=e.readInt(),_=parseFloat(e.readString()),f=parseFloat(e.readString()),g=new ti(c,new y(t,s,_),new y(i,n,f));this._itemsRolling.push(g),a--}if(this._rollerId=e.readInt(),!e.bytesAvailable)return!0;const o=e.readInt(),u=e.readInt(),l=parseFloat(e.readString()),d=parseFloat(e.readString());switch(o){case 0:break;case 1:this._unitRolling=new ti(u,new y(t,s,l),new y(i,n,d),ti.MOVE);break;case 2:this._unitRolling=new ti(u,new y(t,s,l),new y(i,n,d),ti.SLIDE);break}return!0}get rollerId(){return this._rollerId}get itemsRolling(){return this._itemsRolling}get unitRolling(){return this._unitRolling}}class Aa{flush(){return this._model=null,this._width=0,this._height=0,this._wallHeight=-1,this._heightMap=[],this._scale=64,this._model=null,!0}parse(e){if(!e)return!1;const t=e.readBoolean(),s=e.readInt(),i=e.readString();return this.parseExplicitly(i,s,t)}parseModel(e,t,s=!0){return this.parseExplicitly(e,t,s)}parseExplicitly(e,t,s=!0){this._scale=s?32:64,this._wallHeight=t,this._model=e;const i=this._model.split("\r"),n=i.length;let a=0,o=0;for(;o<n;){const u=i[o];u.length>a&&(a=u.length),o++}for(this._heightMap=[],o=0;o<n;){const u=[];let l=0;for(;l<a;)u.push(Aa.TILE_BLOCKED),l++;this._heightMap.push(u),o++}for(this._width=a,this._height=n,o=0;o<n;){const u=this._heightMap[o],l=i[o];if(l.length>0){let d=0;for(;d<l.length;){const c=l.charAt(d);let _=Aa.TILE_BLOCKED;c!=="x"&&c!=="X"&&(_=parseInt(c,36)),u[d]=_,d++}}o++}return!0}getHeight(e,t){if(e<0||e>=this._width||t<0||t>=this._height)return-110;const s=this._heightMap[t];if(s===void 0)return-110;const i=s[e];return i===void 0?-110:i}get model(){return this._model}get width(){return this._width}get height(){return this._height}get heightMap(){return this._heightMap}get wallHeight(){return this._wallHeight}get scale(){return this._scale}}Aa.TILE_BLOCKED=-110;class rC{flush(){return this._x=0,this._y=0,this._direction=0,!0}parse(e){return e?(this._x=e.readInt(),this._y=e.readInt(),this._direction=e.readInt(),!0):!1}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}class zi{static decodeTileHeight(e){return e<0?-1:(e&16383)/256}static decodeIsStackingBlocked(e){return!!(e&16384)}static decodeIsRoomTile(e){return e>=0}getTileHeight(e,t){return e<0||e>=this._width||t<0||t>=this._height?-1:zi.decodeTileHeight(this._heights[t*this._width+e])}getStackingBlocked(e,t){return e<0||e>=this._width||t<0||t>=this._height?!0:zi.decodeIsStackingBlocked(this._heights[t*this._width+e])}isRoomTile(e,t){return e<0||e>=this._width||t<0||t>=this._height?!1:zi.decodeIsRoomTile(this._heights[t*this._width+e])}flush(){return this._width=0,this._height=0,this._heights=[],!0}parse(e){if(!e)return!1;this._width=e.readInt();const t=e.readInt();this._height=t/this._width;let s=0;for(;s<t;)this._heights[s]=e.readShort(),s++;return!0}get width(){return this._width}get height(){return this._height}get heights(){return this._heights}}class iC{flush(){return this._wrapper=null,this._count=0,this._x=0,this._y=0,this._value=0,!0}tileHeight(){return zi.decodeTileHeight(this._value)}isStackingBlocked(){return zi.decodeIsStackingBlocked(this._value)}isRoomTile(){return zi.decodeIsRoomTile(this._value)}next(){return this._count?(this._count--,this._x=this._wrapper.readByte(),this._y=this._wrapper.readByte(),this._value=this._wrapper.readShort(),!0):!1}parse(e){return e?(this._wrapper=e,this._count=e.readByte(),!0):!1}get x(){return this._x}get y(){return this._y}get height(){return this._value}}class nC{flush(){return this._blockedTilesMap=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const s=e.readInt(),i=e.readInt();this._blockedTilesMap[i]||(this._blockedTilesMap[i]=[]),this._blockedTilesMap[i][s]=!0,t--}return!0}get blockedTilesMap(){return this._blockedTilesMap}}class aC{flush(){return this._floorType=null,this._wallType=null,this._landscapeType=null,this._landscapeAnimation=null,!0}parse(e){if(!e)return!1;const t=e.readString(),s=e.readString();switch(t){case"floor":this._floorType=s;break;case"wallpaper":this._wallType=s;break;case"landscape":this._landscapeType=s;break;case"landscapeanim":this._landscapeAnimation=s;break}return!0}get floorType(){return this._floorType}get wallType(){return this._wallType}get landscapeType(){return this._landscapeType}get landscapeAnimation(){return this._landscapeAnimation}}class oC{flush(){return this._name=null,this._roomId=0,!0}parse(e){return e?(this._name=e.readString(),this._roomId=e.readInt(),!0):!1}get name(){return this._name}get roomId(){return this._roomId}}class hC{flush(){return this._hideWalls=!1,this._thicknessWall=0,this._thicknessFloor=0,!0}parse(e){if(!e)return!1;this._hideWalls=e.readBoolean();let t=e.readInt(),s=e.readInt();return t=t<-2?-2:t>1?1:t,s=s<-2?-2:s>1?1:s,this._thicknessWall=Math.pow(2,t),this._thicknessFloor=Math.pow(2,s),!0}get hideWalls(){return this._hideWalls}get thicknessWall(){return this._thicknessWall}get thicknessFloor(){return this._thicknessFloor}}class Mg{constructor(e){if(!e)throw new Error("invalid_wrapper");this._webId=e.readInt(),this._name=e.readString(),this._level=e.readInt(),this._figure=e.readString(),this._owner=e.readString()}dispose(){this._webId=0,this._name="",this._level=0,this._figure="",this._owner=""}get webId(){return this._webId}get name(){return this._name}get level(){return this._level}get figure(){return this._figure}get owner(){return this._owner}}class Pg{constructor(e){this._stuffId=e.readInt(),this._classId=e.readInt(),this._productCode=e.readString(),this._userId=e.readInt(),this._userName=e.readString(),this._rarityLevel=e.readInt(),this._hasMutation=e.readBoolean()}get stuffId(){return this._stuffId}get classId(){return this._classId}get productCode(){return this._productCode}get userId(){return this._userId}get userName(){return this._userName}get rarityLevel(){return this._rarityLevel}get hasMutation(){return this._hasMutation}}class uC{flush(){return this._resultData=null,this._otherResultData=null,!0}parse(e){return e?(this._resultData=new Pg(e),this._otherResultData=new Pg(e),!0):!1}get resultData(){return this._resultData}get otherResultData(){return this._otherResultData}}class lC{flush(){return this._petId=-1,this._roomIndex=-1,this._gainedExperience=0,!0}parse(e){return e?(this._petId=e.readInt(),this._roomIndex=e.readInt(),this._gainedExperience=e.readInt(),!0):!1}get petId(){return this._petId}get roomIndex(){return this._roomIndex}get gainedExperience(){return this._gainedExperience}}class cC{flush(){return!0}parse(e){return e?(this._roomIndex=e.readInt(),this._petId=e.readInt(),this._figureData=new Hc(e),this._hasSaddle=e.readBoolean(),this._isRiding=e.readBoolean(),!0):!1}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get figureData(){return this._figureData}get hasSaddle(){return this._hasSaddle}get isRiding(){return this._isRiding}}class _C{flush(){return this._id=-1,this._skillThresholds=[],!0}parse(e){if(!e)return!1;this._id=e.readInt(),this._name=e.readString(),this._level=e.readInt(),this._maximumLevel=e.readInt(),this._experience=e.readInt(),this._levelExperienceGoal=e.readInt(),this._energy=e.readInt(),this._maximumEnergy=e.readInt(),this._happyness=e.readInt(),this._maximumHappyness=e.readInt(),this._respect=e.readInt(),this._ownerId=e.readInt(),this._age=e.readInt(),this._ownerName=e.readString(),this._rarityLevel=e.readInt(),this._saddle=e.readBoolean(),this._rider=e.readBoolean();let t=e.readInt();for(;t>0;)this._skillThresholds.push(e.readInt()),t--;return this._skillThresholds.sort(),this._publiclyRideable=e.readInt(),this._breedable=e.readBoolean(),this._fullyGrown=e.readBoolean(),this._dead=e.readBoolean(),this._unknownRarity=e.readInt(),this._maximumTimeToLive=e.readInt(),this._remainingTimeToLive=e.readInt(),this._remainingGrowTime=e.readInt(),this._publiclyBreedable=e.readBoolean(),!0}get id(){return this._id}get name(){return this._name}get level(){return this._level}get maximumLevel(){return this._maximumLevel}get experience(){return this._experience}get energy(){return this._energy}get happyness(){return this._happyness}get levelExperienceGoal(){return this._levelExperienceGoal}get maximumEnergy(){return this._maximumEnergy}get maximumHappyness(){return this._maximumHappyness}get respect(){return this._respect}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get age(){return this._age}get rarityLevel(){return this._rarityLevel}get saddle(){return this._saddle}get rider(){return this._rider}get breedable(){return this._breedable}get fullyGrown(){return this._fullyGrown}get dead(){return this._dead}get maximumTimeToLive(){return this._maximumTimeToLive}get remainingTimeToLive(){return this._remainingTimeToLive}get remainingGrowTime(){return this._remainingGrowTime}get skillTresholds(){return this._skillThresholds}get publiclyRideable(){return this._publiclyRideable}get unknownRarity(){return this._unknownRarity}get publiclyBreedable(){return this._publiclyBreedable}}class dC{flush(){return this._roomIndex=-1,this._petId=-1,this._canBreed=!1,this._canHarvest=!1,this._canRevive=!1,this._hasBreedingPermission=!1,!0}parse(e){return e?(this._roomIndex=e.readInt(),this._petId=e.readInt(),this._canBreed=e.readBoolean(),this._canHarvest=e.readBoolean(),this._canRevive=e.readBoolean(),this._hasBreedingPermission=e.readBoolean(),!0):!1}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get canBreed(){return this._canBreed}get canHarvest(){return this._canHarvest}get canRevive(){return this._canRevive}get hasBreedingPermission(){return this._hasBreedingPermission}}class fC{constructor(e){if(!e)throw new Error("invalid_wrapper");this._chance=e.readInt(),this._breeds=[];let t=e.readInt();for(;t>0;)this._breeds.push(e.readInt()),t--}dispose(){this._chance=-1,this._breeds=[]}get chance(){return this._chance}get breeds(){return this._breeds}}class gC{flush(){return this._isPlaying=!1,!0}parse(e){return e?(this._isPlaying=e.readBoolean(),!0):!1}get isPlaying(){return this._isPlaying}}class EC{flush(){return!0}parse(e){return!0}}class mC{flush(){return this._seconds=0,!0}parse(e){return e?(this._seconds=e.readInt(),!0):!1}get seconds(){return this._seconds}}class pC{flush(){return this._seconds=0,!0}parse(e){return e?(this._seconds=e.readInt(),!0):!1}get seconds(){return this._seconds}}class Bc{flush(){return this._roomIndex=null,this._message=null,this._gesture=0,this._bubble=0,this._urls=[],this._messageLength=0,!0}parse(e){return e?(this._roomIndex=e.readInt(),this._message=e.readString(),this._gesture=e.readInt(),this._bubble=e.readInt(),this.parseUrls(e),this._messageLength=e.readInt(),!0):!1}parseUrls(e){if(!e)return!1;this._urls=[];let t=e.readInt();for(;t>0;)this._urls.push(e.readString()),t--;return!0}get roomIndex(){return this._roomIndex}get message(){return this._message}get gesture(){return this._gesture}get bubble(){return this._bubble}get urls(){return this._urls}get messageLength(){return this._messageLength}}class IC{flush(){return this._unitId=null,this._isTyping=!1,!0}parse(e){return e?(this._unitId=e.readInt(),this._isTyping=e.readInt()===1,!0):!1}get unitId(){return this._unitId}get isTyping(){return this._isTyping}}class TC{flush(){return this._unitId=null,this._danceId=0,!0}parse(e){return e?(this._unitId=e.readInt(),this._danceId=e.readInt(),!0):!1}get unitId(){return this._unitId}get danceId(){return this._danceId}}class RC{flush(){return this._unitId=null,this._effectId=0,this._delay=0,!0}parse(e){return e?(this._unitId=e.readInt(),this._effectId=e.readInt(),this._delay=e.readInt(),!0):!1}get unitId(){return this._unitId}get effectId(){return this._effectId}get delay(){return this._delay}}class vC{flush(){return this._unitId=null,this._expression=0,!0}parse(e){return e?(this._unitId=e.readInt(),this._expression=e.readInt(),!0):!1}get unitId(){return this._unitId}get expression(){return this._expression}}class OC{flush(){return this._unitId=null,this._handId=0,!0}parse(e){return e?(this._unitId=e.readInt(),this._handId=e.readInt(),!0):!1}get unitId(){return this._unitId}get handId(){return this._handId}}class SC{flush(){return this._giverUserId=-1,this._handItemType=-1,!0}parse(e){return e?(this._giverUserId=e.readInt(),this._handItemType=e.readInt(),!0):!1}get giverUserId(){return this._giverUserId}get handItemType(){return this._handItemType}}class AC{flush(){return this._unitId=null,this._isIdle=!1,!0}parse(e){return e?(this._unitId=e.readInt(),this._isIdle=e.readBoolean(),!0):!1}get unitId(){return this._unitId}get isIdle(){return this._isIdle}}class yC{flush(){return this._unitId=null,this._figure=null,this._gender="M",this._motto=null,this._achievementScore=0,!0}parse(e){return e?(this._unitId=e.readInt(),this._figure=e.readString(),this._gender=e.readString().toLocaleUpperCase(),this._motto=e.readString(),this._achievementScore=e.readInt(),!0):!1}get unitId(){return this._unitId}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get achievementScore(){return this._achievementScore}}class CC{flush(){return this._unitId=null,this._value=0,!0}parse(e){return e?(this._unitId=e.readInt(),this._value=e.readInt(),!0):!1}get unitId(){return this._unitId}get value(){return this._value}}class ya{constructor(e){this._roomIndex=0,this._x=0,this._y=0,this._z=0,this._dir=0,this._name="",this._userType=0,this._sex="",this._figure="",this._custom="",this._activityPoints=0,this._webID=0,this._groupID=0,this._groupStatus=0,this._groupName="",this._subType="",this._ownerId=0,this._ownerName="",this._rarityLevel=0,this._hasSaddle=!1,this._isRiding=!1,this._canBreed=!1,this._canHarvest=!1,this._canRevive=!1,this._hasBreedingPermission=!1,this._petLevel=0,this._petPosture="",this._botSkills=[],this._isModerator=!1,this._isReadOnly=!1,this._roomIndex=e}setReadOnly(){this._isReadOnly=!0}get roomIndex(){return this._roomIndex}get x(){return this._x}set x(e){this._isReadOnly||(this._x=e)}get y(){return this._y}set y(e){this._isReadOnly||(this._y=e)}get z(){return this._z}set z(e){this._isReadOnly||(this._z=e)}get dir(){return this._dir}set dir(e){this._isReadOnly||(this._dir=e)}get name(){return this._name}set name(e){this._isReadOnly||(this._name=e)}get userType(){return this._userType}set userType(e){this._isReadOnly||(this._userType=e)}get sex(){return this._sex}set sex(e){this._isReadOnly||(this._sex=e)}get figure(){return this._figure}set figure(e){this._isReadOnly||(this._figure=e)}get custom(){return this._custom}set custom(e){this._isReadOnly||(this._custom=e)}get activityPoints(){return this._activityPoints}set activityPoints(e){this._isReadOnly||(this._activityPoints=e)}get webID(){return this._webID}set webID(e){this._isReadOnly||(this._webID=e)}get groupID(){return this._groupID}set groupID(e){this._isReadOnly||(this._groupID=e)}get groupName(){return this._groupName}set groupName(e){this._isReadOnly||(this._groupName=e)}get groupStatus(){return this._groupStatus}set groupStatus(e){this._isReadOnly||(this._groupStatus=e)}get subType(){return this._subType}set subType(e){this._isReadOnly||(this._subType=e)}get ownerId(){return this._ownerId}set ownerId(e){this._isReadOnly||(this._ownerId=e)}get ownerName(){return this._ownerName}set ownerName(e){this._isReadOnly||(this._ownerName=e)}get rarityLevel(){return this._rarityLevel}set rarityLevel(e){this._isReadOnly||(this._rarityLevel=e)}get hasSaddle(){return this._hasSaddle}set hasSaddle(e){this._isReadOnly||(this._hasSaddle=e)}get isRiding(){return this._isRiding}set isRiding(e){this._isReadOnly||(this._isRiding=e)}get canBreed(){return this._canBreed}set canBreed(e){this._isReadOnly||(this._canBreed=e)}get canHarvest(){return this._canHarvest}set canHarvest(e){this._isReadOnly||(this._canHarvest=e)}get canRevive(){return this._canRevive}set canRevive(e){this._isReadOnly||(this._canRevive=e)}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(e){this._isReadOnly||(this._hasBreedingPermission=e)}get petLevel(){return this._petLevel}set petLevel(e){this._isReadOnly||(this._petLevel=e)}get petPosture(){return this._petPosture}set petPosture(e){this._isReadOnly||(this._petPosture=e)}get botSkills(){return this._botSkills}set botSkills(e){this._botSkills=e}get isModerator(){return this._isModerator}set isModerator(e){this._isReadOnly||(this._isModerator=e)}}ya.M="M",ya.F="F";class MC{flush(){return this._users=[],!0}parse(e){if(!e)return!1;this._users=[];const t=e.readInt();let s=0;for(;s<t;){const i=e.readInt(),n=e.readString(),a=e.readString();let o=e.readString();const u=e.readInt(),l=e.readInt(),d=e.readInt(),c=parseFloat(e.readString()),_=e.readInt(),f=e.readInt(),g=new ya(u);if(g.dir=_,g.name=n,g.custom=a,g.x=l,g.y=d,g.z=c,this._users.push(g),f===1){g.webID=i,g.userType=hr.USER,g.sex=this.resolveSex(e.readString()),g.groupID=e.readInt(),g.groupStatus=e.readInt(),g.groupName=e.readString();const I=e.readString();I!==""&&(o=this.convertSwimFigure(I,o,g.sex)),g.figure=o,g.activityPoints=e.readInt(),g.isModerator=e.readBoolean()}else if(f===2)g.userType=hr.PET,g.figure=o,g.webID=i,g.subType=e.readInt().toString(),g.ownerId=e.readInt(),g.ownerName=e.readString(),g.rarityLevel=e.readInt(),g.hasSaddle=e.readBoolean(),g.isRiding=e.readBoolean(),g.canBreed=e.readBoolean(),g.canHarvest=e.readBoolean(),g.canRevive=e.readBoolean(),g.hasBreedingPermission=e.readBoolean(),g.petLevel=e.readInt(),g.petPosture=e.readString();else if(f===3)g.userType=hr.BOT,g.webID=u*-1,o.indexOf("/")===-1?g.figure=o:g.figure="hr-100-.hd-180-1.ch-876-66.lg-270-94.sh-300-64",g.sex=ya.M;else if(f===4){g.userType=hr.RENTABLE_BOT,g.webID=i,g.sex=this.resolveSex(e.readString()),g.figure=o,g.ownerId=e.readInt(),g.ownerName=e.readString();const I=e.readInt();if(I){const p=[];let R=0;for(;R<I;)p.push(e.readShort()),R++;g.botSkills=p}}s++}return!0}resolveSex(e){return e.substr(0,1).toLowerCase()==="f"?ya.F:ya.M}convertSwimFigure(e,t,s){const i=t.split(".");let n=1,a=1,o=1;const u=1e4;let l=0;for(;l<i.length;){const f=i[l].split("-");f.length>2&&f[0]==="hd"&&(n=parseInt(f[2])),l++}const d=["238,238,238","250,56,49","253,146,160","42,199,210","53,51,44","239,255,146","198,255,152","255,146,90","157,89,126","182,243,255","109,255,51","51,120,201","255,182,49","223,161,233","249,251,50","202,175,143","197,198,197","71,98,61","138,131,97","255,140,51","84,198,39","30,108,153","152,79,136","119,200,255","255,192,142","60,75,135","124,44,71","215,255,227","143,63,28","255,99,147","31,155,121","253,255,51"],c=e.split("=");if(c.length>1){const _=c[1].split("/");_[0];const f=_[1];s==="F"?o=10010:o=10011;const g=d.indexOf(f);a=u+g+1}return t+(".bds-10001-"+n+".ss-"+o+"-"+a)}get users(){return this._users}}class PC{flush(){return this._unitId=null,!0}parse(e){return e?(this._unitId=parseInt(e.readString()),!0):!1}get unitId(){return this._unitId}}class NC{constructor(e,t){this._action=e,this._value=t}get action(){return this._action}get value(){return this._value}}class bC{constructor(e,t,s,i,n,a,o,u=0,l=0,d=0,c,_,f){this._id=e,this._x=t,this._y=s,this._z=i,this._height=n,this._headDirection=a,this._direction=o,this._targetX=u,this._targetY=l,this._targetZ=d,this._didMove=c,this._canStandUp=_,this._actions=f||[]}get id(){return this._id}get x(){return this._x}get y(){return this._y}get z(){return this._z}get height(){return this._height}get headDirection(){return this._headDirection}get direction(){return this._direction}get targetX(){return this._targetX}get targetY(){return this._targetY}get targetZ(){return this._targetZ}get didMove(){return this._didMove}get canStandUp(){return this._canStandUp}get actions(){return this._actions}}class DC{flush(){return this._statuses=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const s=this.parseStatus(e);if(!s){t--;continue}this._statuses.push(s),t--}return!0}parseStatus(e){if(!e)return null;const t=e.readInt(),s=e.readInt(),i=e.readInt(),n=parseFloat(e.readString()),a=e.readInt()%8*45,o=e.readInt()%8*45,u=e.readString();let l=0,d=0,c=0,_=0,f=!1,g=!1;if(u){const I=u.split("/"),p=[];for(const R of I){const S=R.split(" ");if(S[0]!==""&&S.length>=2){switch(S[0]){case"mv":{const O=S[1].split(",");O.length>=3&&(l=parseInt(O[0]),d=parseInt(O[1]),c=parseFloat(O[2]),g=!0);break}case"sit":{const O=parseFloat(S[1]);S.length>=3&&(f=S[2]==="1"),_=O;break}case"lay":{const O=parseFloat(S[1]);_=Math.abs(O);break}}p.push(new NC(S[0],S[1]))}}this._statuses.push(new bC(t,s,i,n,_,a,o,l,d,c,g,f,p))}}get statuses(){return this._statuses}}class Nn{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._rentable=!1,this._itemId=0,this._furniType=null,this._ref=0,this._spriteId=0,this._category=0,this._stuffData=null,this._isGroupable=!1,this._isRecyclable=!1,this._tradable=!1,this._sellable=!1,this._secondsToExpiration=0,this._extra=0,this._flatId=0,this._isWallItem=!1,this._hasRentPeriodStarted=!1,this._expirationTimeStamp=0,this._slotId="",this._songId=-1,!0}parse(e){return e?(this._itemId=e.readInt(),this._furniType=e.readString(),this._ref=e.readInt(),this._spriteId=e.readInt(),this._category=e.readInt(),this._stuffData=Wi.parseObjectData(e),this._isRecyclable=e.readBoolean(),this._tradable=e.readBoolean(),this._isGroupable=e.readBoolean(),this._sellable=e.readBoolean(),this._secondsToExpiration=e.readInt(),this._expirationTimeStamp=ve(),this.secondsToExpiration>-1?this._rentable=!0:(this._rentable=!1,this._secondsToExpiration=-1),this._hasRentPeriodStarted=e.readBoolean(),this._flatId=e.readInt(),this._isWallItem=this._furniType===Nn.WALL_ITEM,this._furniType===Nn.FLOOR_ITEM&&(this._slotId=e.readString(),this._extra=e.readInt()),!0):!1}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get isGroupable(){return this._isGroupable}get isRecycleable(){return this._isRecyclable}get tradable(){return this._tradable}get sellable(){return this._sellable}get secondsToExpiration(){return this._secondsToExpiration}get flatId(){return this._flatId}get slotId(){return this._slotId}get songId(){return this._songId}get extra(){return this._extra}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}get creationDay(){return 0}get creationMonth(){return 0}get creationYear(){return 0}get isExternalImageFurni(){return this._furniType.indexOf("external_image")!==-1}}Nn.WALL_ITEM="I",Nn.FLOOR_ITEM="S";class LC{flush(){return this._items=[],!0}parse(e){return e?(this._items.push(new Nn(e)),!0):!1}get items(){return this._items}}class UC{flush(){return!0}parse(e){return!!e}}class FC{flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=new Map,!0}parse(e){if(!e)return!1;this._totalFragments=e.readInt(),this._fragmentNumber=e.readInt();let t=e.readInt();for(;t>0;){const s=new Nn(e);s&&this._fragment.set(s.itemId,s),t--}return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class wC{flush(){return this._itemId=0,!0}parse(e){return e?(this._itemId=e.readInt(),!0):!1}get itemId(){return this._itemId}}class xC{flush(){return this._itemId=0,this._itemsLeft=0,!0}parse(e){return e?(this._itemId=e.readInt(),this._itemsLeft=e.readInt(),!0):!1}get itemId(){return this._itemId}get itemsLeft(){return this._itemsLeft}}class GC{flush(){return this._itemType="",this._classId=0,this._productCode="",!0}parse(e){return e?(this._itemType=e.readString(),this._classId=e.readInt(),this._productCode=e.readString(),this._placedItemId=e.readInt(),this._placedItemType=e.readString(),this._placedInRoom=e.readBoolean(),this._petFigureString=e.readString(),!0):!1}get itemType(){return this._itemType}get classId(){return this._classId}get productCode(){return this._productCode}get placedItemId(){return this._placedItemId}get placedItemType(){return this._placedItemType}get placedInRoom(){return this._placedInRoom}get petFigureString(){return this._petFigureString}}class BC{flush(){this._nestId=0,this._pet1&&(this._pet1.dispose(),this._pet1=null),this._pet2&&(this._pet2.dispose(),this._pet2=null);for(const e of this._rarityCategories)e&&e.dispose();return this._rarityCategories=[],!0}parse(e){if(!e)return!1;this._nestId=e.readInt(),this._pet1=new Mg(e),this._pet2=new Mg(e);let t=e.readInt();for(;t>0;)this._rarityCategories.push(new fC(e)),t--;return this._resultPetType=e.readInt(),!0}get nestId(){return this._nestId}get pet1(){return this._pet1}get pet2(){return this._pet2}get rarityCategories(){return this._rarityCategories}get resultPetType(){return this._resultPetType}}class HC{flush(){return this._breedingNestStuffId=0,this._result=0,!0}parse(e){return e?(this._breedingNestStuffId=e.readInt(),this._result=e.readInt(),!0):!1}get breedingNestStuffId(){return this._breedingNestStuffId}get result(){return this._result}}class Ng{flush(){return!0}parse(e){return this._reason=e.readInt(),!0}get reason(){return this._reason}}Ng.PET_TOO_TIRED_TO_BREED=6;class kC{flush(){return this._petId=-1,this._rarityCategory=-1,!0}parse(e){return this._petId=e.readInt(),this._rarityCategory=e.readInt(),!0}get rarityCategory(){return this._rarityCategory}get petId(){return this._petId}}class Hc{constructor(e){this._typeId=e.readInt(),this._paletteId=e.readInt(),this._color=e.readString(),this._breedId=e.readInt(),this._customParts=[],this._customPartCount=e.readInt();let t=0;for(;t<this._customPartCount;)this._customParts.push(e.readInt()),this._customParts.push(e.readInt()),this._customParts.push(e.readInt()),t++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get breedId(){return this._breedId}get figuredata(){let e=this.typeId+" "+this.paletteId+" "+this.color;e=e+(" "+this.custompartCount);for(const t of this.customParts)e=e+(" "+t);return e}get customParts(){return this._customParts}get custompartCount(){return this._customPartCount}}class Au{constructor(e){if(!e)throw new Error("invalid_wrapper");this._id=e.readInt(),this._name=e.readString(),this._figureData=new Hc(e),this._level=e.readInt()}get id(){return this._id}get name(){return this._name}get typeId(){return this._figureData.typeId}get paletteId(){return this._figureData.paletteId}get color(){return this._figureData.color}get breedId(){return this._figureData.breedId}get customPartCount(){return this._figureData.custompartCount}get figureString(){return this._figureData.figuredata}get figureData(){return this._figureData}get level(){return this._level}}class VC{flush(){return this._pet=null,this._boughtAsGift=!1,!0}parse(e){return this._pet=new Au(e),this._boughtAsGift=e.readBoolean(),!0}get pet(){return this._pet}get boughtAsGift(){return this._boughtAsGift}}class yu{flush(){return this._state=0,this._ownPetId=0,this._otherPetId=0,!0}parse(e){return e?(this._state=e.readInt(),this._ownPetId=e.readInt(),this._otherPetId=e.readInt(),!0):!1}get state(){return this._state}get ownPetId(){return this._ownPetId}get otherPetId(){return this._otherPetId}}yu.STATE_CANCEL=1,yu.STATE_ACCEPT=2,yu.STATE_REQUEST=3;class jC{flush(){return this._fragment=null,!0}parse(e){this._totalFragments=e.readInt(),this._fragmentNumber=e.readInt();let t=e.readInt();for(this._fragment=new Map;t>0;){const s=new Au(e);this._fragment.set(s.id,s),t--}return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class YC{flush(){return this._boughtAsGift=!1,this._pet=null,!0}parse(e){return this._boughtAsGift=e.readBoolean(),this._pet=new Au(e),!0}get boughtAsGift(){return this._boughtAsGift}get pet(){return this._pet}}class WC{flush(){return!0}parse(e){return e?(this._petId=e.readInt(),!0):!1}get petId(){return this._petId}}class qq{parse(e){return e?(this._balance=parseFloat(e.readString()),!0):!1}flush(){return!0}get balance(){return this._balance}}class zC{constructor(e){this._itemId=e.readInt(),this._furniType=e.readString().toUpperCase(),this._ref=e.readInt(),this._spriteId=e.readInt(),this._category=e.readInt(),this._isGroupable=e.readBoolean(),this._stuffData=Wi.parseObjectData(e),this._secondsToExpiration=-1,this._expirationTimeStamp=ve(),this._hasRentPeriodStarted=!1,this._creationDay=e.readInt(),this._creationMonth=e.readInt(),this._creationYear=e.readInt(),this._extra=this.furniType==="S"?e.readInt():-1,this._flatId=-1,this._rentable=!1,this._isWallItem=this._furniType==="I"}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get extra(){return this._extra}get secondsToExpiration(){return this._secondsToExpiration}get creationDay(){return this._creationDay}get creationMonth(){return this._creationMonth}get creationYear(){return this._creationYear}get isGroupable(){return this._isGroupable}get songId(){return this._extra}get flatId(){return this._flatId}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}get isRecycleable(){return!0}get tradable(){return!0}get sellable(){return!0}get slotId(){return null}get isExternalImageFurni(){return this._furniType.indexOf("external_image")!==-1}}class XC{flush(){return this._userID=-1,this._userAccepts=!1,!0}parse(e){return e?(this._userID=e.readInt(),this._userAccepts=e.readInt()>0,!0):!1}get userID(){return this._userID}get userAccepts(){return this._userAccepts}}class bg{flush(){return!0}parse(e){return e?(this._userId=e.readInt(),this._reason=e.readInt(),!0):!1}get userID(){return this._userId}get reason(){return this._reason}}bg.ERROR_WHILE_COMMIT=1;class KC{flush(){return!0}parse(e){return!!e}}class qC{flush(){return!0}parse(e){return!!e}}class QC{flush(){return this._firstUserID=-1,this._firstUserItemArray=null,this._firstUserNumItems=0,this._firstUserNumCredits=0,this._secondUserID=-1,this._secondUserItemArray=null,this._secondUserNumItems=0,this._secondUserNumCredits=0,!0}parse(e){return!e||(this._firstUserID=e.readInt(),this._firstUserItemArray=[],!this.parseItems(e,this._firstUserItemArray))||(this._firstUserNumItems=e.readInt(),this._firstUserNumCredits=e.readInt(),this._secondUserID=e.readInt(),this._secondUserItemArray=[],!this.parseItems(e,this._secondUserItemArray))?!1:(this._secondUserNumItems=e.readInt(),this._secondUserNumCredits=e.readInt(),!0)}parseItems(e,t){let s=e.readInt();for(;s>0;)t.push(new zC(e)),s--;return!0}get firstUserID(){return this._firstUserID}get firstUserItemArray(){return this._firstUserItemArray}get firstUserNumItems(){return this._firstUserNumItems}get firstUserNumCredits(){return this._firstUserNumCredits}get secondUserID(){return this._secondUserID}get secondUserItemArray(){return this._secondUserItemArray}get secondUserNumItems(){return this._secondUserNumItems}get secondUserNumCredits(){return this._secondUserNumCredits}}class ZC{flush(){return!0}parse(e){return!!e}}class JC{flush(){return!0}parse(e){return!!e}}class kc{flush(){return!0}parse(e){return e?(this._reason=e.readInt(),this._otherUserName=e.readString(),!0):!1}get reason(){return this._reason}get otherUserName(){return this._otherUserName}}kc.REASON_YOU_ARE_ALREADY_TRADING=7,kc.REASON_OTHER_USER_ALREADY_TRADING=8;class $C{flush(){return this._userId=-1,this._userCanTrade=!1,this._otherUserId=-1,this._otherUserCanTrade=!1,!0}parse(e){return e?(this._userId=e.readInt(),this._userCanTrade=e.readInt()===1,this._otherUserId=e.readInt(),this._otherUserCanTrade=e.readInt()===1,!0):!1}get userID(){return this._userId}get userCanTrade(){return this._userCanTrade}get otherUserID(){return this._otherUserId}get otherUserCanTrade(){return this._otherUserCanTrade}}class eM{flush(){return!0}parse(e){return!!e}}class tM{flush(){return!0}parse(e){return!!e}}class sM{flush(){return this._respect=0,this._petOwnerId=0,this._petData=null,!0}parse(e){return e?(this._respect=e.readInt(),this._petOwnerId=e.readInt(),this._petData=new Au(e),!0):!1}get respect(){return this._respect}get petOwnerId(){return this._petOwnerId}get petData(){return this._petData}get isTreat(){return this._petData.typeId===be.MONSTERPLANT}}class rM{flush(){return this._petId=0,this._userId=0,this._supplementType=0,!0}parse(e){return e?(this._petId=e.readInt(),this._userId=e.readInt(),this._supplementType=e.readInt(),!0):!1}get petId(){return this._petId}get userId(){return this._userId}get supplementType(){return this._supplementType}}class Xi{}Xi.WATER=0,Xi.LIGHT=1,Xi.REVIVE=2,Xi.REBREED_FERTILIZER=3,Xi.SPEED_FERTILIZER=4;class iM{flush(){return this._userId=0,this._respectsReceived=0,!0}parse(e){return e?(this._userId=e.readInt(),this._respectsReceived=e.readInt(),!0):!1}get userId(){return this._userId}get respectsReceived(){return this._respectsReceived}}class nM{constructor(e,t,s){this._hasControllers=!1,this._roomId=e,this._roomName=t,this._hasControllers=s}get roomId(){return this._roomId}get roomName(){return this._roomName}get hasControllers(){return this._hasControllers}}class aM{constructor(e){this._currentHcStreak=e.readInt(),this._firstSubscriptionDate=e.readString(),this._kickbackPercentage=e.readDouble(),this._totalCreditsMissed=e.readInt(),this._totalCreditsRewarded=e.readInt(),this._totalCreditsSpent=e.readInt(),this._creditRewardForStreakBonus=e.readInt(),this._creditRewardForMonthlySpent=e.readInt(),this._timeUntilPayday=e.readInt()}get currentHcStreak(){return this._currentHcStreak}get firstSubscriptionDate(){return this._firstSubscriptionDate}get kickbackPercentage(){return this._kickbackPercentage}get totalCreditsMissed(){return this._totalCreditsMissed}get totalCreditsRewarded(){return this._totalCreditsRewarded}get totalCreditsSpent(){return this._totalCreditsSpent}get creditRewardForStreakBonus(){return this._creditRewardForStreakBonus}get creditRewardForMonthlySpent(){return this._creditRewardForMonthlySpent}get timeUntilPayday(){return this._timeUntilPayday}}class oM{flush(){return this._data=null,!0}parse(e){return this._data=new aM(e),!0}get data(){return this._data}}class hM{flush(){return this._looks=new Map,!0}parse(e){if(!e)return!1;e.readInt();let t=e.readInt();for(;t>0;){const s=e.readInt(),i=e.readString(),n=e.readString();this._looks.set(s,[i,n]),t--}return!0}get looks(){return this._looks}}class uM{flush(){return this._result=-1,!0}parse(e){return e?(this._result=e.readInt(),!0):!1}get result(){return this._result}}class lM{flush(){return this._isVip=!1,this._rooms=[],!0}parse(e){if(!e)return!1;this._isVip=e.readBoolean();let t=e.readInt();for(;t>0;)this._rooms.push(new nM(e.readInt(),e.readString(),e.readBoolean())),t--;return!0}get isVip(){return this._isVip}get rooms(){return this._rooms}}class cM{flush(){return this._pageId=-1,this._data=null,!0}parse(e){return e?(this._pageId=e.readInt(),this._data=new vu(e),!0):!1}get pageId(){return this._pageId}get data(){return this._data}}class _M{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._type=-1,this._breedId=-1,this._paletteId=-1,this._sellable=!1,this._rare=!1,!0}parse(e){return e?(this._type=e.readInt(),this._breedId=e.readInt(),this._paletteId=e.readInt(),this._sellable=e.readBoolean(),this._rare=e.readBoolean(),!0):!1}get type(){return this._type}get breedId(){return this._breedId}get paletteId(){return this._paletteId}get sellable(){return this._sellable}get rare(){return this._rare}}class dM{flush(){return this._productCode="",this._palettes=[],!0}parse(e){if(!e)return!1;this._productCode=e.readString();let t=e.readInt();for(;t>0;)this._palettes.push(new _M(e)),t--;return!0}get productCode(){return this._productCode}get palettes(){return this._palettes}}class fM{constructor(e){this._trackingState=e.readInt(),this._id=e.readInt(),this._identifier=e.readString(),this._productCode=e.readString(),this._priceInCredits=e.readInt(),this._priceInActivityPoints=e.readInt(),this._activityPointType=e.readInt(),this._purchaseLimit=e.readInt();const t=e.readInt();this._expirationTime=t>0?t*1e3+Date.now():0,this._title=e.readString(),this._description=e.readString(),this._imageUrl=e.readString(),this._iconImageUrl=e.readString(),this._type=e.readInt(),this._subProductCodes=[];let s=e.readInt();for(;s>0;)this._subProductCodes.push(e.readString()),s--;return this}populate(e){e&&(this._id=e.id,this._identifier=e.identifier,this._type=e.type,this._title=e.title,this._description=e.description,this._imageUrl=e.imageUrl,this._iconImageUrl=e.iconImageUrl,this._productCode=e.productCode,this._purchaseLimit=e.purchaseLimit,this._expirationTime=e.expirationTime,this._priceInCredits=e.priceInCredits,this._priceInActivityPoints=e.priceInActivityPoints,this._activityPointType=e.activityPointType,this._subProductCodes=e.subProductCodes,this._trackingState=e.trackingState)}purchase(e){this._purchaseLimit=this._purchaseLimit-e}get id(){return this._id}get identifier(){return this._identifier}get type(){return this._type}get title(){return this._title}get description(){return this._description}get imageUrl(){return this._imageUrl}get iconImageUrl(){return this._iconImageUrl}get productCode(){return this._productCode}get purchaseLimit(){return this._purchaseLimit}get expirationTime(){return this._expirationTime}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}get subProductCodes(){return this._subProductCodes}get trackingState(){return this._trackingState}}class gM{flush(){return!0}parse(e){return!!e}}class EM{flush(){return this._data=null,!0}parse(e){return e?(this._data=new fM(e),!0):!1}get data(){return this._data}}class mM{constructor(){this._errorCode=""}flush(){return this._errorCode="",!0}parse(e){return e?(this._errorCode=e.readString(),!0):!1}get errorCode(){return this._errorCode}}class pM{constructor(){this._productName="",this._productDescription=""}flush(){return this._productDescription="",this._productName="",!0}parse(e){return e?(this._productDescription=e.readString(),this._productName=e.readString(),!0):!1}get productName(){return this._productName}get productDescription(){return this._productDescription}}class IM{flush(){return!0}parse(e){return!!e}}class Ki{flush(){return this._goalId=0,this._goalCode=null,this._result=0,this._requiredFurnis=null,this._missingFurnis=null,!0}parse(e){this._goalId=e.readInt(),this._goalCode=e.readString(),this._result=e.readInt(),this._requiredFurnis=[];let t=e.readInt();for(;t>0;)this._requiredFurnis.push(e.readString()),t--;for(t=e.readInt();t>0;)this._missingFurnis[e.readString()]="",t--;return!0}get goalId(){return this._goalId}get goalCode(){return this._goalCode}get result(){return this._result}get requiredFurnis(){return this._requiredFurnis}isMissing(e){return!!this._missingFurnis[e]}}Ki.SUBMITTED=0,Ki.ASK_FOR_SUBMIT=1,Ki.ASK_FOR_CONFIRM=2,Ki.PREREQUISITES_NOT_MET=3,Ki.ROOM_DOOR_NOT_OPEN=4,Ki.ROOM_TOO_OLD=5,Ki.ASK_FOR_ACCEPT_RULES=6;class Cu{}Cu.ALLOWED=0,Cu.REQUIRED_PERK_MISSING=1,Cu.REQUIRED_BADGE_MISSING=2;class TM{flush(){return this._goalId=0,this._goalCode=null,this._resultCode=0,this._votesRemaining=0,!0}parse(e){return this._goalId=e.readInt(),this._goalCode=e.readString(),this._resultCode=e.readInt(),this._votesRemaining=e.readInt(),!0}get goalId(){return this._goalId}get goalCode(){return this._goalCode}get isVotingAllowedForUser(){return this._resultCode===Cu.ALLOWED}get votesRemaining(){return this._votesRemaining}get resultCode(){return this._resultCode}}class RM{flush(){return this._schedulingStr=null,this._code=null,!0}parse(e){return this._schedulingStr=e.readString(),this._code=e.readString(),!0}get schedulingStr(){return this._schedulingStr}get code(){return this._code}}class vM{flush(){return this._isPartOf=!1,this._targetId=0,!0}parse(e){return this._isPartOf=e.readBoolean(),this._targetId=e.readInt(),!0}get isPartOf(){return this._isPartOf}get targetId(){return this._targetId}}class OM{flush(){return!0}parse(e){return!0}}class SM{flush(){return this._timeStr=null,this._secondsUntil=0,!0}parse(e){return this._timeStr=e.readString(),this._secondsUntil=e.readInt(),!0}get timeStr(){return this._timeStr}get secondsUntil(){return this._secondsUntil}}class Dg{constructor(e){this._recipeName=e.readString(),this._itemName=e.readString()}get recipeName(){return this._recipeName}get itemName(){return this._itemName}}class AM{constructor(){this._recipes=[],this._ingredients=[]}flush(){return this._recipes=[],this._ingredients=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let i=0;i<t;i++)this._recipes.push(new Dg(e));const s=e.readInt();for(let i=0;i<s;i++)this._ingredients.push(e.readString());return!0}get recipes(){return this._recipes}get ingredients(){return this._ingredients}isActive(){return this._recipes.length>0||this._ingredients.length>0}}class yM{constructor(e){this._count=e.readInt(),this._itemName=e.readString()}get count(){return this._count}get itemName(){return this._itemName}}class CM{constructor(){this._ingredients=[]}parse(e){if(!e)return!1;const t=e.readInt();for(let s=0;s<t;s++)this._ingredients.push(new yM(e));return!0}flush(){return this._ingredients=[],!0}get ingredients(){return this._ingredients}}class MM{parse(e){return e?(this._count=e.readInt(),this._hasRecipes=e.readBoolean(),!0):!1}flush(){return this._count=0,this._hasRecipes=!1,!0}get count(){return this._count}get hasRecipes(){return this._hasRecipes}}class PM{parse(e){return e?(this._success=e.readBoolean(),this._success&&(this._result=new Dg(e)),!0):!1}flush(){return this._success=!1,!0}get success(){return this._success}get result(){return this._result}}class NM{flush(){return!0}parse(e){return!!e}}class bM{constructor(e){if(!e)throw new Error("invalid_wrapper");this._senderId=e.readInt(),this._errorCode=e.readInt()}get senderId(){return this._senderId}get errorCode(){return this._errorCode}}class DM{flush(){return this._failuers=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._failuers.push(new bM(e)),t--;return!0}get failures(){return this._failuers}}class LM{flush(){return this._success=!1,!0}parse(e){return e?(this._success=e.readBoolean(),!0):!1}get success(){return this._success}}class UM{flush(){return this._errorCode=0,!0}parse(e){return e?(this._errorCode=e.readInt(),!0):!1}get errorCode(){return this._errorCode}}class Lg{constructor(e){if(!e)throw new Error("invalid_wrapper");this._id=e.readInt(),this._name=e.readString()}get id(){return this._id}get name(){return this._name}}class Vc{constructor(e){if(!e)throw new Error("invalid_wrapper");this._id=e.readInt(),this._name=e.readString(),this._gender=e.readInt(),this._online=e.readBoolean(),this._followingAllowed=e.readBoolean(),this._figure=e.readString(),this._categoryId=e.readInt(),this._motto=e.readString(),this._realName=e.readString(),this._lastAccess=e.readString(),this._persistedMessageUser=e.readBoolean(),this._vipMember=e.readBoolean(),this._pocketHabboUser=e.readBoolean(),this._relationshipStatus=e.readShort()}get id(){return this._id}get name(){return this._name}get gender(){return this._gender}get online(){return this._online}get followingAllowed(){return this._followingAllowed}get figure(){return this._figure}get categoryId(){return this._categoryId}get motto(){return this._motto}get lastAccess(){return this._lastAccess}get realName(){return this._realName}get persistedMessageUser(){return this._persistedMessageUser}get vipMember(){return this._vipMember}get pocketHabboUser(){return this._pocketHabboUser}get relationshipStatus(){return this._relationshipStatus}}class FM{flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=[],!0}parse(e){if(!e)return!1;this._totalFragments=e.readInt(),this._fragmentNumber=e.readInt();let t=e.readInt();for(;t>0;)this._fragment.push(new Vc(e)),t--;return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class wM{flush(){return this._categories=[],this._removedFriendIds=[],this._addedFriends=[],this._updatedFriends=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._categories.push(new Lg(e)),t--;let s=e.readInt();for(;s>0;){const i=e.readInt();i===-1?this._removedFriendIds.push(e.readInt()):i===0?this._updatedFriends.push(new Vc(e)):i===1&&this._addedFriends.push(new Vc(e)),s--}return!0}get categories(){return this._categories}get removedFriendIds(){return this._removedFriendIds}get addedFriends(){return this._addedFriends}get updatedFriends(){return this._updatedFriends}}class xM{flush(){return this._typeCode=-1,this._avatarId=0,this._message=null,!0}parse(e){return e?(this._typeCode=e.readInt(),this._avatarId=e.readInt(),this._message=e.readString(),!0):!1}get typeCode(){return this._typeCode}get avatarId(){return this._avatarId}get message(){return this._message}}class Ug{constructor(e){if(!e)throw new Error("invalid_wrapper");this._requestId=e.readInt(),this._requesterName=e.readString(),this._figureString=e.readString(),this._requesterUserId=this._requestId}get requestId(){return this._requestId}get requesterName(){return this._requesterName}get requesterUserId(){return this._requesterUserId}get figureString(){return this._figureString}}class GM{flush(){return this._totalRequests=0,this._requests=[],!0}parse(e){if(!e)return!1;this._totalRequests=e.readInt();let t=e.readInt();for(;t>0;)this._requests.push(new Ug(e)),t--;return!0}get totalRequests(){return this._totalRequests}get requests(){return this._requests}}class Fg{constructor(e){if(!e)throw new Error("invalid_wrapper");this._avatarId=e.readInt(),this._avatarName=e.readString(),this._avatarMotto=e.readString(),this._isAvatarOnline=e.readBoolean(),this._canFollow=e.readBoolean(),this._lastOnlineData=e.readString(),this._avatarGender=e.readInt(),this._avatarFigure=e.readString(),this._realName=e.readString()}get avatarId(){return this._avatarId}get avatarName(){return this._avatarName}get avatarMotto(){return this._avatarMotto}get isAvatarOnline(){return this._isAvatarOnline}get canFollow(){return this._canFollow}get avatarGender(){return this._avatarGender}get avatarFigure(){return this._avatarFigure}get lastOnlineData(){return this._lastOnlineData}get realName(){return this._realName}}class BM{flush(){return this._friends=[],this._others=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._friends.push(new Fg(e)),t--;let s=e.readInt();for(;s>0;)this._others.push(new Fg(e)),s--;return!0}get friends(){return this._friends}get others(){return this._others}}class HM{flush(){return this._errorCode=0,this._userId=0,this._message=null,!0}parse(e){return e?(this._errorCode=e.readInt(),this._userId=e.readInt(),this._message=e.readString(),!0):!1}get errorCode(){return this._errorCode}get userId(){return this._userId}get message(){return this._message}}class kM{flush(){return this._clientMessageId=0,this._errorCode=0,!0}parse(e){return e?(this._clientMessageId=e.readInt(),this._errorCode=e.readInt(),!0):!1}get clientMessageId(){return this._clientMessageId}get errorCode(){return this._errorCode}}class VM{flush(){return this._userFriendLimit=0,this._normalFriendLimit=0,this._extendedFriendLimit=0,this._categories=[],!0}parse(e){if(!e)return!1;this._userFriendLimit=e.readInt(),this._normalFriendLimit=e.readInt(),this._extendedFriendLimit=e.readInt();let t=e.readInt();for(;t>0;)this._categories.push(new Lg(e)),t--;return!0}get userFriendLimit(){return this._userFriendLimit}get normalFriendLimit(){return this._normalFriendLimit}get extendedFriendLimit(){return this._extendedFriendLimit}get categories(){return this._categories}}class jM{flush(){return!0}parse(e){return!!e}}class YM{flush(){return this._count=0,!0}parse(e){return e?(this._count=e.readInt(),!0):!1}get count(){return this._count}}class WM{flush(){return this._senderId=0,this._messageText=null,this._secondsSinceSent=0,this._extraData=null,!0}parse(e){return e?(this._senderId=e.readInt(),this._messageText=e.readString(),this._secondsSinceSent=e.readInt(),e.bytesAvailable&&(this._extraData=e.readString()),!0):!1}get senderId(){return this._senderId}get messageText(){return this._messageText}get secondsSinceSent(){return this._secondsSinceSent}get extraData(){return this._extraData}}class zM{flush(){return this._request=null,!0}parse(e){return e?(this._request=new Ug(e),!0):!1}get request(){return this._request}}class XM{flush(){return this._errorCode=0,this._failedRecipients=[],!0}parse(e){if(!e)return!1;this._errorCode=e.readInt();let t=e.readInt();for(;t>0;)this._failedRecipients.push(e.readInt()),t--;return!0}get errorCode(){return this._errorCode}get failedRecipients(){return this._failedRecipients}}class KM{flush(){return this._senderId=0,this._messageText=null,!0}parse(e){return e?(this._senderId=e.readInt(),this._messageText=e.readString(),!0):!1}get senderId(){return this._senderId}get messageText(){return this._messageText}}class qM{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),this._freeGamesLeft=e.readInt(),this._gamesPlayedTotal=e.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get freeGamesLeft(){return this._freeGamesLeft}get gamesPlayedTotal(){return this._gamesPlayedTotal}get hasUnlimitedGames(){return this._freeGamesLeft==-1}}class Uo{flush(){return this._status=-1,this._blockLength=-1,this._gamesPlayed=-1,this._freeGamesLeft=-1,!0}parse(e){return e?(this._status=e.readInt(),this._blockLength=e.readInt(),this._gamesPlayed=e.readInt(),this._freeGamesLeft=e.readInt(),!0):!1}get status(){return this._status}get blockLength(){return this._blockLength}get gamesPlayed(){return this._gamesPlayed}get freeGamesLeft(){return this._freeGamesLeft}get hasUnlimitedGames(){return this._freeGamesLeft==-1}}Uo.STATUS_OK=0,Uo.STATUS_FAILED_REASON_UNKNOWN=1,Uo.STATUS_FAILED_REASON_GAME_DIRECTORY_IS_NOT_AVAILABLE=2,Uo.STATUS_FAILED_REASON_HOTEL_IS_CLOSED=3;class QM{flush(){return this._position=-1,!0}parse(e){return e?(this._position=e.readInt(),!0):!1}get position(){return this._position}}class ui{flush(){return this._reason=-1,!0}parse(e){return e?(this._reason=e.readInt(),!0):!1}get reason(){return this._reason}}ui.KICKED=1,ui.DUPLICATE_MACHINEID=2,ui.INVITATION_REQUIRED=3,ui.NO_SPACE_IN_TEAM=4,ui.TEAM_NOT_FOUND=5,ui.USER_HAS_ACTIVE_INSTANCE=6,ui.USER_HAS_PENDING_INSTANCE_REQUEST=7,ui.USER_HAS_NO_FREE_GAMES_LEFT=8;class jc{flush(){return this._reason=-1,!0}parse(e){return e?(this._reason=e.readInt(),!0):!1}get reason(){return this._reason}}jc.NOT_ENOUGH_PLAYERS=1,jc.GAME_HAS_NO_OWNER=2;class ZM{flush(){return!0}parse(e){return!!e}}class JM{flush(){return this._userId=-1,!0}parse(e){return e?(this._userId=e.readInt(),!0):!1}get userId(){return this._userId}}class $M{flush(){return!0}parse(e){return e?(this._stuffCode=e.readString(),this._badgeCode=e.readString(),!0):!1}get stuffCode(){return this._stuffCode}get badgeCode(){return this._badgeCode}}class e0{flush(){return this._stuffId=-1,this._achievementId=0,this._requiredLevelBadgeCode="",this._userProgress=0,this._totalProgress=0,this._endTime=0,!0}parse(e){return e?(this._stuffId=e.readInt(),this._achievementId=e.readInt(),this._requiredLevelBadgeCode=e.readString(),this._userProgress=e.readInt(),this._totalProgress=e.readInt(),this._endTime=e.readInt(),!0):!1}get stuffId(){return this._stuffId}get achievementId(){return this._achievementId}get requiredLevelBadgeCode(){return this._requiredLevelBadgeCode}get userProgress(){return this._userProgress}get totalProgress(){return this._totalProgress}get endTime(){return this._endTime}}class t0{flush(){return!0}parse(e){if(!e)return!1;this._stuffId=e.readInt();const t=e.readInt();let s=0;for(;s<t;)this._achievements.push(new Su(e)),s++;return this._endTime=e.readInt(),!0}get stuffId(){return this._stuffId}get achievements(){return this._achievements}get endTime(){return this._endTime}}class s0{constructor(e,t,s,i){this._gameTypeId=e,this._achievementId=t,this._achievementName=s,this._levels=i}get gameTypeId(){return this._gameTypeId}get achievementId(){return this._achievementId}get achievementName(){return this._achievementName}get levels(){return this._levels}}class r0{flush(){return!0}parse(e){if(!e)return!1;this._achievements=[];const t=e.readInt();let s=0;for(;s<t;){const i=e.readInt(),n=e.readInt();let a=0;for(;a<n;){const o=e.readInt(),u=e.readString(),l=e.readInt();this._achievements.push(new s0(i,o,u,l)),a++}s++}return!0}get achievements(){return this._achievements}}class i0{constructor(e,t,s,i,n,a){this._gameId=e,this._gameNameId=t,this._bgColor=s,this._textColor=i,this._assetUrl=n,this._supportUrl=a}get gameId(){return this._gameId}get gameNameId(){return this._gameNameId}get bgColor(){return this._bgColor}get textColor(){return this._textColor}get assetUrl(){return this._assetUrl}get supportUrl(){return this._supportUrl}}class n0{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),this._inviterId=e.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get inviterId(){return this._inviterId}}class a0{flush(){return!0}parse(e){if(!e)return!1;this._games=[];const t=e.readInt();for(let s=0;s<t;s++){const i=e.readInt(),n=e.readString(),a=e.readString();let o=parseInt(a,16);o=o|4278190080;const u=e.readString();let l=parseInt(u,16);l=l|4278190080;const d=e.readString(),c=e.readString();this._games.push(new i0(i,n,o,l,d,c))}return!0}get games(){return this._games}}class Ca{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),this._status=e.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get isOk(){return this._status==Ca.OK}get isInMaintenance(){return this._status==Ca.MAINTENANCE}}Ca.OK=0,Ca.MAINTENANCE=1;class o0{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}}class wg{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),this._reason=e.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get reason(){return this._reason}}wg.DUPLICATE_MACHINEID=1;class h0{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}}class u0{flush(){return!0}parse(e){if(!e)return!1;this._gameTypeId=e.readInt(),this._gameClientId=e.readString(),this._url=e.readString(),this._quality=e.readString(),this._scaleMode=e.readString(),this._frameRate=e.readInt(),this._minMajorVersion=e.readInt(),this._minMinorVersion=e.readInt(),this._params=new Map;const t=e.readInt();let s=0;for(;s<t;)this._params.set(e.readString(),e.readString()),s++;return!0}get gameTypeId(){return this._gameTypeId}get url(){return this._url}get quality(){return this._quality}get scaleMode(){return this._scaleMode}get frameRate(){return this._frameRate}get minMajorVersion(){return this._minMajorVersion}get minMinorVersion(){return this._minMinorVersion}get params(){return this._params}get gameClientId(){return this._gameClientId}}class l0{flush(){return this._gameTypeId=0,this._url=null,this._gameClientId=null,!0}parse(e){return e?(this._gameTypeId=e.readInt(),this._gameClientId=e.readString(),this._url=e.readString(),!0):!1}get gameTypeId(){return this._gameTypeId}get url(){return this._url}get gameClientId(){return this._gameClientId}}class c0{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),this._gameClientId=e.readString(),!0):!1}get gameTypeId(){return this._gameTypeId}get gameClientId(){return this._gameClientId}}class _0{flush(){return!0}parse(e){return!!e}}class Mu{flush(){return this._year=-1,this._week=-1,this._maxOffset=-1,this._currentOffset=-1,this._minutesUntilReset=-1,!0}parse(e){return e?(this._year=e.readInt(),this._week=e.readInt(),this._maxOffset=e.readInt(),this._currentOffset=e.readInt(),this._minutesUntilReset=e.readInt(),!0):!1}get year(){return this._year}get week(){return this._week}get maxOffset(){return this._maxOffset}get currentOffset(){return this._currentOffset}get minutesUntilReset(){return this._minutesUntilReset}}class d0{constructor(e){this._name=e.readString(),this._figure=e.readString(),this._gender=e.readString(),this._rank=e.readInt(),this._score=e.readInt()}get name(){return this._name}get figure(){return this._figure}get gender(){return this._gender}get rank(){return this._rank}get score(){return this._score}}class Qq{constructor(e){this._userId=e.readInt(),this._score=e.readInt(),this._rank=e.readInt(),this._name=e.readString(),this._figure=e.readString(),this._gender=e.readString()}get userId(){return this._userId}get score(){return this._score}get rank(){return this._rank}get figure(){return this._figure}get gender(){return this._gender}get name(){return this._name}}class f0{flush(){return this._gameTypeId=-1,this._products=[],this._minutesUntilNextWeek=0,this._rewardingOn=!0,!0}parse(e){if(!e)return!1;this._gameTypeId=e.readInt();let t=e.readInt();for(;t>0;)this._products.push(new Dr(e)),t--;return this._minutesUntilNextWeek=e.readInt(),this._rewardingOn=e.readBoolean(),!0}get gameTypeId(){return this._gameTypeId}get products(){return this._products}get minutesUntilNextWeek(){return this._minutesUntilNextWeek}get rewardingOn(){return this._rewardingOn}}class g0{flush(){return this._gameTypeId=-1,this._winners=[],!0}parse(e){if(!e)return!1;this._gameTypeId=e.readInt();let t=e.readInt();for(;t>0;)this._winners.push(new d0(e)),t--;return!0}get gameTypeId(){return this._gameTypeId}get winners(){return this._winners}}class E0{flush(){return this._errorCode=0,!0}parse(e){return e?(this._errorCode=e.readInt(),!0):!1}get errorCode(){return this._errorCode}}class m0{flush(){return this._phoneStatusCode=-1,this._millisecondsToAllowProcessReset=-1,!0}parse(e){return e?(this._phoneStatusCode=e.readInt(),this._collectionStatusCode=e.readInt(),this._millisecondsToAllowProcessReset=e.readInt(),!0):!1}get phoneStatusCode(){return this._phoneStatusCode}get collectionStatusCode(){return this._collectionStatusCode}get millisecondsToAllowProcessReset(){return this._millisecondsToAllowProcessReset}}class p0{flush(){return this._resultCode=-1,!0}parse(e){return e?(this._resultCode=e.readInt(),this._millisToAllowProcessReset=e.readInt(),!0):!1}get resultCode(){return this._resultCode}get millisToAllowProcessReset(){return this._millisToAllowProcessReset}}class I0{flush(){return this._resultCode=-1,this._millisecondsToAllowProcessReset=-1,!0}parse(e){return e?(this._resultCode=e.readInt(),this._millisecondsToAllowProcessReset=e.readInt(),!0):!1}get resultCode(){return this._resultCode}get millisToAllowProcessReset(){return this._millisecondsToAllowProcessReset}}class T0{flush(){return this._bases=new Map,this._symbols=new Map,this._partColors=new Map,this._colorsA=new Map,this._colorsB=new Map,!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const o=e.readInt(),u=e.readString(),l=e.readString();this._bases.set(o,[u,l]),t--}let s=e.readInt();for(;s>0;){const o=e.readInt(),u=e.readString(),l=e.readString();this._symbols.set(o,[u,l]),s--}let i=e.readInt();for(;i>0;){const o=e.readInt(),u=e.readString();this._partColors.set(o,u),i--}let n=e.readInt();for(;n>0;){const o=e.readInt(),u=e.readString();this._colorsA.set(o,u),n--}let a=e.readInt();for(;a>0;){const o=e.readInt(),u=e.readString();this._colorsB.set(o,u),a--}return!0}get bases(){return this._bases}get symbols(){return this._symbols}get partColors(){return this._partColors}get colorsA(){return this._colorsA}get colorsB(){return this._colorsB}}class R0{flush(){return this._groupCost=0,this._availableRooms=new Map,!0}parse(e){if(!e)return!1;this._groupCost=e.readInt();let t=e.readInt();for(;t>0;){const s=e.readInt(),i=e.readString();e.readBoolean(),this._availableRooms.set(s,i),t--}return!0}get groupCost(){return this._groupCost}get availableRooms(){return this._availableRooms}}class v0{flush(){return this._userId=0,this._furnitureCount=0,!0}parse(e){return e?(this._userId=e.readInt(),this._furnitureCount=e.readInt(),!0):!1}get userId(){return this._userId}get furnitureCount(){return this._furnitureCount}}class O0{flush(){return this._id=0,this._type=0,this._title=null,this._description=null,this._badge=null,this._roomId=0,this._roomName=null,this._membershipType=0,this._membersCount=0,this._isFavorite=!1,this._createdAt=null,this._isOwner=!1,this._isAdmin=!1,this._ownerName=null,this._flag=!1,this._canMembersDecorate=!1,this._pendingRequestsCount=0,!0}parse(e){return e?(this._id=e.readInt(),e.readBoolean(),this._type=e.readInt(),this._title=e.readString(),this._description=e.readString(),this._badge=e.readString(),this._roomId=e.readInt(),this._roomName=e.readString(),this._membershipType=e.readInt(),this._membersCount=e.readInt(),this._isFavorite=e.readBoolean(),this._createdAt=e.readString(),this._isOwner=e.readBoolean(),this._isAdmin=e.readBoolean(),this._ownerName=e.readString(),this._flag=e.readBoolean(),this._canMembersDecorate=e.readBoolean(),this._pendingRequestsCount=e.readInt(),!0):!1}get id(){return this._id}get type(){return this._type}get title(){return this._title}get description(){return this._description}get badge(){return this._badge}get roomId(){return this._roomId}get roomName(){return this._roomName}get membershipType(){return this._membershipType}get membersCount(){return this._membersCount}get isFavorite(){return this._isFavorite}get createdAt(){return this._createdAt}get isOwner(){return this._isOwner}get isAdmin(){return this._isAdmin}get ownerName(){return this._ownerName}get flag(){return this._flag}get canMembersDecorate(){return this._canMembersDecorate}get pendingRequestsCount(){return this._pendingRequestsCount}}class S0{constructor(e){this.isBase=e,this.key=0,this.color=0,this.position=4}get code(){return this.key===0?null:(this.isBase?"b":"s")+(this.key<100?"0":"")+(this.key<10?"0":"")+this.key+(this.color<10?"0":"")+this.color+this.position}}class Fo{}Fo.OWNER=0,Fo.ADMIN=1,Fo.MEMBER=2,Fo.REQUESTED=3,Fo.DELETED=4;class A0{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._rank=-1,this._id=0,this._name=null,this._figure=null,this._joinedAt=null,!0}parse(e){return e?(this._rank=e.readInt(),this._id=e.readInt(),this._name=e.readString(),this._figure=e.readString(),this._joinedAt=e.readString(),!0):!1}get id(){return this._id}get name(){return this._name}get figure(){return this._figure}get rank(){return this._rank}get joinedAt(){return this._joinedAt}}class y0{flush(){return this._groupId=0,this._groupTitle=null,this._roomId=0,this._badge=null,this._totalMembersCount=0,this._result=[],this._admin=!1,this._pageSize=0,this._pageIndex=0,this._level=0,this._query=null,!0}parse(e){if(!e)return!1;this._groupId=e.readInt(),this._groupTitle=e.readString(),this._roomId=e.readInt(),this._badge=e.readString(),this._totalMembersCount=e.readInt();let t=e.readInt();for(;t>0;)this._result.push(new A0(e)),t--;return this._admin=e.readBoolean(),this._pageSize=e.readInt(),this._pageIndex=e.readInt(),this._level=e.readInt(),this._query=e.readString(),!0}get groupId(){return this._groupId}get groupTitle(){return this._groupTitle}get roomId(){return this._roomId}get badge(){return this._badge}get totalMembersCount(){return this._totalMembersCount}get result(){return this._result}get admin(){return this._admin}get pageSize(){return this._pageSize}get pageIndex(){return this._pageIndex}get level(){return this._level}get query(){return this._query}}class C0{flush(){return this._roomId=0,this._groupId=0,!0}parse(e){return e?(this._roomId=e.readInt(),this._groupId=e.readInt(),!0):!1}get roomId(){return this._roomId}get guildId(){return this._groupId}}class M0{flush(){return this._roomId=0,this._roomName=null,this._id=0,this._title=null,this._description=null,this._colorA=0,this._colorB=0,this._state=0,this._canMembersDecorate=!1,this._badgeParts=new Map,this._badgeCode=null,this._membersCount=0,!0}parse(e){if(!e)return!1;e.readInt()===1&&(this._roomId=e.readInt(),this._roomName=e.readString(),e.readBoolean()),e.readBoolean(),this._id=e.readInt(),this._title=e.readString(),this._description=e.readString(),e.readInt(),this._colorA=e.readInt(),this._colorB=e.readInt(),this._state=e.readInt(),this._canMembersDecorate=e.readInt()===0,e.readBoolean(),e.readString();const s=e.readInt();for(let i=0;i<s;i++){const n=new S0(i===0);n.key=e.readInt(),n.color=e.readInt(),n.position=e.readInt(),n.key===0&&(n.position=4),this._badgeParts.set(i,n)}return this._badgeCode=e.readString(),this._membersCount=e.readInt(),!0}get roomId(){return this._roomId}get roomName(){return this._roomName}get id(){return this._id}get title(){return this._title}get description(){return this._description}get colorA(){return this._colorA}get colorB(){return this._colorB}get state(){return this._state}get canMembersDecorate(){return this._canMembersDecorate}get badgeParts(){return this._badgeParts}get badgeCode(){return this._badgeCode}get membersCount(){return this._membersCount}}class P0{flush(){return!0}parse(e){return this._groupId=e.readInt(),!0}get groupId(){return this._groupId}}class wo{static parse(e){return this.fillFromMessage(new wo,e)}static fillFromMessage(e,t){return e._groupId=t.readInt(),e._name=t.readString(),e._description=t.readString(),e._icon=t.readString(),e._totalThreads=t.readInt(),e._leaderboardScore=t.readInt(),e._totalMessages=t.readInt(),e._unreadMessages=t.readInt(),e._lastMessageId=t.readInt(),e._lastMessageAuthorId=t.readInt(),e._lastMessageAuthorName=t.readString(),e._lastMessageTimeAsSecondsAgo=t.readInt(),e}get groupId(){return this._groupId}get name(){return this._name}get description(){return this._description}get icon(){return this._icon}get totalThreads(){return this._totalThreads}get leaderboardScore(){return this._leaderboardScore}get totalMessages(){return this._totalMessages}get unreadMessages(){return this._unreadMessages}get lastMessageId(){return this._lastMessageId}get lastMessageAuthorId(){return this._lastMessageAuthorId}get lastMessageAuthorName(){return this._lastMessageAuthorName}get lastMessageTimeAsSecondsAgo(){return this._lastMessageTimeAsSecondsAgo}updateFrom(e){this._totalThreads=e._totalThreads,this._totalMessages=e._totalMessages,this._unreadMessages=e._unreadMessages,this._lastMessageAuthorId=e._lastMessageAuthorId,this._lastMessageAuthorName=e._lastMessageAuthorName,this._lastMessageId=e._lastMessageId,this._lastMessageTimeAsSecondsAgo=e._lastMessageTimeAsSecondsAgo}get lastReadMessageId(){return this._totalMessages-this._unreadMessages}set lastReadMessageId(e){this._unreadMessages=this._totalMessages-e,this._unreadMessages<0&&(this._unreadMessages=0)}addNewThread(e){this._lastMessageAuthorId=e.lastUserId,this._lastMessageAuthorName=e.lastUserName,this._lastMessageId=e.lastMessageId,this._lastMessageTimeAsSecondsAgo=e.lastCommentTime,this._totalThreads++,this._totalMessages++,this._unreadMessages=0}}class Yc extends wo{static parse(e){const t=new Yc;return wo.fillFromMessage(t,e),t._readPermissions=e.readInt(),t._postMessagePermissions=e.readInt(),t._postThreadPermissions=e.readInt(),t._moderatePermissions=e.readInt(),t._readPermissionError=e.readString(),t._postMessagePermissionError=e.readString(),t._postThreadPermissionError=e.readString(),t._moderatePermissionError=e.readString(),t._reportPermissionError=e.readString(),t._canChangeSettings=e.readBoolean(),t._isStaff=e.readBoolean(),t}get readPermissions(){return this._readPermissions}get postMessagePermissions(){return this._postMessagePermissions}get postThreadPermissions(){return this._postThreadPermissions}get moderatePermissions(){return this._moderatePermissions}get hasReadPermissionError(){return this._readPermissionError.length===0}get canReport(){return!0}get hasPostMessagePermissionError(){return this._postMessagePermissionError.length===0}get hasPostThreadPermissionError(){return this._postThreadPermissionError.length===0}get hasModeratePermissionError(){return this._moderatePermissionError.length===0}get canChangeSettings(){return this._canChangeSettings}get isStaf(){return this._isStaff}get readPermissionError(){return this._readPermissionError}get postMessagePermissionError(){return this._postMessagePermissionError}get postThreadPermissionError(){return this._postThreadPermissionError}get moderatePermissionError(){return this._moderatePermissionError}get reportPermissionError(){return this._reportPermissionError}}class N0{flush(){return this._extendedForumData=null,!0}parse(e){return e?(this._extendedForumData=Yc.parse(e),!0):!1}get extendedForumData(){return this._extendedForumData}}class b0{flush(){return this._listCode=-1,this._totalAmount=0,this._startIndex=-1,this._amount=0,this._forums=[],!0}parse(e){if(!e)return!1;this._listCode=e.readInt(),this._totalAmount=e.readInt(),this._startIndex=e.readInt(),this._amount=e.readInt(),this._forums=[];let t=0;for(;t<this._amount;)this._forums.push(wo.parse(e)),t++;return!0}get listCode(){return this._listCode}get totalAmount(){return this._totalAmount}get startIndex(){return this._startIndex}get amount(){return this._amount}get forums(){return this._forums}}class xo{static parse(e){const t=new xo;return t._threadId=e.readInt(),t._authorId=e.readInt(),t._authorName=e.readString(),t._header=e.readString(),t._isPinned=e.readBoolean(),t._isLocked=e.readBoolean(),t._creationTimeAsSecondsAgo=e.readInt(),t._totalMessages=e.readInt(),t._unreadMessagesCount=e.readInt(),t._lastMessageId=e.readInt(),t._lastUserId=e.readInt(),t._lastUserName=e.readString(),t._lastCommentTime=e.readInt(),t._state=e.readByte(),t._adminId=e.readInt(),t._adminName=e.readString(),t._adminOperationTimeAsSecondsAgo=e.readInt(),t}get adminOperationTimeAsSecondsAgo(){return this._adminOperationTimeAsSecondsAgo}set adminOperationTimeAsSecondsAgo(e){this._adminOperationTimeAsSecondsAgo=e}get lastCommentTime(){return this._lastCommentTime}set lastCommentTime(e){this._lastCommentTime=e}get threadId(){return this._threadId}set threadId(e){this._threadId=e}get authorId(){return this._authorId}set authorId(e){this._authorId=e}get authorName(){return this._authorName}set authorName(e){this._authorName=e}get creationTimeAsSecondsAgo(){return this._creationTimeAsSecondsAgo}set creationTimeAsSecondsAgo(e){this._creationTimeAsSecondsAgo=e}get header(){return this._header}set header(e){this._header=e}get lastMessageId(){return this._lastMessageId}set lastMessageId(e){this._lastMessageId=e}get lastUserId(){return this._lastUserId}set lastUserId(e){this._lastUserId=e}get lastUserName(){return this._lastUserName}set lastUserName(e){this._lastUserName=e}get totalMessages(){return this._totalMessages}set totalMessages(e){this._totalMessages=e}get unreadMessagesCount(){return this._unreadMessagesCount}set unreadMessagesCount(e){this._unreadMessagesCount=e}get state(){return this._state}set state(e){this._state=e}get adminId(){return this._adminId}set adminId(e){this._adminId=e}get adminName(){return this._adminName}set adminName(e){this._adminName=e}get isPinned(){return this._isPinned}set isPinned(e){this._isPinned=e}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked=e}}class D0{flush(){return this._groupId=-1,this._startIndex=-1,this._amount=0,this._threads=[],!0}parse(e){if(!e)return!1;this._groupId=e.readInt(),this._startIndex=e.readInt(),this._amount=e.readInt(),this._threads=[];let t=0;for(;t<this._amount;)this._threads.push(xo.parse(e)),t++;return!0}get groupId(){return this._groupId}get startIndex(){return this._startIndex}get amount(){return this._amount}get threads(){return this._threads}}class Go{static parse(e){const t=new Go;return t._messageId=e.readInt(),t._messageIndex=e.readInt(),t._authorId=e.readInt(),t._authorName=e.readString(),t._authorFigure=e.readString(),t._creationTime=e.readInt(),t._messageText=e.readString(),t._state=e.readByte(),t._adminId=e.readInt(),t._adminName=e.readString(),t._adminOperationTimeAsSeccondsAgo=e.readInt(),t._authorPostCount=e.readInt(),t}get state(){return this._state}set state(e){this._state=e}get adminId(){return this._adminId}set adminId(e){this._adminId=e}get adminName(){return this._adminName}set adminName(e){this._adminName=e}get adminOperationTimeAsSeccondsAgo(){return this._adminOperationTimeAsSeccondsAgo}set adminOperationTimeAsSeccondsAgo(e){this._adminOperationTimeAsSeccondsAgo=e}get messageId(){return this._messageId}set messageId(e){this._messageId=e}get creationTime(){return this._creationTime}set creationTime(e){this._creationTime=e}get authorName(){return this._authorName}set authorName(e){this._authorName=e}get authorFigure(){return this._authorFigure}set authorFigure(e){this._authorFigure=e}get threadId(){return this._threadId}set threadId(e){this._threadId=e}get messageIndex(){return this._messageIndex}set messageIndex(e){this._messageIndex=e}set groupID(e){this._groupId=e}get groupId(){return this._groupId}get authorId(){return this._authorId}set authorId(e){this._authorId=e}get messageText(){return this._messageText}set messageText(e){this._messageText=e}get authorPostCount(){return this._authorPostCount}set authorPostCount(e){this._authorPostCount=e}}class L0{flush(){return this._groupId=-1,this._threadId=-1,this._message=null,!0}parse(e){return e?(this._groupId=e.readInt(),this._threadId=e.readInt(),this._message=Go.parse(e),!0):!1}get groupId(){return this._groupId}get threadId(){return this._threadId}get message(){return this._message}}class U0{flush(){return this._groupId=-1,this._thread=null,!0}parse(e){return e?(this._groupId=e.readInt(),this._thread=xo.parse(e),!0):!1}get groupId(){return this._groupId}get thread(){return this._thread}}class F0{flush(){return this._groupId=-1,this._threadId=-1,this._startIndex=-1,this._amount=0,this._messages=[],!0}parse(e){if(!e)return!1;this._groupId=e.readInt(),this._threadId=e.readInt(),this._startIndex=e.readInt(),this._amount=e.readInt(),this._messages=[];let t=0;for(;t<this._amount;){const s=Go.parse(e);s.groupID=this._groupId,s.threadId=this._threadId,this._messages.push(s),t++}return!0}get groupId(){return this._groupId}get threadId(){return this._threadId}get startIndex(){return this._startIndex}get amount(){return this._amount}get messages(){return this._messages}}class w0{flush(){return this._count=0,!0}parse(e){return e?(this._count=e.readInt(),!0):!1}get count(){return this._count}}class x0{flush(){return this._groupId=-1,this._threadId=-1,this._message=null,!0}parse(e){return e?(this._groupId=e.readInt(),this._threadId=e.readInt(),this._message=Go.parse(e),!0):!1}get groupId(){return this._groupId}get threadId(){return this._threadId}get message(){return this._message}}class G0{flush(){return this._groupId=-1,this._thread=null,!0}parse(e){return e?(this._groupId=e.readInt(),this._thread=xo.parse(e),!0):!1}get groupId(){return this._groupId}get thread(){return this._thread}}class B0{constructor(){this._encryptedPublicKey=null,this._serverClientEncryption=!1}flush(){return!0}parse(e){return e?(this._encryptedPublicKey=e.readString(),e.bytesAvailable&&(this._serverClientEncryption=e.readBoolean()),!0):!1}get encryptedPublicKey(){return this._encryptedPublicKey}get serverClientEncryption(){return this._serverClientEncryption}}class H0{flush(){return this._reason=-1,!0}parse(e){return e?(this._reason=0,e.bytesAvailable&&(this._reason=e.readInt()),!0):!1}get reason(){return this._reason}}class k0{flush(){return this._accounts&&(this._accounts=new Map),!0}parse(e){if(!e)return!1;this._accounts=new Map;let t=e.readInt();for(;t>0;)this._accounts.set(e.readInt(),e.readString()),t--;return!0}get accounts(){return this._accounts}}class V0{flush(){return!0}parse(e){return e?(this._encryptedPrime=e.readString(),this._encryptedGenerator=e.readString(),!0):!1}get encryptedPrime(){return this._encryptedPrime}get encryptedGenerator(){return this._encryptedGenerator}}class j0{flush(){return this._noobnessLevel=0,!0}parse(e){return e?(this._noobnessLevel=e.readInt(),!0):!1}get noobnessLevel(){return this._noobnessLevel}}class Y0{flush(){return!0}parse(e){return e?(this._infoUrl=e.readString(),!0):!1}get infoUrl(){return this._infoUrl}}class W0{flush(){return!0}parse(e){return!0}}class z0{flush(){return this._calls=[],!0}parse(e){this._calls=[];const t=e.readInt();for(let s=0;s<t;s++){const i=e.readString(),n=e.readString(),a=e.readString();this._calls.push({callId:i,timeStamp:n,message:a})}return!0}get pendingCalls(){return this._calls}get count(){return this._calls.length}}class X0{flush(){return this._message=null,!0}parse(e){return this._message=e.readString(),!0}get message(){return this._message}}class K0{flush(){return this._resultType=0,this._messageText=null,!0}parse(e){return e?(this._resultType=e.readInt(),this._messageText=e.readString(),!0):!1}get resultType(){return this._resultType}get messageText(){return this._messageText}}class q0{flush(){return!0}parse(e){return!0}}class Q0{flush(){return this._acceptanceTimeout=-1,!0}parse(e){return this._acceptanceTimeout=e.readInt(),!0}get acceptanceTimeout(){return this._acceptanceTimeout}}class Z0{flush(){return this._winningVoteCode=-1,this._ownVoteCode=-1,this._finalStatus=null,!0}parse(e){this._finalStatus=[],this._winningVoteCode=e.readInt(),this._ownVoteCode=e.readInt();const t=e.readInt();for(let s=0;s<t;s++)this._finalStatus.push(e.readInt());return!0}get winningVoteCode(){return this._winningVoteCode}get ownVoteCode(){return this._ownVoteCode}get finalStatus(){return this._finalStatus}}class J0{flush(){return!0}parse(e){return this._votingTimeout=e.readInt(),this._chatRecord=e.readString(),!0}get votingTimeout(){return this._votingTimeout}get chatRecord(){return this._chatRecord}}class bn{flush(){return this._status=null,!0}parse(e){this._status=[];const t=e.readInt();for(let s=0;s<t;s++)this._status.push(e.readInt());return!0}get status(){return this._status}}bn.AWAITING_VOTE=0,bn.VOTED_OK=1,bn.VOTED_BAD=2,bn.VOTED_VERY_BAD=3,bn.NO_VOTE=4,bn.FINDING_NEW_VOTER=5;class $0{flush(){return this._onDuty=!1,this._guidesOnDuty=0,this._helpersOnDuty=0,this._guardiansOnDuty=0,!0}parse(e){return e?(this._onDuty=e.readBoolean(),this._guidesOnDuty=e.readInt(),this._helpersOnDuty=e.readInt(),this._guardiansOnDuty=e.readInt(),!0):!1}get onDuty(){return this._onDuty}get guidesOnDuty(){return this._guidesOnDuty}get helpersOnDuty(){return this._helpersOnDuty}get guardiansOnDuty(){return this._guardiansOnDuty}}class eP{constructor(e,t,s,i,n,a,o){this._type=e,this._secondsAgo=t,this._isGuide=s,this._otherPartyName=i,this._otherPartyFigure=n,this._description=a,this._roomName=o}get type(){return this._type}set type(e){this._type=e}get secondsAgo(){return this._secondsAgo}set secondsAgo(e){this._secondsAgo=e}get isGuide(){return this._isGuide}set isGuide(e){this._isGuide=e}get otherPartyName(){return this._otherPartyName}set otherPartyName(e){this._otherPartyName=e}get otherPartyFigure(){return this._otherPartyFigure}set otherPartyFigure(e){this._otherPartyFigure=e}get description(){return this._description}set description(e){this._description=e}get roomName(){return this._roomName}set roomName(e){this._roomName=e}}class Bo{flush(){return this._statusCode=0,this._pendingTicket=null,!0}parse(e){return e?(this._statusCode=e.readInt(),this._pendingTicket=new eP(e.readInt(),e.readInt(),e.readBoolean(),e.readString(),e.readString(),e.readString(),e.readString()),!0):!1}get statusCode(){return this._statusCode}get pendingTicket(){return this._pendingTicket}}Bo.GUIDE_REPORTING_STATUS_OK=0,Bo.GUIDE_REPORTING_STATUS_PENDING_TICKET=1,Bo.GUIDE_REPORTING_STATUS_ABUSIVE=2,Bo.GUIDE_REPORTING_STATUS_REPORTING_TOO_QUICKLY=3;class tP{flush(){return this._asGuide=!1,this._helpRequestType=0,this._helpRequestDescription=null,this._roleSpecificWaitTime=0,!0}parse(e){return e?(this._asGuide=e.readBoolean(),this._helpRequestType=e.readInt(),this._helpRequestDescription=e.readString(),this._roleSpecificWaitTime=e.readInt(),!0):!1}get asGuide(){return this._asGuide}get helpRequestType(){return this._helpRequestType}get helpRequestDescription(){return this._helpRequestDescription}get roleSpecificWaitTime(){return this._roleSpecificWaitTime}}class sP{flush(){return!0}parse(e){return!!e}}class rP{flush(){return this._endReason=0,!0}parse(e){return e?(this._endReason=e.readInt(),!0):!1}get endReason(){return this._endReason}}class Ma{flush(){return this._errorCode=0,!0}parse(e){return e?(this._errorCode=e.readInt(),!0):!1}get errorCode(){return this._errorCode}}Ma.ERROR_GENERIC=0,Ma.ERROR_GUIDES_REJECT=1,Ma.ERROR_NOT_ENOUGH_GUIDES=2,Ma.ERROR_NOT_ENOUGH_VOTES=3,Ma.ERROR_NO_CHATLOG_FOUND=4;class iP{flush(){return this._roomId=0,this._roomName=null,!0}parse(e){return e?(this._roomId=e.readInt(),this._roomName=e.readString(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}}class nP{flush(){return this._chatMessage=null,this._senderId=0,!0}parse(e){return e?(this._chatMessage=e.readString(),this._senderId=e.readInt(),!0):!1}get chatMessage(){return this._chatMessage}get senderId(){return this._senderId}}class aP{flush(){return this._isTyping=!1,!0}parse(e){return e?(this._isTyping=e.readBoolean(),!0):!1}get isTyping(){return this._isTyping}}class oP{flush(){return this._requesterRoomId=0,!0}parse(e){return e?(this._requesterRoomId=e.readInt(),!0):!1}get requesterRoomId(){return this._requesterRoomId}}class hP{flush(){return this._requesterUserId=0,this._requesterName=null,this._requesterFigure=null,this._guideUserId=0,this._guideName=null,this._guideFigure=null,!0}parse(e){return e?(this._requesterUserId=e.readInt(),this._requesterName=e.readString(),this._requesterFigure=e.readString(),this._guideUserId=e.readInt(),this._guideName=e.readString(),this._guideFigure=e.readString(),!0):!1}get requesterUserId(){return this._requesterUserId}get requesterName(){return this._requesterName}get requesterFigure(){return this._requesterFigure}get guideUserId(){return this._guideUserId}get guideName(){return this._guideName}get guideFigure(){return this._guideFigure}}class Ho{flush(){return this._result=0,!0}parse(e){return e?(this._result=e.readInt(),!0):!1}get result(){return this._result}}Ho.CREATION_RESULT_OK=0,Ho.CREATION_RESULT_UNABLE_TO_REPORT=1,Ho.CREATION_RESULT_NO_CHATLOG_FOUND=2,Ho.CREATION_RESULT_BULLY_ALREADY_REPORTED=3;class Pu{flush(){return this._resolution=0,!0}parse(e){return e?(this._resolution=e.readInt(),!0):!1}get resolution(){return this._resolution}}Pu.RESOLUTION_GUARDIANS_TOOK_ACTION=0,Pu.RESOLUTION_FORWARDED_TO_MODERATORS=1,Pu.RESOLUTION_REPORTER_IS_ABUSIVE=2;class uP{flush(){return!0}parse(e){return!!e}}class lP{flush(){return this._closeReason=0,this._messageText="",!0}parse(e){return e?(this._closeReason=e.readInt(),this._messageText=e.readString(),!0):!1}get closeReason(){return this._closeReason}get messageText(){return this._messageText}}class cP{flush(){return this._quizCode=null,this._questionIds=[],!0}parse(e){if(!e)return!1;this._quizCode=e.readString();const t=e.readInt();this._questionIds=[];for(let s=0;s<t;s++)this._questionIds.push(e.readInt());return!0}get quizCode(){return this._quizCode}get questionIds(){return this._questionIds}}class _P{flush(){return this._quizCode=null,this._questionIdsForWrongAnswers=[],!0}parse(e){if(!e)return!1;this._quizCode=e.readString();const t=e.readInt();this._questionIdsForWrongAnswers=[];for(let s=0;s<t;s++)this._questionIdsForWrongAnswers.push(e.readInt());return!0}get quizCode(){return this._quizCode}get questionIdsForWrongAnswers(){return this._questionIdsForWrongAnswers}}class Nu{constructor(e){this._id=e.readInt(),this._title=e.readString(),this._bodyText=e.readString(),this._buttonText=e.readString(),this._linkType=e.readInt(),this._linkContent=e.readString(),this._imageUrl=e.readString()}get id(){return this._id}get title(){return this._title}get bodyText(){return this._bodyText}get buttonText(){return this._buttonText}get linkType(){return this._linkType}get linkContent(){return this._linkContent}get imageUrl(){return this._imageUrl}}Nu.LINK_TYPE_URL=0,Nu.LINK_TYPE_INTERNAL=1,Nu.LINK_TYPE_NO_LINK=2;class dP{flush(){return this._articles=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let s=0;s<t;s++)this._articles.push(new Nu(e));return!0}get articles(){return this._articles}}class fP{flush(){return!0}parse(e){return e?(this._acknowledged=e.readBoolean(),!0):!1}get acknowledged(){return this._acknowledged}}class gP{flush(){return this._newOfferId=-1,this._newPrice=0,this._requestedOfferId=-1,!0}parse(e){return e?(this._result=e.readInt(),this._newOfferId=e.readInt(),this._newPrice=e.readInt(),this._requestedOfferId=e.readInt(),!0):!1}get result(){return this._result}get offerId(){return this._newOfferId}get newPrice(){return this._newPrice}get requestedOfferId(){return this._requestedOfferId}}class EP{flush(){return this._offerId=0,this._success=!1,!0}parse(e){return e?(this._offerId=e.readInt(),this._success=e.readBoolean(),!0):!1}get offerId(){return this._offerId}get success(){return this._success}}class mP{flush(){return this._tokenCount=0,this._result=0,!0}parse(e){return e?(this._result=e.readInt(),this._tokenCount=e.readInt(),!0):!1}get tokenCount(){return this._tokenCount}get resultCode(){return this._result}}class pP{flush(){return this._enabled=!1,this._commission=0,this._credits=0,this._advertisements=0,this._maximumPrice=0,this._minimumPrice=0,this._offerTime=0,this._displayTime=0,!0}parse(e){return e?(this._enabled=e.readBoolean(),this._commission=e.readInt(),this._credits=e.readInt(),this._advertisements=e.readInt(),this._minimumPrice=e.readInt(),this._maximumPrice=e.readInt(),this._offerTime=e.readInt(),this._displayTime=e.readInt(),!0):!1}get enabled(){return this._enabled}get commission(){return this._commission}get credits(){return this._credits}get advertisements(){return this._advertisements}get minimumPrice(){return this._minimumPrice}get maximumPrice(){return this._maximumPrice}get offerTime(){return this._offerTime}get displayTime(){return this._displayTime}}class IP{flush(){return this._result=0,!0}parse(e){return e?(this._result=e.readInt(),!0):!1}get result(){return this._result}}class TP{flush(){return this._averagePrice=0,this._currentOfferCount=0,this._historyLength=0,this._dayOffsets=[],this._averagePrices=[],this._soldAmounts=[],this._furniTypeId=0,this._furniCategoryId=0,!0}parse(e){if(!e)return!1;this._averagePrice=e.readInt(),this._currentOfferCount=e.readInt(),this._historyLength=e.readInt();let t=e.readInt();for(;t>0;)this._dayOffsets.push(e.readInt()),this._averagePrices.push(e.readInt()),this._soldAmounts.push(e.readInt()),t--;return this._furniCategoryId=e.readInt(),this._furniTypeId=e.readInt(),!0}get averagePrice(){return this._averagePrice}get offerCount(){return this._currentOfferCount}get historyLength(){return this._historyLength}get dayOffsets(){return this._dayOffsets}get averagePrices(){return this._averagePrices}get soldAmounts(){return this._soldAmounts}get furniTypeId(){return this._furniTypeId}get furniCategoryId(){return this._furniCategoryId}}class xg{constructor(e,t,s,i,n,a,o,u,l,d=-1){this._timeLeftMinutes=-1,this._offerId=e,this._furniId=t,this._furniType=s,this._extraData=i,this._stuffData=n,this._price=a,this._status=o,this._timeLeftMinutes=u,this._averagePrice=l,this._offerCount=d}get offerId(){return this._offerId}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}get averagePrice(){return this._averagePrice}get offerCount(){return this._offerCount}get isUniqueLimitedItem(){return this.stuffData!=null&&this.stuffData.uniqueSeries>0}}class Gg{constructor(e,t,s,i,n,a,o,u,l=-1){this._timeLeftMinutes=-1,this._offerId=e,this._furniId=t,this._furniType=s,this._extraData=i,this._stuffData=n,this._price=a,this._status=o,this._averagePrice=u,this._offerCount=l}get offerId(){return this._offerId}set offerId(e){this._offerId=e}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}set price(e){this._price=e}get averagePrice(){return this._averagePrice}get image(){return this._image}set image(e){this._image=e}get imageCallback(){return this._imageCallback}set imageCallback(e){this._imageCallback=e}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}set timeLeftMinutes(e){this._timeLeftMinutes=e}get offerCount(){return this._offerCount}set offerCount(e){this._offerCount=e}get isUniqueLimitedItem(){return this.stuffData&&this.stuffData.uniqueSeries>0}}Gg.TYPE_LANDSCAPE=1,Gg.TYPE_FLOOR=2;class li{constructor(){this.MAX_LIST_LENGTH=500}flush(){return this._offers=[],this._totalItemsFound=0,!0}parse(e){if(!e)return!1;const t=e.readInt();let s=0;for(;s<t;){const i=e.readInt(),n=e.readInt();let a=e.readInt(),o=-1,u="",l=null;a===li.FURNITYPE_STUFF?(o=e.readInt(),l=Wi.parseObjectData(e)):a===li.FURNITYPE_WALL?(o=e.readInt(),u=e.readString()):a==li.FAKE_FURNITYPE_UNIQUE&&(o=e.readInt(),l=Fi.getData(ns.FORMAT_KEY),l.uniqueNumber=e.readInt(),l.uniqueSeries=e.readInt(),a=li.FURNITYPE_STUFF);const d=e.readInt(),c=e.readInt(),_=e.readInt(),f=e.readInt(),g=new xg(i,o,a,u,l,d,n,c,_,f);s<this.MAX_LIST_LENGTH&&this._offers.push(g),s++}return this._totalItemsFound=e.readInt(),!0}get offers(){return this._offers}get totalItemsFound(){return this._totalItemsFound}}li.FURNITYPE_STUFF=1,li.FURNITYPE_WALL=2,li.FAKE_FURNITYPE_UNIQUE=3;class bu{flush(){return this._offers=[],!0}parse(e){if(!e)return!1;this._offers=[],this._creditsWaiting=e.readInt();const t=e.readInt();for(let s=0;s<t;s++){const i=e.readInt(),n=e.readInt();let a=e.readInt(),o,u,l;a==1?(o=e.readInt(),l=this.getStuffData(e)):a==2?(o=e.readInt(),u=e.readString()):a==3&&(o=e.readInt(),l=Fi.getData(ns.FORMAT_KEY),l.uniqueNumber=e.readInt(),l.uniqueSeries=e.readInt(),a=1);const d=e.readInt(),c=e.readInt(),_=e.readInt(),f=new xg(i,o,a,u,l,d,n,c,_);s<bu.MAX_LIST_LENGTH&&this._offers.push(f)}return!0}get offers(){return this._offers}get creditsWaiting(){return this._creditsWaiting}getStuffData(e){const t=e.readInt(),s=Fi.getData(t);return s.parseWrapper(e),s}}bu.MAX_LIST_LENGTH=500;class RP{constructor(e,t,s,i,n){this._timestamp=e,this._habboId=t,this._username=s,this._message=i,this._hasHighlighting=n}get timestamp(){return this._timestamp}get userId(){return this._habboId}get userName(){return this._username}get message(){return this._message}get hasHighlighting(){return this._hasHighlighting}}class Lr{constructor(e){this._context=new Map,this._chatlog=[],this._recordType=e.readByte();const t=e.readShort();for(let i=0;i<t;i++){const n=e.readString(),a=e.readByte();switch(a){case 0:this._context.set(n,e.readBoolean());break;case 1:this._context.set(n,e.readInt());break;case 2:this._context.set(n,e.readString());break;default:throw new Error("Unknown data type "+a)}}const s=e.readShort();for(let i=0;i<s;i++){const n=e.readString(),a=e.readInt(),o=e.readString(),u=e.readString(),l=e.readBoolean();this._chatlog.push(new RP(n,a,o,u,l))}}get recordType(){return this._recordType}get context(){return this._context}get chatlog(){return this._chatlog}get roomId(){return this.getInt("roomId")}get roomName(){return this._context.get("roomName")}get groupId(){return this.getInt("groupId")}get threadId(){return this.getInt("threadId")}get messageId(){return this.getInt("messageId")}getInt(e){const t=this._context.get(e);return t||0}}Lr.TYPE_SIMPLE=0,Lr.TYPE_ROOM_CHAT=1,Lr.TYPE_IM_SESSION=2,Lr.TYPE_DISCUSSION_THREAD=3,Lr.TYPE_DISCUSSION_MESSAGE=4,Lr.TYPE_SELFIE=5,Lr.TYPE_PHOTO=6;class vP{constructor(e){this._issueId=e.readInt(),this._callerUserId=e.readInt(),this._reportedUserId=e.readInt(),this._chatRecordId=e.readInt(),this._chatRecord=new Lr(e)}get issueId(){return this._issueId}get callerUserId(){return this._callerUserId}get reportedUserId(){return this._reportedUserId}get chatRecordId(){return this._chatRecordId}get chatRecord(){return this._chatRecord}}class OP{flush(){return this._data=null,!0}parse(e){return e?(this._data=new vP(e),!0):!1}get data(){return this._data}}class SP{flush(){return!0}parse(e){return this._issueId=parseInt(e.readString()),!0}get issueId(){return this._issueId}}class ko{constructor(e,t,s,i,n,a,o,u,l,d,c,_,f,g,I,p){this._disposed=!1,this._issueId=e,this._state=t,this._categoryId=s,this._reportedCategoryId=i,this._issueAgeInMilliseconds=n,this._priority=a,this._groupingId=o,this._reporterUserId=u,this._reporterUserName=l,this._reportedUserId=d,this._reportedUserName=c,this._pickerUserId=_,this._pickerUserName=f,this._message=g,this._chatRecordId=I,this._patterns=p,this._creationTimeInMilliseconds=ve()}get issueId(){return this._issueId}get state(){return this._state}get categoryId(){return this._categoryId}get reportedCategoryId(){return this._reportedCategoryId}get issueAgeInMilliseconds(){return this._issueAgeInMilliseconds}get priority(){return this._priority}get groupingId(){return this._groupingId}get reporterUserId(){return this._reporterUserId}get reporterUserName(){return this._reporterUserName}get reportedUserId(){return this._reportedUserId}get reportedUserName(){return this._reportedUserName}get pickerUserId(){return this._pickerUserId}get pickerUserName(){return this._pickerUserName}get message(){return this._message}get chatRecordId(){return this._chatRecordId}get patterns(){return this._patterns}dispose(){if(!this.disposed){for(const e of this._patterns)e.dispose();this._patterns=[],this._disposed=!0}}get disposed(){return this._disposed}getOpenTime(e){const s=(this._issueAgeInMilliseconds+e-this._creationTimeInMilliseconds)/1e3/60,i=s%60,n=s/60,a=(i<10?"0":"")+i;return(n<10?"0":"")+n+":"+a}}ko.STATE_OPEN=1,ko.STATE_PICKED=2,ko.STATE_CLOSED=3;class AP{constructor(e){this._disposed=!1,this._pattern=e.readString(),this._startIndex=e.readInt(),this._endIndex=e.readInt()}dispose(){this._disposed=!0,this._pattern="",this._startIndex=-1,this._endIndex=-1}get disposed(){return this._disposed}get pattern(){return this._pattern}get startIndex(){return this._startIndex}get endIndex(){return this._endIndex}}class Bg{get issueData(){return this._issueData}flush(){return this._issueData=null,!0}parse(e){const t=e.readInt(),s=e.readInt(),i=e.readInt(),n=e.readInt(),a=e.readInt(),o=e.readInt(),u=e.readInt(),l=e.readInt(),d=e.readString(),c=e.readInt(),_=e.readString(),f=e.readInt(),g=e.readString(),I=e.readString(),p=e.readInt(),R=e.readInt(),S=[];for(let O=0;O<R;O++)S.push(new AP(e));return this._issueData=new ko(t,s,i,n,a,o,u,l,d,c,_,f,g,I,p,S),!0}}class yP{flush(){return this._issues=null,!0}parse(e){this._issues=[];const t=e.readInt();for(let s=0;s<t;s++){const i=e.readInt(),n=e.readInt(),a=e.readString(),o=new ko(i,0,0,0,0,0,0,0,null,0,null,n,a,null,0,[]);this._issues.push(o)}return this._retryEnabled=e.readBoolean(),this._retryCount=e.readInt(),!0}get issues(){return this._issues}get retryEnabled(){return this._retryEnabled}get retryCount(){return this._retryCount}}class CP{flush(){return this._message="",this._url=null,!0}parse(e){return e?(this._message=e.readString(),this._url=e.readString(),!0):!1}get message(){return this._message}get url(){return this._url}}class MP{flush(){return this._userId=-1,this._success=!1,!0}parse(e){return this._userId=e.readInt(),this._success=e.readBoolean(),!0}get userId(){return this._userId}get success(){return this._success}}class PP{constructor(e){this._disposed=!1;const t=new Bg;this._issues=[],this._messageTemplates=[],this._roomMessageTemplates=[];let s=e.readInt(),i=0;for(;i<s;)t.parse(e)&&this._issues.push(t.issueData),i++;for(s=e.readInt(),i=0;i<s;)this._messageTemplates.push(e.readString()),i++;for(s=e.readInt(),i=0;i<s;)e.readString(),i++;for(this._cfhPermission=e.readBoolean(),this._chatlogsPermission=e.readBoolean(),this._alertPermission=e.readBoolean(),this._kickPermission=e.readBoolean(),this._banPermission=e.readBoolean(),this._roomAlertPermission=e.readBoolean(),this._roomKickPermission=e.readBoolean(),s=e.readInt(),i=0;i<s;)this._roomMessageTemplates.push(e.readString()),i++}dispose(){this._disposed||(this._disposed=!0,this._messageTemplates=null,this._roomMessageTemplates=null,this._issues=null)}get disposed(){return this._disposed}get messageTemplates(){return this._messageTemplates}get roomMessageTemplates(){return this._roomMessageTemplates}get issues(){return this._issues}get cfhPermission(){return this._cfhPermission}get chatlogsPermission(){return this._chatlogsPermission}get alertPermission(){return this._alertPermission}get kickPermission(){return this._kickPermission}get banPermission(){return this._banPermission}get roomAlertPermission(){return this._roomAlertPermission}get roomKickPermission(){return this._roomKickPermission}}class NP{constructor(){this._data=null}flush(){return this._data=null,!0}parse(e){return this._data=new PP(e),!0}get data(){return this._data}}class bP{flush(){return this._message="",this._url="",!0}parse(e){return e?(this._message=e.readString(),this._url=e.readString(),!0):!1}get message(){return this._message}get url(){return this._url}}class DP{constructor(e){if(this._tags=[],this._exists=e.readBoolean(),!this.exists)return;this._name=e.readString(),this._desc=e.readString();const t=e.readInt();for(let s=0;s<t;s++)this._tags.push(e.readString())}get name(){return this._name}get desc(){return this._desc}get tags(){return this._tags}get exists(){return this._exists}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._tags=null)}}class LP{constructor(e){this._flatId=e.readInt(),this._userCount=e.readInt(),this._ownerInRoom=e.readBoolean(),this._ownerId=e.readInt(),this._ownerName=e.readString(),this._room=new DP(e)}get flatId(){return this._flatId}get userCount(){return this._userCount}get ownerInRoom(){return this._ownerInRoom}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get room(){return this._room}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._room!=null&&(this._room.dispose(),this._room=null))}}class UP{flush(){return this._data=null,!0}parse(e){return e?(this._data=new LP(e),!0):!1}get data(){return this._data}}class FP{flush(){return this._windowX=0,this._windowY=0,this._windowWidth=0,this._windowHeight=0,!0}parse(e){return this._windowX=e.readInt(),this._windowY=e.readInt(),this._windowWidth=e.readInt(),this._windowHeight=e.readInt(),!0}get windowX(){return this._windowX}get windowY(){return this._windowY}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}}class wP{constructor(e){this._lastSanctionTime="",this._sanctionAgeHours=0,this._userId=e.readInt(),this._userName=e.readString(),this._figure=e.readString(),this._registrationAgeInMinutes=e.readInt(),this._minutesSinceLastLogin=e.readInt(),this._online=e.readBoolean(),this._cfhCount=e.readInt(),this._abusiveCfhCount=e.readInt(),this._cautionCount=e.readInt(),this._banCount=e.readInt(),this._tradingLockCount=e.readInt(),this._tradingExpiryDate=e.readString(),this._lastPurchaseDate=e.readString(),this._identityId=e.readInt(),this._identityRelatedBanCount=e.readInt(),this._primaryEmailAddress=e.readString(),this._userClassification=e.readString(),e.bytesAvailable&&(this._lastSanctionTime=e.readString(),this._sanctionAgeHours=e.readInt())}get userId(){return this._userId}get userName(){return this._userName}get figure(){return this._figure}get registrationAgeInMinutes(){return this._registrationAgeInMinutes}get minutesSinceLastLogin(){return this._minutesSinceLastLogin}get online(){return this._online}get cfhCount(){return this._cfhCount}get abusiveCfhCount(){return this._abusiveCfhCount}get cautionCount(){return this._cautionCount}get banCount(){return this._banCount}get tradingLockCount(){return this._tradingLockCount}get tradingExpiryDate(){return this._tradingExpiryDate}get lastPurchaseDate(){return this._lastPurchaseDate}get identityId(){return this._identityId}get identityRelatedBanCount(){return this._identityRelatedBanCount}get primaryEmailAddress(){return this._primaryEmailAddress}get userClassification(){return this._userClassification}get lastSanctionTime(){return this._lastSanctionTime}get sanctionAgeHours(){return this._sanctionAgeHours}}class xP{flush(){return this._data=null,!0}parse(e){return e?(this._data=new wP(e),!0):!1}get data(){return this._data}}class GP{flush(){return this._data=null,!0}parse(e){return e?(this._data=new Lr(e),!0):!1}get data(){return this._data}}class BP{constructor(e){this._roomId=e.readInt(),this._roomName=e.readString(),this._enterHour=e.readInt(),this._enterMinute=e.readInt()}get roomId(){return this._roomId}get roomName(){return this._roomName}get enterHour(){return this._enterHour}get enterMinute(){return this._enterMinute}}class HP{constructor(e){this._rooms=[],this._userId=e.readInt(),this._userName=e.readString();const t=e.readInt();let s=0;for(;s<t;)this._rooms.push(new BP(e)),s++}get userId(){return this._userId}get userName(){return this._userName}get rooms(){return this._rooms}}class kP{flush(){return!0}parse(e){return this._data=new HP(e),!0}get data(){return this._data}}class VP{flush(){return this._message="",!0}parse(e){return e?(this._message=e.readString(),!0):!1}get message(){return this._message}}class jP{constructor(e){this._roomChatlogs=[],this._userId=e.readInt(),this._username=e.readString();const t=e.readInt();for(let s=0;s<t;s++)this._roomChatlogs.push(new Lr(e))}get userId(){return this._userId}get username(){return this._username}get roomChatlogs(){return this._roomChatlogs}}class YP{flush(){return this._data=null,!0}parse(e){return e?(this._data=new jP(e),!0):!1}get data(){return this._data}}class WP{flush(){return!0}parse(e){return!!e}}class zP{flush(){return!0}parse(e){return e?(this._contentType=e.readString(),this._classId=e.readInt(),!0):!1}get contentType(){return this._contentType}get classId(){return this._classId}}class XP{flush(){return this._boxColor=null,this._keyColor=null,!0}parse(e){return e?(this._boxColor=e.readString(),this._keyColor=e.readString(),!0):!1}get boxColor(){return this._boxColor}get keyColor(){return this._keyColor}}class KP{flush(){return!0}parse(e){return!!e}}class qP{flush(){return this._canCreate=!1,this._errorCode=0,!0}parse(e){return e?(this._canCreate=e.readBoolean(),this._errorCode=e.readInt(),!0):!1}get canCreate(){return this._canCreate}get errorCode(){return this._errorCode}}class Wc{flush(){return!0}parse(e){return e?(this._resultCode=e.readInt(),this._roomLimit=e.readInt(),!0):!1}get resultCode(){return this._resultCode}get roomLimit(){return this._roomLimit}}Wc.CREATION_ALLOWED=0,Wc.ROOM_LIMIT_REACHED=1;class QP{constructor(e){this._categoryToCurrentUserCountMap=new Map,this._categoryToMaxUserCountMap=new Map;const t=e.readInt();for(let s=0;s<t;s++){const i=e.readInt(),n=e.readInt(),a=e.readInt();this._categoryToCurrentUserCountMap.set(i,n),this._categoryToMaxUserCountMap.set(i,a)}}get categoryToCurrentUserCountMap(){return this._categoryToCurrentUserCountMap}get categoryToMaxUserCountMap(){return this._categoryToMaxUserCountMap}}class ZP{constructor(e,t=0,s=0){this._goalId=t,this._pageIndex=s,e&&(this._goalId=e.readInt(),this._pageIndex=e.readInt(),this._pageCount=e.readInt())}get goalId(){return this._goalId}get pageIndex(){return this._pageIndex}get pageCount(){return this._pageCount}}class ci{constructor(e){this._index=e.readInt(),this._popupCaption=e.readString(),this._popupDesc=e.readString(),this._showDetails=e.readInt()==1,this._picText=e.readString(),this._picRef=e.readString(),this._folderId=e.readInt(),this._userCount=e.readInt(),this._type=e.readInt(),this._type==ci.TYPE_TAG?this._tag=e.readString():this._type==ci.TYPE_GUEST_ROOM?this._guestRoomData=new It(e):this._open=e.readBoolean()}dispose(){this._disposed||(this._disposed=!0,this._guestRoomData!=null&&(this._guestRoomData.flush(),this._guestRoomData=null))}get disposed(){return this._disposed}get type(){return this._type}get index(){return this._index}get popupCaption(){return this._popupCaption}get popupDesc(){return this._popupDesc}get showDetails(){return this._showDetails}get picText(){return this._picText}get picRef(){return this._picRef}get folderId(){return this._folderId}get tag(){return this._tag}get userCount(){return this._userCount}get guestRoomData(){return this._guestRoomData}get open(){return this._open}toggleOpen(){this._open=!this._open}get maxUsers(){return this.type==ci.TYPE_TAG?0:this.type==ci.TYPE_GUEST_ROOM?this._guestRoomData.maxUserCount:0}}ci.TYPE_TAG=1,ci.TYPE_GUEST_ROOM=2,ci.TYPE_FOLDER=4;class JP{constructor(e){this._rooms=[],this._searchType=e.readInt(),this._searchParam=e.readString();const t=e.readInt();for(let i=0;i<t;i++)this._rooms.push(new It(e));e.readBoolean()&&(this._ad=new ci(e))}dispose(){if(!this._disposed){if(this._disposed=!0,this._rooms!=null)for(const e of this._rooms)e.flush();this._ad!=null&&(this._ad.dispose(),this._ad=null),this._rooms=null}}get disposed(){return this._disposed}get searchType(){return this._searchType}get searchParam(){return this._searchParam}get rooms(){return this._rooms}get ad(){return this._ad}}class Hg{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._id=-1,this._code=null,this._filter=null,this._localization=null,!0}parse(e){return e?(this._id=e.readInt(),this._code=e.readString(),this._filter=e.readString(),this._localization=e.readString(),!0):!1}get id(){return this._id}get code(){return this._code}get filter(){return this._filter}get localization(){return this._localization}}class $P{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._code=null,this._data=null,this._action=-1,this._closed=!1,this._mode=-1,this._rooms=[],!0}parse(e){if(!e)return!1;this._code=e.readString(),this._data=e.readString(),this._action=e.readInt(),this._closed=e.readBoolean(),this._mode=e.readInt();let t=e.readInt();for(;t>0;)this._rooms.push(new It(e)),t--;return!0}get code(){return this._code}get data(){return this._data}get action(){return this._action}get closed(){return this._closed}get mode(){return this._mode}get rooms(){return this._rooms}}class eN{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._code=null,this._data=null,this._results=[],!0}parse(e){if(!e)return!1;this._code=e.readString(),this._data=e.readString();let t=e.readInt();for(;t>0;)this._results.push(new $P(e)),t--;return!0}get code(){return this._code}get data(){return this._data}get results(){return this._results}}class tN{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._code=null,this._savedSearches=[],!0}parse(e){if(!e)return!1;this._code=e.readString();let t=e.readInt();for(;t>0;)this._savedSearches.push(new Hg(e)),t--;return!0}get code(){return this._code}get savedSearches(){return this._savedSearches}}class sN{constructor(e){this._adId=e.readInt(),this._ownerAvatarId=e.readInt(),this._ownerAvatarName=e.readString(),this._flatId=e.readInt(),this._eventType=e.readInt(),this._eventName=e.readString(),this._eventDescription=e.readString();const t=e.readInt(),s=e.readInt(),i=new Date;let n=i.getTime();const a=t*60*1e3;n=n-a;const o=new Date(n);this._creationTime=o.getDate()+"-"+o.getMonth()+"-"+o.getFullYear()+" "+o.getHours()+":"+o.getMinutes();let u=i.getTime();const l=s*60*1e3;u=u+l,this._expirationDate=new Date(u),this._categoryId=e.readInt()}dispose(){this._disposed||(this._disposed=!0)}get disposed(){return this._disposed}get adId(){return this._adId}get ownerAvatarId(){return this._ownerAvatarId}get ownerAvatarName(){return this._ownerAvatarName}get flatId(){return this._flatId}get categoryId(){return this._categoryId}get eventType(){return this._eventType}get eventName(){return this._eventName}get eventDescription(){return this._eventDescription}get creationTime(){return this._creationTime}get expirationDate(){return this._expirationDate}}class rN{flush(){return!0}parse(e){return e?(this._data=new QP(e),!0):!1}get data(){return this._data}}class iN{flush(){return!0}parse(e){return e?(this._data=new ZP(e),!0):!1}get data(){return this._data}}class nN{flush(){return!0}parse(e){return e?(this._globalId=e.readString(),this._convertedId=e.readInt(),!0):!1}get globalId(){return this._globalId}get convertedId(){return this._convertedId}}class aN{flush(){return this._userName=null,!0}parse(e){return e?(this._userName=e.readString(),!0):!1}get userName(){return this._userName}}class oN{flush(){return!0}parse(e){return e?(this._flatId=e.readInt(),this._added=e.readBoolean(),!0):!1}get flatId(){return this._flatId}get added(){return this._added}}class hN{flush(){return!0}parse(e){if(!e)return!1;this._favouriteRoomIds=[],this._limit=e.readInt();const t=e.readInt();for(let s=0;s<t;s++)this._favouriteRoomIds.push(e.readInt());return!0}get limit(){return this._limit}get favoriteRoomIds(){return this._favouriteRoomIds}}class uN{flush(){return this._userName=null,!0}parse(e){return e?(this._userName=e.readString(),!0):!1}get userName(){return this._userName}}class lN{flush(){return this._roomId=-1,this._roomName=null,!0}parse(e){return e?(this._roomId=e.readInt(),this._roomName=e.readString(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}}class cN{flush(){return this._roomEnter=!1,this._roomForward=!1,this._data=null,this._staffPick=!1,this._isGroupMember=!1,this._moderation=null,this._chat=null,!0}parse(e){return e?(this._roomEnter=e.readBoolean(),this._data=new It(e),this._roomForward=e.readBoolean(),this._staffPick=e.readBoolean(),this._isGroupMember=e.readBoolean(),this.data.allInRoomMuted=e.readBoolean(),this._moderation=new Lo(e),this.data.canMute=e.readBoolean(),this._chat=new Cs(e),!0):!1}get roomEnter(){return this._roomEnter}get roomForward(){return this._roomForward}get data(){return this._data}get staffPick(){return this._staffPick}get isGroupMember(){return this._isGroupMember}get moderation(){return this._moderation}get chat(){return this._chat}}class _N{flush(){return!0}parse(e){return e?(this._data=new JP(e),!0):!1}get data(){return this._data}}class dN{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._id=-1,this._name=null,this._visible=!1,this._automatic=!1,this._automaticCategoryKey=null,this._globalCategoryKey=null,this._staffOnly=!1,!0}parse(e){return e?(this._id=e.readInt(),this._name=e.readString(),this._visible=e.readBoolean(),this._automatic=e.readBoolean(),this._automaticCategoryKey=e.readString(),this._globalCategoryKey=e.readString(),this._staffOnly=e.readBoolean(),!0):!1}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}get automatic(){return this._automatic}get automaticCategoryKey(){return this._automaticCategoryKey}get globalCategoryKey(){return this._globalCategoryKey}get staffOnly(){return this._staffOnly}}class fN{flush(){return this._categories=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._categories.push(e.readString()),t--;return!0}get categories(){return this._categories}}class gN{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._id=-1,this._name=null,this._visible=!1,!0}parse(e){return e?(this._id=e.readInt(),this._name=e.readString(),this._visible=e.readBoolean(),!0):!1}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}}class EN{flush(){return this._homeRoomId=-1,this._roomIdToEnter=-1,!0}parse(e){return e?(this._homeRoomId=e.readInt(),this._roomIdToEnter=e.readInt(),!0):!1}get homeRoomId(){return this._homeRoomId}get roomIdToEnter(){return this._roomIdToEnter}}class mN{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._roomId=-1,this._areaId=-1,this._image=null,this._caption=null,!0}parse(e){return e?(this._roomId=e.readInt(),this._areaId=e.readInt(),this._image=e.readString(),this._caption=e.readString(),!0):!1}get roomId(){return this._roomId}get areaId(){return this._areaId}get image(){return this._image}get caption(){return this._caption}}class pN{flush(){return this._rooms=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._rooms.push(new mN(e)),t--;return!0}get rooms(){return this._rooms}}class IN{flush(){return this._topLevelContexts=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._topLevelContexts.push(new tN(e)),t--;return!0}get topLevelContexts(){return this._topLevelContexts}}class TN{flush(){return!0}parse(e){return!!e}}class RN{flush(){return this._searches=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._searches.push(new Hg(e)),t--;return!0}get searches(){return this._searches}}class vN{flush(){return this._result=null,!0}parse(e){return e?(this._result=new eN(e),!0):!1}get result(){return this._result}}class ON{flush(){return this._windowX=0,this._windowY=0,this._windowWidth=0,this._windowHeight=0,this._leftPanelHidden=!1,this._resultsMode=0,!0}parse(e){return e?(this._windowX=e.readInt(),this._windowY=e.readInt(),this._windowWidth=e.readInt(),this._windowHeight=e.readInt(),this._leftPanelHidden=e.readBoolean(),this._resultsMode=e.readInt(),!0):!1}get windowX(){return this._windowX}get windowY(){return this._windowY}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}get leftPanelHidden(){return this._leftPanelHidden}get resultsMode(){return this._resultsMode}}class SN{constructor(e){this._tagName=e.readString(),this._userCount=e.readInt()}get tagName(){return this._tagName}get userCount(){return this._userCount}}class AN{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._tags=[],!0}parse(e){if(!e)return!1;this._tags=[];const t=e.readInt();let s=0;for(;s<t;)this._tags.push(new SN(e)),s++;return!0}get tags(){return this._tags}}class yN{flush(){return this._data=null,!0}parse(e){return e?(this._data=new AN(e),!0):!1}get data(){return this._data}}class CN{flush(){return!0}parse(e){return!0}}class MN{flush(){return!0}parse(e){return this._data=new sN(e),!0}get data(){return this._data}}class PN{flush(){return this._words=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._words.push(e.readString()),t--;return!0}get words(){return this._words}}class NN{flush(){return this._roomId=0,!0}parse(e){return e?(this._roomId=e.readInt(),!0):!1}get roomId(){return this._roomId}}class bN{flush(){return!0}parse(e){return this._flatId=e.readInt(),this._resultCode=e.readInt(),!0}get flatId(){return this._flatId}get resultCode(){return this._resultCode}}class DN{flush(){return this._categories=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._categories.push(new gN(e)),t--;return!0}get categories(){return this._categories}}class LN{flush(){return this._categories=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._categories.push(new dN(e)),t--;return!0}get categories(){return this._categories}}class UN{constructor(e){this._badgeCode="",this._removedBadgeCode="",this._type=e.readInt(),this._level=e.readInt(),this._badgeId=e.readInt(),this._badgeCode=e.readString(),this._points=e.readInt(),this._levelRewardPoints=e.readInt(),this._levelRewardPointType=e.readInt(),this._bonusPoints=e.readInt(),this._achievementID=e.readInt(),this._removedBadgeCode=e.readString(),this._category=e.readString(),this._showDialogToUser=e.readBoolean()}get type(){return this._type}get level(){return this._level}get points(){return this._points}get levelRewardPoints(){return this._levelRewardPoints}get levelRewardPointType(){return this._levelRewardPointType}get bonusPoints(){return this._bonusPoints}get badgeId(){return this._badgeId}get badgeCode(){return this._badgeCode}get removedBadgeCode(){return this._removedBadgeCode}get achievementID(){return this._achievementID}get category(){return this._category}get showDialogToUser(){return this._showDialogToUser}}class FN{flush(){return this._data=null,!0}parse(e){return e?(this._data=new UN(e),!0):!1}get data(){return this._data}}class wN{flush(){return this._amount=0,this._amountChanged=0,this._type=-1,!0}parse(e){return e?(this._amount=e.readInt(),this._amountChanged=e.readInt(),this._type=e.readInt(),!0):!1}get amount(){return this._amount}get amountChanged(){return this._amountChanged}get type(){return this._type}}class xN{flush(){return this._errorCode=-1,!0}parse(e){return e?(this._errorCode=e.readInt(),!0):!1}get errorCode(){return this._errorCode}}class GN{flush(){return this._numGifts=0,!0}parse(e){return e?(this._numGifts=e.readInt(),!0):!1}get numGifts(){return this._numGifts}}class BN{flush(){return this._errorCode=0,this._messageId=0,this._timestamp=null,!0}parse(e){return e?(this._messageId=e.readInt(),this._errorCode=e.readInt(),this._timestamp=e.readString(),!0):!1}get errorCode(){return this._errorCode}get messageId(){return this._messageId}get timestamp(){return this._timestamp}}class HN{flush(){return this._key=null,!0}parse(e){return e?(this._key=e.readString(),!0):!1}get key(){return this._key}}class kN{flush(){return this._message=null,!0}parse(e){return e?(this._message=e.readString(),!0):!1}get message(){return this._message}}class VN{flush(){return this._minutes=null,!0}parse(e){return e?(this._minutes=e.readInt(),!0):!1}get minutes(){return this._minutes}}class jN{flush(){return this._enabled=!1,!0}parse(e){return e?(this._enabled=e.readBoolean(),!0):!1}get enabled(){return this._enabled}}class YN{flush(){return this._messages=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._messages.push(e.readString()),t--;return!0}get messages(){return this._messages}}class WN{flush(){return this._type=null,this._parameters=new Map,!0}parse(e){if(!e)return!1;this._type=e.readString();let t=e.readInt();for(;t>0;)this._parameters.set(e.readString(),e.readString()),t--;return!0}get type(){return this._type}get parameters(){return this._parameters}}class zN{flush(){return this._contentType=null,this._classId=0,this._name=null,this._description=null,!0}parse(e){return e?(this._contentType=e.readString(),this._classId=e.readInt(),this._name=e.readString(),this._description=e.readString(),!0):!1}get contentType(){return this._contentType}get classId(){return this._classId}get name(){return this._name}get description(){return this._description}}class XN{flush(){return this._petId=-1,this._petName=null,this._level=0,this._figureData=null,!0}parse(e){return e?(this._petId=e.readInt(),this._petName=e.readString(),this._level=e.readInt(),this._figureData=new Hc(e),!0):!1}get petId(){return this._petId}get petName(){return this._petName}get level(){return this._level}get figureData(){return this._figureData}}class KN{flush(){return this._errorCode=-1,!0}parse(e){return e?(this._errorCode=e.readInt(),!0):!1}get errorCode(){return this._errorCode}}class qN{flush(){return!0}parse(e){return!0}}class QN{flush(){return this._alertMessage=null,!0}parse(e){return e?(this._alertMessage=e.readString(),e.bytesAvailable&&(this._titleMessage=e.readString()),!0):!1}get alertMessage(){return this._alertMessage}get titleMessage(){return this._titleMessage}}class ZN{flush(){return this._items=new Ot,!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const s=e.readInt();let i=e.readInt();const n=[];for(;i>0;)n.push(e.readInt()),i--;this._items.add(s,n),t--}return!0}getItemsByCategory(e){return this._items.getValue(e)}get categories(){return this._items.getKeys()}}class JN{constructor(e,t,s){this._code=e,this._errorMessage=t,this._isAllowed=s}get code(){return this._code}get errorMessage(){return this._errorMessage}get isAllowed(){return this._isAllowed}}class Js{}Js.USE_GUIDE_TOOL="USE_GUIDE_TOOL",Js.GIVE_GUIDE_TOUR="GIVE_GUIDE_TOUR",Js.JUDGE_CHAT_REVIEWS="JUDGE_CHAT_REVIEWS",Js.VOTE_IN_COMPETITIONS="VOTE_IN_COMPETITIONS",Js.CALL_ON_HELPERS="CALL_ON_HELPERS",Js.CITIZEN="CITIZEN",Js.TRADE="TRADE",Js.HEIGHTMAP_EDITOR_BETA="HEIGHTMAP_EDITOR_BETA",Js.BUILDER_AT_WORK="BUILDER_AT_WORK",Js.NAVIGATOR_ROOM_THUMBNAIL_CAMERA="NAVIGATOR_ROOM_THUMBNAIL_CAMERA",Js.CAMERA="CAMERA",Js.MOUSE_ZOOM="MOUSE_ZOOM";class $N{flush(){return this._perks=[],!0}parse(e){if(!e)return!1;this._perks=[];const t=e.readInt();for(let s=0;s<t;s++)this._perks.push(new JN(e.readString(),e.readString(),e.readBoolean()));return!0}isAllowed(e){let t=!1;for(const s of this._perks)if(s.code===e){t=s.isAllowed;break}return t}get perks(){return this._perks}}class eb{flush(){return this._objectId=-1,this._figureData=null,!0}parse(e){return this._objectId=e.readInt(),e.bytesAvailable&&(this._figureData=new ul(e.readString())),!0}get objectId(){return this._objectId}get figureData(){return this._figureData}}class tb{flush(){return this._objectId=0,this._nameValidationStatus=0,this._nameValidationInfo=null,!0}parse(e){return this._objectId=e.readInt(),this._nameValidationStatus=e.readInt(),this._nameValidationInfo=e.readString(),!0}get objectId(){return this._objectId}get nameValidationStatus(){return this._nameValidationStatus}get nameValidationInfo(){return this._nameValidationInfo}}class sb{flush(){return this._roomIndex=-1,this._petId=-1,this._level=-1,!0}parse(e){return this._roomIndex=e.readInt(),this._petId=e.readInt(),this._level=e.readInt(),!0}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get level(){return this._level}}class rb{flush(){return this._currentAge=-1,this._requiredAge=-1,!0}parse(e){return this._currentAge=e.readInt(),this._requiredAge=e.readInt(),!0}get currentAge(){return this._currentAge}get requiredAge(){return this._requiredAge}}class ib{flush(){return this._petId=-1,this._commands=[],this._enabledCommands=[],!0}parse(e){this._petId=e.readInt();let t=e.readInt();for(;t>0;)this._commands.push(e.readInt()),t--;let s=e.readInt();for(;s>0;)this._enabledCommands.push(e.readInt()),s--;return!0}get petId(){return this._petId}get commands(){return this._commands}get enabledCommands(){return this._enabledCommands}}class nb{constructor(e,t,s){this._value=e,this._choiceText=t,this._choiceType=s}get value(){return this._value}set value(e){this._value=e}get choiceText(){return this._choiceText}set choiceText(e){this._choiceText=e}get choiceType(){return this._choiceType}set choiceType(e){this._choiceType=e}}class ab{constructor(){this._children=[],this._questionChoices=[]}get questionId(){return this._questionId}set questionId(e){this._questionId=e}get questionType(){return this._questionType}set questionType(e){this._questionType=e}get sortOrder(){return this._sortOrder}set sortOrder(e){this._sortOrder=e}get questionText(){return this._questionText}set questionText(e){this._questionText=e}get questionCategory(){return this._questionCategory}set questionCategory(e){this._questionCategory=e}get questionAnswerType(){return this._questionAnswerType}set questionAnswerType(e){this._questionAnswerType=e}get questionAnswerCount(){return this._questionAnswerCount}set questionAnswerCount(e){this._questionAnswerCount=e}get children(){return this._children}set children(e){this._children=e}get questionChoices(){return this._questionChoices}set questionChoices(e){this._questionChoices=e}}class ob{constructor(){this._id=-1,this._startMessage="",this._endMessage="",this._numQuestions=0,this._questionArray=[],this._npsPoll=!1}flush(){return this._id=-1,this._startMessage="",this._endMessage="",this._numQuestions=0,this._questionArray=[],!0}parse(e){this._id=e.readInt(),this._startMessage=e.readString(),this._endMessage=e.readString(),this._numQuestions=e.readInt();for(let t=0;t<this._numQuestions;t++){const s=this.parsePollQuestion(e),i=e.readInt();for(let n=0;n<i;n++)s.children.push(this.parsePollQuestion(e));this._questionArray.push(s)}return this._npsPoll=e.readBoolean(),!0}parsePollQuestion(e){const t=new ab;if(t.questionId=e.readInt(),t.sortOrder=e.readInt(),t.questionType=e.readInt(),t.questionText=e.readString(),t.questionCategory=e.readInt(),t.questionAnswerType=e.readInt(),t.questionAnswerCount=e.readInt(),t.questionType==1||t.questionType==2)for(let s=0;s<t.questionAnswerCount;s++)t.questionChoices.push(new nb(e.readString(),e.readString(),e.readInt()));return t}get id(){return this._id}get startMessage(){return this._startMessage}get endMessage(){return this._endMessage}get numQuestions(){return this._numQuestions}get questionArray(){return this._questionArray}get npsPoll(){return this._npsPoll}}class hb{flush(){throw!0}parse(e){return!0}}class ub{constructor(){this._id=-1,this._type="",this._headline="",this._summary=""}flush(){return this._id=-1,this._type="",this._summary="",!0}parse(e){return this._id=e.readInt(),this._type=e.readString(),this._headline=e.readString(),this._summary=e.readString(),!0}get id(){return this._id}get type(){return this._type}get headline(){return this._headline}get summary(){return this._summary}}class lb{flush(){return this._userId=-1,this._value="",this._answerCounts=null,!0}parse(e){this._userId=e.readInt(),this._value=e.readString(),this._answerCounts=new Map;const t=e.readInt();for(let s=0;s<t;s++){const i=e.readString(),n=e.readInt();this._answerCounts.set(i,n)}return!0}get userId(){return this._userId}get value(){return this._value}get answerCounts(){return this._answerCounts}}class cb{flush(){return this._questionId=-1,this._answerCounts=null,!0}parse(e){this._questionId=e.readInt(),this._answerCounts=new Map;const t=e.readInt();for(let s=0;s<t;s++){const i=e.readString(),n=e.readInt();this._answerCounts.set(i,n)}return!0}get questionId(){return this._questionId}get answerCounts(){return this._answerCounts}}class _b{constructor(){this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null}flush(){return this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null,!0}parse(e){this._pollType=e.readString(),this._pollId=e.readInt(),this._questionId=e.readInt(),this._duration=e.readInt();const t=e.readInt(),s=e.readInt(),i=e.readInt(),n=e.readString();if(this._question={id:t,number:s,type:i,content:n},this._question.type==1||this._question.type==2){this._question.selection_min=e.readInt();const a=e.readInt();this._question.selections=[],this._question.selection_values=[],this._question.selection_count=a,this._question.selection_max=a;for(let o=0;o<a;o++)this._question.selection_values.push(e.readString()),this._question.selections.push(e.readString())}return!0}get pollType(){return this._pollType}get pollId(){return this._pollId}get questionId(){return this._questionId}get duration(){return this._duration}get question(){return this._question}}class db{flush(){return this._question=null,this._choices=[],this._SafeStr_7651=[],this._SafeStr_7654=-1,!0}parse(e){this._question=e.readString(),this._choices=[],this._SafeStr_7651=[];let t=e.readInt();for(;t>0;)this._choices.push(e.readString()),this._SafeStr_7651.push(e.readInt()),t--;return this._SafeStr_7654=e.readInt(),!0}get question(){return this._question}get choices(){return this._choices}get SafeStr_7651(){return this._SafeStr_7651}get SafeStr_7654(){return this._SafeStr_7654}}class fb{flush(){return this._question=null,this._choices=[],!0}parse(e){this._question=e.readString(),this._choices=[];const t=e.readInt();let s=0;for(;s<t;)this._choices.push(e.readString()),s++;return!0}get question(){return this._question}get choices(){return this._choices.slice()}}class gb{constructor(e){this._rewardUserLimits=[],this._hasGoalExpired=e.readBoolean(),this._personalContributionScore=e.readInt(),this._personalContributionRank=e.readInt(),this._communityTotalScore=e.readInt(),this._communityHighestAchievedLevel=e.readInt(),this._scoreRemainingUntilNextLevel=e.readInt(),this._percentCompletionTowardsNextLevel=e.readInt(),this._goalCode=e.readString(),this._timeRemainingInSeconds=e.readInt();const t=e.readInt();for(let s=0;s<t;s++)this._rewardUserLimits.push(e.readInt())}dispose(){this._rewardUserLimits=null}get disposed(){return this._rewardUserLimits==null}get hasGoalExpired(){return this._hasGoalExpired}get personalContributionScore(){return this._personalContributionScore}get personalContributionRank(){return this._personalContributionRank}get communityTotalScore(){return this._communityTotalScore}get communityHighestAchievedLevel(){return this._communityHighestAchievedLevel}get scoreRemainingUntilNextLevel(){return this._scoreRemainingUntilNextLevel}get percentCompletionTowardsNextLevel(){return this._percentCompletionTowardsNextLevel}get timeRemainingInSeconds(){return this._timeRemainingInSeconds}get rewardUserLimits(){return this._rewardUserLimits}get goalCode(){return this._goalCode}}class Eb{constructor(e){this._communityGoalId=e.readInt(),this._communityGoalCode=e.readString(),this._userRank=e.readInt(),this._rewardCode=e.readString(),this._badge=e.readBoolean(),this._localizedName=e.readString()}get communityGoalId(){return this._communityGoalId}get communityGoalCode(){return this._communityGoalCode}get userRank(){return this._userRank}get rewardCode(){return this._rewardCode}get badge(){return this._badge}get localizedName(){return this._localizedName}}class mb{flush(){return this._prizes=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let s=0;s<t;s++)this._prizes.push(new Eb(e));return!0}get prizes(){return this._prizes}}class pb{constructor(e){this._userId=e.readInt(),this._userName=e.readString(),this._figure=e.readString(),this._rank=e.readInt(),this._currentScore=e.readInt()}get userId(){return this._userId}get userName(){return this._userName}get figure(){return this._figure}get rank(){return this._rank}get currentScore(){return this._currentScore}}class Ib{constructor(e){this._hof=[],this._goalCode=e.readString();const t=e.readInt();for(let s=0;s<t;s++)this._hof.push(new pb(e))}dispose(){this._hof=null}get disposed(){return this._hof==null}get hof(){return this._hof}get goalCode(){return this._goalCode}}class Tb{flush(){return this._data=null,!0}parse(e){return e?(this._data=new Ib(e),!0):!1}get data(){return this._data}}class Rb{flush(){return this._data=null,!0}parse(e){return e?(this._data=new gb(e),!0):!1}get data(){return this._data}}class vb{flush(){return this._state=-1,this._userCount=-1,this._userCountGoal=-1,!0}parse(e){return e?(this._state=e.readInt(),this._userCount=e.readInt(),this._userCountGoal=e.readInt(),!0):!1}get state(){return this._state}get userCount(){return this._userCount}get userCountGoal(){return this._userCountGoal}}class Ob{flush(){return this._imageUri="",!0}parse(e){return e?(this._imageUri=e.readString(),!0):!1}get imageUri(){return this._imageUri}}class Sb{flush(){return!0}parse(e){return e?(this._expired=e.readBoolean(),!0):!1}get expired(){return this._expired}}class Dn{constructor(e){this._receiveTime=new Date,this._campaignCode=e.readString(),this._completedQuestsInCampaign=e.readInt(),this._questCountInCampaign=e.readInt(),this._activityPointType=e.readInt(),this._id=e.readInt(),this._accepted=e.readBoolean(),this._type=e.readString(),this._imageVersion=e.readString(),this._rewardCurrencyAmount=e.readInt(),this._localizationCode=e.readString(),this._completedSteps=e.readInt(),this._totalSteps=e.readInt(),this._sortOrder=e.readInt(),this._catalogPageName=e.readString(),this._chainCode=e.readString(),this._easy=e.readBoolean()}static getCampaignLocalizationKeyForCode(e){return"quests."+e}get campaignCode(){return this._campaignCode}get localizationCode(){return this._localizationCode}get completedQuestsInCampaign(){return this._completedQuestsInCampaign}get questCountInCampaign(){return this._questCountInCampaign}get activityPointType(){return this._activityPointType}set accepted(e){this._accepted=e}get accepted(){return this._accepted}set id(e){this._id=e}get id(){return this._id}get type(){return this._type}get imageVersion(){return this._imageVersion}get rewardCurrencyAmount(){return this._rewardCurrencyAmount}get completedSteps(){return this._completedSteps}get totalSteps(){return this._totalSteps}get isCompleted(){return this._completedSteps==this._totalSteps}set waitPeriodSeconds(e){this._waitPeriodSeconds=e}get waitPeriodSeconds(){if(this._waitPeriodSeconds<1)return 0;const t=new Date().getTime()-this._receiveTime.getTime();return Math.max(0,this._waitPeriodSeconds-Math.floor(t/1e3))}getCampaignLocalizationKey(){return Dn.getCampaignLocalizationKeyForCode(this.campaignCode)}getQuestLocalizationKey(){return this.getCampaignLocalizationKey()+"."+this._localizationCode}get completedCampaign(){return this._id<1}get lastQuestInCampaign(){return this._completedQuestsInCampaign>=this._questCountInCampaign}get receiveTime(){return this._receiveTime}get sortOrder(){return this._sortOrder}get catalogPageName(){return this._catalogPageName}get chainCode(){return this._chainCode}get easy(){return this._easy}}class Ab{flush(){return this._questData=null,!0}parse(e){return e?(this._questData=new Dn(e),this._showDialog=e.readBoolean(),!0):!1}get questData(){return this._questData}get showDialog(){return this._showDialog}}class yb{flush(){return this._quest=null,!0}parse(e){return e?(e.readBoolean()&&(this._quest=new Dn(e),this._easyQuestCount=e.readInt(),this._hardQuestCount=e.readInt()),!0):!1}get quest(){return this._quest}get easyQuestCount(){return this._easyQuestCount}get hardQuestCount(){return this._hardQuestCount}}class Cb{flush(){return this._quest=null,!0}parse(e){return e?(this._quest=new Dn(e),!0):!1}get quest(){return this._quest}}class Mb{flush(){return this._quests=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let s=0;s<t;s++)this._quests.push(new Dn(e));return this._openWindow=e.readBoolean(),!0}get quests(){return this._quests}get openWindow(){return this._openWindow}}class Pb{flush(){return this._quests=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let s=0;s<t;s++)this._quests.push(new Dn(e));return!0}get quests(){return this._quests}}class Nb{flush(){return this._recyclerFinishedStatus=-1,this._prizeId=0,!0}parse(e){return e?(this._recyclerFinishedStatus=e.readInt(),this._prizeId=e.readInt(),!0):!1}get recyclerFinishedStatus(){return this._recyclerFinishedStatus}get prizeId(){return this._prizeId}}class bb{flush(){return this._recyclerStatus=-1,this._recyclerTimeoutSeconds=0,!0}parse(e){return e?(this._recyclerStatus=e.readInt(),this._recyclerTimeoutSeconds=e.readInt(),!0):!1}get recyclerStatus(){return this._recyclerStatus}get recyclerTimeoutSeconds(){return this._recyclerTimeoutSeconds}}class zc{constructor(e){this._stuffIds=[],this._intParams=[],this._stuffTypeSelectionEnabled=e.readBoolean(),this._furniLimit=e.readInt();let t=e.readInt();for(;t>0;)this._stuffIds.push(e.readInt()),t--;for(this._stuffTypeId=e.readInt(),this._id=e.readInt(),this._stringParam=e.readString(),t=e.readInt();t>0;)this._intParams.push(e.readInt()),t--;this._stuffTypeSelectionCode=e.readInt()}getBoolean(e){return this._intParams[e]===1}get stuffTypeSelectionEnabled(){return this._stuffTypeSelectionEnabled}get stuffTypeSelectionCode(){return this._stuffTypeSelectionCode}set stuffTypeSelectionCode(e){this._stuffTypeSelectionCode=e}get maximumItemSelectionCount(){return this._furniLimit}get selectedItems(){return this._stuffIds}get id(){return this._id}get stringData(){return this._stringParam}get intData(){return this._intParams}get code(){return 0}get spriteId(){return this._stuffTypeId}}class Db extends zc{constructor(e){super(e),this._type=e.readInt()}get type(){return this._type}get code(){return this._type}}class Lb extends zc{constructor(e){super(e),this._conflictingActions=[],this._triggerConf=e.readInt();let t=e.readInt();for(;t>0;)this._conflictingActions.push(e.readInt()),t--}get code(){return this._triggerConf}get conflictingActions(){return this._conflictingActions}}class Ub extends zc{constructor(e){super(e),this._conflictingTriggers=[],this._type=e.readInt(),this._delayInPulses=e.readInt();let t=e.readInt();for(;t>0;)this._conflictingTriggers.push(e.readInt()),t--}get type(){return this._type}get code(){return this._type}get delayInPulses(){return this._delayInPulses}get conflictingTriggers(){return this._conflictingTriggers}}class Fb{flush(){return this._definition=null,!0}parse(e){return e?(this._definition=new Ub(e),!0):!1}get definition(){return this._definition}}class wb{flush(){return this._definition=null,!0}parse(e){return e?(this._definition=new Db(e),!0):!1}get definition(){return this._definition}}class xb{flush(){return this._definition=null,!0}parse(e){return e?(this._definition=new Lb(e),!0):!1}get definition(){return this._definition}}class Gb{flush(){return this._stuffId=0,!0}parse(e){return e?(this._stuffId=e.readInt(),!0):!1}get stuffId(){return this._stuffId}}class Bb{flush(){return this._reason=0,!0}parse(e){return e?(this._reason=e.readInt(),!0):!1}get reason(){return this._reason}}class Hb{flush(){return!0}parse(e){return!!e}}class kb{flush(){return this._info=null,!0}parse(e){return e?(this._info=e.readString(),!0):!1}get info(){return this._info}}class Vb{flush(){return!0}parse(e){return!!e}}class jb{flush(){return!0}parse(e){return!0}}class Yb{constructor(){this._songDisks=new Ot}flush(){return this._songDisks.reset(),this._maxLength=0,!0}parse(e){this._maxLength=e.readInt();const t=e.readInt();for(let s=0;s<t;s++)this._songDisks.add(e.readInt(),e.readInt());return!0}get songDisks(){return this._songDisks}get maxLength(){return this._maxLength}}class Wb{flush(){return this._currentSongId=-1,this._currentPosition=-1,this._nextSongId=-1,this._nextPosition=-1,this._syncCount=-1,!0}parse(e){return this._currentSongId=e.readInt(),this._currentPosition=e.readInt(),this._nextSongId=e.readInt(),this._nextPosition=e.readInt(),this._syncCount=e.readInt(),!0}get currentSongId(){return this._currentSongId}get currentPosition(){return this._currentPosition}get nextSongId(){return this._nextSongId}get nextPosition(){return this._nextPosition}get syncCount(){return this._syncCount}}class zb{flush(){return this._songId=0,this._officialSongId="",!0}parse(e){return this._officialSongId=e.readString(),this._songId=e.readInt(),!0}get songId(){return this._songId}get officialSongId(){return this._officialSongId}}class Du{constructor(e,t,s,i){this._startPlayHead=0,this._id=e,this._length=t,this._name=s,this._creator=i}get id(){return this._id}get length(){return this._length}get name(){return this._name}get creator(){return this._creator}get startPlayHeadPos(){return this._startPlayHead}set startPlayHeadPos(e){this._startPlayHead=e}}class Xb{flush(){return this._synchronizationCount=-1,this._playlist=[],!0}parse(e){this._synchronizationCount=e.readInt();const t=e.readInt();for(let s=0;s<t;s++)this._playlist.push(new Du(e.readInt(),e.readInt(),e.readString(),e.readString()));return!0}get synchronizationCount(){return this._synchronizationCount}get playList(){return this._playlist}}class Kb{flush(){return this._entry=null,!0}parse(e){return this._entry=new Du(e.readInt(),e.readInt(),e.readString(),e.readString()),!0}get entry(){return this._entry}}class qb extends Du{constructor(e,t,s,i,n){super(e,t,s,i),this._data="",this._data=n}get data(){return this._data}}class Qb{flush(){return this._songs=[],!0}parse(e){const t=e.readInt();for(let s=0;s<t;s++){const i=e.readInt();e.readString();const n=e.readString(),a=e.readString(),o=e.readInt(),u=e.readString(),l=new qb(i,o,n,u,a);this._songs.push(l)}return!0}get songs(){return this._songs}}class Zb{constructor(){this._songDiskInventory=new Ot}flush(){return this._songDiskInventory.reset(),!0}parse(e){const t=e.readInt();for(let s=0;s<t;s++)this._songDiskInventory.add(e.readInt(),e.readInt());return!0}getDiskId(e){return e>=0&&e<this._songDiskInventory.length?this._songDiskInventory.getKey(e):-1}getSongId(e){return e>=0&&e<this._songDiskInventory.length?this._songDiskInventory.getWithIndex(e):-1}get songDiskCount(){return this._songDiskInventory.length}}class Jb{flush(){return this._talentTrackName=null,this._level=-1,this._rewardPerks=[],this._rewardProducts=[],!0}parse(e){if(!e)return!1;let t=0;this._talentTrackName=e.readString(),this._level=e.readInt();const s=e.readInt();for(;t<s;)this._rewardPerks.push(new rD(e)),t++;const i=e.readInt();if(t<i)for(let n=0;n<i;n++){const a=e.readString(),o=e.readInt();this._rewardProducts.push(new kg(a,o)),t++}return!0}get talentTrackName(){return this._talentTrackName}get level(){return this._level}get rewardPerks(){return this._rewardPerks}get rewardProducts(){return this._rewardProducts}}class $b{constructor(e,t,s,i,n){this._level=e,this._state=t,this._tasks=s,this._rewardPerks=i,this._rewardProducts=n}get level(){return this._level}get state(){return this._state}get tasks(){return this._tasks}get perks(){return this._rewardPerks}get items(){return this._rewardProducts}}class eD{flush(){return this._talentTrackName=null,this._level=-1,this._maxLevel=-1,!0}parse(e){return e?(this._talentTrackName=e.readString(),this._level=e.readInt(),this._maxLevel=e.readInt(),!0):!1}get talentTrackName(){return this._talentTrackName}get level(){return this._level}get maxLevel(){return this._maxLevel}}class kg{constructor(e,t){this._productCode=e,this._vipDays=t}get productCode(){return this._productCode}get vipDays(){return this._vipDays}}class tD{constructor(e,t,s,i,n,a){this._id=e,this._requiredLevel=t,this._badgeCode=s,this._state=i,this._currentScore=n,this._totalScore=a}get id(){return this._id}get requiredLevel(){return this._requiredLevel}get badgeCode(){return this._badgeCode}get state(){return this._state}get currentScore(){return this._currentScore}get totalScore(){return this._totalScore}}class sD{flush(){return this._type=null,this._levels=null,!0}parse(e){if(!e)return!1;this._type=e.readString(),this._levels=[];const t=e.readInt();for(let s=0;s<t;s++){const i=e.readInt(),n=e.readInt(),a=[],o=e.readInt();for(let _=0;_<o;_++){const f=e.readInt(),g=e.readInt(),I=e.readString(),p=e.readInt(),R=e.readInt(),S=e.readInt();a.push(new tD(f,g,I,p,R,S))}const u=[],l=e.readInt();for(let _=0;_<l;_++)u.push(e.readString());const d=[],c=e.readInt();for(let _=0;_<c;_++){const f=e.readString(),g=e.readInt();d.push(new kg(f,g))}this._levels.push(new $b(i,n,a,u,d))}return!0}get type(){return this._type}get levels(){return this._levels}}class rD{constructor(e){this._perkId=e.readInt()}get perkId(){return this._perkId}}class iD{flush(){return this._classifiedUsersNames&&(this._classifiedUsersNames=new Map),this._classifiedUsersClass&&(this._classifiedUsersClass=new Map),!0}parse(e){if(!e)return!1;let t,s,i,n=e.readInt();for(this._classifiedUsersNames=new Map,this._classifiedUsersClass=new Map;n>0;)t=e.readInt(),s=e.readString(),i=e.readString(),this._classifiedUsersNames.set(t,s),this._classifiedUsersClass.set(t,i),n--;return!0}get classifiedUsernameMap(){return this._classifiedUsersNames}get classifiedUserTypeMap(){return this._classifiedUsersClass}}class nD extends v{constructor(e){super(e,sS)}getParser(){return this.parser}}class aD extends v{constructor(e){super(e,rS)}getParser(){return this.parser}}class Vg extends v{constructor(e){super(e,iS)}getParser(){return this.parser}}class oD extends v{constructor(e){super(e,nS)}getParser(){return this.parser}}class hD extends v{constructor(e){super(e,aS)}getParser(){return this.parser}}class uD extends v{constructor(e){super(e,oS)}getParser(){return this.parser}}class lD extends v{constructor(e){super(e,hS)}getParser(){return this.parser}}class cD extends v{constructor(e){super(e,uS)}getParser(){return this.parser}}class gr extends v{constructor(e){super(e,lS)}getParser(){return this.parser}}gr.NAME_OK=0,gr.ERROR_NAME_REQUIRED=1,gr.ERROR_NAME_TOO_SHORT=2,gr.ERROR_NAME_TOO_LONG=3,gr.ERROR_NAME_NOT_VALID=4,gr.ERROR_NAME_IN_USE=5,gr.ERROR_NAME_CHANGE_NOT_ALLOWED=6,gr.ERROR_MERGE_HOTEL_DOWN=7;class _D extends v{constructor(e){super(e,cS)}getParser(){return this.parser}}class jg extends v{constructor(e){super(e,_S)}getParser(){return this.parser}}class dD extends v{constructor(e){super(e,fS)}getParser(){return this.parser}}class fD extends v{constructor(e){super(e,gS)}getParser(){return this.parser}}class gD extends v{constructor(e){super(e,ES)}getParser(){return this.parser}}class ED extends v{constructor(e){super(e,mS)}getParser(){return this.parser}}class mD extends v{constructor(e){super(e,pS)}getParser(){return this.parser}}class pD extends v{constructor(e){super(e,vS)}getParser(){return this.parser}}class ID extends v{constructor(e){super(e,OS)}getParser(){return this.parser}}class TD extends v{constructor(e){super(e,SS)}getParser(){return this.parser}}class RD extends v{constructor(e){super(e,AS)}getParser(){return this.parser}}class vD extends v{constructor(e){super(e,yS)}getParser(){return this.parser}}class OD extends v{constructor(e){super(e,CS)}getParser(){return this.parser}}class SD extends v{constructor(e){super(e,MS)}getParser(){return this.parser}}class AD extends v{constructor(e){super(e,PS)}getParser(){return this.parser}}class yD extends v{constructor(e){super(e,NS)}getParser(){return this.parser}}class CD extends v{constructor(e){super(e,bS)}getParser(){return this.parser}}class MD extends v{constructor(e){super(e,DS)}getParser(){return this.parser}}class PD extends v{constructor(e){super(e,LS)}getParser(){return this.parser}}class ND extends v{constructor(e){super(e,US)}getParser(){return this.parser}}class bD extends v{constructor(e){super(e,FS)}getParser(){return this.parser}}class DD extends v{constructor(e){super(e,wS)}getParser(){return this.parser}}class LD extends v{constructor(e){super(e,GS)}getParser(){return this.parser}}class UD extends v{constructor(e){super(e,kS)}getParser(){return this.parser}}class FD extends v{constructor(e){super(e,VS)}getParser(){return this.parser}}class wD extends v{constructor(e){super(e,BS)}getParser(){return this.parser}}class xD extends v{constructor(e){super(e,jS)}getParser(){return this.parser}}class GD extends v{constructor(e){super(e,YS)}getParser(){return this.parser}}class BD extends v{constructor(e){super(e,zS)}getParser(){return this.parser}}class HD extends v{constructor(e){super(e,XS)}getParser(){return this.parser}}class kD extends v{constructor(e){super(e,qS)}getParser(){return this.parser}}class VD extends v{constructor(e){super(e,ZS)}getParser(){return this.parser}}class jD extends v{constructor(e){super(e,JS)}getParser(){return this.parser}}class YD extends v{constructor(e){super(e,$S)}getParser(){return this.parser}}class WD extends v{constructor(e){super(e,eA)}getParser(){return this.parser}}class zD extends v{constructor(e){super(e,tA)}getParser(){return this.parser}}class XD extends v{constructor(e){super(e,sA)}getParser(){return this.parser}}class KD extends v{constructor(e){super(e,rA)}getParser(){return this.parser}}class qD extends v{constructor(e){super(e,iA)}getParser(){return this.parser}}class QD extends v{constructor(e){super(e,nA)}getParser(){return this.parser}}class ZD extends v{constructor(e){super(e,aA)}getParser(){return this.parser}}class JD extends v{constructor(e){super(e,oA)}getParser(){return this.parser}}class $D extends v{constructor(e){super(e,hA)}getParser(){return this.parser}}class eL extends v{constructor(e){super(e,lA)}getParser(){return this.parser}}class tL extends v{constructor(e){super(e,lM)}getParser(){return this.parser}}class sL extends v{constructor(e){super(e,cM)}getParser(){return this.parser}}class rL extends v{constructor(e){super(e,dM)}getParser(){return this.parser}}class iL extends v{constructor(e){super(e,EM)}getParser(){return this.parser}}class nL extends v{constructor(e){super(e,gM)}getParser(){return this.parser}}class aL extends v{constructor(e){super(e,mM)}getParser(){return this.parser}}class oL extends v{constructor(e){super(e,pM)}getParser(){return this.parser}}class Yg extends v{constructor(e){super(e,IM)}getParser(){return this.parser}}class hL extends v{constructor(e){super(e,Ki)}getParser(){return this.parser}}class uL extends v{constructor(e){super(e,TM)}getParser(){return this.parser}}class lL extends v{constructor(e){super(e,RM)}getParser(){return this.parser}}class cL extends v{constructor(e){super(e,vM)}getParser(){return this.parser}}class _L extends v{constructor(e){super(e,OM)}getParser(){return this.parser}}class dL extends v{constructor(e){super(e,SM)}getParser(){return this.parser}}class fL extends v{constructor(e){super(e,AM)}getParser(){return this.parser}}class gL extends v{constructor(e){super(e,CM)}getParser(){return this.parser}}class EL extends v{constructor(e){super(e,MM)}getParser(){return this.parser}}class mL extends v{constructor(e){super(e,PM)}getParser(){return this.parser}}class Xc extends v{constructor(e){super(e,NM)}getParser(){return this.parser}}class pL extends v{constructor(e){super(e,DM)}getParser(){return this.parser}}class IL extends v{constructor(e){super(e,LM)}getParser(){return this.parser}}class TL extends v{constructor(e){super(e,UM)}getParser(){return this.parser}}class RL extends v{constructor(e){super(e,FM)}getParser(){return this.parser}}class vL extends v{constructor(e){super(e,wM)}getParser(){return this.parser}}class OL extends v{constructor(e){super(e,xM)}getParser(){return this.parser}}class SL extends v{constructor(e){super(e,GM)}getParser(){return this.parser}}class AL extends v{constructor(e){super(e,BM)}getParser(){return this.parser}}class yL extends v{constructor(e){super(e,HM)}getParser(){return this.parser}}class CL extends v{constructor(e){super(e,kM)}getParser(){return this.parser}}class ML extends v{constructor(e){super(e,VM)}getParser(){return this.parser}}class PL extends v{constructor(e){super(e,jM)}getParser(){return this.parser}}class NL extends v{constructor(e){super(e,YM)}getParser(){return this.parser}}class bL extends v{constructor(e){super(e,WM)}getParser(){return this.parser}}class Wg extends v{constructor(e){super(e,zM)}getParser(){return this.parser}}class DL extends v{constructor(e){super(e,XM)}getParser(){return this.parser}}class LL extends v{constructor(e){super(e,KM)}getParser(){return this.parser}}class UL extends v{constructor(e){super(e,qM)}getParser(){return this.parser}}class FL extends v{constructor(e){super(e,Uo)}getParser(){return this.parser}}class wL extends v{constructor(e){super(e,QM)}getParser(){return this.parser}}class xL extends v{constructor(e){super(e,ui)}getParser(){return this.parser}}class GL extends v{constructor(e){super(e,jc)}getParser(){return this.parser}}class BL extends v{constructor(e){super(e,ZM)}getParser(){return this.parser}}class HL extends v{constructor(e){super(e,JM)}getParser(){return this.parser}}class kL extends v{constructor(e){super(e,$M)}getParser(){return this.parser}}class VL extends v{constructor(e){super(e,e0)}getParser(){return this.parser}}class jL extends v{constructor(e){super(e,t0)}getParser(){return this.parser}}class YL extends v{constructor(e){super(e,r0)}getParser(){return this.parser}}class WL extends v{constructor(e){super(e,n0)}getParser(){return this.parser}}class zL extends v{constructor(e){super(e,a0)}getParser(){return this.parser}}class XL extends v{constructor(e){super(e,Ca)}getParser(){return this.parser}}class KL extends v{constructor(e){super(e,o0)}getParser(){return this.parser}}class qL extends v{constructor(e){super(e,wg)}getParser(){return this.parser}}class QL extends v{constructor(e){super(e,h0)}getParser(){return this.parser}}class ZL extends v{constructor(e){super(e,u0)}getParser(){return this.parser}}class zg extends v{constructor(e){super(e,l0)}getParser(){return this.parser}}class JL extends v{constructor(e){super(e,c0)}getParser(){return this.parser}}class $L extends v{constructor(e){super(e,_0)}getParser(){return this.parser}}class eU extends v{constructor(e){super(e,Mu)}getParser(){return this.parser}}class tU extends v{constructor(e){super(e,Mu)}getParser(){return this.parser}}class sU extends v{constructor(e){super(e,Mu)}getParser(){return this.parser}}class rU extends v{constructor(e){super(e,Mu)}getParser(){return this.parser}}class iU extends v{constructor(e){super(e,f0)}getParser(){return this.parser}}class nU extends v{constructor(e){super(e,g0)}getParser(){return this.parser}}class Kc extends v{constructor(e){super(e,E0)}getParser(){return this.parser}}class aU extends v{constructor(e){super(e,m0)}getParser(){return this.parser}}class oU extends v{constructor(e){super(e,p0)}getParser(){return this.parser}}class hU extends v{constructor(e){super(e,I0)}getParser(){return this.parser}}class Xg extends v{constructor(e){super(e,T0)}getParser(){return this.parser}}class uU extends v{constructor(e){super(e,R0)}getParser(){return this.parser}}class lU extends v{constructor(e){super(e,v0)}getParser(){return this.parser}}class cU extends v{constructor(e){super(e,O0)}getParser(){return this.parser}}class _U extends v{constructor(e){super(e,y0)}getParser(){return this.parser}}class dU extends v{constructor(e){super(e,C0)}getParser(){return this.parser}}class fU extends v{constructor(e){super(e,M0)}getParser(){return this.parser}}class gU extends v{constructor(e){super(e,P0)}getParser(){return this.parser}}class EU extends v{constructor(e){super(e,N0)}getParser(){return this.parser}}class mU extends v{constructor(e){super(e,b0)}getParser(){return this.parser}}class pU extends v{constructor(e){super(e,D0)}getParser(){return this.parser}}class IU extends v{constructor(e){super(e,L0)}getParser(){return this.parser}}class TU extends v{constructor(e){super(e,U0)}getParser(){return this.parser}}class RU extends v{constructor(e){super(e,F0)}getParser(){return this.parser}}class vU extends v{constructor(e){super(e,w0)}getParser(){return this.parser}}class OU extends v{constructor(e){super(e,x0)}getParser(){return this.parser}}class SU extends v{constructor(e){super(e,G0)}getParser(){return this.parser}}class AU extends v{constructor(e){super(e,B0)}getParser(){return this.parser}}class pe{}pe.LOGOUT=0,pe.JUST_BANNED=1,pe.CONCURRENT_LOGIN=2,pe.CONNECTION_LOST_TO_PEER=3,pe.AVATAR_IDENTITY_CHANGE=4,pe.REMOVE_FURNITURE_TOOL=5,pe.STILL_BANNED=10,pe.DUAL_LOGIN_BY_USERID=11,pe.HOTEL_CLOSED=12,pe.DUAL_LOGIN_BY_IP=13,pe.PEER_CONNECTION_MISSING=16,pe.NO_LOGIN_PERMISSION=17,pe.DUPLICATE_CONNECTION=18,pe.HOTEL_CLOSING=19,pe.INCORRECT_PASSWORD=20,pe.INVALID_LOGIN_TICKET=22,pe.VERSION_CHECK_URL=23,pe.VERSION_CHECK_PROPERTY=24,pe.VERSION_CHECK_MACHINE_ID=25,pe.NO_MESSENGER_SESSION=26,pe.USER_NOT_FOUND=27,pe.CRYPTO_NOT_INITIALIZED=28,pe.DEV_CRYPTO_NOT_ALLOWED=29,pe.DUPLICATE_UUID_DETECTED=100,pe.OLD_SESSION_IN_PROXY=101,pe.PUBLIC_KEY_NOT_NUMERIC=102,pe.PUBLIC_KEY_TOO_SHORT=103,pe.SOCKET_READ_GENERIC=104,pe.SOCKET_READ_FIRST_BYTE=105,pe.SOCKET_READ_LENGTH=106,pe.SOCKET_READ_BODY=107,pe.SOCKET_READ_POLICY=108,pe.SOCKET_IO_EXCEPTION=109,pe.SOCKET_WRONG_CRYPTO=110,pe.PROXY_RUNTIME_EXCEPTION=111,pe.IDLE_CONNECTION=112,pe.PONG_TIMEOUT=113,pe.IDLE_CONNECTION_NOT_AUTH=114,pe.IDLE_CONNECTION_NO_USER_ID=115,pe.WRITE_CLOSED_CHANNEL=116,pe.SOCKET_WRITE_EXCEPTION_1=117,pe.SOCKET_WRITE_EXCEPTION_2=118,pe.SOCKET_WRITE_EXCEPTION_3=119;class yU extends v{constructor(e){super(e,H0)}getParser(){return this.parser}get reasonString(){switch(this.getParser().reason){case pe.JUST_BANNED:case pe.STILL_BANNED:return"banned";case pe.CONCURRENT_LOGIN:return"concurrentlogin";case pe.INCORRECT_PASSWORD:return"incorrectpassword";default:return"logout"}}}class CU extends v{constructor(e){super(e,k0)}getParser(){return this.parser}}class MU extends v{constructor(e){super(e,V0)}getParser(){return this.parser}}class Kg extends v{constructor(e){super(e,j0)}getParser(){return this.parser}}class PU extends v{constructor(e){super(e,Y0)}getParser(){return this.parser}}class NU extends v{constructor(e){super(e,W0)}getParser(){return this.parser}}class bU extends v{constructor(e){super(e,z0)}getParser(){return this.parser}}class DU extends v{constructor(e){super(e,X0)}getParser(){return this.parser}}class LU extends v{constructor(e){super(e,K0)}getParser(){return this.parser}}class UU extends v{constructor(e){super(e,q0)}getParser(){return this.parser}}class FU extends v{constructor(e){super(e,Q0)}getParser(){return this.parser}}class wU extends v{constructor(e){super(e,Z0)}getParser(){return this.parser}}class xU extends v{constructor(e){super(e,J0)}getParser(){return this.parser}}class GU extends v{constructor(e){super(e,bn)}getParser(){return this.parser}}class BU extends v{constructor(e){super(e,$0)}getParser(){return this.parser}}class HU extends v{constructor(e){super(e,Bo)}getParser(){return this.parser}}class kU extends v{constructor(e){super(e,tP)}getParser(){return this.parser}}class VU extends v{constructor(e){super(e,sP)}getParser(){return this.parser}}class qg extends v{constructor(e){super(e,rP)}getParser(){return this.parser}}class Qg extends v{constructor(e){super(e,Ma)}getParser(){return this.parser}}class jU extends v{constructor(e){super(e,iP)}getParser(){return this.parser}}class YU extends v{constructor(e){super(e,nP)}getParser(){return this.parser}}class WU extends v{constructor(e){super(e,aP)}getParser(){return this.parser}}class zU extends v{constructor(e){super(e,oP)}getParser(){return this.parser}}class Zg extends v{constructor(e){super(e,hP)}getParser(){return this.parser}}class XU extends v{constructor(e){super(e,Ho)}getParser(){return this.parser}}class KU extends v{constructor(e){super(e,Pu)}getParser(){return this.parser}}class qU extends v{constructor(e){super(e,uP)}getParser(){return this.parser}}class QU extends v{constructor(e){super(e,lP)}getParser(){return this.parser}}class ZU extends v{constructor(e){super(e,cP)}getParser(){return this.parser}}class JU extends v{constructor(e){super(e,_P)}getParser(){return this.parser}}class m{}m.ACHIEVEMENT_LIST=305,m.AUTHENTICATED=2491,m.AUTHENTICATION=-1,m.AVAILABILITY_STATUS=2033,m.BUILDERS_CLUB_EXPIRED=1452,m.CLUB_OFFERS=2405,m.CATALOG_PAGE=804,m.CATALOG_PAGE_LIST=1032,m.CATALOG_PURCHASE_OK=869,m.CATALOG_PURCHASE_ERROR=1404,m.CATALOG_PURCHASE_NOT_ALLOWED=3770,m.PRODUCT_OFFER=3388,m.LIMITED_SOLD_OUT=377,m.CATALOG_PUBLISHED=1866,m.CFH_RESULT_MESSAGE=3635,m.CLIENT_LATENCY=10,m.CLIENT_PING=3928,m.DESKTOP_CAMPAIGN=1745,m.DESKTOP_NEWS=286,m.DESKTOP_VIEW=122,m.BUNDLE_DISCOUNT_RULESET=2347,m.FIRST_LOGIN_OF_DAY=793,m.FURNITURE_ALIASES=1723,m.FURNITURE_DATA=2547,m.FURNITURE_FLOOR=1778,m.FURNITURE_FLOOR_ADD=1534,m.FURNITURE_FLOOR_REMOVE=2703,m.FURNITURE_FLOOR_UPDATE=3776,m.FURNITURE_ITEMDATA=2202,m.FURNITURE_STATE=2376,m.FURNITURE_GROUP_CONTEXT_MENU_INFO=3293,m.FURNITURE_POSTIT_STICKY_POLE_OPEN=2366,m.GAME_CENTER_ACHIEVEMENTS=2265,m.GAME_CENTER_GAME_LIST=222,m.GAME_CENTER_STATUS=2893,m.GAME_CENTER_IN_ARENA_QUEUE=872,m.GAME_CENTER_STOP_COUNTER=3191,m.GAME_CENTER_USER_LEFT_GAME=3138,m.GAME_CENTER_DIRECTORY_STATUS=2246,m.GAME_CENTER_STARTING_GAME_FAILED=2142,m.GAME_CENTER_JOINING_FAILED=1730,m.GAMESTATUSMESSAGE=3805,m.GAMEACHIEVEMENTS=1689,m.GAMEINVITE=904,m.JOININGQUEUEFAILED=3035,m.JOINEDQUEUEMESSAGE=2260,m.LEFTQUEUE=1477,m.LOAD_GAME_URL=2624,m.LOADGAME=3654,m.UNLOADGAME=1715,m.ACHIEVEMENTRESOLUTIONCOMPLETED=740,m.ACHIEVEMENTRESOLUTIONPROGRESS=3370,m.ACHIEVEMENTRESOLUTIONS=66,m.GENERIC_ALERT=3801,m.MODERATOR_MESSAGE=2030,m.GENERIC_ERROR=1600,m.GIFT_WRAPPER_CONFIG=2234,m.GROUP_BADGES=2402,m.GROUP_CREATE_OPTIONS=2159,m.GROUP_FORUM_DATA=3011,m.GROUP_FORUM_LIST=3001,m.GROUP_FORUM_THREADS=1073,m.GROUP_FORUM_POST=2049,m.GROUP_FORUM_POST_THREAD=1862,m.GROUP_FORUM_THREAD_MESSAGES=509,m.GROUP_FORUM_UNREAD_COUNT=2379,m.GROUP_FORUM_UPDATE_MESSAGE=324,m.GROUP_FORUM_UPDATE_THREAD=2528,m.GROUP_INFO=1702,m.GROUP_LIST=420,m.GROUP_MEMBER=265,m.GROUP_MEMBERS=1200,m.GROUP_MEMBERS_REFRESH=2445,m.GROUP_MEMBER_REMOVE_CONFIRM=1876,m.GROUP_PURCHASED=2808,m.GROUP_SETTINGS=3965,m.GROUP_BADGE_PARTS=2238,m.GROUP_MEMBERSHIP_REQUESTED=1180,m.GROUP_DETAILS_CHANGED=1459,m.GROUP_HABBO_JOIN_FAILED=762,m.GUILD_EDIT_FAILED=3988,m.GUILD_MEMBER_MGMT_FAILED=818,m.ITEM_DIMMER_SETTINGS=2710,m.ITEM_STACK_HELPER=2816,m.ITEM_WALL=1369,m.ITEM_WALL_ADD=2187,m.ITEM_WALL_REMOVE=3208,m.ITEM_WALL_UPDATE=2009,m.MARKETPLACE_CONFIG=1823,m.MESSENGER_ACCEPT_FRIENDS=896,m.MESSENGER_CHAT=1587,m.MESSENGER_FIND_FRIENDS=1210,m.MESSENGER_FOLLOW_FAILED=3048,m.MESSENGER_FRIEND_NOTIFICATION=3082,m.MESSENGER_FRIENDS=3130,m.MESSENGER_INIT=1605,m.MESSENGER_INSTANCE_MESSAGE_ERROR=3359,m.MESSENGER_INVITE=3870,m.MESSENGER_INVITE_ERROR=462,m.MESSENGER_MESSAGE_ERROR=892,m.MESSENGER_MINIMAIL_COUNT=2803,m.MESSENGER_MINIMAIL_NEW=1911,m.MESSENGER_RELATIONSHIPS=2016,m.MESSENGER_REQUEST=2219,m.MESSENGER_REQUEST_ERROR=892,m.MESSENGER_REQUESTS=280,m.MESSENGER_SEARCH=973,m.MESSENGER_UPDATE=2800,m.MODERATION_REPORT_DISABLED=1651,m.MODERATION_TOOL=2696,m.MODERATION_USER_INFO=2866,m.MOTD_MESSAGES=2035,m.NAVIGATOR_CATEGORIES=1562,m.NAVIGATOR_COLLAPSED=1543,m.NAVIGATOR_EVENT_CATEGORIES=3244,m.NAVIGATOR_LIFTED=3104,m.NAVIGATOR_METADATA=3052,m.NAVIGATOR_OPEN_ROOM_CREATOR=2064,m.NAVIGATOR_SEARCH=2690,m.NAVIGATOR_SEARCHES=3984,m.NAVIGATOR_SETTINGS=518,m.THUMBNAIL_UPDATE_RESULT=1927,m.CAN_CREATE_ROOM=378,m.CATEGORIES_WITH_VISITOR_COUNT=1455,m.COMPETITION_ROOMS_DATA=3954,m.CONVERTED_ROOM_ID=1331,m.GUEST_ROOM_SEARCH_RESULT=52,m.NOTIFICATION_LIST=1992,m.NOTIFICATION_OFFER_REWARD_DELIVERED=2125,m.NOTIFICATION_SIMPLE_ALERT=5100,m.NOTIFICATION_ELEMENT_POINTER=1787,m.PET_FIGURE_UPDATE=1924,m.PET_INFO=2901,m.PET_TRAINING_PANEL=1164,m.PET_LEVEL_UPDATE=2824,m.PET_SCRATCH_FAILED=1130,m.PET_OPEN_PACKAGE_REQUESTED=2380,m.PET_OPEN_PACKAGE_RESULT=546,m.PET_BREEDING=1746,m.PET_CONFIRM_BREEDING_RESULT=1625,m.PET_GO_TO_BREEDING_NEST_FAILURE=2621,m.PET_NEST_BREEDING_SUCCESS=2527,m.PET_CONFIRM_BREEDING_REQUEST=634,m.PET_BREEDING_RESULT=1553,m.RECYCLER_PRIZES=3164,m.RECYCLER_STATUS=3433,m.RECYCLER_FINISHED=468,m.ROOM_BAN_LIST=1869,m.ROOM_BAN_REMOVE=3429,m.ROOM_CREATED=1304,m.ROOM_DOORBELL=2309,m.ROOM_DOORBELL_ACCEPTED=3783,m.ROOM_DOORBELL_REJECTED=878,m.ROOM_ENTER=758,m.ROOM_ENTER_ERROR=899,m.ROOM_FORWARD=160,m.ROOM_HEIGHT_MAP=2753,m.ROOM_HEIGHT_MAP_UPDATE=558,m.ROOM_INFO=687,m.ROOM_INFO_OWNER=749,m.ROOM_MODEL=1301,m.ROOM_MODEL_BLOCKED_TILES=3990,m.ROOM_MODEL_DOOR=1664,m.ROOM_MODEL_NAME=2031,m.ROOM_MUTED=2533,m.ROOM_MUTE_USER=826,m.ROOM_PAINT=2454,m.ROOM_PROMOTION=2274,m.ROOM_QUEUE_STATUS=2208,m.ROOM_RIGHTS=780,m.ROOM_RIGHTS_CLEAR=2392,m.ROOM_RIGHTS_LIST=1284,m.ROOM_RIGHTS_LIST_ADD=2088,m.ROOM_RIGHTS_LIST_REMOVE=1327,m.ROOM_RIGHTS_OWNER=339,m.ROOM_ROLLING=3207,m.ROOM_SCORE=482,m.ROOM_SETTINGS=1498,m.ROOM_SETTINGS_CHAT=1191,m.ROOM_SETTINGS_SAVE=948,m.ROOM_SETTINGS_SAVE_ERROR=1555,m.ROOM_INFO_UPDATED=3297,m.ROOM_SPECTATOR=1033,m.ROOM_THICKNESS=3547,m.ROOM_GET_FILTER_WORDS=2937,m.ROOM_MESSAGE_NOTIFICATION=1634,m.ROOM_POPULAR_TAGS_RESULT=2012,m.INFO_FEED_ENABLE=3284,m.SECURITY_MACHINE=1488,m.MYSTERY_BOX_KEYS=2833,m.GOTMYSTERYBOXPRIZEMESSAGE=3712,m.CANCELMYSTERYBOXWAITMESSAGE=596,m.SHOWMYSTERYBOXWAITMESSAGE=3201,m.TRADE_ACCEPTED=2568,m.TRADE_CLOSED=1373,m.TRADE_COMPLETED=1001,m.TRADE_CONFIRMATION=2720,m.TRADE_LIST_ITEM=2024,m.TRADE_NOT_OPEN=3128,m.TRADE_OPEN=2505,m.TRADE_OPEN_FAILED=217,m.TRADE_OTHER_NOT_ALLOWED=1254,m.TRADE_YOU_NOT_ALLOWED=3058,m.TRADE_NO_SUCH_ITEM=2873,m.UNIT=374,m.UNIT_CHANGE_NAME=2182,m.UNIT_CHAT=1446,m.UNIT_CHAT_SHOUT=1036,m.UNIT_CHAT_WHISPER=2704,m.UNIT_DANCE=2233,m.UNIT_EFFECT=1167,m.UNIT_EXPRESSION=1631,m.UNIT_HAND_ITEM=1474,m.UNIT_IDLE=1797,m.UNIT_INFO=3920,m.UNIT_NUMBER=2324,m.UNIT_REMOVE=2661,m.UNIT_STATUS=1640,m.UNIT_TYPING=1717,m.UNSEEN_ITEMS=2103,m.USER_ACHIEVEMENT_SCORE=1968,m.USER_BADGES=717,m.USER_BADGES_ADD=2493,m.USER_BADGES_CURRENT=1087,m.USER_BOT_REMOVE=233,m.USER_BOTS=3086,m.USER_CHANGE_NAME=118,m.USER_CLOTHING=1450,m.USER_CREDITS=3475,m.USER_CURRENCY=2018,m.ACTIVITY_POINT_NOTIFICATION=2275,m.USER_EFFECTS=340,m.USER_FAVORITE_ROOM=2524,m.USER_FAVORITE_ROOM_COUNT=151,m.USER_FIGURE=2429,m.USER_FURNITURE=994,m.USER_FURNITURE_ADD=104,m.USER_FURNITURE_POSTIT_PLACED=1501,m.USER_FURNITURE_REFRESH=3151,m.USER_FURNITURE_REMOVE=159,m.USER_HOME_ROOM=2875,m.ROOM_EVENT_CANCEL=3479,m.ROOM_EVENT=1840,m.USER_IGNORED=126,m.USER_IGNORED_RESULT=207,m.USER_INFO=2725,m.USER_OUTFITS=3315,m.USER_PERKS=2586,m.USER_PERMISSIONS=411,m.USER_PET_ADD=2101,m.USER_PET_REMOVE=3253,m.USER_PETS=3522,m.USER_PROFILE=3898,m.USER_RESPECT=2815,m.USER_SANCTION_STATUS=3679,m.USER_SETTINGS=513,m.USER_SUBSCRIPTION=954,m.USER_WARDROBE_PAGE=3315,m.USER_CLASSIFICATION=966,m.GET_USER_TAGS=1255,m.WIRED_ACTION=1434,m.WIRED_CONDITION=1108,m.WIRED_ERROR=156,m.WIRED_OPEN=1830,m.WIRED_REWARD=178,m.WIRED_SAVE=1155,m.WIRED_TRIGGER=383,m.PLAYING_GAME=448,m.FURNITURE_STATE_2=3431,m.REMOVE_BOT_FROM_INVENTORY=233,m.ADD_BOT_TO_INVENTORY=1352,m.ACHIEVEMENT_PROGRESSED=2107,m.MODTOOL_ROOM_INFO=1333,m.MODTOOL_USER_CHATLOG=3377,m.MODTOOL_ROOM_CHATLOG=3434,m.MODTOOL_VISITED_ROOMS_USER=1752,m.MODERATOR_ACTION_RESULT=2335,m.ISSUE_DELETED=3192,m.ISSUE_INFO=3609,m.ISSUE_PICK_FAILED=3150,m.CFH_CHATLOG=607,m.MODERATOR_TOOL_PREFERENCES=1576,m.LOVELOCK_FURNI_START=3753,m.LOVELOCK_FURNI_FRIEND_COMFIRMED=382,m.LOVELOCK_FURNI_FINISHED=770,m.GIFT_RECEIVER_NOT_FOUND=1517,m.GIFT_OPENED=56,m.FLOOD_CONTROL=566,m.REMAINING_MUTE=826,m.USER_EFFECT_LIST=340,m.USER_EFFECT_LIST_ADD=2867,m.USER_EFFECT_LIST_REMOVE=2228,m.USER_EFFECT_ACTIVATE=1959,m.AVATAR_EFFECT_SELECTED=3473,m.CLUB_GIFT_INFO=619,m.REDEEM_VOUCHER_ERROR=714,m.REDEEM_VOUCHER_OK=3336,m.IN_CLIENT_LINK=2023,m.BOT_COMMAND_CONFIGURATION=1618,m.BOT_SKILL_LIST_UPDATE=69,m.BOT_FORCE_OPEN_CONTEXT_MENU=296,m.HAND_ITEM_RECEIVED=354,m.PET_PLACING_ERROR=2913,m.BOT_ERROR=639,m.MARKETPLACE_SELL_ITEM=54,m.MARKETPLACE_ITEM_STATS=725,m.MARKETPLACE_OWN_ITEMS=3884,m.MARKETPLACE_CANCEL_SALE=3264,m.MARKETPLACE_ITEM_POSTED=1359,m.MARKETPLACE_ITEMS_SEARCHED=680,m.MARKETPLACE_AFTER_ORDER_STATUS=2032,m.CATALOG_RECEIVE_PET_BREEDS=3331,m.CATALOG_APPROVE_NAME_RESULT=1503,m.OBJECTS_DATA_UPDATE=1453,m.PET_EXPERIENCE=2156,m.COMMUNITY_GOAL_VOTE_EVENT=1435,m.PROMO_ARTICLES=286,m.COMMUNITY_GOAL_EARNED_PRIZES=3319,m.COMMUNITY_GOAL_PROGRESS=2525,m.CONCURRENT_USERS_GOAL_PROGRESS=2737,m.QUEST_DAILY=1878,m.QUEST_CANCELLED=3027,m.QUEST_COMPLETED=949,m.COMMUNITY_GOAL_HALL_OF_FAME=3005,m.EPIC_POPUP=3945,m.SEASONAL_QUESTS=1122,m.QUESTS=3625,m.QUEST=230,m.BONUS_RARE_INFO=1533,m.CRAFTABLE_PRODUCTS=1e3,m.CRAFTING_RECIPE=2774,m.CRAFTING_RECIPES_AVAILABLE=2124,m.CRAFTING_RESULT=618,m.CAMERA_PUBLISH_STATUS=2057,m.CAMERA_PURCHASE_OK=2783,m.CAMERA_STORAGE_URL=3696,m.CAMERA_SNAPSHOT=463,m.COMPETITION_STATUS=133,m.INIT_CAMERA=3878,m.THUMBNAIL_STATUS=3595,m.ACHIEVEMENT_NOTIFICATION=806,m.CLUB_GIFT_NOTIFICATION=2188,m.INTERSTITIAL_MESSAGE=1808,m.ROOM_AD_ERROR=1759,m.AVAILABILITY_TIME=600,m.HOTEL_CLOSED_AND_OPENS=3728,m.HOTEL_CLOSES_AND_OPENS_AT=2771,m.HOTEL_WILL_CLOSE_MINUTES=1050,m.HOTEL_MAINTENANCE=1350,m.JUKEBOX_PLAYLIST_FULL=105,m.JUKEBOX_SONG_DISKS=34,m.NOW_PLAYING=469,m.OFFICIAL_SONG_ID=1381,m.PLAYLIST=1748,m.PLAYLIST_SONG_ADDED=1140,m.TRAX_SONG_INFO=3365,m.USER_SONG_DISKS_INVENTORY=2602,m.CHECK_USER_NAME=563,m.CFH_SANCTION=2782,m.CFH_TOPICS=325,m.CFH_SANCTION_STATUS=2221,m.CAMPAIGN_CALENDAR_DATA=2531,m.CAMPAIGN_CALENDAR_DOOR_OPENED=2551,m.BUILDERS_CLUB_FURNI_COUNT=3828,m.BUILDERS_CLUB_SUBSCRIPTION=1452,m.CATALOG_PAGE_EXPIRATION=2668,m.CATALOG_EARLIEST_EXPIRY=2515,m.CLUB_GIFT_SELECTED=659,m.TARGET_OFFER_NOT_FOUND=1237,m.TARGET_OFFER=119,m.DIRECT_SMS_CLUB_BUY=195,m.ROOM_AD_PURCHASE=2468,m.NOT_ENOUGH_BALANCE=3914,m.LIMITED_OFFER_APPEARING_NEXT=44,m.IS_OFFER_GIFTABLE=761,m.CLUB_EXTENDED_OFFER=3964,m.SEASONAL_CALENDAR_OFFER=1889,m.COMPETITION_ENTRY_SUBMIT=1177,m.COMPETITION_VOTING_INFO=3506,m.COMPETITION_TIMING_CODE=1745,m.COMPETITION_USER_PART_OF=3841,m.COMPETITION_NO_OWNED_ROOMS=2064,m.COMPETITION_SECONDS_UNTIL=3926,m.BADGE_POINT_LIMITS=2501,m.BADGE_REQUEST_FULFILLED=2998,m.HELPER_TALENT_TRACK=3406,m.TALENT_TRACK_LEVEL=1203,m.TALENT_TRACK_LEVEL_UP=638,m.USER_BANNED=1683,m.BOT_RECEIVED=3684,m.PET_LEVEL_NOTIFICATION=859,m.PET_RECEIVED=1111,m.MODERATION_CAUTION=1890,m.YOUTUBE_CONTROL_VIDEO=1554,m.YOUTUBE_DISPLAY_PLAYLISTS=1112,m.YOUTUBE_DISPLAY_VIDEO=1411,m.CFH_DISABLED_NOTIFY=1651,m.QUESTION=2665,m.POLL_CONTENTS=2997,m.POLL_ERROR=662,m.POLL_OFFER=3785,m.POLL_ROOM_RESULT=5201,m.POLL_START_ROOM=5200,m.QUESTION_ANSWERED=2589,m.QUESTION_FINISHED=1066,m.CFH_PENDING_CALLS=1121,m.GUIDE_ON_DUTY_STATUS=1548,m.GUIDE_SESSION_ATTACHED=1591,m.GUIDE_SESSION_DETACHED=138,m.GUIDE_SESSION_ENDED=1456,m.GUIDE_SESSION_ERROR=673,m.GUIDE_SESSION_INVITED_TO_GUIDE_ROOM=219,m.GUIDE_SESSION_MESSAGE=841,m.GUIDE_SESSION_PARTNER_IS_TYPING=1016,m.GUIDE_SESSION_REQUESTER_ROOM=1847,m.GUIDE_SESSION_STARTED=3209,m.GUIDE_TICKET_CREATION_RESULT=3285,m.GUIDE_TICKET_RESOLUTION=2674,m.GUIDE_REPORTING_STATUS=3463,m.HOTEL_MERGE_NAME_CHANGE=1663,m.ISSUE_CLOSE_NOTIFICATION=934,m.QUIZ_DATA=2927,m.QUIZ_RESULTS=2772,m.CFH_PENDING_CALLS_DELETED=77,m.CFH_REPLY=3796,m.CHAT_REVIEW_SESSION_DETACHED=30,m.CHAT_REVIEW_SESSION_OFFERED_TO_GUIDE=735,m.CHAT_REVIEW_SESSION_RESULTS=3276,m.CHAT_REVIEW_SESSION_STARTED=143,m.CHAT_REVIEW_SESSION_VOTING_STATUS=1829,m.SCR_SEND_KICKBACK_INFO=3277,m.PET_STATUS=1907,m.GROUP_DEACTIVATE=3129,m.PET_RESPECTED=2788,m.PET_SUPPLEMENT=3441,m.NOOBNESS_LEVEL=3738,m.DISCONNECT_REASON=4e3,m.CAN_CREATE_ROOM_EVENT=2599,m.FAVORITE_GROUP_UDPATE=3403,m.NO_SUCH_FLAT=84,m.ROOM_SETTINGS_ERROR=2897,m.SHOW_ENFORCE_ROOM_CATEGORY=3896,m.CUSTOM_USER_NOTIFICATION=909,m.NEW_USER_EXPERIENCE_GIFT_OFFER=3575,m.RESTORE_CLIENT=426,m.FIREWORK_CHARGE_DATA=5210,m.NEW_USER_EXPERIENCE_NOT_COMPLETE=3639,m.CONNECTION_ERROR=1004,m.ACCOUNT_SAFETY_LOCK_STATUS_CHANGE=1243,m.PHONE_COLLECTION_STATE=2890,m.PHONE_TRY_NUMBER_RESULT=800,m.PHONE_TRY_VERIFICATION_CODE_RESULT=91,m.EXTENDED_PROFILE_CHANGED=876,m.WELCOME_GIFT_CHANGE_EMAIL_RESULT=2293,m.WELCOME_GIFT_STATUS=2707,m.HANDSHAKE_INIT_DIFFIE=1347,m.HANDSHAKE_COMPLETE_DIFFIE=3885,m.RENTABLE_SPACE_RENT_OK=2046,m.RENTABLE_SPACE_STATUS=3559,m.RENTABLE_SPACE_RENT_FAILED=1868,m.EMAIL_STATUS=612,m.CHANGE_EMAIL_RESULT=1815,m.WEEKLY_GAME_REWARD=2641,m.WEEKLY_GAME_REWARD_WINNERS=3097,m.WEEKLY_COMPETITIVE_LEADERBOARD=3512,m.WEEKLY_COMPETITIVE_FRIENDS_LEADERBOARD=3560,m.WEEKLY_GAME2_FRIENDS_LEADERBOARD=2270,m.WEEKLY_GAME2_LEADERBOARD=2196,m.RENTABLE_FURNI_RENT_OR_BUYOUT_OFFER=35,m.HANDSHAKE_IDENTITY_ACCOUNT=3523;class $U extends v{constructor(e){super(e,UA)}getParser(){return this.parser}}class e1 extends v{constructor(e){super(e,FA)}getParser(){return this.parser}}class t1 extends v{constructor(e){super(e,wA)}getParser(){return this.parser}}class s1 extends v{constructor(e){super(e,GA)}getParser(){return this.parser}}class r1 extends v{constructor(e){super(e,BA)}getParser(){return this.parser}}class i1 extends v{constructor(e){super(e,HA)}getParser(){return this.parser}}class n1 extends v{constructor(e){super(e,kA)}getParser(){return this.parser}}class a1 extends v{constructor(e){super(e,VA)}getParser(){return this.parser}}class Jg extends v{constructor(e){super(e,YA)}getParser(){return this.parser}}class o1 extends v{constructor(e){super(e,WA)}getParser(){return this.parser}}class h1 extends v{constructor(e){super(e,zA)}getParser(){return this.parser}}class u1 extends v{constructor(e){super(e,XA)}getParser(){return this.parser}}class l1 extends v{constructor(e){super(e,KA)}getParser(){return this.parser}}class Zq extends v{constructor(e){super(e,qA)}getParser(){return this.parser}}class Jq extends v{constructor(e){super(e,QA)}getParser(){return this.parser}}class c1 extends v{constructor(e){super(e,LC)}getParser(){return this.parser}}class _1 extends v{constructor(e){super(e,FC)}getParser(){return this.parser}}class d1 extends v{constructor(e){super(e,UC)}getParser(){return this.parser}}class f1 extends v{constructor(e){super(e,wC)}getParser(){return this.parser}}class g1 extends v{constructor(e){super(e,xC)}getParser(){return this.parser}}class $g extends v{constructor(e){super(e,GC)}getParser(){return this.parser}}class E1 extends v{constructor(e){super(e,BC)}getParser(){return this.parser}}class m1 extends v{constructor(e){super(e,HC)}getParser(){return this.parser}}class $q extends v{constructor(e){super(e,Ng)}getParser(){return this.parser}}class p1 extends v{constructor(e){super(e,kC)}getParser(){return this.parser}}class I1 extends v{constructor(e){super(e,VC)}getParser(){return this.parser}}class T1 extends v{constructor(e){super(e,jC)}getParser(){return this.parser}}class R1 extends v{constructor(e){super(e,YC)}getParser(){return this.parser}}class v1 extends v{constructor(e){super(e,WC)}getParser(){return this.parser}}class O1 extends v{constructor(e){super(e,XC)}get userID(){return this.getParser().userID}get userAccepts(){return this.getParser().userAccepts}getParser(){return this.parser}}class S1 extends v{constructor(e){super(e,bg)}get userID(){return this.getParser().userID}getParser(){return this.parser}}class A1 extends v{constructor(e){super(e,KC)}getParser(){return this.parser}}class y1 extends v{constructor(e){super(e,qC)}getParser(){return this.parser}}class C1 extends v{constructor(e){super(e,QC)}get firstUserID(){return this.getParser().firstUserID}get secondUserID(){return this.getParser().secondUserID}get firstUserNumItems(){return this.getParser().firstUserNumItems}get secondUserNumItems(){return this.getParser().secondUserNumItems}get firstUserNumCredits(){return this.getParser().firstUserNumCredits}get secondUserNumCredits(){return this.getParser().secondUserNumCredits}get firstUserItemArray(){return this.getParser().firstUserItemArray}get secondUserItemArray(){return this.getParser().secondUserItemArray}getParser(){return this.parser}}class M1 extends v{constructor(e){super(e,ZC)}getParser(){return this.parser}}class P1 extends v{constructor(e){super(e,JC)}getParser(){return this.parser}}class N1 extends v{constructor(e){super(e,$C)}get userID(){return this.getParser().userID}get userCanTrade(){return this.getParser().userCanTrade}get otherUserID(){return this.getParser().otherUserID}get otherUserCanTrade(){return this.getParser().otherUserCanTrade}getParser(){return this.parser}}class b1 extends v{constructor(e){super(e,kc)}getParser(){return this.parser}}class D1 extends v{constructor(e){super(e,eM)}getParser(){return this.parser}}class L1 extends v{constructor(e){super(e,tM)}getParser(){return this.parser}}class U1 extends v{constructor(e){super(e,dP)}getParser(){return this.parser}}class F1 extends v{constructor(e){super(e,fP)}getParser(){return this.parser}}class w1 extends v{constructor(e){super(e,gP)}getParser(){return this.parser}}class x1 extends v{constructor(e){super(e,EP)}getParser(){return this.parser}}class G1 extends v{constructor(e){super(e,mP)}getParser(){return this.parser}}class B1 extends v{constructor(e){super(e,pP)}getParser(){return this.parser}}class H1 extends v{constructor(e){super(e,TP)}getParser(){return this.parser}}class k1 extends v{constructor(e){super(e,IP)}getParser(){return this.parser}}class V1 extends v{constructor(e){super(e,li)}getParser(){return this.parser}}class j1 extends v{constructor(e){super(e,bu)}getParser(){return this.parser}}class Y1 extends v{constructor(e){super(e,OP)}getParser(){return this.parser}}class W1 extends v{constructor(e){super(e,SP)}getParser(){return this.parser}}class z1 extends v{constructor(e){super(e,Bg)}getParser(){return this.parser}}class X1 extends v{constructor(e){super(e,yP)}getParser(){return this.parser}}class K1 extends v{constructor(e){super(e,MP)}getParser(){return this.parser}}class q1 extends v{constructor(e){super(e,CP)}getParser(){return this.parser}}class Q1 extends v{constructor(e){super(e,NP)}getParser(){return this.parser}}class Z1 extends v{constructor(e){super(e,bP)}getParser(){return this.parser}}class J1 extends v{constructor(e){super(e,UP)}getParser(){return this.parser}}class $1 extends v{constructor(e){super(e,FP)}getParser(){return this.parser}}class eF extends v{constructor(e){super(e,xP)}getParser(){return this.parser}}class tF extends v{constructor(e){super(e,GP)}getParser(){return this.parser}}class sF extends v{constructor(e){super(e,kP)}getParser(){return this.parser}}class rF extends v{constructor(e){super(e,VP)}getParser(){return this.parser}}class iF extends v{constructor(e){super(e,YP)}getParser(){return this.parser}}class nF extends v{constructor(e){super(e,WP)}getParser(){return this.parser}}class aF extends v{constructor(e){super(e,zP)}getParser(){return this.parser}}class eE extends v{constructor(e){super(e,XP)}getParser(){return this.parser}}class oF extends v{constructor(e){super(e,KP)}getParser(){return this.parser}}class hF extends v{constructor(e){super(e,Wc)}getParser(){return this.parser}}class uF extends v{constructor(e){super(e,qP)}getParser(){return this.parser}}class lF extends v{constructor(e){super(e,rN)}getParser(){return this.parser}}class cF extends v{constructor(e){super(e,iN)}getParser(){return this.parser}}class _F extends v{constructor(e){super(e,nN)}getParser(){return this.parser}}class tE extends v{constructor(e){super(e,aN)}getParser(){return this.parser}get userName(){return this.getParser().userName}}class dF extends v{constructor(e){super(e,oN)}getParser(){return this.parser}}class fF extends v{constructor(e){super(e,hN)}getParser(){return this.parser}}class qc extends v{constructor(e){super(e,uN)}getParser(){return this.parser}}class gF extends v{constructor(e){super(e,lN)}getParser(){return this.parser}}class Qc extends v{constructor(e){super(e,cN)}getParser(){return this.parser}}class EF extends v{constructor(e){super(e,_N)}getParser(){return this.parser}}class mF extends v{constructor(e){super(e,fN)}getParser(){return this.parser}}class pF extends v{constructor(e){super(e,EN)}getParser(){return this.parser}}class IF extends v{constructor(e){super(e,pN)}getParser(){return this.parser}}class TF extends v{constructor(e){super(e,IN)}getParser(){return this.parser}}class RF extends v{constructor(e){super(e,TN)}getParser(){return this.parser}}class vF extends v{constructor(e){super(e,RN)}getParser(){return this.parser}}class OF extends v{constructor(e){super(e,vN)}getParser(){return this.parser}}class SF extends v{constructor(e){super(e,ON)}getParser(){return this.parser}}class AF extends v{constructor(e){super(e,yN)}getParser(){return this.parser}}class yF extends v{constructor(e){super(e,CN)}getParser(){return this.parser}}class CF extends v{constructor(e){super(e,MN)}getParser(){return this.parser}}class MF extends v{constructor(e){super(e,PN)}getParser(){return this.parser}}class PF extends v{constructor(e){super(e,NN)}getParser(){return this.parser}}class NF extends v{constructor(e){super(e,bN)}getParser(){return this.parser}}class bF extends v{constructor(e){super(e,DN)}getParser(){return this.parser}}class DF extends v{constructor(e){super(e,LN)}getParser(){return this.parser}}class LF extends v{constructor(e){super(e,FN)}getParser(){return this.parser}}class UF extends v{constructor(e){super(e,wN)}getParser(){return this.parser}}class sE extends v{constructor(e){super(e,xN)}getParser(){return this.parser}}class FF extends v{constructor(e){super(e,GN)}getParser(){return this.parser}}class wF extends v{constructor(e){super(e,BN)}getParser(){return this.parser}}class xF extends v{constructor(e){super(e,HN)}getParser(){return this.parser}}class GF extends v{constructor(e){super(e,kN)}getParser(){return this.parser}}class eQ extends v{constructor(e){super(e,VN)}getParser(){return this.parser}}class BF extends v{constructor(e){super(e,jN)}getParser(){return this.parser}}class HF extends v{constructor(e){super(e,YN)}getParser(){return this.parser}}class kF extends v{constructor(e){super(e,WN)}getParser(){return this.parser}}class VF extends v{constructor(e){super(e,zN)}getParser(){return this.parser}}class jF extends v{constructor(e){super(e,XN)}getParser(){return this.parser}}class rE extends v{constructor(e){super(e,KN)}getParser(){return this.parser}}class YF extends v{constructor(e){super(e,qN)}getParser(){return this.parser}}class WF extends v{constructor(e){super(e,QN)}getParser(){return this.parser}}class zF extends v{constructor(e){super(e,ZN)}getParser(){return this.parser}}class XF{constructor(e){this._itemName=e.readString(),this._extraInfo=e.readString(),this._extraInfo==""&&(this._extraInfo=null)}get itemName(){return this._itemName}get extraInfo(){return this._extraInfo}}class KF{constructor(e){this._thumbnailUrl=e.readString(),this._thumbnailUrl==""&&(this._thumbnailUrl=null),this._productOfferList=[];const t=e.readInt();let s=0;for(;s<t;)this._productOfferList.push(new XF(e)),s++}get productOfferList(){return this._productOfferList}get thumbnailUrl(){return this._thumbnailUrl}}class tQ{flush(){return!0}parse(e){if(!e)return!1;const t=e.readInt();this._giftOptions=[];let s=0;for(;s<t;)this._giftOptions.push(new QF(e)),s++;return!0}get giftOptions(){return this._giftOptions}}class sQ{flush(){return!0}parse(e){return!!e}}class qF extends v{constructor(e){super(e,tQ)}getParser(){return this.parser}}class QF{constructor(e){this._dayIndex=e.readInt(),this._stepIndex=e.readInt(),this._options=[];const t=e.readInt();let s=0;for(;s<t;)this._options.push(new KF(e)),s++}get dayIndex(){return this._dayIndex}get stepIndex(){return this._stepIndex}get options(){return this._options}}class ZF extends v{constructor(e){super(e,sQ)}getParser(){return this.parser}}class JF extends v{constructor(e){super(e,$N)}getParser(){return this.parser}}class $F extends v{constructor(e){super(e,yu)}getParser(){return this.parser}}class iE extends v{constructor(e){super(e,eb)}getParser(){return this.parser}}class nE extends v{constructor(e){super(e,tb)}getParser(){return this.parser}}class aE extends v{constructor(e){super(e,sb)}getParser(){return this.parser}}class oE extends v{constructor(e){super(e,rb)}getParser(){return this.parser}}class ew extends v{constructor(e){super(e,ib)}getParser(){return this.parser}}class hE extends v{constructor(e){super(e,ob)}getParser(){return this.parser}}class uE extends v{constructor(e){super(e,hb)}getParser(){return this.parser}}class lE extends v{constructor(e){super(e,ub)}getParser(){return this.parser}}class cE extends v{constructor(e){super(e,lb)}getParser(){return this.parser}}class _E extends v{constructor(e){super(e,_b)}getParser(){return this.parser}}class dE extends v{constructor(e){super(e,cb)}getParser(){return this.parser}}class fE extends v{constructor(e){super(e,db)}getParser(){return this.parser}}class gE extends v{constructor(e){super(e,fb)}getParser(){return this.parser}}class tw extends v{constructor(e){super(e,mb)}getParser(){return this.parser}}class sw extends v{constructor(e){super(e,Tb)}getParser(){return this.parser}}class rw extends v{constructor(e){super(e,Rb)}getParser(){return this.parser}}class iw extends v{constructor(e){super(e,vb)}getParser(){return this.parser}}class nw extends v{constructor(e){super(e,Ob)}getParser(){return this.parser}}class aw extends v{constructor(e){super(e,Sb)}getParser(){return this.parser}}class ow extends v{constructor(e){super(e,Ab)}getParser(){return this.parser}}class hw extends v{constructor(e){super(e,yb)}getParser(){return this.parser}}class uw extends v{constructor(e){super(e,Cb)}getParser(){return this.parser}}class lw extends v{constructor(e){super(e,Mb)}getParser(){return this.parser}}class cw extends v{constructor(e){super(e,Pb)}getParser(){return this.parser}}class Zc extends v{constructor(e){super(e,Nb)}getParser(){return this.parser}}Zc.FINISHED_OK=1,Zc.FINISHED_FAIL=2;class Lu extends v{constructor(e){super(e,bb)}getParser(){return this.parser}}Lu.SYSTEM_STATUS_ENABLED=1,Lu.SYSTEM_STATUS_DISABLED=2,Lu.SYSTEM_STATUS_TIMEOUT=3;class Jc extends v{constructor(e){super(e,ZA)}getParser(){return this.parser}}class $c extends v{constructor(e){super(e,JA)}getParser(){return this.parser}}class e_ extends v{constructor(e){super(e,ey)}getParser(){return this.parser}}class t_ extends v{constructor(e){super(e,$A)}getParser(){return this.parser}}class _w extends v{constructor(e){super(e,Do)}getParser(){return this.parser}}class s_ extends v{constructor(e){super(e,ty)}getParser(){return this.parser}}class dw extends v{constructor(e){super(e,sy)}getParser(){return this.parser}}class fw extends v{constructor(e){super(e,ry)}getParser(){return this.parser}}class gw extends v{constructor(e){super(e,iy)}getParser(){return this.parser}}class Ew extends v{constructor(e){super(e,ay)}getParser(){return this.parser}}class mw extends v{constructor(e){super(e,Ty)}getParser(){return this.parser}}class pw extends v{constructor(e){super(e,Ry)}getParser(){return this.parser}}class Iw extends v{constructor(e){super(e,vy)}getParser(){return this.parser}}class EE extends v{constructor(e){super(e,Oy)}getParser(){return this.parser}}class r_ extends v{constructor(e){super(e,tC)}getParser(){return this.parser}}class i_ extends v{constructor(e){super(e,sC)}getParser(){return this.parser}}class Tw extends v{constructor(e){super(e,Ay)}getParser(){return this.parser}}class n_ extends v{constructor(e){super(e,yy)}getParser(){return this.parser}}class a_ extends v{constructor(e){super(e,Cy)}getParser(){return this.parser}}class o_ extends v{constructor(e){super(e,My)}getParser(){return this.parser}}class h_ extends v{constructor(e){super(e,Py)}getParser(){return this.parser}}class u_ extends v{constructor(e){super(e,Ny)}getParser(){return this.parser}}class Rw extends v{constructor(e){super(e,by)}getParser(){return this.parser}}class l_ extends v{constructor(e){super(e,Dy)}getParser(){return this.parser}}class c_ extends v{constructor(e){super(e,Wi)}getParser(){return this.parser}}class vw extends v{constructor(e){super(e,Ly)}getParser(){return this.parser}}class Ow extends v{constructor(e){super(e,Uy)}getParser(){return this.parser}}class __ extends v{constructor(e){super(e,Fy)}getParser(){return this.parser}}class Sw extends v{constructor(e){super(e,wy)}getParser(){return this.parser}}class Aw extends v{constructor(e){super(e,xy)}getParser(){return this.parser}}class yw extends v{constructor(e){super(e,Gy)}getParser(){return this.parser}}class d_ extends v{constructor(e){super(e,By)}getParser(){return this.parser}}class Cw extends v{constructor(e){super(e,Hy)}getParser(){return this.parser}}class Mw extends v{constructor(e){super(e,ky)}getParser(){return this.parser}}class Pw extends v{constructor(e){super(e,fr)}getParser(){return this.parser}}class Nw extends v{constructor(e){super(e,Vy)}getParser(){return this.parser}}class mE extends v{constructor(e){super(e,Yy)}getParser(){return this.parser}}class bw extends v{constructor(e){super(e,Wy)}getParser(){return this.parser}}class f_ extends v{constructor(e){super(e,zy)}getParser(){return this.parser}}class g_ extends v{constructor(e){super(e,Xy)}getParser(){return this.parser}}class E_ extends v{constructor(e){super(e,Ky)}getParser(){return this.parser}}class m_ extends v{constructor(e){super(e,qy)}getParser(){return this.parser}}class Dw extends v{constructor(e){super(e,Qy)}getParser(){return this.parser}}class Lw extends v{constructor(e){super(e,Zy)}getParser(){return this.parser}}class Uw extends v{constructor(e){super(e,$y)}getParser(){return this.parser}}class Fw extends v{constructor(e){super(e,eC)}getParser(){return this.parser}}class p_ extends v{constructor(e){super(e,Aa)}getParser(){return this.parser}}class I_ extends v{constructor(e){super(e,rC)}getParser(){return this.parser}}class T_ extends v{constructor(e){super(e,zi)}getParser(){return this.parser}}class R_ extends v{constructor(e){super(e,iC)}getParser(){return this.parser}}class ww extends v{constructor(e){super(e,nC)}getParser(){return this.parser}}class v_ extends v{constructor(e){super(e,aC)}getParser(){return this.parser}}class Pa extends v{constructor(e){super(e,oC)}getParser(){return this.parser}}class O_ extends v{constructor(e){super(e,hC)}getParser(){return this.parser}}class pE extends v{constructor(e){super(e,uC)}getParser(){return this.parser}}class IE extends v{constructor(e){super(e,lC)}getParser(){return this.parser}}class Uu extends v{constructor(e){super(e,cC)}getParser(){return this.parser}}class TE extends v{constructor(e){super(e,_C)}getParser(){return this.parser}}class RE extends v{constructor(e){super(e,dC)}getParser(){return this.parser}}class vE extends v{constructor(e){super(e,gC)}getParser(){return this.parser}}class OE extends v{constructor(e){super(e,EC)}getParser(){return this.parser}}class SE extends v{constructor(e){super(e,mC)}getParser(){return this.parser}}class AE extends v{constructor(e){super(e,pC)}getParser(){return this.parser}}class S_ extends v{constructor(e){super(e,Bc)}getParser(){return this.parser}}class Fu extends v{constructor(e){super(e,Bc)}getParser(){return this.parser}}class wu extends v{constructor(e){super(e,Bc)}getParser(){return this.parser}}class A_ extends v{constructor(e){super(e,IC)}getParser(){return this.parser}}class xu extends v{constructor(e){super(e,TC)}getParser(){return this.parser}}class y_ extends v{constructor(e){super(e,RC)}getParser(){return this.parser}}class Gu extends v{constructor(e){super(e,MC)}getParser(){return this.parser}}class C_ extends v{constructor(e){super(e,vC)}getParser(){return this.parser}}class M_ extends v{constructor(e){super(e,OC)}getParser(){return this.parser}}class yE extends v{constructor(e){super(e,SC)}getParser(){return this.parser}}class P_ extends v{constructor(e){super(e,AC)}getParser(){return this.parser}}class Bu extends v{constructor(e){super(e,yC)}getParser(){return this.parser}}class N_ extends v{constructor(e){super(e,CC)}getParser(){return this.parser}}class Hu extends v{constructor(e){super(e,PC)}getParser(){return this.parser}}class b_ extends v{constructor(e){super(e,DC)}getParser(){return this.parser}}class xw extends v{constructor(e){super(e,Fb)}getParser(){return this.parser}}class Gw extends v{constructor(e){super(e,wb)}getParser(){return this.parser}}class Bw extends v{constructor(e){super(e,xb)}getParser(){return this.parser}}class Hw extends v{constructor(e){super(e,Gb)}getParser(){return this.parser}}class D_ extends v{constructor(e){super(e,Bb)}getParser(){return this.parser}}D_.PRODUCT_DONATED_CODE=6,D_.BADGE_DONATED_CODE=7;class kw extends v{constructor(e){super(e,Hb)}getParser(){return this.parser}}class Vw extends v{constructor(e){super(e,kb)}getParser(){return this.parser}}class jw extends v{constructor(e){super(e,hy)}getParser(){return this.parser}}class Yw extends v{constructor(e){super(e,ly)}getParser(){return this.parser}}class Ww extends v{constructor(e){super(e,cy)}getParser(){return this.parser}}class zw extends v{constructor(e){super(e,_y)}getParser(){return this.parser}}class Xw extends v{constructor(e){super(e,dy)}getParser(){return this.parser}}class Kw extends v{constructor(e){super(e,fy)}getParser(){return this.parser}}class qw extends v{constructor(e){super(e,gy)}getParser(){return this.parser}}class Qw extends v{constructor(e){super(e,Ey)}getParser(){return this.parser}}class Zw extends v{constructor(e){super(e,my)}getParser(){return this.parser}}class Jw extends v{constructor(e){super(e,Ms)}getParser(){return this.parser}}class $w extends v{constructor(e){super(e,py)}getParser(){return this.parser}}class ex extends v{constructor(e){super(e,Iy)}getParser(){return this.parser}}class CE extends v{constructor(e){super(e,Vb)}getParser(){return this.parser}}class ME extends v{constructor(e){super(e,jb)}getParser(){return this.parser}}class PE extends v{constructor(e){super(e,Yb)}getParser(){return this.parser}}class NE extends v{constructor(e){super(e,Wb)}getParser(){return this.parser}}class tx extends v{constructor(e){super(e,zb)}getParser(){return this.parser}}class sx extends v{constructor(e){super(e,Xb)}getParser(){return this.parser}}class rx extends v{constructor(e){super(e,Kb)}getParser(){return this.parser}}class bE extends v{constructor(e){super(e,Qb)}getParser(){return this.parser}}class DE extends v{constructor(e){super(e,Zb)}getParser(){return this.parser}}class ix extends v{constructor(e){super(e,Jb)}getParser(){return this.parser}}class nx extends v{constructor(e){super(e,eD)}getParser(){return this.parser}}class ax extends v{constructor(e){super(e,sD)}getParser(){return this.parser}}class LE extends v{constructor(e){super(e,cA)}getParser(){return this.parser}}class UE extends v{constructor(e){super(e,Ou)}getParser(){return this.parser}}class ox extends v{constructor(e){super(e,_A)}getParser(){return this.parser}}class hx extends v{constructor(e){super(e,Sg)}getParser(){return this.parser}}class ux extends v{constructor(e){super(e,fA)}getParser(){return this.parser}}class FE extends v{constructor(e){super(e,gA)}getParser(){return this.parser}}class ku extends v{constructor(e){super(e,mA)}getParser(){return this.parser}}class L_ extends v{constructor(e){super(e,pA)}getParser(){return this.parser}}class lx extends v{constructor(e){super(e,IA)}getParser(){return this.parser}}class cx extends v{constructor(e){super(e,TA)}getParser(){return this.parser}}class wE extends v{constructor(e){super(e,RA)}getParser(){return this.parser}}class xE extends v{constructor(e){super(e,vA)}getParser(){return this.parser}}class _x extends v{constructor(e){super(e,OA)}getParser(){return this.parser}}class dx extends v{constructor(e){super(e,SA)}getParser(){return this.parser}}class fx extends v{constructor(e){super(e,AA)}getParser(){return this.parser}}class gx extends v{constructor(e){super(e,yg)}getParser(){return this.parser}}class Ex extends v{constructor(e){super(e,yA)}getParser(){return this.parser}}class mx extends v{constructor(e){super(e,CA)}getParser(){return this.parser}}class GE extends v{constructor(e){super(e,MA)}getParser(){return this.parser}}class px extends v{constructor(e){super(e,Cg)}getParser(){return this.parser}}class BE extends v{constructor(e){super(e,PA)}getParser(){return this.parser}}class U_ extends v{constructor(e){super(e,NA)}getParser(){return this.parser}}class HE extends v{constructor(e){super(e,bA)}getParser(){return this.parser}}class Ix extends v{constructor(e){super(e,DA)}getParser(){return this.parser}}class Tx extends v{constructor(e){super(e,LA)}getParser(){return this.parser}}class Rx extends v{constructor(e){super(e,bo)}getParser(){return this.parser}}class $s{constructor(e){this._type=e.readInt(),this._userId=e.readInt(),this._userName=e.readString(),this._figure=e.readString(),this._memberSince=e.readString()}get userId(){return this._userId}get userName(){return this._userName}get admin(){return this._type==$s.TYPE_ADMIN}get owner(){return this._type==$s.TYPE_OWNER}get pending(){return this._type==$s.TYPE_PENDING}get member(){return this._type!=$s.TYPE_MEMBER}get blocked(){return this._type==$s.TYPE_BLOCKED}get figure(){return this._figure}get memberSince(){return this._memberSince}}$s.TYPE_OWNER=0,$s.TYPE_ADMIN=1,$s.TYPE_PENDING=2,$s.TYPE_MEMBER=3,$s.TYPE_BLOCKED=4;class kE extends v{constructor(e){super(e,sM)}getParser(){return this.parser}}class VE extends v{constructor(e){super(e,rM)}getParser(){return this.parser}}class jE extends v{constructor(e){super(e,iM)}getParser(){return this.parser}}class vx extends v{constructor(e){super(e,oM)}getParser(){return this.parser}}class Ox extends v{constructor(e){super(e,hM)}getParser(){return this.parser}}class Sx extends v{constructor(e){super(e,uM)}getParser(){return this.parser}}class Ax extends v{constructor(e){super(e,iD)}getParser(){return this.parser}}class yx{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class Cx{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class Mx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Px{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class Nx{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class bx{constructor(e=0){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Dx{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class Lx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Ux{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Fx{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Vu{constructor(e="",t="",s="",i=-1,n=-1){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=[]}assignBitmap(e){const t=Je.generateImageUrl(e);if(!t)return;const s=t.split(",")[1],i=Uint8Array.from(atob(s),n=>n.charCodeAt(0));this._data.push(i.byteLength,i.buffer)}assignBase64(e){const t=e.split(",")[1],s=Uint8Array.from(atob(t),i=>i.charCodeAt(0));this._data.push(s.byteLength,s.buffer)}}class F_ extends Vu{constructor(e="",t="",s="",i=-1,n=-1){super(e,t,s,i,n)}}class wx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class xx{constructor(e,t){this._data=[e,t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Gx{constructor(e,t){this._data=[e,t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Bx{constructor(e,t,s,i,n,a){this._data=[e,t,s,i,n,a]}dispose(){this._data=null}getMessageArray(){return this._data}}class Hx{constructor(e,t,s,i){this._data=[e,t,s,i]}dispose(){this._data=null}getMessageArray(){return this._data}}class kx{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class Vx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class jx{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class Yx{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Wx{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class zx{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Xx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Kx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class qx{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){this._data=null}}class Qx{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){this._data=null}}class Zx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Jx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class $x{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class eG{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){this._data=null}}class tG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class sG{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){this._data=null}}class rG{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class iG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class nG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class aG{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class oG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class hG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class uG{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){this._data=null}}class lG{constructor(e,t,s,i,n,a,o,u,l){this._data=[e,t,s,i,n,a,o,u,l]}getMessageArray(){return this._data}dispose(){}}class cG{constructor(e,t,s,i){this._data=[e,t,s,i]}getMessageArray(){return this._data}dispose(){}}class _G{constructor(e,t,s,i,n,a,o){this._data=[e,t,s,i,n,a,o]}getMessageArray(){return this._data}dispose(){}}class dG{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class fG{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class gG{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class EG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class mG{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class pG{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class IG{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class TG{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class RG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class vG{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class OG{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class SG{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class AG{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class yG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Vo{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}Vo.CONFIRM_LEVEL_NOT_ACCEPTED=0,Vo.CONFIRM_LEVEL_NOT_SUBMITTED=1,Vo.CONFIRM_LEVEL_NOT_CONFIRMED=2,Vo.CONFIRM_LEVEL_COMMIT=3;class CG{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class MG{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class PG{constructor(e,t){this._data=[e,t.length].concat(t)}getMessageArray(){return this._data}dispose(){}}class NG{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class bG{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class DG{constructor(e,t){this._data=[e,t.length].concat(t)}getMessageArray(){return this._data}dispose(){}}class LG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class UG{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class FG{constructor(...e){this._data=[e.length,...e]}getMessageArray(){return this._data}dispose(){}}class wG{constructor(e,...t){this._data=[e,t.length,...t]}getMessageArray(){return this._data}dispose(){}}class xG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class GG{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class BG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class HG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class kG{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class VG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class jG{constructor(...e){this._data=[e.length,...e]}getMessageArray(){return this._data}dispose(){}}class YG{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class WG{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class zG{constructor(e,t){this._data=[t.length,...t,e]}getMessageArray(){return this._data}dispose(){}}class XG{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class KG{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class qG{constructor(e=!0){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class QG{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class ZG{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class JG{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class $G{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class eB{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class tB{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class sB{constructor(e,t){this._data=[e,t]}dispose(){this._data=null}getMessageArray(){return this._data}}class rB{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class iB{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class nB{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class aB{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class YE{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class oB{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class hB{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class uB{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class lB{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class cB{constructor(e,t,s,i,n,a){this._data=[e,t,s,i,n,a]}dispose(){this._data=null}getMessageArray(){return this._data}}class _B{constructor(e,t,s,i,n,a){this._data=[e,t,s,i,n,a]}dispose(){this._data=null}getMessageArray(){return this._data}}class dB{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class fB{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class WE{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}WE.NO_ISSUE_ID=-1;class gB{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class zE{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}zE.NO_ISSUE_ID=-1;class EB{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class mB{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class pB{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class IB{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class TB{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class RB{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class vB{constructor(e,t,s,i,n,a){this._data=[e,t,s,i,n,a.length,...a]}getMessageArray(){return this._data}dispose(){}}class OB{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class SB{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class AB{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class yB{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class CB{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class MB{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class PB{constructor(e,t,s,i){this._data=[e,t,s,i]}getMessageArray(){return this._data}dispose(){}}class NB{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class bB{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class DB{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class LB{constructor(e,t){this._data=[e,t.length,...t]}getMessageArray(){return this._data}dispose(){}}class UB{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class FB{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class wB{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class xB{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class GB{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class BB{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class HB{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class kB{constructor(e,t,s,i){this._data=[e,t,s,i]}getMessageArray(){return this._data}dispose(){}}class VB{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class jB{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class YB{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class WB{constructor(e,t,s,i){this._data=[e,t,s,i]}getMessageArray(){return this._data}dispose(){}}class zB{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class XB{constructor(e,t,s,i){this._data=[e,t,s,i]}getMessageArray(){return this._data}dispose(){}}class KB{constructor(...e){this._data=[e.length],e.forEach(t=>{this._data.push(t.k),this._data.push(t._arg_2),this._data.push(t._arg_3)})}getMessageArray(){return this._data}dispose(){}}class rQ{constructor(e,t,s){this.k=e,this._arg_2=t,this._arg_3=s}}class qB{constructor(e,t,s,i,n){this._data=[e,t,s,i,n]}getMessageArray(){return this._data}dispose(){}}class QB{constructor(e,t,s,i){this._data=[e,t,i,s]}getMessageArray(){return this._data}dispose(){}}class ZB{constructor(e,t,s){if(this._type=e,t.length===s.length){this._data=[];for(let i=0;i<t.length;i++)this._data.push(t[i]),this._data.push(s[i])}}getMessageArray(){return this._data}dispose(){}}class XE{constructor(e,t,s,i){this._data=[`NITRO-${hi.RENDERER_VERSION.replaceAll(".","-")}`,"HTML5",jh.HTML5,cc.BROWSER]}getMessageArray(){return this._data}dispose(){}}class JB{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class $B{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class KE{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class e2{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class qE{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class QE{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class t2{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class s2{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class r2{constructor(e,t,s,i,n){this._data=[e,t,s,i,n]}getMessageArray(){return this._data}dispose(){}}class i2{constructor(e,t,s,i){this._data=[e,t,s,i]}getMessageArray(){return this._data}dispose(){}}class n2{constructor(e,t,s,i){this._data=[e,t,s,i.length/2,...i]}getMessageArray(){return this._data}dispose(){}}class a2{constructor(e,t,s,i,n){this._data=[e,t,s,i,n]}getMessageArray(){return this._data}dispose(){}}class o2{constructor(e,t,s,i,n){this._data=[e,t,s,i,n]}getMessageArray(){return this._data}dispose(){}}class h2{constructor(e,t,s,i,n){this._data=[e,t,s,i,n.length/2,...n]}getMessageArray(){return this._data}dispose(){}}class u2{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class l2{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class c2{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class _2{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class d2{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class f2{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class g2{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class E2{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class m2{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class p2{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class I2{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class T2{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class R2{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class v2{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class O2{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class S2{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class A2{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class y2{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class C2{constructor(e,t,s,i){this._data=[e,t,s,i]}getMessageArray(){return this._data}dispose(){}}class M2{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class P2{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class N2{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class b2{constructor(e,t){this._data=[e,t.length,...t]}getMessageArray(){return this._data}dispose(){}}class D2{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class L2{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class U2{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class F2{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class w2{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class x2{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class G2{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class B2{constructor(){this._badges=[]}getMessageArray(){const e=[];for(let t=1;t<=this._badges.length;t++)e.push(t),e.push(this._badges[t-1]);return e}dispose(){}addActivatedBadge(e){this._badges.push(e)}}class ZE{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class H2{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class k2{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class V2{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class j2{constructor(e,t,s,i){this._data=[e,t,s,i]}getMessageArray(){return this._data}dispose(){}}class JE{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Y2{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class W2{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class z2{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class X2{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class K2{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class q2{constructor(...e){this._data=[e.length,...e]}getMessageArray(){return this._data}dispose(){}}class Q2{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Z2{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class J2{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class $2{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class eH{constructor(e,...t){this._data=[e,t.length,...t]}getMessageArray(){return this._data}dispose(){}}class tH{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class sH{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class rH{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){this._data=null}}class iH{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class nH{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){this._data=null}}class aH{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class oH{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class hH{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){this._data=null}}class uH{constructor(e,t,s,i){this._data=[e,t,s,i]}getMessageArray(){return this._data}dispose(){this._data=null}}class lH{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class cH{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class _H{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class dH{constructor(e,t,s){this._data=[e,t.length,...t,s]}getMessageArray(){return this._data}dispose(){}}class ju{constructor(e,t){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}ju.RESOLUTION_USELESS=1,ju.RESOLUTION_ABUSIVE=2,ju.RESOLUTION_RESOLVED=3;class Ur{constructor(e,t,s,i,n,a=-1){this._data=[e,t,s,i,n],a!=Ur.NO_ISSUE_ID&&this._data.push(a)}getMessageArray(){return this._data}dispose(){}}Ur.NO_ISSUE_ID=-1;class fH{constructor(e,t,s,i=-1){this._data=[e,t,s],i!=Ur.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class gH{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class EH{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class mH{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class pH{constructor(e,t=0){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class IH{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class TH{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class RH{constructor(e,t,s,i=-1){this._data=[e,t,s],i!=Ur.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class vH{constructor(e,t,s,i){this._data=[e,t,s,i]}getMessageArray(){return this._data}dispose(){}}class jo{constructor(e,t,s){this._data=[],this._data.push(e),this._data.push(t),this._data.push(s)}getMessageArray(){return this._data}dispose(){}}jo.ACTION_ALERT=0,jo.ACTION_KICK=1,jo.ACTION_MESSAGE=3,jo.ACTION_MESSAGE_AND_SOFT_KICK=4;class OH{constructor(e,t,s,i=-1){this._data=[e,t,s],i!=Ur.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class SH{constructor(e,t,s,i=-1){this._data=[],this._data.push(e),this._data.push(t),this._data.push(""),this._data.push(""),this._data.push(s),i!=Ur.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class AH{constructor(e,t,s,i=-1){this._data=[e,t,s],i!=Ur.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class yH{constructor(e,t,s,i){this._data=[e,t,s,i]}getMessageArray(){return this._data}dispose(){}}class CH{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class MH{constructor(e,t,s,i,n=-1){this._data=[e,t,s,i],n!=Ur.NO_ISSUE_ID&&this._data.push(n)}getMessageArray(){return this._data}dispose(){}}class PH{constructor(e,t,s,i){this._data=[e.length,...e,t,s,i]}getMessageArray(){return this._data}dispose(){}}class NH{constructor(e){this._data=[e.length,...e]}getMessageArray(){return this._data}dispose(){}}class bH{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class DH{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class LH{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class UH{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class FH{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class wH{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class xH{constructor(e,t,s,i,n,a){this._data=[e,t,s,i,n,a]}getMessageArray(){return this._data}dispose(){}}class GH{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class BH{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class HH{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class kH{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class VH{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class jH{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class YH{constructor(e,t,s){this._data=[e,t?1:0,s?1:0]}getMessageArray(){return this._data}dispose(){}}class WH{constructor(e=0){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class zH{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class XH{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class KH{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class qH{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class QH{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ZH{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class JH{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class $H{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ek{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class tk{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class sk{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class rk{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ik{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class nk{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class ak{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ok{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class hk{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class uk{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class lk{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class ck{constructor(e,t,s,i,n,a){this._data=[e,t,s,i,n,a]}getMessageArray(){return this._data}dispose(){}}class _k{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class dk{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class fk{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class gk{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class Ek{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class mk{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class pk{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Ik{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Tk{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Rk{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class vk{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Ok{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Sk{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class Ak{constructor(e,t,s,i){this._data=[e,t,s,i]}getMessageArray(){return this._data}dispose(){}}class yk{constructor(...e){this._data=[e.length*3],e.forEach(t=>{this._data.push(t.dayIndex),this._data.push(t.stepIndex),this._data.push(t.giftIndex)})}dispose(){this._data=null}getMessageArray(){return this._data}}class iQ{constructor(e,t,s){this._dayIndex=e,this._stepIndex=t,this._giftIndex=s}get dayIndex(){return this._dayIndex}get stepIndex(){return this._stepIndex}get giftIndex(){return this._giftIndex}}class $E{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class E{}E.ACHIEVEMENT_LIST=219,E.AUTHENTICATION=-1,E.BOT_CONFIGURATION=1986,E.BOT_PICKUP=3323,E.BOT_PLACE=1592,E.BOT_SKILL_SAVE=2624,E.GET_CLUB_OFFERS=3285,E.GET_CLUB_GIFT_INFO=487,E.GET_CATALOG_INDEX=1195,E.GET_CATALOG_PAGE=412,E.CATALOG_PURCHASE=3492,E.CATALOG_PURCHASE_GIFT=1411,E.GET_PRODUCT_OFFER=2594,E.CLIENT_LATENCY=295,E.CLIENT_LATENCY_MEASURE=96,E.CLIENT_POLICY=26979,E.CLIENT_PONG=2596,E.CLIENT_TOOLBAR_TOGGLE=2313,E.CLIENT_VARIABLES=1053,E.GET_CURRENT_TIMING_CODE=2912,E.DESKTOP_NEWS=1827,E.DESKTOP_VIEW=105,E.GET_BUNDLE_DISCOUNT_RULESET=223,E.EVENT_TRACKER=3457,E.FIND_NEW_FRIENDS=516,E.FURNITURE_ALIASES=3898,E.FURNITURE_FLOOR_UPDATE=248,E.FURNITURE_MULTISTATE=99,E.FURNITURE_PICKUP=3456,E.FURNITURE_PLACE=1258,E.FURNITURE_POSTIT_PLACE=2248,E.FURNITURE_POSTIT_SAVE_STICKY_POLE=3283,E.FURNITURE_RANDOMSTATE=3617,E.FURNITURE_WALL_MULTISTATE=210,E.FURNITURE_WALL_UPDATE=168,E.GAMES_INIT=2914,E.GAMES_LIST=741,E.ACCEPTGAMEINVITE=3802,E.GAMEUNLOADEDMESSAGE=3207,E.GETGAMEACHIEVEMENTSMESSAGE=2399,E.GETGAMESTATUSMESSAGE=3171,E.GETUSERGAMEACHIEVEMENTSMESSAGE=389,E.JOINQUEUEMESSAGE=1458,E.LEAVEQUEUEMESSAGE=2384,E.RESETRESOLUTIONACHIEVEMENTMESSAGE=3144,E.GETWEEKLYGAMEREWARDWINNERS=1054,E.GAME2GETACCOUNTGAMESTATUSMESSAGE=11,E.GAME2CHECKGAMEDIRECTORYSTATUSMESSAGE=3259,E.GAME2EXITGAMEMESSAGE=1445,E.GAME2GAMECHATMESSAGE=2502,E.GAME2LOADSTAGEREADYMESSAGE=2415,E.GAME2PLAYAGAINMESSAGE=3196,E.GAME2REQUESTFULLSTATUSUPDATEMESSAGE=1598,E.GAME2GETWEEKLYFRIENDSLEADERBOARD=1232,E.GAME2GETWEEKLYLEADERBOARD=2565,E.GET_GIFT_WRAPPING_CONFIG=418,E.GROUP_ADMIN_ADD=2894,E.GROUP_ADMIN_REMOVE=722,E.GROUP_CREATE_OPTIONS=798,E.GROUP_FAVORITE=3549,E.GET_FORUM_STATS=3149,E.GET_FORUM_THREADS=873,E.GET_FORUMS_LIST=436,E.GET_FORUM_MESSAGES=232,E.GET_FORUM_THREAD=3900,E.GET_UNREAD_FORUMS_COUNT=2908,E.FORUM_MODERATE_MESSAGE=286,E.FORUM_MODERATE_THREAD=1397,E.FORUM_POST_MESSAGE=3529,E.UPDATE_FORUM_READ_MARKER=1855,E.UPDATE_FORUM_SETTINGS=2214,E.FORUM_UPDATE_THREAD=3045,E.GROUP_INFO=2991,E.GROUP_DELETE=1134,E.GROUP_MEMBER_REMOVE_CONFIRM=3593,E.GROUP_MEMBER_REMOVE=593,E.GROUP_MEMBERS=312,E.GROUP_MEMBERSHIPS=367,E.GROUP_REQUEST=998,E.GROUP_REQUEST_ACCEPT=3386,E.GROUP_REQUEST_DECLINE=1894,E.GROUP_SETTINGS=1004,E.GROUP_PARTS=813,E.GROUP_BUY=230,E.GROUP_SAVE_INFORMATION=3137,E.GROUP_SAVE_BADGE=1991,E.GROUP_SAVE_COLORS=1764,E.GROUP_SAVE_PREFERENCES=3435,E.GROUP_BADGES=21,E.GROUP_UNBLOCK_MEMBER=2864,E.GET_BADGE_POINTS_LIMITS=1371,E.REQUESTABADGE=3077,E.GETISBADGEREQUESTFULFILLED=1364,E.ITEM_CLOTHING_REDEEM=3374,E.ITEM_COLOR_WHEEL_CLICK=2144,E.ITEM_DICE_CLICK=1990,E.ITEM_DICE_CLOSE=1533,E.ITEM_DIMMER_SAVE=1648,E.ITEM_DIMMER_SETTINGS=2813,E.ITEM_DIMMER_TOGGLE=2296,E.ITEM_EXCHANGE_REDEEM=3115,E.ITEM_PAINT=711,E.SET_OBJECT_DATA=3608,E.ITEM_STACK_HELPER=3839,E.ITEM_WALL_CLICK=210,E.ITEM_WALL_UPDATE=168,E.MARKETPLACE_CONFIG=2597,E.ACCEPT_FRIEND=137,E.MESSENGER_CHAT=3567,E.DECLINE_FRIEND=2890,E.FOLLOW_FRIEND=3997,E.MESSENGER_FRIENDS=1523,E.MESSENGER_INIT=2781,E.MESSENGER_RELATIONSHIPS=2138,E.SET_RELATIONSHIP_STATUS=3768,E.REMOVE_FRIEND=1689,E.REQUEST_FRIEND=3157,E.GET_FRIEND_REQUESTS=2448,E.SEND_ROOM_INVITE=1276,E.HABBO_SEARCH=1210,E.FRIEND_LIST_UPDATE=1419,E.MOD_TOOL_USER_INFO=3295,E.GET_USER_FLAT_CATS=3027,E.NAVIGATOR_INIT=2110,E.NAVIGATOR_SEARCH=249,E.NAVIGATOR_SEARCH_CLOSE=1834,E.NAVIGATOR_SEARCH_OPEN=637,E.NAVIGATOR_SEARCH_SAVE=2226,E.GET_USER_EVENT_CATS=1782,E.NAVIGATOR_SETTINGS_SAVE=3159,E.NAVIGATOR_CATEGORY_LIST_MODE=1202,E.NAVIGATOR_DELETE_SAVED_SEARCH=1954,E.PET_INFO=2934,E.PET_PICKUP=1581,E.PET_PLACE=2647,E.PET_RESPECT=3202,E.PET_RIDE=1036,E.PET_MOVE=3449,E.PET_OPEN_PACKAGE=3698,E.PET_SELECTED=549,E.PETS_BREED=1638,E.PET_CANCEL_BREEDING=2713,E.PET_CONFIRM_BREEDING=3382,E.GET_PET_TRAINING_PANEL=2161,E.RECYCLER_PRIZES=398,E.RECYCLER_STATUS=1342,E.RECYCLER_ITEMS=2771,E.RELEASE_VERSION=4e3,E.CALL_FOR_HELP=1691,E.ROOM_AMBASSADOR_ALERT=2996,E.ROOM_BAN_GIVE=1477,E.ROOM_BAN_LIST=2267,E.ROOM_BAN_REMOVE=992,E.ROOM_CREATE=2752,E.ROOM_DELETE=532,E.ROOM_DOORBELL=1644,E.ROOM_ENTER=2312,E.ROOM_FAVORITE=3817,E.ROOM_FAVORITE_REMOVE=309,E.CAN_CREATE_ROOM=2128,E.CANCEL_ROOM_EVENT=2725,E.EDIT_ROOM_EVENT=3991,E.COMPETITION_ROOM_SEARCH=433,E.FORWARD_TO_RANDOM_PROMOTED_ROOM=10,E.FORWARD_TO_SOME_ROOM=1703,E.GET_CATEGORIES_WITH_USER_COUNT=3782,E.GET_GUEST_ROOM=2230,E.GET_OFFICIAL_ROOMS=1229,E.GET_POPULAR_ROOM_TAGS=826,E.GUILD_BASE_SEARCH=2930,E.MY_FAVOURITE_ROOMS_SEARCH=2578,E.MY_FREQUENT_ROOM_HISTORY_SEARCH=1002,E.MY_FRIENDS_ROOM_SEARCH=2266,E.MY_GUILD_BASES_SEARCH=39,E.MY_RECOMMENDED_ROOMS=2537,E.MY_ROOM_HISTORY_SEARCH=2264,E.MY_ROOM_RIGHTS_SEARCH=272,E.MY_ROOMS_SEARCH=2277,E.POPULAR_ROOMS_SEARCH=2758,E.ROOM_AD_EVENT_TAB_CLICKED=2412,E.ROOM_AD_EVENT_TAB_VIEWED=2668,E.ROOM_AD_SEARCH=2809,E.ROOM_TEXT_SEARCH=3943,E.ROOMS_WHERE_MY_FRIENDS_ARE=1786,E.ROOMS_WITH_HIGHEST_SCORE_SEARCH=2939,E.SET_ROOM_SESSION_TAGS=3305,E.UPDATE_ROOM_THUMBNAIL=2468,E.ROOM_KICK=1320,E.ROOM_LIKE=3582,E.ROOM_MODEL=2300,E.GET_OCCUPIED_TILES=1687,E.GET_ROOM_ENTRY_TILE=3559,E.ROOM_MODEL_SAVE=875,E.ROOM_MUTE=3637,E.ROOM_MUTE_USER=3485,E.ROOM_RIGHTS_GIVE=808,E.ROOM_RIGHTS_LIST=3385,E.ROOM_RIGHTS_REMOVE=2064,E.ROOM_RIGHTS_REMOVE_ALL=2683,E.ROOM_RIGHTS_REMOVE_OWN=3182,E.ROOM_SETTINGS=3129,E.ROOM_SETTINGS_SAVE=1969,E.ROOM_SETTINGS_UPDATE_ROOM_CATEGORY_AND_TRADE=1265,E.ROOM_STAFF_PICK=1918,E.ROOM_FILTER_WORDS=1911,E.ROOM_FILTER_WORDS_MODIFY=3001,E.MYSTERYBOXWAITINGCANCELEDMESSAGE=2012,E.MYSTERYBOX_OPEN_TROPHY=3074,E.SECURITY_MACHINE=2490,E.SECURITY_TICKET=2419,E.TRADE=1481,E.TRADE_ACCEPT=3863,E.TRADE_CANCEL=2341,E.TRADE_CLOSE=2551,E.TRADE_CONFIRM=2760,E.TRADE_ITEM=3107,E.TRADE_ITEM_REMOVE=3845,E.TRADE_ITEMS=1263,E.TRADE_UNACCEPT=1444,E.UNIT_ACTION=2456,E.UNIT_CHAT=1314,E.UNIT_CHAT_SHOUT=2085,E.UNIT_CHAT_WHISPER=1543,E.UNIT_DANCE=2080,E.UNIT_DROP_HAND_ITEM=2814,E.UNIT_GIVE_HANDITEM=2941,E.UNIT_LOOK=3301,E.UNIT_POSTURE=2235,E.UNIT_SIGN=1975,E.UNIT_TYPING=1597,E.UNIT_TYPING_STOP=1474,E.UNIT_WALK=3320,E.USER_BADGES=2769,E.USER_BADGES_CURRENT=2091,E.USER_BADGES_CURRENT_UPDATE=644,E.USER_BOTS=3848,E.USER_CURRENCY=273,E.USER_EFFECT_ACTIVATE=2959,E.USER_EFFECT_ENABLE=1752,E.USER_FIGURE=2730,E.USER_FURNITURE=3150,E.REQUESTFURNIINVENTORYWHENNOTINROOM=3500,E.USER_HOME_ROOM=1740,E.USER_INFO=357,E.USER_MOTTO=2228,E.USER_IGNORED=3878,E.USER_PETS=3095,E.USER_PROFILE=3265,E.USER_PROFILE_BY_NAME=2249,E.USER_RESPECT=2694,E.GET_SOUND_SETTINGS=2388,E.USER_SETTINGS_CAMERA=1461,E.USER_SETTINGS_CHAT_STYLE=1030,E.USER_SETTINGS_INVITES=1086,E.USER_SETTINGS_OLD_CHAT=1262,E.USER_SETTINGS_VOLUME=1367,E.USER_SUBSCRIPTION=3166,E.GET_WARDROBE=2742,E.SAVE_WARDROBE_OUTFIT=800,E.USER_TAGS=17,E.PEER_USERS_CLASSIFICATION=1160,E.USER_CLASSIFICATION=2285,E.VISIT_USER=2970,E.WIRED_ACTION_SAVE=2281,E.WIRED_APPLY_SNAPSHOT=3373,E.WIRED_CONDITION_SAVE=3203,E.WIRED_OPEN=768,E.WIRED_TRIGGER_SAVE=1520,E.GET_ITEM_DATA=3964,E.ONE_WAY_DOOR_CLICK=2765,E.REMOVE_WALL_ITEM=3336,E.SET_ITEM_DATA=3666,E.CATALOG_REDEEM_VOUCHER=339,E.ROOM_TONER_APPLY=2880,E.FRIEND_FURNI_CONFIRM_LOCK=3775,E.MANNEQUIN_SAVE_NAME=2850,E.MANNEQUIN_SAVE_LOOK=2209,E.PRESENT_OPEN_PRESENT=3558,E.CATALOG_SELECT_VIP_GIFT=2276,E.USER_IGNORE_ID=3314,E.USER_IGNORE=1117,E.USER_UNIGNORE=2061,E.MODTOOL_REQUEST_ROOM_INFO=707,E.MODTOOL_CHANGE_ROOM_SETTINGS=3260,E.MODTOOL_REQUEST_USER_CHATLOG=1391,E.MODTOOL_REQUEST_ROOM_CHATLOG=2587,E.MODTOOL_SANCTION_ALERT=229,E.MODTOOL_SANCTION_BAN=2766,E.MODTOOL_SANCTION_KICK=2582,E.MODTOOL_SANCTION_TRADELOCK=3742,E.MODTOOL_ALERTEVENT=1840,E.MODTOOL_SANCTION_MUTE=1945,E.MODTOOL_REQUEST_USER_ROOMS=3526,E.MODTOOL_ROOM_ALERT=3842,E.MODTOOL_PREFERENCES=31,E.CLOSE_ISSUE_DEFAULT_ACTION=2717,E.CLOSE_ISSUES=2067,E.DEFAULT_SANCTION=1681,E.GET_CFH_CHATLOG=211,E.MODTOOL_SANCTION=1392,E.PICK_ISSUES=15,E.RELEASE_ISSUES=1572,E.CONVERT_GLOBAL_ROOM_ID=314,E.REQUEST_SELL_ITEM=848,E.REQUEST_MARKETPLACE_ITEM_STATS=3288,E.MARKETPLACE_SELL_ITEM=3447,E.MARKETPLACE_REQUEST_OWN_ITEMS=2105,E.MARKETPLACE_TAKE_BACK_ITEM=434,E.MARKETPLACE_REDEEM_CREDITS=2650,E.MARKETPLACE_REQUEST_OFFERS=2407,E.MARKETPLACE_BUY_OFFER=1603,E.MARKETPLACE_BUY_TOKENS=1866,E.CATALOG_REQUESET_PET_BREEDS=1756,E.APPROVE_NAME=2109,E.UNIT_GIVE_HANDITEM_PET=2768,E.PET_MOUNT=1036,E.PET_SUPPLEMENT=749,E.FURNITURE_GROUP_INFO=2651,E.ACHIEVEMENT_RESOLUTION_OPEN=359,E.USE_PET_PRODUCT=1328,E.REMOVE_PET_SADDLE=186,E.TOGGLE_PET_RIDING=1472,E.TOGGLE_PET_BREEDING=3379,E.UNSEEN_RESET_CATEGORY=3493,E.UNSEEN_RESET_ITEMS=2343,E.COMMUNITY_GOAL_VOTE_COMPOSER=3536,E.GET_PROMO_ARTICLES=1827,E.ACCEPT_QUEST=3604,E.ACTIVATE_QUEST=793,E.CANCEL_QUEST=3133,E.FRIEND_REQUEST_QUEST_COMPLETE=1148,E.GET_COMMUNITY_GOAL_EARNED_PRIZES=2688,E.GET_COMMUNITY_GOAL_HALL_OF_FAME=2167,E.GET_COMMUNITY_GOAL_PROGRESS=1145,E.GET_CONCURRENT_USERS_GOAL_PROGRESS=1343,E.GET_CONCURRENT_USERS_REWARD=3872,E.GET_DAILY_QUEST=2486,E.GET_QUESTS=3333,E.GET_SEASONAL_QUESTS_ONLY=1190,E.OPEN_QUEST_TRACKER=2750,E.REDEEM_COMMUNITY_GOAL_PRIZE=90,E.REJECT_QUEST=2397,E.START_CAMPAIGN=1697,E.GET_BONUS_RARE_INFO=957,E.CRAFT=3591,E.CRAFT_SECRET=1251,E.GET_CRAFTABLE_PRODUCTS=633,E.GET_CRAFTING_RECIPE=1173,E.GET_CRAFTING_RECIPES_AVAILABLE=3086,E.PHOTO_COMPETITION=3959,E.PUBLISH_PHOTO=2068,E.PURCHASE_PHOTO=2408,E.RENDER_ROOM=3226,E.RENDER_ROOM_THUMBNAIL=1982,E.REQUEST_CAMERA_CONFIGURATION=796,E.ADD_JUKEBOX_DISK=753,E.GET_JUKEBOX_PLAYLIST=1435,E.GET_NOW_PLAYING=1325,E.GET_OFFICIAL_SONG_ID=3189,E.GET_SONG_INFO=3082,E.GET_SOUND_MACHINE_PLAYLIST=3498,E.GET_USER_SONG_DISKS=2304,E.REMOVE_JUKEBOX_DISK=3050,E.INTERSTITIAL_SHOWN=1109,E.GET_INTERSTITIAL=2519,E.CHANGE_USERNAME=2977,E.CHECK_USERNAME=3950,E.OPEN_CAMPAIGN_CALENDAR_DOOR_STAFF=3889,E.OPEN_CAMPAIGN_CALENDAR_DOOR=2257,E.BUILDERS_CLUB_PLACE_ROOM_ITEM=1051,E.BUILDERS_CLUB_PLACE_WALL_ITEM=462,E.BUILDERS_CLUB_QUERY_FURNI_COUNT=2529,E.GET_CATALOG_PAGE_EXPIRATION=742,E.GET_CATALOG_PAGE_WITH_EARLIEST_EXP=3135,E.GET_DIRECT_CLUB_BUY_AVAILABLE=801,E.GET_HABBO_BASIC_MEMBERSHIP_EXTEND_OFFER=603,E.GET_HABBO_CLUB_EXTEND_OFFER=2462,E.GET_IS_OFFER_GIFTABLE=1347,E.GET_LIMITED_OFFER_APPEARING_NEXT=410,E.GET_NEXT_TARGETED_OFFER=596,E.GET_ROOM_AD_PURCHASE_INFO=1075,E.GET_SEASONAL_CALENDAR_DAILY_OFFER=3257,E.GET_TARGETED_OFFER=2487,E.MARK_CATALOG_NEW_ADDITIONS_PAGE_OPENED=2150,E.PURCHASE_BASIC_MEMBERSHIP_EXTENSION=2735,E.PURCHASE_ROOM_AD=777,E.PURCHASE_TARGETED_OFFER=1826,E.PURCHASE_VIP_MEMBERSHIP_EXTENSION=3407,E.ROOM_AD_PURCHASE_INITIATED=2283,E.SET_TARGETTED_OFFER_STATE=2041,E.SHOP_TARGETED_OFFER_VIEWED=3483,E.HELPER_TALENT_TRACK=196,E.TALENT_TRACK_GET_LEVEL=2127,E.FORWARD_TO_A_COMPETITION_ROOM=172,E.FORWARD_TO_A_SUBMITTABLE_ROOM=1450,E.FORWARD_TO_RANDOM_COMPETITION_ROOM=865,E.GET_IS_USER_PART_OF_COMPETITION=2077,E.GET_SECONDS_UNTIL=271,E.ROOM_COMPETITION_INIT=1334,E.SUBMIT_ROOM_TO_COMPETITION=2595,E.VOTE_FOR_ROOM=143,E.GET_GIFT=2436,E.RESET_PHONE_NUMBER_STATE=2741,E.SET_PHONE_NUMBER_VERIFICATION_STATUS=1379,E.TRY_PHONE_NUMBER=790,E.VERIFY_CODE=2721,E.CONTROL_YOUTUBE_DISPLAY_PLAYBACK=3005,E.GET_YOUTUBE_DISPLAY_STATUS=336,E.SET_YOUTUBE_DISPLAY_PLAYLIST=2069,E.GO_TO_FLAT=685,E.CHANGE_QUEUE=3093,E.CALL_FOR_HELP_FROM_FORUM_MESSAGE=1412,E.CALL_FOR_HELP_FROM_FORUM_THREAD=534,E.CALL_FOR_HELP_FROM_IM=2950,E.CALL_FOR_HELP_FROM_PHOTO=2492,E.CALL_FOR_HELP_FROM_SELFIE=2755,E.CHAT_REVIEW_GUIDE_DECIDES=3365,E.CHAT_REVIEW_GUIDE_DETACHED=2501,E.CHAT_REVIEW_GUIDE_VOTE=3961,E.CHAT_REVIEW_SESSION_CREATE=3060,E.DELETE_PENDING_CALLS_FOR_HELP=3605,E.GET_CFH_STATUS=2746,E.GET_FAQ_CATEGORY=3445,E.GET_FAQ_TEXT=1849,E.GET_GUIDE_REPORTING_STATUS=3786,E.GET_PENDING_CALLS_FOR_HELP=3267,E.GET_QUIZ_QUESTIONS=1296,E.GUIDE_SESSION_CREATE=3338,E.GUIDE_SESSION_FEEDBACK=477,E.GUIDE_SESSION_GET_REQUESTER_ROOM=1052,E.GUIDE_SESSION_GUIDE_DECIDES=1424,E.GUIDE_SESSION_INVITE_REQUESTER=234,E.GUIDE_SESSION_IS_TYPING=519,E.GUIDE_SESSION_MESSAGE=3899,E.GUIDE_SESSION_ON_DUTY_UPDATE=1922,E.GUIDE_SESSION_REPORT=3969,E.GUIDE_SESSION_REQUESTER_CANCELS=291,E.GUIDE_SESSION_RESOLVED=887,E.POST_QUIZ_ANSWERS=3720,E.SEARCH_FAQS=2031,E.POLL_ANSWER=3505,E.POLL_REJECT=1773,E.POLL_START=109,E.POLL_VOTE_COUNTER=6200,E.DISCONNECT=2445,E.SCR_GET_KICKBACK_INFO=869,E.COMPOST_PLANT=3835,E.HARVEST_PET=1521,E.SET_CLOTHING_CHANGE_DATA=924,E.GROUP_UNFAVORITE=1820,E.NEW_USER_EXPERIENCE_GET_GIFTS=1822,E.NEW_USER_EXPERIENCE_SCRIPT_PROCEED=1299,E.HANDSHAKE_INIT_DIFFIE=3110,E.HANDSHAKE_COMPLETE_DIFFIE=773,E.WELCOME_OPEN_GIFT=2638,E.WELCOME_GIFT_CHANGE_EMAIL=66,E.EMAIL_GET_STATUS=2557,E.EMAIL_CHANGE=3965,E.APPROVE_ALL_MEMBERSHIP_REQUESTS=882,E.RENTABLE_SPACE_CANCEL_RENT=1667,E.RENTABLE_SPACE_RENT=2946,E.RENTABLE_SPACE_STATUS=872,E.TRACKING_PERFORMANCE_LOG=3230,E.TRACKING_LAG_WARNING_REPORT=3847,E.ROOM_DIRECTORY_ROOM_NETWORK_OPEN_CONNECTION=3736,E.RENTABLE_EXTEND_RENT_OR_BUYOUT_STRIP_ITEM=2115,E.RENTABLE_EXTEND_RENT_OR_BUYOUT_FURNI=1071,E.RENTABLE_GET_RENT_OR_BUYOUT_OFFER=2518;class em{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class w_{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class tm{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Ck{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class sm{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class rm{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class im{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class nm{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class am{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class om{constructor(e,t,s){this._data=[e,t,s.length,...s]}getMessageArray(){return this._data}dispose(){}}class hm{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class um{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class lm{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Mk{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Pk{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Nk{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class bk{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Dk{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Lk{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Uk{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Fk{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class wk{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class xk{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Gk{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Bk{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Hk{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class kk{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Vk{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class jk{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Yk{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Wk{constructor(...e){this._data=[e.length],e.forEach(t=>{this._data.push(t.itemId)})}getMessageArray(){return this._data}dispose(){}}class nQ{constructor(e){this.itemId=e}}class cm{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class _m{constructor(e,t=null){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class zk{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class dm{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class fm{constructor(e,t=0,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class Xk{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class gm{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Em{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class mm{constructor(e,t,s=0){this._data=[e,s,t]}getMessageArray(){return this._data}dispose(){}}class pm{constructor(...e){this._data=[e.length,...e]}getMessageArray(){return this._data}dispose(){}}class Kk{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class qk{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Qk{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Zk{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Jk{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class $k{constructor(e,t,s,i,n,a,o,u,l,d,c,_,f,g,I,p,R,S,O,A,C,M,N,L){this._data=[],this._data.push(e,t,s,i,n,a,o),this._data.push(l.length,...l),this._data.push(d,c,_,f,g,I,p,R,S,O,A,C,M,N,L)}getMessageArray(){return this._data}dispose(){}}class Im{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class Tm{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class eV{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class Rm{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class vm extends Rm{constructor(e){super(e)}}class Om{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Sm extends Rm{constructor(e){super(e)}}class x_{constructor(e,t,s,i){this._data=[e,t,s,i]}getMessageArray(){return this._data}dispose(){}}class Am{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class ym{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Cm{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Mm{constructor(e,t,s=""){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class Pm{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class Nm{constructor(e,t){this._data=[e,t.size*2];for(const[s,i]of t.entries())this._data.push(s,i)}getMessageArray(){return this._data}dispose(){}}class tV{constructor(e,t,s,i){this._data=[e,t,s,i]}getMessageArray(){return this._data}dispose(){}}class bm{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Dm{constructor(e,t,s,i,n){this._data=[e,t,s,i,n]}getMessageArray(){return this._data}dispose(){}}class Lm{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class sV{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class rV{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class G_{constructor(e,t,s,i){this._data=[e,t,s,i]}getMessageArray(){return this._data}dispose(){}}class Um{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Fm{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class wm{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class xm{constructor(e,t,s,i,n,a){this._itemId=e,this._category=t,this._wallLocation=s,this._x=i,this._y=n,this._direction=a}getMessageArray(){switch(this._category){case U.FLOOR:return[`${this._itemId} ${this._x} ${this._y} ${this._direction}`];case U.WALL:return[`${this._itemId} ${this._wallLocation} `];default:return[]}}dispose(){}}class iV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Gm{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class nV{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class Bm{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Hm{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class km{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class aV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class B_{constructor(e,t=0){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Vm{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class jm{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class oV{constructor(e,t=-100){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Ym{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class hV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class uV{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class lV{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Wm{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class cV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class zm{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class _V{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class dV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class fV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class gV{constructor(e,t,s,i){this._data=[e,t,s,i]}getMessageArray(){return this._data}dispose(){}}class Xm{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class EV{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class mV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class pV{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class IV{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class H_{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class TV{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class RV{constructor(e,t,s,i,n,a,o){this._data=[e,t,s,i,n,a,o]}getMessageArray(){return this._data}dispose(){}}class vV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Km{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class qm{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class k_{constructor(e,t=0){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Qm{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class OV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Zm{constructor(e,t,s){this._data=[e+" "+t,s]}getMessageArray(){return this._data}dispose(){}}class Jm{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class $m{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ep{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class tp{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class SV{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class AV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class yV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class sp{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class rp{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class ip{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class np{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Yu{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}Yu.STATE_START=0,Yu.STATE_CANCEL=1,Yu.STATE_ACCEPT=2;class CV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class MV{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class PV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class NV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class bV{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class DV{constructor(e,t,s,i,n,a){this._data=[e,t.length,...t,s,i.length,...i,n,a]}getMessageArray(){return this._data}dispose(){}}class LV{constructor(e,t,s,i,n){this._data=[e,t.length,...t,s,i.length,...i,n]}getMessageArray(){return this._data}dispose(){}}class UV{constructor(e,t,s,i,n){this._data=[e,t.length,...t,s,i.length,...i,n]}getMessageArray(){return this._data}dispose(){}}class aQ{get tradeMode(){return this._tradeMode}set tradeMode(e){this._tradeMode=e}get allowPets(){return this._allowPets}set allowPets(e){this._allowPets=e}get allowFoodConsume(){return this._allowFoodConsume}set allowFoodConsume(e){this._allowFoodConsume=e}get allowWalkThrough(){return this._allowWalkThrough}set allowWalkThrough(e){this._allowWalkThrough=e}get hideWalls(){return this._hideWalls}set hideWalls(e){this._hideWalls=e}get wallThickness(){return this._wallThickness}set wallThickness(e){this._wallThickness=e}get floorThickness(){return this._floorThickness}set floorThickness(e){this._floorThickness=e}get roomId(){return this._roomId}set roomId(e){this._roomId=e}get name(){return this._name}set name(e){this._name=e}get description(){return this._description}set description(e){this._description=e}get doorMode(){return this._doorMode}set doorMode(e){this._doorMode=e}get password(){return this._password}set password(e){this._password=e}get categoryId(){return this._categoryId}set categoryId(e){this._categoryId=e}get maximumVisitors(){return this._maximumVisitors}set maximumVisitors(e){this._maximumVisitors=e}get tags(){return this._tags}set tags(e){this._tags=e}get whoCanMute(){return this._whoCanMute}set whoCanMute(e){this._whoCanMute=e}get whoCanKick(){return this._whoCanKick}set whoCanKick(e){this._whoCanKick=e}get whoCanBan(){return this._whoCanBan}set whoCanBan(e){this._whoCanBan=e}get chatMode(){return this._chatMode}set chatMode(e){this._chatMode=e}get chatBubbleSize(){return this._chatBubbleSize}set chatBubbleSize(e){this._chatBubbleSize=e}get chatScrollUpFrequency(){return this._chatScrollUpFrequency}set chatScrollUpFrequency(e){this._chatScrollUpFrequency=e}get chatFullHearRange(){return this._chatFullHearRange}set chatFullHearRange(e){this._chatFullHearRange=e}get chatFloodSensitivity(){return this._chatFloodSensitivity}set chatFloodSensitivity(e){this._chatFloodSensitivity=e}get allowNavigatorDynCats(){return this._allowNavigatorDynCats}set allowNavigatorDynCats(e){this._allowNavigatorDynCats=e}}class FV{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class wV{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class ap{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class op{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class xV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class hp{constructor(...e){this._data=[e.length].concat(e)}getMessageArray(){return this._data}dispose(){}}class GV{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class BV{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class up{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class HV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class kV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class VV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class jV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class YV{constructor(e,t,s,i,n,a,o,u,l,d,c){this._data=[e,t,s,i,n,a,o,u,l,d,c]}getMessageArray(){return this._data}dispose(){}}class WV{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class zV{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class XV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class KV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class lp{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class cp{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class _p{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class dp{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class fp{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class gp{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class qV{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Ep{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class QV{constructor(e,t=!0){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class ZV{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class JV{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class mp{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class $V{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ej{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class tj{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class sj{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class rj{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class ij{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class nj{constructor(e,t,s){this._data=[e,t,s]}getMessageArray(){return this._data}dispose(){}}class aj{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class pp{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class oj{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Ip{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Tp{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class hj extends Pr{constructor(e){super(),this._communication=e,this._handShaking=!1,this._didConnect=!1,this._pongInterval=null,this.onConnectionOpenedEvent=this.onConnectionOpenedEvent.bind(this),this.onConnectionClosedEvent=this.onConnectionClosedEvent.bind(this),this.onConnectionErrorEvent=this.onConnectionErrorEvent.bind(this),this.sendPong=this.sendPong.bind(this)}onInit(){const e=this._communication.connection;e&&(e.addEventListener(Ct.CONNECTION_OPENED,this.onConnectionOpenedEvent),e.addEventListener(Ct.CONNECTION_CLOSED,this.onConnectionClosedEvent),e.addEventListener(Ct.CONNECTION_ERROR,this.onConnectionErrorEvent)),this._communication.registerMessageEvent(new Yg(this.onClientPingEvent.bind(this))),this._communication.registerMessageEvent(new CE(this.onAuthenticatedEvent.bind(this)))}onDispose(){const e=this._communication.connection;e&&(e.removeEventListener(Ct.CONNECTION_OPENED,this.onConnectionOpenedEvent),e.removeEventListener(Ct.CONNECTION_CLOSED,this.onConnectionClosedEvent),e.removeEventListener(Ct.CONNECTION_ERROR,this.onConnectionErrorEvent)),this._handShaking=!1,this.stopPonging(),super.onDispose()}onConnectionOpenedEvent(e){const t=this._communication.connection;t&&(this._didConnect=!0,this.dispatchCommunicationDemoEvent(qt.CONNECTION_ESTABLISHED,t),ue.getValue("system.pong.manually",!1)&&this.startPonging(),this.startHandshake(t),t.send(new XE(null,null,null,null)),this.tryAuthentication(t))}onConnectionClosedEvent(e){const t=this._communication.connection;t&&(this.stopPonging(),this._didConnect&&this.dispatchCommunicationDemoEvent(qt.CONNECTION_CLOSED,t))}onConnectionErrorEvent(e){const t=this._communication.connection;t&&(this.stopPonging(),this.dispatchCommunicationDemoEvent(qt.CONNECTION_ERROR,t))}tryAuthentication(e){if(!e||!this.getSSO()){this.getSSO()||Y.error("Login without an SSO ticket is not supported"),this.dispatchCommunicationDemoEvent(qt.CONNECTION_HANDSHAKE_FAILED,e);return}e.send(new QE(this.getSSO(),ve()))}onClientPingEvent(e){!e||!e.connection||this.sendPong(e.connection)}onAuthenticatedEvent(e){!e||!e.connection||(this.completeHandshake(e.connection),this.dispatchCommunicationDemoEvent(qt.CONNECTION_AUTHENTICATED,e.connection),e.connection.send(new KE))}startHandshake(e){this.dispatchCommunicationDemoEvent(qt.CONNECTION_HANDSHAKING,e),this._handShaking=!0}completeHandshake(e){this.dispatchCommunicationDemoEvent(qt.CONNECTION_HANDSHAKED,e),this._handShaking=!1}startPonging(){this.stopPonging(),this._pongInterval=setInterval(this.sendPong,ue.getValue("system.pong.interval.ms",2e4))}stopPonging(){this._pongInterval&&(clearInterval(this._pongInterval),this._pongInterval=null)}sendPong(e=null){e=e||this._communication.connection||null,e&&e.send(new qE)}dispatchCommunicationDemoEvent(e,t){X.instance.events.dispatchEvent(new qt(e,t))}getSSO(){return ue.getValue("sso.ticket",null)}}class uj{constructor(){this._events=new Map,this._composers=new Map,this.registerEvents(),this.registerComposers()}registerEvents(){this._events.set(m.INTERSTITIAL_MESSAGE,nD),this._events.set(m.ROOM_AD_ERROR,aD),this._events.set(m.AVAILABILITY_STATUS,Vg),this._events.set(m.AVAILABILITY_TIME,oD),this._events.set(m.HOTEL_CLOSED_AND_OPENS,hD),this._events.set(m.HOTEL_CLOSES_AND_OPENS_AT,uD),this._events.set(m.HOTEL_WILL_CLOSE_MINUTES,lD),this._events.set(m.HOTEL_MAINTENANCE,cD),this._events.set(m.USER_CHANGE_NAME,gr),this._events.set(m.CHECK_USER_NAME,_D),this._events.set(m.USER_FIGURE,jg),this._events.set(m.USER_OUTFITS,dD),this._events.set(m.ADD_BOT_TO_INVENTORY,fD),this._events.set(m.USER_BOTS,gD),this._events.set(m.BOT_RECEIVED,ED),this._events.set(m.REMOVE_BOT_FROM_INVENTORY,mD),this._events.set(m.CFH_SANCTION,pD),this._events.set(m.CFH_TOPICS,ID),this._events.set(m.CFH_SANCTION_STATUS,TD),this._events.set(m.CAMERA_PUBLISH_STATUS,RD),this._events.set(m.CAMERA_PURCHASE_OK,vD),this._events.set(m.CAMERA_STORAGE_URL,SD),this._events.set(m.COMPETITION_STATUS,AD),this._events.set(m.INIT_CAMERA,yD),this._events.set(m.THUMBNAIL_STATUS,CD),this._events.set(m.CAMERA_SNAPSHOT,OD),this._events.set(m.CAMPAIGN_CALENDAR_DATA,MD),this._events.set(m.CAMPAIGN_CALENDAR_DOOR_OPENED,PD),this._events.set(m.BONUS_RARE_INFO,ND),this._events.set(m.BUILDERS_CLUB_FURNI_COUNT,bD),this._events.set(m.BUILDERS_CLUB_SUBSCRIPTION,DD),this._events.set(m.BUNDLE_DISCOUNT_RULESET,LD),this._events.set(m.CATALOG_PAGE_EXPIRATION,UD),this._events.set(m.CATALOG_PAGE,FD),this._events.set(m.CATALOG_PAGE_LIST,wD),this._events.set(m.CATALOG_EARLIEST_EXPIRY,xD),this._events.set(m.CATALOG_PUBLISHED,GD),this._events.set(m.CLUB_GIFT_INFO,BD),this._events.set(m.CLUB_GIFT_SELECTED,HD),this._events.set(m.DIRECT_SMS_CLUB_BUY,kD),this._events.set(m.GIFT_RECEIVER_NOT_FOUND,jD),this._events.set(m.GIFT_WRAPPER_CONFIG,YD),this._events.set(m.CLUB_EXTENDED_OFFER,WD),this._events.set(m.CLUB_OFFERS,zD),this._events.set(m.IS_OFFER_GIFTABLE,XD),this._events.set(m.LIMITED_SOLD_OUT,KD),this._events.set(m.LIMITED_OFFER_APPEARING_NEXT,qD),this._events.set(m.NOT_ENOUGH_BALANCE,QD),this._events.set(m.PRODUCT_OFFER,ZD),this._events.set(m.CATALOG_PURCHASE_ERROR,JD),this._events.set(m.CATALOG_PURCHASE_NOT_ALLOWED,$D),this._events.set(m.CATALOG_PURCHASE_OK,eL),this._events.set(m.ROOM_AD_PURCHASE,tL),this._events.set(m.SEASONAL_CALENDAR_OFFER,sL),this._events.set(m.CATALOG_RECEIVE_PET_BREEDS,rL),this._events.set(m.TARGET_OFFER,iL),this._events.set(m.TARGET_OFFER_NOT_FOUND,nL),this._events.set(m.REDEEM_VOUCHER_ERROR,aL),this._events.set(m.REDEEM_VOUCHER_OK,oL),this._events.set(m.CLIENT_PING,Yg),this._events.set(m.COMPETITION_ENTRY_SUBMIT,hL),this._events.set(m.COMPETITION_VOTING_INFO,uL),this._events.set(m.COMPETITION_TIMING_CODE,lL),this._events.set(m.COMPETITION_USER_PART_OF,cL),this._events.set(m.COMPETITION_NO_OWNED_ROOMS,_L),this._events.set(m.COMPETITION_SECONDS_UNTIL,dL),this._events.set(m.CRAFTABLE_PRODUCTS,fL),this._events.set(m.CRAFTING_RECIPE,gL),this._events.set(m.CRAFTING_RECIPES_AVAILABLE,EL),this._events.set(m.CRAFTING_RESULT,mL),this._events.set(m.DESKTOP_VIEW,Xc),this._events.set(m.MESSENGER_ACCEPT_FRIENDS,pL),this._events.set(m.MESSENGER_FIND_FRIENDS,IL),this._events.set(m.MESSENGER_FOLLOW_FAILED,TL),this._events.set(m.MESSENGER_FRIENDS,RL),this._events.set(m.MESSENGER_UPDATE,vL),this._events.set(m.MESSENGER_FRIEND_NOTIFICATION,OL),this._events.set(m.MESSENGER_REQUESTS,SL),this._events.set(m.MESSENGER_SEARCH,AL),this._events.set(m.MESSENGER_INSTANCE_MESSAGE_ERROR,yL),this._events.set(m.MESSENGER_MESSAGE_ERROR,CL),this._events.set(m.MESSENGER_INIT,ML),this._events.set(m.MESSENGER_MINIMAIL_NEW,PL),this._events.set(m.MESSENGER_MINIMAIL_COUNT,NL),this._events.set(m.MESSENGER_CHAT,bL),this._events.set(m.MESSENGER_REQUEST,Wg),this._events.set(m.MESSENGER_INVITE_ERROR,DL),this._events.set(m.MESSENGER_INVITE,LL),this._events.set(m.ACHIEVEMENTRESOLUTIONCOMPLETED,kL),this._events.set(m.ACHIEVEMENTRESOLUTIONPROGRESS,VL),this._events.set(m.ACHIEVEMENTRESOLUTIONS,jL),this._events.set(m.LOAD_GAME_URL,zg),this._events.set(m.LOADGAME,ZL),this._events.set(m.UNLOADGAME,JL),this._events.set(m.GAME_CENTER_GAME_LIST,zL),this._events.set(m.GAMESTATUSMESSAGE,XL),this._events.set(m.GAME_CENTER_ACHIEVEMENTS,$L),this._events.set(m.GAME_CENTER_STATUS,UL),this._events.set(m.GAME_CENTER_IN_ARENA_QUEUE,wL),this._events.set(m.GAME_CENTER_STOP_COUNTER,BL),this._events.set(m.GAME_CENTER_USER_LEFT_GAME,HL),this._events.set(m.GAME_CENTER_DIRECTORY_STATUS,FL),this._events.set(m.GAME_CENTER_STARTING_GAME_FAILED,GL),this._events.set(m.GAME_CENTER_JOINING_FAILED,xL),this._events.set(m.GAMEACHIEVEMENTS,YL),this._events.set(m.GAMEINVITE,WL),this._events.set(m.JOINEDQUEUEMESSAGE,KL),this._events.set(m.JOININGQUEUEFAILED,qL),this._events.set(m.LEFTQUEUE,QL),this._events.set(m.WEEKLY_GAME_REWARD,iU),this._events.set(m.WEEKLY_GAME_REWARD_WINNERS,nU),this._events.set(m.WEEKLY_COMPETITIVE_LEADERBOARD,rU),this._events.set(m.WEEKLY_COMPETITIVE_FRIENDS_LEADERBOARD,sU),this._events.set(m.WEEKLY_GAME2_FRIENDS_LEADERBOARD,eU),this._events.set(m.WEEKLY_GAME2_LEADERBOARD,tU),this._events.set(m.GROUP_INFO,cU),this._events.set(m.GROUP_MEMBER_REMOVE_CONFIRM,lU),this._events.set(m.GROUP_MEMBERS,_U),this._events.set(m.GROUP_CREATE_OPTIONS,uU),this._events.set(m.GROUP_BADGE_PARTS,Xg),this._events.set(m.GROUP_SETTINGS,fU),this._events.set(m.GROUP_PURCHASED,dU),this._events.set(m.GROUP_BADGES,GE),this._events.set(m.GROUP_DEACTIVATE,gU),this._events.set(m.GROUP_MEMBERSHIP_REQUESTED,fx),this._events.set(m.GROUP_DETAILS_CHANGED,dx),this._events.set(m.GROUP_HABBO_JOIN_FAILED,px),this._events.set(m.GROUP_FORUM_DATA,EU),this._events.set(m.GROUP_FORUM_LIST,mU),this._events.set(m.GROUP_FORUM_THREADS,pU),this._events.set(m.GROUP_FORUM_POST,IU),this._events.set(m.GROUP_FORUM_POST_THREAD,TU),this._events.set(m.GROUP_FORUM_THREAD_MESSAGES,RU),this._events.set(m.GROUP_FORUM_UNREAD_COUNT,vU),this._events.set(m.GROUP_FORUM_UPDATE_MESSAGE,OU),this._events.set(m.GROUP_FORUM_UPDATE_THREAD,SU),this._events.set(m.CFH_DISABLED_NOTIFY,PU),this._events.set(m.CFH_PENDING_CALLS_DELETED,NU),this._events.set(m.CFH_PENDING_CALLS,bU),this._events.set(m.CFH_REPLY,DU),this._events.set(m.CFH_RESULT_MESSAGE,LU),this._events.set(m.GUIDE_ON_DUTY_STATUS,BU),this._events.set(m.GUIDE_SESSION_ATTACHED,kU),this._events.set(m.GUIDE_SESSION_DETACHED,VU),this._events.set(m.GUIDE_SESSION_ENDED,qg),this._events.set(m.GUIDE_SESSION_ERROR,Qg),this._events.set(m.GUIDE_SESSION_INVITED_TO_GUIDE_ROOM,jU),this._events.set(m.GUIDE_SESSION_MESSAGE,YU),this._events.set(m.GUIDE_SESSION_PARTNER_IS_TYPING,WU),this._events.set(m.GUIDE_SESSION_REQUESTER_ROOM,zU),this._events.set(m.GUIDE_SESSION_STARTED,Zg),this._events.set(m.GUIDE_TICKET_CREATION_RESULT,XU),this._events.set(m.GUIDE_TICKET_RESOLUTION,KU),this._events.set(m.GUIDE_REPORTING_STATUS,HU),this._events.set(m.HOTEL_MERGE_NAME_CHANGE,qU),this._events.set(m.ISSUE_CLOSE_NOTIFICATION,QU),this._events.set(m.QUIZ_DATA,ZU),this._events.set(m.QUIZ_RESULTS,JU),this._events.set(m.CHAT_REVIEW_SESSION_DETACHED,UU),this._events.set(m.CHAT_REVIEW_SESSION_OFFERED_TO_GUIDE,FU),this._events.set(m.CHAT_REVIEW_SESSION_RESULTS,wU),this._events.set(m.CHAT_REVIEW_SESSION_STARTED,xU),this._events.set(m.CHAT_REVIEW_SESSION_VOTING_STATUS,GU),this._events.set(m.ACHIEVEMENT_PROGRESSED,$U),this._events.set(m.ACHIEVEMENT_LIST,e1),this._events.set(m.USER_ACHIEVEMENT_SCORE,t1),this._events.set(m.USER_EFFECT_ACTIVATE,s1),this._events.set(m.USER_EFFECT_LIST_ADD,r1),this._events.set(m.USER_EFFECT_LIST_REMOVE,i1),this._events.set(m.USER_EFFECT_LIST,a1),this._events.set(m.AVATAR_EFFECT_SELECTED,n1),this._events.set(m.USER_BADGES,h1),this._events.set(m.USER_BADGES_ADD,o1),this._events.set(m.BADGE_POINT_LIMITS,Jg),this._events.set(m.BADGE_REQUEST_FULFILLED,u1),this._events.set(m.USER_CLOTHING,l1),this._events.set(m.USER_FURNITURE_ADD,c1),this._events.set(m.USER_FURNITURE,_1),this._events.set(m.USER_FURNITURE_REFRESH,d1),this._events.set(m.USER_FURNITURE_REMOVE,f1),this._events.set(m.USER_FURNITURE_POSTIT_PLACED,g1),this._events.set(m.USER_PETS,T1),this._events.set(m.USER_PET_REMOVE,v1),this._events.set(m.USER_PET_ADD,I1),this._events.set(m.PET_RECEIVED,R1),this._events.set(m.PET_PLACING_ERROR,rE),this._events.set(m.YOUTUBE_CONTROL_VIDEO,Lw),this._events.set(m.YOUTUBE_DISPLAY_PLAYLISTS,Uw),this._events.set(m.YOUTUBE_DISPLAY_VIDEO,Fw),this._events.set(m.TRADE_ACCEPTED,O1),this._events.set(m.TRADE_CLOSED,S1),this._events.set(m.TRADE_COMPLETED,A1),this._events.set(m.TRADE_CONFIRMATION,y1),this._events.set(m.TRADE_LIST_ITEM,C1),this._events.set(m.TRADE_NOT_OPEN,P1),this._events.set(m.TRADE_OPEN_FAILED,b1),this._events.set(m.TRADE_OPEN,N1),this._events.set(m.TRADE_OTHER_NOT_ALLOWED,D1),this._events.set(m.TRADE_YOU_NOT_ALLOWED,L1),this._events.set(m.TRADE_NO_SUCH_ITEM,M1),this._events.set(m.COMMUNITY_GOAL_VOTE_EVENT,F1),this._events.set(m.PROMO_ARTICLES,U1),this._events.set(m.MARKETPLACE_AFTER_ORDER_STATUS,w1),this._events.set(m.MARKETPLACE_CANCEL_SALE,x1),this._events.set(m.MARKETPLACE_SELL_ITEM,G1),this._events.set(m.MARKETPLACE_CONFIG,B1),this._events.set(m.MARKETPLACE_ITEM_STATS,H1),this._events.set(m.MARKETPLACE_ITEM_POSTED,k1),this._events.set(m.MARKETPLACE_ITEMS_SEARCHED,V1),this._events.set(m.MARKETPLACE_OWN_ITEMS,j1),this._events.set(m.USER_BANNED,rF),this._events.set(m.MODERATION_CAUTION,q1),this._events.set(m.MODTOOL_ROOM_INFO,J1),this._events.set(m.MODTOOL_USER_CHATLOG,iF),this._events.set(m.MODTOOL_ROOM_CHATLOG,tF),this._events.set(m.MODERATION_USER_INFO,eF),this._events.set(m.MODERATION_TOOL,Q1),this._events.set(m.MODTOOL_VISITED_ROOMS_USER,sF),this._events.set(m.CFH_CHATLOG,Y1),this._events.set(m.ISSUE_DELETED,W1),this._events.set(m.ISSUE_INFO,z1),this._events.set(m.ISSUE_PICK_FAILED,X1),this._events.set(m.MODERATOR_ACTION_RESULT,K1),this._events.set(m.MODERATOR_MESSAGE,Z1),this._events.set(m.MODERATOR_TOOL_PREFERENCES,$1),this._events.set(m.MYSTERY_BOX_KEYS,eE),this._events.set(m.GOTMYSTERYBOXPRIZEMESSAGE,aF),this._events.set(m.CANCELMYSTERYBOXWAITMESSAGE,nF),this._events.set(m.SHOWMYSTERYBOXWAITMESSAGE,oF),this._events.set(m.CAN_CREATE_ROOM,hF),this._events.set(m.CAN_CREATE_ROOM_EVENT,uF),this._events.set(m.CATEGORIES_WITH_VISITOR_COUNT,lF),this._events.set(m.COMPETITION_ROOMS_DATA,cF),this._events.set(m.CONVERTED_ROOM_ID,_F),this._events.set(m.ROOM_DOORBELL,tE),this._events.set(m.USER_FAVORITE_ROOM,dF),this._events.set(m.USER_FAVORITE_ROOM_COUNT,fF),this._events.set(m.ROOM_DOORBELL_REJECTED,qc),this._events.set(m.ROOM_CREATED,gF),this._events.set(m.ROOM_INFO,Qc),this._events.set(m.GUEST_ROOM_SEARCH_RESULT,EF),this._events.set(m.USER_HOME_ROOM,pF),this._events.set(m.ROOM_EVENT_CANCEL,yF),this._events.set(m.ROOM_EVENT,CF),this._events.set(m.ROOM_INFO_UPDATED,PF),this._events.set(m.THUMBNAIL_UPDATE_RESULT,NF),this._events.set(m.NAVIGATOR_EVENT_CATEGORIES,bF),this._events.set(m.NAVIGATOR_CATEGORIES,DF),this._events.set(m.NAVIGATOR_COLLAPSED,mF),this._events.set(m.NAVIGATOR_LIFTED,IF),this._events.set(m.NAVIGATOR_METADATA,TF),this._events.set(m.NAVIGATOR_OPEN_ROOM_CREATOR,RF),this._events.set(m.NAVIGATOR_SEARCHES,vF),this._events.set(m.NAVIGATOR_SEARCH,OF),this._events.set(m.NAVIGATOR_SETTINGS,SF),this._events.set(m.GENERIC_ALERT,GF),this._events.set(m.MOTD_MESSAGES,HF),this._events.set(m.NOTIFICATION_LIST,kF),this._events.set(m.UNSEEN_ITEMS,zF),this._events.set(m.ACHIEVEMENT_NOTIFICATION,LF),this._events.set(m.INFO_FEED_ENABLE,BF),this._events.set(m.CLUB_GIFT_NOTIFICATION,FF),this._events.set(m.ACTIVITY_POINT_NOTIFICATION,UF),this._events.set(m.BOT_ERROR,sE),this._events.set(m.PET_LEVEL_NOTIFICATION,jF),this._events.set(m.NOTIFICATION_OFFER_REWARD_DELIVERED,VF),this._events.set(m.NOTIFICATION_SIMPLE_ALERT,WF),this._events.set(m.NOTIFICATION_ELEMENT_POINTER,xF),this._events.set(m.USER_PERKS,JF),this._events.set(m.PET_TRAINING_PANEL,ew),this._events.set(m.PET_LEVEL_UPDATE,aE),this._events.set(m.PET_SCRATCH_FAILED,oE),this._events.set(m.PET_OPEN_PACKAGE_REQUESTED,iE),this._events.set(m.PET_OPEN_PACKAGE_RESULT,nE),this._events.set(m.PET_BREEDING_RESULT,pE),this._events.set(m.QUESTION,_E),this._events.set(m.POLL_CONTENTS,hE),this._events.set(m.POLL_ERROR,uE),this._events.set(m.POLL_OFFER,lE),this._events.set(m.POLL_START_ROOM,gE),this._events.set(m.QUESTION_ANSWERED,cE),this._events.set(m.QUESTION_FINISHED,dE),this._events.set(m.POLL_ROOM_RESULT,fE),this._events.set(m.COMMUNITY_GOAL_EARNED_PRIZES,tw),this._events.set(m.COMMUNITY_GOAL_PROGRESS,rw),this._events.set(m.CONCURRENT_USERS_GOAL_PROGRESS,iw),this._events.set(m.QUEST_DAILY,hw),this._events.set(m.QUEST_CANCELLED,aw),this._events.set(m.QUEST_COMPLETED,ow),this._events.set(m.COMMUNITY_GOAL_HALL_OF_FAME,sw),this._events.set(m.EPIC_POPUP,nw),this._events.set(m.SEASONAL_QUESTS,cw),this._events.set(m.QUESTS,lw),this._events.set(m.QUEST,uw),this._events.set(m.ROOM_ENTER_ERROR,_w),this._events.set(m.ROOM_ENTER,s_),this._events.set(m.ROOM_FORWARD,dw),this._events.set(m.ROOM_DOORBELL_ACCEPTED,Jc),this._events.set(m.ROOM_RIGHTS_CLEAR,$c),this._events.set(m.ROOM_RIGHTS_OWNER,t_),this._events.set(m.ROOM_RIGHTS,e_),this._events.set(m.BOT_COMMAND_CONFIGURATION,fw),this._events.set(m.BOT_SKILL_LIST_UPDATE,Ew),this._events.set(m.BOT_FORCE_OPEN_CONTEXT_MENU,gw),this._events.set(m.ROOM_SETTINGS_CHAT,mw),this._events.set(m.ROOM_INFO_OWNER,pw),this._events.set(m.ROOM_SCORE,Iw),this._events.set(m.ROOM_ROLLING,i_),this._events.set(m.FURNITURE_FLOOR_ADD,a_),this._events.set(m.FURNITURE_FLOOR,o_),this._events.set(m.FURNITURE_FLOOR_REMOVE,h_),this._events.set(m.FURNITURE_FLOOR_UPDATE,u_),this._events.set(m.ITEM_WALL_ADD,f_),this._events.set(m.ITEM_WALL,g_),this._events.set(m.ITEM_WALL_REMOVE,E_),this._events.set(m.ITEM_WALL_UPDATE,m_),this._events.set(m.FURNITURE_ALIASES,l_),this._events.set(m.FURNITURE_DATA,c_),this._events.set(m.FURNITURE_ITEMDATA,__),this._events.set(m.ITEM_STACK_HELPER,vw),this._events.set(m.FURNITURE_STATE,d_),this._events.set(m.ITEM_DIMMER_SETTINGS,mE),this._events.set(m.FURNITURE_STATE_2,n_),this._events.set(m.LOVELOCK_FURNI_FINISHED,Sw),this._events.set(m.LOVELOCK_FURNI_FRIEND_COMFIRMED,Aw),this._events.set(m.LOVELOCK_FURNI_START,yw),this._events.set(m.OBJECTS_DATA_UPDATE,r_),this._events.set(m.FURNITURE_GROUP_CONTEXT_MENU_INFO,Ow),this._events.set(m.FURNITURE_POSTIT_STICKY_POLE_OPEN,Nw),this._events.set(m.ROOM_SPECTATOR,OE),this._events.set(m.CUSTOM_USER_NOTIFICATION,Tw),this._events.set(m.ROOM_MESSAGE_NOTIFICATION,bw),this._events.set(m.ROOM_POPULAR_TAGS_RESULT,AF),this._events.set(m.ROOM_RIGHTS_LIST,zw),this._events.set(m.ROOM_RIGHTS_LIST_ADD,Yw),this._events.set(m.ROOM_RIGHTS_LIST_REMOVE,Ww),this._events.set(m.ROOM_BAN_LIST,jw),this._events.set(m.ROOM_SETTINGS_SAVE_ERROR,Jw),this._events.set(m.ROOM_SETTINGS,qw),this._events.set(m.ROOM_SETTINGS_SAVE,Zw),this._events.set(m.ROOM_SETTINGS_ERROR,Qw),this._events.set(m.SHOW_ENFORCE_ROOM_CATEGORY,$w),this._events.set(m.ROOM_BAN_REMOVE,ex),this._events.set(m.ROOM_MUTED,Xw),this._events.set(m.NO_SUCH_FLAT,Kw),this._events.set(m.FAVORITE_GROUP_UDPATE,EE),this._events.set(m.ROOM_MODEL_DOOR,I_),this._events.set(m.ROOM_HEIGHT_MAP,T_),this._events.set(m.ROOM_HEIGHT_MAP_UPDATE,R_),this._events.set(m.ROOM_MODEL,p_),this._events.set(m.ROOM_MODEL_NAME,Pa),this._events.set(m.ROOM_PAINT,v_),this._events.set(m.ROOM_THICKNESS,O_),this._events.set(m.ROOM_GET_FILTER_WORDS,MF),this._events.set(m.ROOM_MODEL_BLOCKED_TILES,ww),this._events.set(m.PET_FIGURE_UPDATE,Uu),this._events.set(m.PET_INFO,TE),this._events.set(m.PET_STATUS,RE),this._events.set(m.PET_EXPERIENCE,IE),this._events.set(m.PLAYING_GAME,vE),this._events.set(m.UNIT_DANCE,xu),this._events.set(m.UNIT_EFFECT,y_),this._events.set(m.UNIT,Gu),this._events.set(m.UNIT_EXPRESSION,C_),this._events.set(m.UNIT_HAND_ITEM,M_),this._events.set(m.UNIT_IDLE,P_),this._events.set(m.UNIT_INFO,Bu),this._events.set(m.UNIT_NUMBER,N_),this._events.set(m.UNIT_REMOVE,Hu),this._events.set(m.UNIT_STATUS,b_),this._events.set(m.HAND_ITEM_RECEIVED,yE),this._events.set(m.FLOOD_CONTROL,SE),this._events.set(m.REMAINING_MUTE,AE),this._events.set(m.UNIT_CHAT,S_),this._events.set(m.UNIT_CHAT_SHOUT,Fu),this._events.set(m.UNIT_CHAT_WHISPER,wu),this._events.set(m.UNIT_TYPING,A_),this._events.set(m.WIRED_ACTION,xw),this._events.set(m.WIRED_CONDITION,Gw),this._events.set(m.WIRED_TRIGGER,Bw),this._events.set(m.WIRED_OPEN,Hw),this._events.set(m.WIRED_REWARD,D_),this._events.set(m.WIRED_SAVE,kw),this._events.set(m.WIRED_ERROR,Vw),this._events.set(m.AUTHENTICATED,CE),this._events.set(m.JUKEBOX_PLAYLIST_FULL,ME),this._events.set(m.JUKEBOX_SONG_DISKS,PE),this._events.set(m.NOW_PLAYING,NE),this._events.set(m.OFFICIAL_SONG_ID,tx),this._events.set(m.PLAYLIST,sx),this._events.set(m.PLAYLIST_SONG_ADDED,rx),this._events.set(m.TRAX_SONG_INFO,bE),this._events.set(m.USER_SONG_DISKS_INVENTORY,DE),this._events.set(m.HELPER_TALENT_TRACK,ax),this._events.set(m.TALENT_TRACK_LEVEL,nx),this._events.set(m.TALENT_TRACK_LEVEL_UP,ix),this._events.set(m.IN_CLIENT_LINK,HE),this._events.set(m.USER_IGNORED,BE),this._events.set(m.USER_IGNORED_RESULT,U_),this._events.set(m.USER_RESPECT,jE),this._events.set(m.USER_PERMISSIONS,LE),this._events.set(m.USER_BADGES_CURRENT,FE),this._events.set(m.USER_INFO,ku),this._events.set(m.UNIT_CHANGE_NAME,L_),this._events.set(m.USER_SETTINGS,cx),this._events.set(m.USER_PROFILE,lx),this._events.set(m.MESSENGER_RELATIONSHIPS,ux),this._events.set(m.GIFT_OPENED,$g),this._events.set(m.USER_CREDITS,Ix),this._events.set(m.USER_CURRENCY,Tx),this._events.set(m.USER_SUBSCRIPTION,Rx),this._events.set(m.USER_WARDROBE_PAGE,Ox),this._events.set(m.USER_CLASSIFICATION,Ax),this._events.set(m.GET_USER_TAGS,wE),this._events.set(m.SCR_SEND_KICKBACK_INFO,vx),this._events.set(m.PET_RESPECTED,kE),this._events.set(m.PET_SUPPLEMENT,VE),this._events.set(m.ACCOUNT_SAFETY_LOCK_STATUS_CHANGE,UE),this._events.set(m.GENERIC_ERROR,Kc),this._events.set(m.GROUP_LIST,mx),this._events.set(m.CATALOG_APPROVE_NAME_RESULT,ox),this._events.set(m.CONNECTION_ERROR,wF),this._events.set(m.GUILD_EDIT_FAILED,gx),this._events.set(m.GUILD_MEMBER_MGMT_FAILED,Ex),this._events.set(m.EXTENDED_PROFILE_CHANGED,_x),this._events.set(m.NOOBNESS_LEVEL,Kg),this._events.set(m.DISCONNECT_REASON,yU),this._events.set(m.HANDSHAKE_INIT_DIFFIE,MU),this._events.set(m.HANDSHAKE_COMPLETE_DIFFIE,AU),this._events.set(m.HANDSHAKE_IDENTITY_ACCOUNT,CU),this._events.set(m.NEW_USER_EXPERIENCE_GIFT_OFFER,qF),this._events.set(m.NEW_USER_EXPERIENCE_NOT_COMPLETE,ZF),this._events.set(m.RESTORE_CLIENT,YF),this._events.set(m.FIREWORK_CHARGE_DATA,VD),this._events.set(m.PHONE_COLLECTION_STATE,aU),this._events.set(m.PHONE_TRY_NUMBER_RESULT,oU),this._events.set(m.PHONE_TRY_VERIFICATION_CODE_RESULT,hU),this._events.set(m.WELCOME_GIFT_CHANGE_EMAIL_RESULT,Sx),this._events.set(m.WELCOME_GIFT_STATUS,Dw),this._events.set(m.RENTABLE_SPACE_RENT_OK,Mw),this._events.set(m.RENTABLE_SPACE_STATUS,Pw),this._events.set(m.RENTABLE_SPACE_RENT_FAILED,Cw),this._events.set(m.RECYCLER_STATUS,Lu),this._events.set(m.RECYCLER_FINISHED,Zc),this._events.set(m.EMAIL_STATUS,xE),this._events.set(m.CHANGE_EMAIL_RESULT,hx),this._events.set(m.RENTABLE_FURNI_RENT_OR_BUYOUT_OFFER,Rw)}registerComposers(){this._composers.set(E.AUTHENTICATION,ZB),this._composers.set(E.INTERSTITIAL_SHOWN,Cx),this._composers.set(E.GET_INTERSTITIAL,yx),this._composers.set(E.GET_WARDROBE,bx),this._composers.set(E.SAVE_WARDROBE_OUTFIT,Dx),this._composers.set(E.CHANGE_USERNAME,Px),this._composers.set(E.CHECK_USERNAME,Nx),this._composers.set(E.REQUEST_CAMERA_CONFIGURATION,wx),this._composers.set(E.RENDER_ROOM,Vu),this._composers.set(E.RENDER_ROOM_THUMBNAIL,F_),this._composers.set(E.PURCHASE_PHOTO,Fx),this._composers.set(E.PUBLISH_PHOTO,Ux),this._composers.set(E.PHOTO_COMPETITION,Lx),this._composers.set(E.OPEN_CAMPAIGN_CALENDAR_DOOR,Gx),this._composers.set(E.OPEN_CAMPAIGN_CALENDAR_DOOR_STAFF,xx),this._composers.set(E.BUILDERS_CLUB_PLACE_ROOM_ITEM,Bx),this._composers.set(E.BUILDERS_CLUB_PLACE_WALL_ITEM,Hx),this._composers.set(E.BUILDERS_CLUB_QUERY_FURNI_COUNT,kx),this._composers.set(E.GET_CATALOG_INDEX,Yx),this._composers.set(E.GET_CATALOG_PAGE,Wx),this._composers.set(E.CATALOG_PURCHASE,cG),this._composers.set(E.CATALOG_PURCHASE_GIFT,lG),this._composers.set(E.GET_PRODUCT_OFFER,rG),this._composers.set(E.GET_CLUB_OFFERS,qx),this._composers.set(E.GET_CLUB_GIFT_INFO,Kx),this._composers.set(E.CATALOG_REDEEM_VOUCHER,gG),this._composers.set(E.GROUP_MEMBERSHIPS,zV),this._composers.set(E.GET_GIFT_WRAPPING_CONFIG,Zx),this._composers.set(E.CATALOG_SELECT_VIP_GIFT,mG),this._composers.set(E.CATALOG_REQUESET_PET_BREEDS,aG),this._composers.set(E.GET_BONUS_RARE_INFO,Vx),this._composers.set(E.GET_BUNDLE_DISCOUNT_RULESET,jx),this._composers.set(E.GET_CATALOG_PAGE_EXPIRATION,zx),this._composers.set(E.GET_CATALOG_PAGE_WITH_EARLIEST_EXP,Xx),this._composers.set(E.GET_DIRECT_CLUB_BUY_AVAILABLE,Qx),this._composers.set(E.GET_HABBO_BASIC_MEMBERSHIP_EXTEND_OFFER,Jx),this._composers.set(E.GET_HABBO_CLUB_EXTEND_OFFER,$x),this._composers.set(E.GET_IS_OFFER_GIFTABLE,eG),this._composers.set(E.GET_LIMITED_OFFER_APPEARING_NEXT,tG),this._composers.set(E.GET_NEXT_TARGETED_OFFER,sG),this._composers.set(E.GET_ROOM_AD_PURCHASE_INFO,iG),this._composers.set(E.GET_SEASONAL_CALENDAR_DAILY_OFFER,nG),this._composers.set(E.GET_TARGETED_OFFER,oG),this._composers.set(E.MARK_CATALOG_NEW_ADDITIONS_PAGE_OPENED,hG),this._composers.set(E.PURCHASE_BASIC_MEMBERSHIP_EXTENSION,uG),this._composers.set(E.PURCHASE_ROOM_AD,_G),this._composers.set(E.PURCHASE_TARGETED_OFFER,dG),this._composers.set(E.PURCHASE_VIP_MEMBERSHIP_EXTENSION,fG),this._composers.set(E.ROOM_AD_PURCHASE_INITIATED,EG),this._composers.set(E.SET_TARGETTED_OFFER_STATE,pG),this._composers.set(E.SHOP_TARGETED_OFFER_VIEWED,IG),this._composers.set(E.FORWARD_TO_A_COMPETITION_ROOM,TG),this._composers.set(E.FORWARD_TO_A_SUBMITTABLE_ROOM,RG),this._composers.set(E.FORWARD_TO_RANDOM_COMPETITION_ROOM,vG),this._composers.set(E.GET_CURRENT_TIMING_CODE,OG),this._composers.set(E.GET_IS_USER_PART_OF_COMPETITION,SG),this._composers.set(E.GET_SECONDS_UNTIL,AG),this._composers.set(E.ROOM_COMPETITION_INIT,yG),this._composers.set(E.SUBMIT_ROOM_TO_COMPETITION,Vo),this._composers.set(E.VOTE_FOR_ROOM,CG),this._composers.set(E.CRAFT,MG),this._composers.set(E.CRAFT_SECRET,PG),this._composers.set(E.GET_CRAFTABLE_PRODUCTS,bG),this._composers.set(E.GET_CRAFTING_RECIPE,NG),this._composers.set(E.GET_CRAFTING_RECIPES_AVAILABLE,DG),this._composers.set(E.FRIEND_FURNI_CONFIRM_LOCK,UG),this._composers.set(E.ACCEPT_FRIEND,FG),this._composers.set(E.DECLINE_FRIEND,wG),this._composers.set(E.FIND_NEW_FRIENDS,xG),this._composers.set(E.FOLLOW_FRIEND,GG),this._composers.set(E.FRIEND_LIST_UPDATE,BG),this._composers.set(E.GET_FRIEND_REQUESTS,HG),this._composers.set(E.HABBO_SEARCH,kG),this._composers.set(E.MESSENGER_INIT,VG),this._composers.set(E.REMOVE_FRIEND,jG),this._composers.set(E.REQUEST_FRIEND,YG),this._composers.set(E.MESSENGER_CHAT,WG),this._composers.set(E.SEND_ROOM_INVITE,zG),this._composers.set(E.SET_RELATIONSHIP_STATUS,XG),this._composers.set(E.VISIT_USER,KG),this._composers.set(E.ACHIEVEMENT_RESOLUTION_OPEN,YE),this._composers.set(E.ACCEPTGAMEINVITE,sB),this._composers.set(E.GAMEUNLOADEDMESSAGE,rB),this._composers.set(E.GETGAMEACHIEVEMENTSMESSAGE,iB),this._composers.set(E.GAMES_LIST,nB),this._composers.set(E.GETGAMESTATUSMESSAGE,aB),this._composers.set(E.GETUSERGAMEACHIEVEMENTSMESSAGE,oB),this._composers.set(E.JOINQUEUEMESSAGE,hB),this._composers.set(E.LEAVEQUEUEMESSAGE,uB),this._composers.set(E.RESETRESOLUTIONACHIEVEMENTMESSAGE,lB),this._composers.set(E.GAMES_INIT,dB),this._composers.set(E.GETWEEKLYGAMEREWARDWINNERS,fB),this._composers.set(E.GAME2GETACCOUNTGAMESTATUSMESSAGE,eB),this._composers.set(E.GAME2CHECKGAMEDIRECTORYSTATUSMESSAGE,$G),this._composers.set(E.GAME2EXITGAMEMESSAGE,qG),this._composers.set(E.GAME2GAMECHATMESSAGE,QG),this._composers.set(E.GAME2LOADSTAGEREADYMESSAGE,ZG),this._composers.set(E.GAME2PLAYAGAINMESSAGE,JG),this._composers.set(E.GAME2REQUESTFULLSTATUSUPDATEMESSAGE,tB),this._composers.set(E.GAME2GETWEEKLYFRIENDSLEADERBOARD,cB),this._composers.set(E.GAME2GETWEEKLYLEADERBOARD,_B),this._composers.set(E.GET_GIFT,WE),this._composers.set(E.RESET_PHONE_NUMBER_STATE,gB),this._composers.set(E.SET_PHONE_NUMBER_VERIFICATION_STATUS,zE),this._composers.set(E.TRY_PHONE_NUMBER,EB),this._composers.set(E.VERIFY_CODE,mB),this._composers.set(E.GET_FORUM_STATS,HB),this._composers.set(E.GET_FORUMS_LIST,BB),this._composers.set(E.GET_FORUM_MESSAGES,kB),this._composers.set(E.GET_FORUM_THREAD,VB),this._composers.set(E.GET_FORUM_THREADS,jB),this._composers.set(E.GET_UNREAD_FORUMS_COUNT,YB),this._composers.set(E.FORUM_MODERATE_MESSAGE,WB),this._composers.set(E.FORUM_MODERATE_THREAD,zB),this._composers.set(E.FORUM_POST_MESSAGE,XB),this._composers.set(E.UPDATE_FORUM_READ_MARKER,KB),this._composers.set(E.UPDATE_FORUM_SETTINGS,qB),this._composers.set(E.FORUM_UPDATE_THREAD,QB),this._composers.set(E.CLIENT_PONG,qE),this._composers.set(E.RELEASE_VERSION,XE),this._composers.set(E.SECURITY_TICKET,QE),this._composers.set(E.USER_INFO,KE),this._composers.set(E.DISCONNECT,$B),this._composers.set(E.SECURITY_MACHINE,t2),this._composers.set(E.CLIENT_VARIABLES,s2),this._composers.set(E.HANDSHAKE_INIT_DIFFIE,e2),this._composers.set(E.HANDSHAKE_COMPLETE_DIFFIE,JB),this._composers.set(E.CALL_FOR_HELP_FROM_FORUM_MESSAGE,r2),this._composers.set(E.CALL_FOR_HELP_FROM_FORUM_THREAD,i2),this._composers.set(E.CALL_FOR_HELP_FROM_IM,n2),this._composers.set(E.CALL_FOR_HELP_FROM_PHOTO,a2),this._composers.set(E.CALL_FOR_HELP_FROM_SELFIE,o2),this._composers.set(E.CALL_FOR_HELP,h2),this._composers.set(E.CHAT_REVIEW_GUIDE_DECIDES,u2),this._composers.set(E.CHAT_REVIEW_GUIDE_DETACHED,l2),this._composers.set(E.CHAT_REVIEW_GUIDE_VOTE,c2),this._composers.set(E.CHAT_REVIEW_SESSION_CREATE,_2),this._composers.set(E.DELETE_PENDING_CALLS_FOR_HELP,d2),this._composers.set(E.GET_CFH_STATUS,f2),this._composers.set(E.GET_FAQ_CATEGORY,g2),this._composers.set(E.GET_FAQ_TEXT,E2),this._composers.set(E.GET_GUIDE_REPORTING_STATUS,m2),this._composers.set(E.GET_PENDING_CALLS_FOR_HELP,p2),this._composers.set(E.GET_QUIZ_QUESTIONS,I2),this._composers.set(E.GUIDE_SESSION_CREATE,T2),this._composers.set(E.GUIDE_SESSION_FEEDBACK,R2),this._composers.set(E.GUIDE_SESSION_GET_REQUESTER_ROOM,v2),this._composers.set(E.GUIDE_SESSION_GUIDE_DECIDES,O2),this._composers.set(E.GUIDE_SESSION_INVITE_REQUESTER,S2),this._composers.set(E.GUIDE_SESSION_IS_TYPING,A2),this._composers.set(E.GUIDE_SESSION_MESSAGE,y2),this._composers.set(E.GUIDE_SESSION_ON_DUTY_UPDATE,C2),this._composers.set(E.GUIDE_SESSION_REPORT,M2),this._composers.set(E.GUIDE_SESSION_REQUESTER_CANCELS,P2),this._composers.set(E.GUIDE_SESSION_RESOLVED,N2),this._composers.set(E.POST_QUIZ_ANSWERS,b2),this._composers.set(E.SEARCH_FAQS,D2),this._composers.set(E.DESKTOP_VIEW,LG),this._composers.set(E.GROUP_INFO,CB),this._composers.set(E.GROUP_REQUEST,MB),this._composers.set(E.GROUP_MEMBER_REMOVE_CONFIRM,SB),this._composers.set(E.GROUP_MEMBER_REMOVE,DB),this._composers.set(E.GROUP_MEMBERS,PB),this._composers.set(E.GROUP_ADMIN_ADD,IB),this._composers.set(E.GROUP_ADMIN_REMOVE,TB),this._composers.set(E.GROUP_REQUEST_ACCEPT,NB),this._composers.set(E.GROUP_REQUEST_DECLINE,bB),this._composers.set(E.GROUP_DELETE,AB),this._composers.set(E.GROUP_CREATE_OPTIONS,OB),this._composers.set(E.GROUP_PARTS,RB),this._composers.set(E.GROUP_BUY,vB),this._composers.set(E.GROUP_SETTINGS,xB),this._composers.set(E.GROUP_SAVE_BADGE,LB),this._composers.set(E.GROUP_SAVE_COLORS,UB),this._composers.set(E.GROUP_SAVE_INFORMATION,FB),this._composers.set(E.GROUP_SAVE_PREFERENCES,wB),this._composers.set(E.GROUP_FAVORITE,yB),this._composers.set(E.GROUP_UNFAVORITE,GB),this._composers.set(E.GROUP_BADGES,mp),this._composers.set(E.APPROVE_ALL_MEMBERSHIP_REQUESTS,pB),this._composers.set(E.GROUP_UNBLOCK_MEMBER,aj),this._composers.set(E.ROOM_FAVORITE,DH),this._composers.set(E.CAN_CREATE_ROOM,UH),this._composers.set(E.CANCEL_ROOM_EVENT,LH),this._composers.set(E.CONVERT_GLOBAL_ROOM_ID,wH),this._composers.set(E.COMPETITION_ROOM_SEARCH,FH),this._composers.set(E.ROOM_CREATE,xH),this._composers.set(E.GET_USER_FLAT_CATS,KH),this._composers.set(E.GET_USER_EVENT_CATS,XH),this._composers.set(E.ROOM_FAVORITE_REMOVE,GH),this._composers.set(E.EDIT_ROOM_EVENT,BH),this._composers.set(E.FORWARD_TO_RANDOM_PROMOTED_ROOM,HH),this._composers.set(E.FORWARD_TO_SOME_ROOM,kH),this._composers.set(E.GET_CATEGORIES_WITH_USER_COUNT,VH),this._composers.set(E.GET_GUEST_ROOM,YH),this._composers.set(E.GET_OFFICIAL_ROOMS,WH),this._composers.set(E.GET_POPULAR_ROOM_TAGS,zH),this._composers.set(E.GUILD_BASE_SEARCH,qH),this._composers.set(E.MY_FAVOURITE_ROOMS_SEARCH,QH),this._composers.set(E.MY_FREQUENT_ROOM_HISTORY_SEARCH,ZH),this._composers.set(E.MY_FRIENDS_ROOM_SEARCH,JH),this._composers.set(E.MY_GUILD_BASES_SEARCH,$H),this._composers.set(E.MY_RECOMMENDED_ROOMS,ek),this._composers.set(E.MY_ROOM_HISTORY_SEARCH,tk),this._composers.set(E.MY_ROOM_RIGHTS_SEARCH,sk),this._composers.set(E.MY_ROOMS_SEARCH,rk),this._composers.set(E.POPULAR_ROOMS_SEARCH,_k),this._composers.set(E.ROOM_LIKE,dk),this._composers.set(E.ROOM_RIGHTS_REMOVE_OWN,fk),this._composers.set(E.ROOM_AD_EVENT_TAB_CLICKED,gk),this._composers.set(E.ROOM_AD_EVENT_TAB_VIEWED,Ek),this._composers.set(E.ROOM_AD_SEARCH,mk),this._composers.set(E.ROOM_TEXT_SEARCH,Tk),this._composers.set(E.ROOMS_WHERE_MY_FRIENDS_ARE,pk),this._composers.set(E.ROOMS_WITH_HIGHEST_SCORE_SEARCH,Ik),this._composers.set(E.SET_ROOM_SESSION_TAGS,Rk),this._composers.set(E.ROOM_STAFF_PICK,vk),this._composers.set(E.ROOM_FILTER_WORDS,jH),this._composers.set(E.ROOM_FILTER_WORDS_MODIFY,Sk),this._composers.set(E.USER_HOME_ROOM,Ok),this._composers.set(E.UPDATE_ROOM_THUMBNAIL,Ak),this._composers.set(E.NAVIGATOR_INIT,ak),this._composers.set(E.NAVIGATOR_SEARCH_CLOSE,ok),this._composers.set(E.NAVIGATOR_SEARCH,hk),this._composers.set(E.NAVIGATOR_SEARCH_OPEN,uk),this._composers.set(E.NAVIGATOR_SEARCH_SAVE,lk),this._composers.set(E.NAVIGATOR_SETTINGS_SAVE,ck),this._composers.set(E.NAVIGATOR_CATEGORY_LIST_MODE,ik),this._composers.set(E.NAVIGATOR_DELETE_SAVED_SEARCH,nk),this._composers.set(E.POLL_ANSWER,om),this._composers.set(E.POLL_REJECT,hm),this._composers.set(E.POLL_START,um),this._composers.set(E.POLL_VOTE_COUNTER,lm),this._composers.set(E.USER_EFFECT_ACTIVATE,L2),this._composers.set(E.USER_EFFECT_ENABLE,U2),this._composers.set(E.USER_BADGES,G2),this._composers.set(E.USER_BADGES_CURRENT_UPDATE,B2),this._composers.set(E.GET_BADGE_POINTS_LIMITS,F2),this._composers.set(E.REQUESTABADGE,x2),this._composers.set(E.GETISBADGEREQUESTFULFILLED,w2),this._composers.set(E.USER_BOTS,ZE),this._composers.set(E.USER_FURNITURE,H2),this._composers.set(E.REQUESTFURNIINVENTORYWHENNOTINROOM,k2),this._composers.set(E.USER_PETS,JE),this._composers.set(E.TRADE_ACCEPT,Y2),this._composers.set(E.TRADE_CANCEL,W2),this._composers.set(E.TRADE_CLOSE,z2),this._composers.set(E.TRADE_CONFIRM,X2),this._composers.set(E.TRADE_ITEM,K2),this._composers.set(E.TRADE_ITEMS,q2),this._composers.set(E.TRADE_ITEM_REMOVE,Q2),this._composers.set(E.TRADE,Z2),this._composers.set(E.TRADE_UNACCEPT,J2),this._composers.set(E.UNSEEN_RESET_CATEGORY,$2),this._composers.set(E.UNSEEN_RESET_ITEMS,eH),this._composers.set(E.ACHIEVEMENT_LIST,Mx),this._composers.set(E.PET_MOUNT,w_),this._composers.set(E.PET_RESPECT,tm),this._composers.set(E.PET_SUPPLEMENT,Ck),this._composers.set(E.REMOVE_PET_SADDLE,sm),this._composers.set(E.PET_INFO,rm),this._composers.set(E.TOGGLE_PET_BREEDING,im),this._composers.set(E.TOGGLE_PET_RIDING,nm),this._composers.set(E.USE_PET_PRODUCT,am),this._composers.set(E.GET_PET_TRAINING_PANEL,em),this._composers.set(E.PET_OPEN_PACKAGE,Wm),this._composers.set(E.PET_SELECTED,CV),this._composers.set(E.PETS_BREED,Yu),this._composers.set(E.PET_CANCEL_BREEDING,V2),this._composers.set(E.PET_CONFIRM_BREEDING,j2),this._composers.set(E.ROOM_ENTER,_m),this._composers.set(E.ROOM_DOORBELL,cm),this._composers.set(E.GO_TO_FLAT,qm),this._composers.set(E.CHANGE_QUEUE,Km),this._composers.set(E.ROOM_AMBASSADOR_ALERT,dm),this._composers.set(E.ROOM_BAN_GIVE,fm),this._composers.set(E.ROOM_BAN_REMOVE,Kk),this._composers.set(E.ROOM_RIGHTS_GIVE,gm),this._composers.set(E.ROOM_KICK,Em),this._composers.set(E.ROOM_MUTE_USER,mm),this._composers.set(E.ROOM_RIGHTS_REMOVE,pm),this._composers.set(E.ROOM_RIGHTS_REMOVE_ALL,zk),this._composers.set(E.ROOM_DELETE,Xk),this._composers.set(E.ROOM_SETTINGS,Zk),this._composers.set(E.ROOM_SETTINGS_SAVE,$k),this._composers.set(E.ROOM_RIGHTS_LIST,Jk),this._composers.set(E.ROOM_BAN_LIST,Qk),this._composers.set(E.ROOM_SETTINGS_UPDATE_ROOM_CATEGORY_AND_TRADE,FV),this._composers.set(E.BOT_CONFIGURATION,qk),this._composers.set(E.GET_ITEM_DATA,Om),this._composers.set(E.REMOVE_WALL_ITEM,Cm),this._composers.set(E.BOT_PLACE,Im),this._composers.set(E.BOT_PICKUP,Tm),this._composers.set(E.BOT_SKILL_SAVE,eV),this._composers.set(E.PET_PLACE,Am),this._composers.set(E.PET_MOVE,x_),this._composers.set(E.PET_PICKUP,ym),this._composers.set(E.SET_ITEM_DATA,Pm),this._composers.set(E.SET_OBJECT_DATA,Nm),this._composers.set(E.COMPOST_PLANT,vm),this._composers.set(E.HARVEST_PET,Sm),this._composers.set(E.SET_CLOTHING_CHANGE_DATA,Mm),this._composers.set(E.FURNITURE_ALIASES,Um),this._composers.set(E.FURNITURE_GROUP_INFO,Fm),this._composers.set(E.FURNITURE_PICKUP,wm),this._composers.set(E.FURNITURE_PLACE,xm),this._composers.set(E.ITEM_PAINT,iV),this._composers.set(E.FURNITURE_POSTIT_PLACE,Gm),this._composers.set(E.FURNITURE_POSTIT_SAVE_STICKY_POLE,tV),this._composers.set(E.CONTROL_YOUTUBE_DISPLAY_PLAYBACK,EV),this._composers.set(E.GET_YOUTUBE_DISPLAY_STATUS,mV),this._composers.set(E.SET_YOUTUBE_DISPLAY_PLAYLIST,pV),this._composers.set(E.FURNITURE_FLOOR_UPDATE,G_),this._composers.set(E.FURNITURE_WALL_UPDATE,Xm),this._composers.set(E.ITEM_DIMMER_SETTINGS,bm),this._composers.set(E.ITEM_DIMMER_SAVE,Dm),this._composers.set(E.ITEM_DIMMER_TOGGLE,Lm),this._composers.set(E.ROOM_TONER_APPLY,gV),this._composers.set(E.ITEM_COLOR_WHEEL_CLICK,Bm),this._composers.set(E.ITEM_DICE_CLICK,Hm),this._composers.set(E.ITEM_DICE_CLOSE,km),this._composers.set(E.FURNITURE_MULTISTATE,B_),this._composers.set(E.FURNITURE_RANDOMSTATE,jm),this._composers.set(E.ITEM_STACK_HELPER,oV),this._composers.set(E.FURNITURE_WALL_MULTISTATE,Ym),this._composers.set(E.ONE_WAY_DOOR_CLICK,Vm),this._composers.set(E.ITEM_EXCHANGE_REDEEM,aV),this._composers.set(E.ITEM_CLOTHING_REDEEM,vV),this._composers.set(E.ROOM_MODEL,H_),this._composers.set(E.GET_OCCUPIED_TILES,IV),this._composers.set(E.GET_ROOM_ENTRY_TILE,TV),this._composers.set(E.ROOM_MODEL_SAVE,RV),this._composers.set(E.UNIT_ACTION,ep),this._composers.set(E.UNIT_DANCE,tp),this._composers.set(E.UNIT_DROP_HAND_ITEM,SV),this._composers.set(E.UNIT_GIVE_HANDITEM,AV),this._composers.set(E.UNIT_GIVE_HANDITEM_PET,yV),this._composers.set(E.UNIT_LOOK,sp),this._composers.set(E.UNIT_SIGN,ip),this._composers.set(E.UNIT_POSTURE,rp),this._composers.set(E.UNIT_WALK,np),this._composers.set(E.UNIT_CHAT,k_),this._composers.set(E.UNIT_CHAT_SHOUT,Qm),this._composers.set(E.USER_SETTINGS_CHAT_STYLE,OV),this._composers.set(E.UNIT_CHAT_WHISPER,Zm),this._composers.set(E.UNIT_TYPING,Jm),this._composers.set(E.UNIT_TYPING_STOP,$m),this._composers.set(E.WIRED_APPLY_SNAPSHOT,PV),this._composers.set(E.WIRED_OPEN,NV),this._composers.set(E.WIRED_ACTION_SAVE,DV),this._composers.set(E.WIRED_CONDITION_SAVE,LV),this._composers.set(E.WIRED_TRIGGER_SAVE,UV),this._composers.set(E.ROOM_MUTE,bV),this._composers.set(E.APPROVE_NAME,WV),this._composers.set(E.USER_RESPECT,pp),this._composers.set(E.SCR_GET_KICKBACK_INFO,tj),this._composers.set(E.PEER_USERS_CLASSIFICATION,Ip),this._composers.set(E.USER_CLASSIFICATION,Tp),this._composers.set(E.USER_IGNORED,lp),this._composers.set(E.USER_IGNORE,_p),this._composers.set(E.USER_IGNORE_ID,dp),this._composers.set(E.USER_UNIGNORE,fp),this._composers.set(E.USER_BADGES_CURRENT,gp),this._composers.set(E.USER_FIGURE,qV),this._composers.set(E.USER_MOTTO,Ep),this._composers.set(E.USER_PROFILE,QV),this._composers.set(E.USER_PROFILE_BY_NAME,KV),this._composers.set(E.USER_TAGS,cp),this._composers.set(E.MESSENGER_RELATIONSHIPS,ZV),this._composers.set(E.MANNEQUIN_SAVE_NAME,uV),this._composers.set(E.MANNEQUIN_SAVE_LOOK,hV),this._composers.set(E.PRESENT_OPEN_PRESENT,zm),this._composers.set(E.MARKETPLACE_CONFIG,oH),this._composers.set(E.MARKETPLACE_SELL_ITEM,cH),this._composers.set(E.MARKETPLACE_REQUEST_OWN_ITEMS,lH),this._composers.set(E.MARKETPLACE_TAKE_BACK_ITEM,nH),this._composers.set(E.MARKETPLACE_REQUEST_OFFERS,uH),this._composers.set(E.MARKETPLACE_BUY_OFFER,rH),this._composers.set(E.MARKETPLACE_REDEEM_CREDITS,_H),this._composers.set(E.MARKETPLACE_BUY_TOKENS,iH),this._composers.set(E.REQUEST_SELL_ITEM,aH),this._composers.set(E.REQUEST_MARKETPLACE_ITEM_STATS,hH),this._composers.set(E.USER_BOTS,ZE),this._composers.set(E.USER_PETS,JE),this._composers.set(E.USER_CURRENCY,$V),this._composers.set(E.USER_SUBSCRIPTION,ej),this._composers.set(E.MODTOOL_REQUEST_ROOM_INFO,EH),this._composers.set(E.MODTOOL_CHANGE_ROOM_SETTINGS,vH),this._composers.set(E.MODTOOL_REQUEST_USER_CHATLOG,TH),this._composers.set(E.MODTOOL_REQUEST_ROOM_CHATLOG,pH),this._composers.set(E.MOD_TOOL_USER_INFO,mH),this._composers.set(E.MODTOOL_SANCTION_ALERT,RH),this._composers.set(E.MODTOOL_SANCTION_BAN,Ur),this._composers.set(E.MODTOOL_SANCTION_KICK,OH),this._composers.set(E.MODTOOL_SANCTION_TRADELOCK,MH),this._composers.set(E.MODTOOL_ALERTEVENT,SH),this._composers.set(E.MODTOOL_SANCTION_MUTE,AH),this._composers.set(E.MODTOOL_REQUEST_USER_ROOMS,IH),this._composers.set(E.MODTOOL_ROOM_ALERT,jo),this._composers.set(E.CLOSE_ISSUE_DEFAULT_ACTION,dH),this._composers.set(E.CLOSE_ISSUES,ju),this._composers.set(E.DEFAULT_SANCTION,fH),this._composers.set(E.GET_CFH_CHATLOG,gH),this._composers.set(E.MODTOOL_PREFERENCES,yH),this._composers.set(E.MODTOOL_SANCTION,CH),this._composers.set(E.PICK_ISSUES,PH),this._composers.set(E.RELEASE_ISSUES,NH),this._composers.set(E.MYSTERYBOXWAITINGCANCELEDMESSAGE,bH),this._composers.set(E.MYSTERYBOX_OPEN_TROPHY,lV),this._composers.set(E.USER_SETTINGS_CAMERA,sj),this._composers.set(E.USER_SETTINGS_OLD_CHAT,rj),this._composers.set(E.USER_SETTINGS_INVITES,ij),this._composers.set(E.USER_SETTINGS_VOLUME,nj),this._composers.set(E.COMMUNITY_GOAL_VOTE_COMPOSER,sH),this._composers.set(E.GET_PROMO_ARTICLES,tH),this._composers.set(E.ACCEPT_QUEST,Mk),this._composers.set(E.ACTIVATE_QUEST,Pk),this._composers.set(E.CANCEL_QUEST,Nk),this._composers.set(E.FRIEND_REQUEST_QUEST_COMPLETE,bk),this._composers.set(E.GET_COMMUNITY_GOAL_EARNED_PRIZES,Dk),this._composers.set(E.GET_COMMUNITY_GOAL_HALL_OF_FAME,Lk),this._composers.set(E.GET_COMMUNITY_GOAL_PROGRESS,Uk),this._composers.set(E.GET_CONCURRENT_USERS_GOAL_PROGRESS,Fk),this._composers.set(E.GET_CONCURRENT_USERS_REWARD,wk),this._composers.set(E.GET_DAILY_QUEST,xk),this._composers.set(E.GET_QUESTS,Gk),this._composers.set(E.GET_SEASONAL_QUESTS_ONLY,Bk),this._composers.set(E.OPEN_QUEST_TRACKER,Hk),this._composers.set(E.REDEEM_COMMUNITY_GOAL_PRIZE,kk),this._composers.set(E.REJECT_QUEST,Vk),this._composers.set(E.START_CAMPAIGN,jk),this._composers.set(E.GET_SOUND_SETTINGS,BV),this._composers.set(E.ADD_JUKEBOX_DISK,wV),this._composers.set(E.GET_JUKEBOX_PLAYLIST,ap),this._composers.set(E.GET_NOW_PLAYING,op),this._composers.set(E.GET_OFFICIAL_SONG_ID,xV),this._composers.set(E.GET_SONG_INFO,hp),this._composers.set(E.GET_SOUND_MACHINE_PLAYLIST,GV),this._composers.set(E.GET_USER_SONG_DISKS,up),this._composers.set(E.REMOVE_JUKEBOX_DISK,HV),this._composers.set(E.HELPER_TALENT_TRACK,VV),this._composers.set(E.TALENT_TRACK_GET_LEVEL,kV),this._composers.set(E.NEW_USER_EXPERIENCE_GET_GIFTS,yk),this._composers.set(E.NEW_USER_EXPERIENCE_SCRIPT_PROCEED,$E),this._composers.set(E.WELCOME_OPEN_GIFT,cV),this._composers.set(E.WELCOME_GIFT_CHANGE_EMAIL,oj),this._composers.set(E.EMAIL_GET_STATUS,JV),this._composers.set(E.EMAIL_CHANGE,XV),this._composers.set(E.RENTABLE_SPACE_CANCEL_RENT,_V),this._composers.set(E.RENTABLE_SPACE_RENT,dV),this._composers.set(E.RENTABLE_SPACE_STATUS,fV),this._composers.set(E.RECYCLER_STATUS,Yk),this._composers.set(E.RECYCLER_ITEMS,Wk),this._composers.set(E.TRACKING_PERFORMANCE_LOG,YV),this._composers.set(E.TRACKING_LAG_WARNING_REPORT,jV),this._composers.set(E.ROOM_DIRECTORY_ROOM_NETWORK_OPEN_CONNECTION,MV),this._composers.set(E.RENTABLE_EXTEND_RENT_OR_BUYOUT_STRIP_ITEM,rV),this._composers.set(E.RENTABLE_EXTEND_RENT_OR_BUYOUT_FURNI,sV),this._composers.set(E.RENTABLE_GET_RENT_OR_BUYOUT_OFFER,nV)}get events(){return this._events}get composers(){return this._composers}}class lj extends Pr{constructor(e){super(),this._communication=e,this._connection=null,this._messages=new uj,this._demo=new hj(this),this.onConnectionOpenedEvent=this.onConnectionOpenedEvent.bind(this),this.onConnectionClosedEvent=this.onConnectionClosedEvent.bind(this),this.onConnectionErrorEvent=this.onConnectionErrorEvent.bind(this),this.onConnectionAuthenticatedEvent=this.onConnectionAuthenticatedEvent.bind(this)}onInit(){this._connection||(X.instance.events.addEventListener(qt.CONNECTION_AUTHENTICATED,this.onConnectionAuthenticatedEvent),this._connection=this._communication.createConnection(this),this._connection.registerMessages(this._messages),this._connection.addEventListener(Ct.CONNECTION_OPENED,this.onConnectionOpenedEvent),this._connection.addEventListener(Ct.CONNECTION_CLOSED,this.onConnectionClosedEvent),this._connection.addEventListener(Ct.CONNECTION_ERROR,this.onConnectionErrorEvent),this._demo&&this._demo.init(),this._connection.init(ue.getValue("socket.url")))}onDispose(){this._demo&&this._demo.dispose(),this._connection&&(this._connection.removeEventListener(Ct.CONNECTION_OPENED,this.onConnectionOpenedEvent),this._connection.removeEventListener(Ct.CONNECTION_CLOSED,this.onConnectionClosedEvent),this._connection.removeEventListener(Ct.CONNECTION_ERROR,this.onConnectionErrorEvent)),X.instance.events.removeEventListener(qt.CONNECTION_AUTHENTICATED,this.onConnectionAuthenticatedEvent),super.onDispose()}onConnectionOpenedEvent(e){Y.log("Connection Initialized")}onConnectionClosedEvent(e){Y.log("Connection Closed")}onConnectionErrorEvent(e){Y.log("Connection Error")}onConnectionAuthenticatedEvent(e){Y.log("Connection Authenticated"),this._connection&&this._connection.authenticated()}connectionInit(e){Y.log("Initializing Connection",e)}registerMessageEvent(e){return this._connection&&this._connection.addMessageEvent(e),e}removeMessageEvent(e){this._connection&&this._connection.removeMessageEvent(e)}get demo(){return this._demo}get connection(){return this._connection}}class Ae{static get available(){return this._isListeningForPostMessages||(this._isListeningForPostMessages=!0,window.addEventListener("message",e=>{if(typeof e.data=="string"&&e.data.startsWith(Ae.MESSAGE_KEY)){const{method:t,params:s}=JSON.parse(e.data.substr(Ae.MESSAGE_KEY.length)),i=window[t];if(!i)return;i(...s);return}})),!0}static call(e,...t){if(window.top!==window&&window.top.postMessage(Ae.MESSAGE_KEY+JSON.stringify({method:e,params:t}),"*"),!("FlashExternalInterface"in window))return;const s=window.FlashExternalInterface[e];return typeof s<"u"?s(...t):void 0}static callGame(e,...t){if(window.top!==window&&window.top.postMessage("Nitro_LegacyExternalGameInterface"+JSON.stringify({method:e,params:t}),"*"),!("FlashExternalGameInterface"in window))return;const s=window.FlashExternalGameInterface[e];return typeof s<"u"?s(...t):void 0}static addCallback(e,t){window[e]=t}}Ae.MESSAGE_KEY="Nitro_LegacyExternalInterface",Ae._isListeningForPostMessages=!1;class cj{constructor(e){e.addMessageEvent(new zg(this.onLoadGameUrl.bind(this)))}onLoadGameUrl(e){if(!e)return;const t=e.getParser();t&&Ae.callGame("showGame",t.url)}}class V_{constructor(e){this._badgeId="",this._level=1,this._base="",this._badgeId=e,this.parseText()}parseText(){let e=this._badgeId.length-1;for(;e>0&&this.isNumber(this._badgeId.charAt(e));)e--;this._base=this._badgeId.substr(0,e+1);const t=this._badgeId.substr(e+1,this._badgeId.length);t&&t!==""&&(this._level=Number.parseInt(t))}isNumber(e){const t=e.charCodeAt(0);return t>=48&&t<=57}get level(){return this._level}set level(e){this._level=Math.max(1,e)}get getBadgeId(){return this._base+this._level}get base(){return this._base}}class _j extends Pr{constructor(e){super(),this._communication=e,this._definitions=new Map,this._parameters=new Map,this._badgePointLimits=new Map,this._romanNumerals=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII","XIII","XIV","XV","XVI","XVII","XVIII","XIX","XX","XXI","XXII","XXIII","XXIV","XXV","XXVI","XXVII","XXVIII","XXIX","XXX"],this._pendingUrls=[]}onInit(){this._communication.registerMessageEvent(new Jg(this.onBadgePointLimitsEvent.bind(this)));let e=ue.getValue("external.texts.url");Array.isArray(e)||(e=[ue.getValue("external.texts.url")]);for(let t=0;t<e.length;t++)e[t]=ue.interpolate(e[t]);this._pendingUrls=e,this.loadNextLocalization()}loadNextLocalization(){if(!this._pendingUrls.length){this.events&&this.events.dispatchEvent(new ga(ga.LOADED));return}this.loadLocalizationFromURL(this._pendingUrls[0])}loadLocalizationFromURL(e){fetch(e).then(t=>t.json()).then(t=>this.onLocalizationLoaded(t,e)).catch(t=>this.onLocalizationFailed(t))}onLocalizationLoaded(e,t){if(!e)return;if(!this.parseLocalization(e))throw new Error(`Invalid json data for file ${t}`);const s=this._pendingUrls.indexOf(t);s>=0&&this._pendingUrls.splice(s,1),this.loadNextLocalization()}onLocalizationFailed(e){this.events&&this.events.dispatchEvent(new ga(ga.FAILED))}parseLocalization(e){if(!e)return!1;for(const t in e)this._definitions.set(t,e[t]);return!0}onBadgePointLimitsEvent(e){const t=e.getParser();for(const s of t.data)this.setBadgePointLimit(s.badgeId,s.limit)}getBadgePointLimit(e){return this._badgePointLimits.get(e)||-1}setBadgePointLimit(e,t){this._badgePointLimits.set(e,t)}getRomanNumeral(e){return this._romanNumerals[Math.max(0,e-1)]}getPreviousLevelBadgeId(e){const t=new V_(e);return t.level--,t.getBadgeId}hasValue(e){return this._definitions.has(e)}getValue(e,t=!0){if(!e||!e.length)return null;const s=e.match(/\$\{.[^}]*\}/g);if(s&&s.length)for(const n of s)e=e.replace(n,this.getValue(n.slice(2,-1),t));let i=this._definitions.get(e)||null;if(!i&&(i=ue.definitions.get(e),i))return i;if(i&&t){const n=this._parameters.get(e);if(n)for(const[a,o]of n)i=i.replace("%"+a+"%",o)}return i||e}getValueWithParameter(e,t,s){const i=this.getValue(e,!1),n=i.replace("%"+t+"%",s);if(i.startsWith("%{")){const a=new RegExp("%{"+t.toUpperCase()+"\\|([^|]*)\\|([^|]*)\\|([^|]*)}"),o=i.match(a);if(!o)return n;let u=-1;switch(Number.parseInt(s)){case 0:u=1;break;case 1:u=2;break;default:case 2:u=3;break}if(u==-1||typeof o[u]>"u")return n;const d=o[u];if(d)return d.replace("%%",s)}return n}getValueWithParameters(e,t,s){let i=this.getValue(e,!1);if(t)for(let n=0;n<t.length;n++){const a=t[n],o=s[n];if(o!==void 0&&(i=i.replace("%"+a+"%",o),i.startsWith("%{"))){const u=new RegExp("%{"+a.toUpperCase()+"\\|([^|]*)\\|([^|]*)\\|([^|]*)}"),l=i.match(u);if(!l)continue;const d=parseInt(o);let c=-1;switch(d){case 0:c=1;break;case 1:c=2;break;case 2:default:c=3;break}if(c===-1||typeof l[c]>"u")continue;const _=l[c];_&&(i=_.replace("%%",o))}}return i}setValue(e,t){this._definitions.set(e,t)}registerParameter(e,t,s){if(!e||e.length===0||!t||t.length===0)return;let i=this._parameters.get(e);i||(i=new Map,this._parameters.set(e,i)),i.set(t,s)}getBadgeName(e){const t=new V_(e),s=["badge_name_"+e,"badge_name_"+t.base];let i=this.fixBadLocalization(this.getExistingKey(s));return i=i.replace("%roman%",this.getRomanNumeral(t.level)),i}getBadgeDesc(e){const t=new V_(e),s=["badge_desc_"+e,"badge_desc_"+t.base];let i=this.fixBadLocalization(this.getExistingKey(s));const n=this.getBadgePointLimit(e);return n>-1&&(i=i.replace("%limit%",n.toString())),i=i.replace("%roman%",this.getRomanNumeral(t.level)),i}getExistingKey(e){for(const t of e){const s=this.getValue(t);if(s!=t)return s}return""}fixBadLocalization(e){return e.replace("${","$").replace("{","$").replace("}","$")}}/*!
 * @pixi/canvas-display - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/canvas-display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Zr.prototype._renderCanvas=function(e){},Zr.prototype.renderCanvas=function(e){if(!(!this.visible||this.worldAlpha<=0||!this.renderable)){this._mask&&e.maskManager.pushMask(this._mask),this._renderCanvas(e);for(var t=0,s=this.children.length;t<s;++t)this.children[t].renderCanvas(e);this._mask&&e.maskManager.popMask(e)}},yt.prototype.renderCanvas=function(e){};/*!
 * @pixi/extract - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var oQ=new he,hQ=4,uQ=function(){function r(e){this.renderer=e}return r.prototype.image=function(e,t,s){var i=new Image;return i.src=this.base64(e,t,s),i},r.prototype.base64=function(e,t,s){return this.canvas(e).toDataURL(t,s)},r.prototype.canvas=function(e,t){var s=this._rawPixels(e,t),i=s.pixels,n=s.width,a=s.height,o=s.flipY,u=new BT(n,a,1),l=u.context.getImageData(0,0,n,a);if(r.arrayPostDivide(i,l.data),u.context.putImageData(l,0,0),o){var d=new BT(u.width,u.height,1);d.context.scale(1,-1),d.context.drawImage(u.canvas,0,-a),u.destroy(),u=d}return u.canvas},r.prototype.pixels=function(e,t){var s=this._rawPixels(e,t).pixels;return r.arrayPostDivide(s,s),s},r.prototype._rawPixels=function(e,t){var s=this.renderer,i,n=!1,a,o=!1;if(e)if(e instanceof kt)a=e;else{var u=s.context.webGLVersion>=2?s.multisample:lt.NONE;if(a=this.renderer.generateTexture(e,{multisample:u}),u!==lt.NONE){var l=kt.create({width:a.width,height:a.height});s.framebuffer.bind(a.framebuffer),s.framebuffer.blit(l.framebuffer),s.framebuffer.bind(null),a.destroy(!0),a=l}o=!0}a?(i=a.baseTexture.resolution,t=t??a.frame,n=!1,s.renderTexture.bind(a)):(i=s.resolution,t||(t=oQ,t.width=s.width,t.height=s.height),n=!0,s.renderTexture.bind(null));var d=Math.round(t.width*i),c=Math.round(t.height*i),_=new Uint8Array(hQ*d*c),f=s.gl;return f.readPixels(Math.round(t.x*i),Math.round(t.y*i),d,c,f.RGBA,f.UNSIGNED_BYTE,_),o&&a.destroy(!0),{pixels:_,width:d,height:c,flipY:n}},r.prototype.destroy=function(){this.renderer=null},r.arrayPostDivide=function(e,t){for(var s=0;s<e.length;s+=4){var i=t[s+3]=e[s+3];i!==0?(t[s]=Math.round(Math.min(e[s]*255/i,255)),t[s+1]=Math.round(Math.min(e[s+1]*255/i,255)),t[s+2]=Math.round(Math.min(e[s+2]*255/i,255))):(t[s]=e[s],t[s+1]=e[s+1],t[s+2]=e[s+2])}},r.extension={name:"extract",type:Lt.RendererPlugin},r}();/*!
 * @pixi/graphics-extras - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/graphics-extras is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */function lQ(r,e,t,s,i,n){return i===void 0&&(i=0),n===void 0&&(n=Math.PI*2),Math.abs(n-i)>=Math.PI*2?this.drawCircle(r,e,s).beginHole().drawCircle(r,e,t).endHole():(this.finishPoly(),this.arc(r,e,t,n,i,!0).arc(r,e,s,i,n,!1).finishPoly(),this)}function cQ(r,e,t,s,i){if(i<=0)return this.drawRect(r,e,t,s);for(var n=Math.min(i,Math.min(t,s)/2),a=r+t,o=e+s,u=[r+n,e,a-n,e,a,e+n,a,o-n,a-n,o,r+n,o,r,o-n,r,e+n],l=u.length-1;l>=2;l-=2)u[l]===u[l-2]&&u[l-1]===u[l-3]&&u.splice(l-1,2);return this.drawPolygon(u)}function _Q(r,e,t,s,i){if(i===0)return this.drawRect(r,e,t,s);var n=Math.min(t,s)/2,a=Math.min(n,Math.max(-n,i)),o=r+t,u=e+s,l=a<0?-a:0,d=Math.abs(a);return this.moveTo(r,e+d).arcTo(r+l,e+l,r+d,e,d).lineTo(o-d,e).arcTo(o-l,e+l,o,e+d,d).lineTo(o,u-d).arcTo(o-l,u-l,r+t-d,u,d).lineTo(r+d,u).arcTo(r+l,u-l,r,u-d,d).closePath()}function dQ(r,e,t,s,i){i===void 0&&(i=0),s=Math.max(s|0,3);for(var n=-1*Math.PI/2+i,a=Math.PI*2/s,o=[],u=0;u<s;u++){var l=u*a+n;o.push(r+t*Math.cos(l),e+t*Math.sin(l))}return this.drawPolygon(o)}function fQ(r,e,t,s,i,n){if(n===void 0&&(n=0),s=Math.max(s|0,3),i<=0)return this.drawRegularPolygon(r,e,t,s,n);var a=t*Math.sin(Math.PI/s)-.001;i=Math.min(i,a);for(var o=-1*Math.PI/2+n,u=Math.PI*2/s,l=(s-2)*Math.PI/s/2,d=0;d<s;d++){var c=d*u+o,_=r+t*Math.cos(c),f=e+t*Math.sin(c),g=c+Math.PI+l,I=c-Math.PI-l,p=_+i*Math.cos(g),R=f+i*Math.sin(g),S=_+i*Math.cos(I),O=f+i*Math.sin(I);d===0?this.moveTo(p,R):this.lineTo(p,R),this.quadraticCurveTo(_,f,S,O)}return this.closePath()}/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var Rp=function(r,e){return Rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var i in s)s.hasOwnProperty(i)&&(t[i]=s[i])},Rp(r,e)};function gQ(r,e){Rp(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var EQ=function(r){gQ(e,r);function e(t,s,i,n,a,o){o===void 0&&(o=0);var u=this;a=a||n/2;for(var l=-1*Math.PI/2+o,d=i*2,c=ch/d,_=[],f=0;f<d;f++){var g=f%2?a:n,I=f*c+l;_.push(t+g*Math.cos(I),s+g*Math.sin(I))}return u=r.call(this,_)||this,u}return e}(_h);function mQ(r,e,t,s,i,n){return n===void 0&&(n=0),this.drawPolygon(new EQ(r,e,t,s,i,n))}Object.defineProperties(Po.prototype,{drawTorus:{value:lQ},drawChamferRect:{value:cQ},drawFilletRect:{value:_Q},drawRegularPolygon:{value:dQ},drawRoundedPolygon:{value:fQ},drawStar:{value:mQ}});/*!
 * @pixi/math-extras - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/math-extras is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var dj={add:function(r,e){return e||(e=new k),e.x=this.x+r.x,e.y=this.y+r.y,e},subtract:function(r,e){return e||(e=new k),e.x=this.x-r.x,e.y=this.y-r.y,e},multiply:function(r,e){return e||(e=new k),e.x=this.x*r.x,e.y=this.y*r.y,e},multiplyScalar:function(r,e){return e||(e=new k),e.x=this.x*r,e.y=this.y*r,e},dot:function(r){return this.x*r.x+this.y*r.y},cross:function(r){return this.x*r.y-this.y*r.x},normalize:function(r){r||(r=new k);var e=Math.sqrt(this.x*this.x+this.y*this.y);return r.x=this.x/e,r.y=this.y/e,r},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},magnitudeSquared:function(){return this.x*this.x+this.y*this.y},project:function(r,e){e||(e=new k);var t=(this.x*r.x+this.y*r.y)/(r.x*r.x+r.y*r.y);return e.x=r.x*t,e.y=r.y*t,e},reflect:function(r,e){e||(e=new k);var t=this.x*r.x+this.y*r.y;return e.x=this.x-2*t*r.x,e.y=this.y-2*t*r.y,e}};Object.assign(k.prototype,dj),Object.assign(eo.prototype,dj),he.prototype.containsRect=function(e){return e.width<=0||e.height<=0?e.x>this.x&&e.y>this.y&&e.right<this.right&&e.bottom<this.bottom:e.x>=this.x&&e.y>=this.y&&e.right<=this.right&&e.bottom<=this.bottom},he.prototype.equals=function(e){return e===this?!0:e&&this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height},he.prototype.intersection=function(e,t){t||(t=new he);var s=this.x<e.x?e.x:this.x,i=this.right>e.right?e.right:this.right;if(i<=s)return t.x=t.y=t.width=t.height=0,t;var n=this.y<e.y?e.y:this.y,a=this.bottom>e.bottom?e.bottom:this.bottom;return a<=n?(t.x=t.y=t.width=t.height=0,t):(t.x=s,t.y=n,t.width=i-s,t.height=a-n,t)},he.prototype.union=function(e,t){t||(t=new he);var s=Math.min(this.x,e.x),i=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),a=Math.max(this.y+this.height,e.y+e.height);return t.x=s,t.y=n,t.width=i-s,t.height=a-n,t};/*!
 * @pixi/mixin-cache-as-bitmap - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/mixin-cache-as-bitmap is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var fj=new Ye;yt.prototype._cacheAsBitmap=!1,yt.prototype._cacheData=null,yt.prototype._cacheAsBitmapResolution=null,yt.prototype._cacheAsBitmapMultisample=lt.NONE;var pQ=function(){function r(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}return r}();Object.defineProperties(yt.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(r){r!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=r,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get:function(){return this._cacheAsBitmapMultisample},set:function(r){r!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=r,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(r){if(this._cacheAsBitmap!==r){this._cacheAsBitmap=r;var e;r?(this._cacheData||(this._cacheData=new pQ),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}}}),yt.prototype._renderCached=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e))},yt.prototype._initCachedDisplayObject=function(e){var t;if(!(this._cacheData&&this._cacheData.sprite)){var s=this.alpha;this.alpha=1,e.batch.flush();var i=this.getLocalBounds(null,!0).clone();if(this.filters&&this.filters.length){var n=this.filters[0].padding;i.pad(n)}i.ceil(J.RESOLUTION);var a=e.renderTexture.current,o=e.renderTexture.sourceFrame.clone(),u=e.renderTexture.destinationFrame.clone(),l=e.projection.transform,d=kt.create({width:i.width,height:i.height,resolution:this.cacheAsBitmapResolution||e.resolution,multisample:(t=this.cacheAsBitmapMultisample)!==null&&t!==void 0?t:e.multisample}),c="cacheAsBitmap_"+Kn();this._cacheData.textureCacheId=c,Qe.addToCache(d.baseTexture,c),Re.addToCache(d,c);var _=this.transform.localTransform.copyTo(fj).invert().translate(-i.x,-i.y);this.render=this._cacheData.originalRender,e.render(this,{renderTexture:d,clear:!0,transform:_,skipUpdateTransform:!1}),e.framebuffer.blit(),e.projection.transform=l,e.renderTexture.bind(a,o,u),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=s;var f=new Ze(d);f.transform.worldTransform=this.transform.worldTransform,f.anchor.x=-(i.x/i.width),f.anchor.y=-(i.y/i.height),f.alpha=s,f._bounds=this._bounds,this._cacheData.sprite=f,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=f.containsPoint.bind(f)}},yt.prototype._renderCachedCanvas=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e))},yt.prototype._initCachedDisplayObjectCanvas=function(e){if(!(this._cacheData&&this._cacheData.sprite)){var t=this.getLocalBounds(null,!0),s=this.alpha;this.alpha=1;var i=e.context,n=e._projTransform;t.ceil(J.RESOLUTION);var a=kt.create({width:t.width,height:t.height}),o="cacheAsBitmap_"+Kn();this._cacheData.textureCacheId=o,Qe.addToCache(a.baseTexture,o),Re.addToCache(a,o);var u=fj;this.transform.localTransform.copyTo(u),u.invert(),u.tx-=t.x,u.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,{renderTexture:a,clear:!0,transform:u,skipUpdateTransform:!1}),e.context=i,e._projTransform=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=s;var l=new Ze(a);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-(t.x/t.width),l.anchor.y=-(t.y/t.height),l.alpha=s,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)}},yt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},yt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},yt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Qe.removeFromCache(this._cacheData.textureCacheId),Re.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},yt.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)};/*!
 * @pixi/mixin-get-child-by-name - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/mixin-get-child-by-name is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */yt.prototype.name=null,Zr.prototype.getChildByName=function(e,t){for(var s=0,i=this.children.length;s<i;s++)if(this.children[s].name===e)return this.children[s];if(t)for(var s=0,i=this.children.length;s<i;s++){var n=this.children[s];if(n.getChildByName){var a=n.getChildByName(e,!0);if(a)return a}}return null};/*!
 * @pixi/mixin-get-global-position - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/mixin-get-global-position is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */yt.prototype.getGlobalPosition=function(e,t){return e===void 0&&(e=new k),t===void 0&&(t=!1),this.parent?this.parent.toGlobal(this.position,e,t):(e.x=this.position.x,e.y=this.position.y),e};function IQ(r){var e=this.constructor;return this.then(function(t){return e.resolve(r()).then(function(){return t})},function(t){return e.resolve(r()).then(function(){return e.reject(t)})})}function TQ(r){var e=this;return new e(function(t,s){if(!(r&&typeof r.length<"u"))return s(new TypeError(typeof r+" "+r+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var i=Array.prototype.slice.call(r);if(i.length===0)return t([]);var n=i.length;function a(u,l){if(l&&(typeof l=="object"||typeof l=="function")){var d=l.then;if(typeof d=="function"){d.call(l,function(c){a(u,c)},function(c){i[u]={status:"rejected",reason:c},--n===0&&t(i)});return}}i[u]={status:"fulfilled",value:l},--n===0&&t(i)}for(var o=0;o<i.length;o++)a(o,i[o])})}function gj(r,e){this.name="AggregateError",this.errors=r,this.message=e||""}gj.prototype=Error.prototype;function RQ(r){var e=this;return new e(function(t,s){if(!(r&&typeof r.length<"u"))return s(new TypeError("Promise.any accepts an array"));var i=Array.prototype.slice.call(r);if(i.length===0)return s();for(var n=[],a=0;a<i.length;a++)try{e.resolve(i[a]).then(t).catch(function(o){n.push(o),n.length===i.length&&s(new gj(n,"All promises were rejected"))})}catch(o){s(o)}})}var vQ=setTimeout;function Ej(r){return!!(r&&typeof r.length<"u")}function OQ(){}function SQ(r,e){return function(){r.apply(e,arguments)}}function Tt(r){if(!(this instanceof Tt))throw new TypeError("Promises must be constructed via new");if(typeof r!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],pj(r,this)}function mj(r,e){for(;r._state===3;)r=r._value;if(r._state===0){r._deferreds.push(e);return}r._handled=!0,Tt._immediateFn(function(){var t=r._state===1?e.onFulfilled:e.onRejected;if(t===null){(r._state===1?vp:Wu)(e.promise,r._value);return}var s;try{s=t(r._value)}catch(i){Wu(e.promise,i);return}vp(e.promise,s)})}function vp(r,e){try{if(e===r)throw new TypeError("A promise cannot be resolved with itself.");if(e&&(typeof e=="object"||typeof e=="function")){var t=e.then;if(e instanceof Tt){r._state=3,r._value=e,Op(r);return}else if(typeof t=="function"){pj(SQ(t,e),r);return}}r._state=1,r._value=e,Op(r)}catch(s){Wu(r,s)}}function Wu(r,e){r._state=2,r._value=e,Op(r)}function Op(r){r._state===2&&r._deferreds.length===0&&Tt._immediateFn(function(){r._handled||Tt._unhandledRejectionFn(r._value)});for(var e=0,t=r._deferreds.length;e<t;e++)mj(r,r._deferreds[e]);r._deferreds=null}function AQ(r,e,t){this.onFulfilled=typeof r=="function"?r:null,this.onRejected=typeof e=="function"?e:null,this.promise=t}function pj(r,e){var t=!1;try{r(function(s){t||(t=!0,vp(e,s))},function(s){t||(t=!0,Wu(e,s))})}catch(s){if(t)return;t=!0,Wu(e,s)}}Tt.prototype.catch=function(r){return this.then(null,r)},Tt.prototype.then=function(r,e){var t=new this.constructor(OQ);return mj(this,new AQ(r,e,t)),t},Tt.prototype.finally=IQ,Tt.all=function(r){return new Tt(function(e,t){if(!Ej(r))return t(new TypeError("Promise.all accepts an array"));var s=Array.prototype.slice.call(r);if(s.length===0)return e([]);var i=s.length;function n(o,u){try{if(u&&(typeof u=="object"||typeof u=="function")){var l=u.then;if(typeof l=="function"){l.call(u,function(d){n(o,d)},t);return}}s[o]=u,--i===0&&e(s)}catch(d){t(d)}}for(var a=0;a<s.length;a++)n(a,s[a])})},Tt.any=RQ,Tt.allSettled=TQ,Tt.resolve=function(r){return r&&typeof r=="object"&&r.constructor===Tt?r:new Tt(function(e){e(r)})},Tt.reject=function(r){return new Tt(function(e,t){t(r)})},Tt.race=function(r){return new Tt(function(e,t){if(!Ej(r))return t(new TypeError("Promise.race accepts an array"));for(var s=0,i=r.length;s<i;s++)Tt.resolve(r[s]).then(e,t)})},Tt._immediateFn=typeof setImmediate=="function"&&function(r){setImmediate(r)}||function(r){vQ(r,0)},Tt._unhandledRejectionFn=function(e){typeof console<"u"&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Ij=Object.getOwnPropertySymbols,yQ=Object.prototype.hasOwnProperty,CQ=Object.prototype.propertyIsEnumerable;function MQ(r){if(r==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(r)}function PQ(){try{if(!Object.assign)return!1;var r=new String("abc");if(r[5]="de",Object.getOwnPropertyNames(r)[0]==="5")return!1;for(var e={},t=0;t<10;t++)e["_"+String.fromCharCode(t)]=t;var s=Object.getOwnPropertyNames(e).map(function(n){return e[n]});if(s.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(n){i[n]=n}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var NQ=PQ()?Object.assign:function(r,e){for(var t,s=MQ(r),i,n=1;n<arguments.length;n++){t=Object(arguments[n]);for(var a in t)yQ.call(t,a)&&(s[a]=t[a]);if(Ij){i=Ij(t);for(var o=0;o<i.length;o++)CQ.call(t,i[o])&&(s[i[o]]=t[i[o]])}}return s};const bQ=_d(NQ);/*!
 * @pixi/polyfill - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/polyfill is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */typeof globalThis>"u"&&(typeof self<"u"?self.globalThis=self:typeof global<"u"&&(global.globalThis=global)),globalThis.Promise||(globalThis.Promise=Tt),Object.assign||(Object.assign=bQ);var DQ=16;if(Date.now&&Date.prototype.getTime||(Date.now=function(){return new Date().getTime()}),!(globalThis.performance&&globalThis.performance.now)){var LQ=Date.now();globalThis.performance||(globalThis.performance={}),globalThis.performance.now=function(){return Date.now()-LQ}}for(var Sp=Date.now(),Tj=["ms","moz","webkit","o"],Ap=0;Ap<Tj.length&&!globalThis.requestAnimationFrame;++Ap){var yp=Tj[Ap];globalThis.requestAnimationFrame=globalThis[yp+"RequestAnimationFrame"],globalThis.cancelAnimationFrame=globalThis[yp+"CancelAnimationFrame"]||globalThis[yp+"CancelRequestAnimationFrame"]}globalThis.requestAnimationFrame||(globalThis.requestAnimationFrame=function(r){if(typeof r!="function")throw new TypeError(r+"is not a function");var e=Date.now(),t=DQ+Sp-e;return t<0&&(t=0),Sp=e,globalThis.self.setTimeout(function(){Sp=Date.now(),r(performance.now())},t)}),globalThis.cancelAnimationFrame||(globalThis.cancelAnimationFrame=function(r){return clearTimeout(r)}),Math.sign||(Math.sign=function(e){return e=Number(e),e===0||isNaN(e)?e:e>0?1:-1}),Number.isInteger||(Number.isInteger=function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}),globalThis.ArrayBuffer||(globalThis.ArrayBuffer=Array),globalThis.Float32Array||(globalThis.Float32Array=Array),globalThis.Uint32Array||(globalThis.Uint32Array=Array),globalThis.Uint16Array||(globalThis.Uint16Array=Array),globalThis.Uint8Array||(globalThis.Uint8Array=Array),globalThis.Int32Array||(globalThis.Int32Array=Array);/*!
 * @pixi/sprite-tiling - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/sprite-tiling is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var Cp=function(r,e){return Cp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var i in s)s.hasOwnProperty(i)&&(t[i]=s[i])},Cp(r,e)};function Rj(r,e){Cp(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var zu=new k,UQ=function(r){Rj(e,r);function e(t,s,i){s===void 0&&(s=100),i===void 0&&(i=100);var n=r.call(this,t)||this;return n.tileTransform=new VT,n._width=s,n._height=i,n.uvMatrix=n.texture.uvMatrix||new hR(t),n.pluginName="tilingSprite",n.uvRespectAnchor=!1,n}return Object.defineProperty(e.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copyFrom(t)},enumerable:!1,configurable:!0}),e.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},e.prototype._render=function(t){var s=this._texture;!s||!s.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,s=this._height*-this._anchor._y,i=this._width*(1-this._anchor._x),n=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,s,i,n)},e.prototype.getLocalBounds=function(t){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new he),t=this._localBoundsRect),this._bounds.getRectangle(t)):r.prototype.getLocalBounds.call(this,t)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,zu);var s=this._width,i=this._height,n=-s*this.anchor._x;if(zu.x>=n&&zu.x<n+s){var a=-i*this.anchor._y;if(zu.y>=a&&zu.y<a+i)return!0}return!1},e.prototype.destroy=function(t){r.prototype.destroy.call(this,t),this.tileTransform=null,this.uvMatrix=null},e.from=function(t,s){var i=t instanceof Re?t:Re.from(t,s);return new e(i,s.width,s.height)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0}),e}(Ze),FQ=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`,vj=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,wQ=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,xQ=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,GQ=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,j_=new Ye,BQ=function(r){Rj(e,r);function e(t){var s=r.call(this,t)||this;return t.runners.contextChange.add(s),s.quad=new ZT,s.state=Eh.for2d(),s}return e.prototype.contextChange=function(){var t=this.renderer,s={globals:t.globalUniforms};this.simpleShader=ta.from(vj,FQ,s),this.shader=t.context.webGLVersion>1?ta.from(xQ,GQ,s):ta.from(vj,wQ,s)},e.prototype.render=function(t){var s=this.renderer,i=this.quad,n=i.vertices;n[0]=n[6]=t._width*-t.anchor.x,n[1]=n[3]=t._height*-t.anchor.y,n[2]=n[4]=t._width*(1-t.anchor.x),n[5]=n[7]=t._height*(1-t.anchor.y);var a=t.uvRespectAnchor?t.anchor.x:0,o=t.uvRespectAnchor?t.anchor.y:0;n=i.uvs,n[0]=n[6]=-a,n[1]=n[3]=-o,n[2]=n[4]=1-a,n[5]=n[7]=1-o,i.invalidate();var u=t._texture,l=u.baseTexture,d=l.alphaMode>0,c=t.tileTransform.localTransform,_=t.uvMatrix,f=l.isPowerOfTwo&&u.frame.width===l.width&&u.frame.height===l.height;f&&(l._glTextures[s.CONTEXT_UID]?f=l.wrapMode!==Ai.CLAMP:l.wrapMode===Ai.CLAMP&&(l.wrapMode=Ai.REPEAT));var g=f?this.simpleShader:this.shader,I=u.width,p=u.height,R=t._width,S=t._height;j_.set(c.a*I/R,c.b*I/S,c.c*p/R,c.d*p/S,c.tx/R,c.ty/S),j_.invert(),f?j_.prepend(_.mapCoord):(g.uniforms.uMapCoord=_.mapCoord.toArray(!0),g.uniforms.uClampFrame=_.uClampFrame,g.uniforms.uClampOffset=_.uClampOffset),g.uniforms.uTransform=j_.toArray(!0),g.uniforms.uColor=G6(t.tint,t.worldAlpha,g.uniforms.uColor,d),g.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),g.uniforms.uSampler=u,s.shader.bind(g),s.geometry.bind(i),this.state.blendMode=x6(t.blendMode,d),s.state.set(this.state),s.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},e.extension={name:"tilingSprite",type:Lt.RendererPlugin},e}(Bl);Pi.add(ER,uQ,BQ,bq,BK,LK,j6);class Mp{constructor(){this.id=0,this.data=null,this.image=null}getImage(){return this.image?this.image:this.data?Je.generateImage(this.data):null}}class fs extends St{constructor(e){super(null,null),this._type=e}get type(){return this._type}}fs.IMAGE_LOADED="ROAUM_IMAGE_LOADED",fs.IMAGE_LOADING_FAILED="ROAUM_IMAGE_FAILED";class Rt extends St{constructor(){super(null,null)}}class Pp extends Rt{constructor(e,t){super(),this._itemType=e,this._itemName=t}get itemType(){return this._itemType}get itemName(){return this._itemName}}class Y_ extends Rt{constructor(e=0){super(),this._numberOfWords=e}get numberOfWords(){return this._numberOfWords}}class Np extends Rt{constructor(e=0){super(),this._danceStyle=e}get danceStyle(){return this._danceStyle}}class bp extends Rt{constructor(e,t=0){super(),this._effect=e,this._delayMilliseconds=t}get effect(){return this._effect}get delayMilliseconds(){return this._delayMilliseconds}}class Dp extends Rt{constructor(e){super(),this._gainedExperience=e}get gainedExperience(){return this._gainedExperience}}class Lp extends Rt{constructor(e=0){super(),this._expressionType=e}get expressionType(){return this._expressionType}}class Xu extends Rt{constructor(e,t=null,s=null,i=!1){super(),this._figure=e,this._gender=t,this._subType=s,this._isRiding=i}get figure(){return this._figure}get gender(){return this._gender}get subType(){return this._subType}get isRiding(){return this._isRiding}}class Up extends Rt{constructor(e=0){super(),this._level=e}get level(){return this._level}}class Fp extends Rt{constructor(e=0){super(),this._gesture=e}get gesture(){return this._gesture}}class Oj extends Rt{constructor(e){super(),this._guideStatus=e}get guideStatus(){return this._guideStatus}}class wp extends Rt{constructor(e=!1){super(),this._isMuted=e}get isMuted(){return this._isMuted}}class xp extends Rt{}class Gp extends Rt{constructor(e){super(),this._gesture=e}get gesture(){return this._gesture}}class Bp extends Rt{constructor(e){super(),this._value=e}get value(){return this._value}}class Hp extends Rt{constructor(e){super(),this._isPlayingGame=e}get isPlayingGame(){return this._isPlayingGame}}class W_ extends Rt{constructor(e,t=""){super(),this._postureType=e,this._parameter=t}get postureType(){return this._postureType}get parameter(){return this._parameter}}class Ku extends Rt{constructor(e){super(),this._selected=e}get selected(){return this._selected}}class kp extends Rt{constructor(e=0){super(),this._signType=e}get signType(){return this._signType}}class z_ extends Rt{constructor(e=!1){super(),this._isSleeping=e}get isSleeping(){return this._isSleeping}}class Vp extends Rt{constructor(e=!1){super(),this._isTyping=e}get isTyping(){return this._isTyping}}class qi extends St{constructor(e,t,s,i=!1){super(e,s),this._targetLocation=t,this._isSlide=i}get targetLocation(){return this._targetLocation?this._targetLocation:this.location}get isSlide(){return this._isSlide}}class qu extends qi{constructor(e,t,s,i,n,a){super(e,t,s),this._headDirection=i,this._canStandUp=n,this._baseY=a}get headDirection(){return this._headDirection}get canStandUp(){return this._canStandUp}get baseY(){return this._baseY}}class jp extends Rt{constructor(e){super(),this._itemType=e}get itemType(){return this._itemType}}class Ve extends St{constructor(e,t,s=null){super(null,null),this._state=e,this._data=t,this._extra=s}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}}class Na extends St{constructor(e,t){super(null,null),this._badgeId=e,this._assetName=t}get badgeId(){return this._badgeId}get assetName(){return this._assetName}}Na.BADGE_LOADED="ROGBUM_BADGE_LOADED";class Yp extends St{constructor(e,t,s){super(e,t),this._height=s}get height(){return this._height}}class X_ extends St{constructor(e){super(null,null),this._data=e}get data(){return this._data}}class Wp extends St{constructor(e,t){super(null,null),this._numberKey=e,this._numberValue=t}get numberKey(){return this._numberKey}get numberValue(){return this._numberValue}}class Qu extends St{constructor(e,t,s,i){super(null,null),this._type=e,this._color=t,this._light=s,this._backgroundOnly=i}get type(){return this._type}get color(){return this._color}get light(){return this._light}get backgroundOnly(){return this._backgroundOnly}}Qu.BACKGROUND_COLOR="RORCUM_BACKGROUND_COLOR";class _i extends St{constructor(e,t,s=0,i=0,n=0,a=0){super(null,null),this._type=e,this._id=t,this._x=s,this._y=i,this._width=n,this._height=a}get type(){return this._type}get id(){return this._id}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}}_i.ADD="ORPFHUM_ADD",_i.REMOVE="ORPFHUM_REMOVE";class Yo extends St{constructor(e){super(null,null),this._type=Yo.UPDATE_MAP,this._mapData=e}get type(){return this._type}get mapData(){return this._mapData}}Yo.UPDATE_MAP="RORMUM_UPDATE_MAP";class Ft extends St{constructor(e,t,s=null,i=null,n="window"){super(null,null),this._type=e,this._maskId=t,this._maskType=s,this._maskLocation=i?new y(i.x,i.y,i.z):null,this._maskCategory=n}get type(){return this._type}get maskId(){return this._maskId}get maskType(){return this._maskType}get maskLocation(){return this._maskLocation}get maskCategory(){return this._maskCategory}}Ft.ADD_MASK="RORMUM_ADD_MASK",Ft.REMOVE_MASK="RORMUM_ADD_MASK",Ft.DOOR="door",Ft.WINDOW="window",Ft.HOLE="hole";class di extends St{constructor(e,t){super(null,null),this._type=e,this._value=t}get type(){return this._type}get value(){return this._value}}di.WALL_THICKNESS="RORPPUM_WALL_THICKNESS",di.FLOOR_THICKNESS="RORPVUM_FLOOR_THICKNESS";class fi extends St{constructor(e,t){super(null,null),this._type=e,this._visible=t}get type(){return this._type}get visible(){return this._visible}}fi.WALL_VISIBILITY="RORPVUM_WALL_VISIBILITY",fi.FLOOR_VISIBILITY="RORPVUM_FLOOR_VISIBILITY";class wt extends St{constructor(e,t){super(null,null),this._type=e,this._value=t}get type(){return this._type}get value(){return this._value}}wt.ROOM_WALL_UPDATE="RORUM_ROOM_WALL_UPDATE",wt.ROOM_FLOOR_UPDATE="RORUM_ROOM_FLOOR_UPDATE",wt.ROOM_LANDSCAPE_UPDATE="RORUM_ROOM_LANDSCAPE_UPDATE";class Wo extends Rt{constructor(e){super(),this._selected=e}get selected(){return this._selected}}class ba extends St{constructor(e,t,s,i,n=!1){super(e,null),this._height=t,this._visible=s,this._sourceEventId=i,this._toggleVisibility=n}get height(){return this._height}get visible(){return this._visible}get sourceEventId(){return this._sourceEventId}get toggleVisibility(){return this._toggleVisibility}}class gi extends St{constructor(e){super(null,null),this._type=e}get type(){return this._type}}gi.ENABLED="ROVUM_ENABLED",gi.DISABLED="ROVUM_DISABLED";class Er extends mu{constructor(){super(),this._liftAmount=0,this._location=new y,this._locationDelta=new y,this._lastUpdateTime=0,this._changeTime=0,this._updateInterval=Er.DEFAULT_UPDATE_INTERVAL}onDispose(){this._liftAmount=0,super.onDispose()}update(e){super.update(e);const t=this.getLocationOffset(),s=this.object&&this.object.model;if(s&&(t?this._liftAmount!==t.z&&(this._liftAmount=t.z,s.setValue(T.FURNITURE_LIFT_AMOUNT,this._liftAmount)):this._liftAmount!==0&&(this._liftAmount=0,s.setValue(T.FURNITURE_LIFT_AMOUNT,this._liftAmount))),this._locationDelta.length>0||t){const i=Er.TEMP_VECTOR;let n=this.time-this._changeTime;n===this._updateInterval>>1&&n++,n>this._updateInterval&&(n=this._updateInterval),this._locationDelta.length>0?(i.assign(this._locationDelta),i.multiply(n/this._updateInterval),i.add(this._location)):i.assign(this._location),t&&i.add(t),this.object.setLocation(i),n===this._updateInterval&&(this._locationDelta.x=0,this._locationDelta.y=0,this._locationDelta.z=0)}this._lastUpdateTime=this.time}setObject(e){super.setObject(e),e&&this._location.assign(e.getLocation())}processUpdateMessage(e){if(e&&(super.processUpdateMessage(e),e.location&&this._location.assign(e.location),e instanceof qi))return this.processMoveMessage(e)}processMoveMessage(e){!e||!this.object||!e.location||(this._changeTime=this._lastUpdateTime,this._locationDelta.assign(e.targetLocation),this._locationDelta.subtract(this._location))}getLocationOffset(){return null}get lastUpdateTime(){return this._lastUpdateTime}set updateInterval(e){e<=0&&(e=1),this._updateInterval=e}}Er.DEFAULT_UPDATE_INTERVAL=500,Er.TEMP_VECTOR=new y;class dt extends Er{constructor(){super(),this._selected=!1,this._reportedLocation=null,this._effectChangeTimeStamp=0,this._newEffect=0,this._blinkingStartTimestamp=ve()+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=0,this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0,this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1,this._animationEndTimestamp=0,this._signEndTimestamp=0,this._gestureEndTimestamp=0,this._numberValueEndTimestamp=0}getEventTypes(){const e=[re.CLICK,re.DOUBLE_CLICK,hs.POSITION_CHANGED,re.MOUSE_ENTER,re.MOUSE_LEAVE,B.MOUSE_BUTTON,B.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),e)}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new hs(hs.OBJECT_REMOVED,this.object)),super.dispose(),this._reportedLocation=null}update(e){if(super.update(e),this._selected&&this.object&&this.eventDispatcher){const s=this.object.getLocation();(!this._reportedLocation||this._reportedLocation.x!==s.x||this._reportedLocation.y!==s.y||this._reportedLocation.z!==s.z)&&(this._reportedLocation||(this._reportedLocation=new y),this._reportedLocation.assign(s),this.eventDispatcher.dispatchEvent(new hs(hs.POSITION_CHANGED,this.object)))}const t=this.object&&this.object.model;t&&this.updateModel(this.time,t)}updateModel(e,t){this._talkingEndTimestamp>0&&(e>this._talkingEndTimestamp?(t.setValue(T.FIGURE_TALK,0),this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0):!this._talkingPauseEndTimestamp&&!this._talkingPauseStartTimestamp?(this._talkingPauseStartTimestamp=e+this.randomTalkingPauseStartTimestamp(),this._talkingPauseEndTimestamp=this._talkingPauseStartTimestamp+this.randomTalkingPauseEndTimestamp()):this._talkingPauseStartTimestamp>0&&e>this._talkingPauseStartTimestamp?(t.setValue(T.FIGURE_TALK,0),this._talkingPauseStartTimestamp=0):this._talkingPauseEndTimestamp>0&&e>this._talkingPauseEndTimestamp&&(t.setValue(T.FIGURE_TALK,1),this._talkingPauseEndTimestamp=0)),this._animationEndTimestamp>0&&e>this._animationEndTimestamp&&(t.setValue(T.FIGURE_EXPRESSION,0),this._animationEndTimestamp=0),this._gestureEndTimestamp>0&&e>this._gestureEndTimestamp&&(t.setValue(T.FIGURE_GESTURE,0),this._gestureEndTimestamp=0),this._signEndTimestamp>0&&e>this._signEndTimestamp&&(t.setValue(T.FIGURE_SIGN,-1),this._signEndTimestamp=0),this._carryObjectEndTimestamp>0&&e>this._carryObjectEndTimestamp&&(t.setValue(T.FIGURE_CARRY_OBJECT,0),t.setValue(T.FIGURE_USE_OBJECT,0),this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1),this._allowUseCarryObject&&e-this._carryObjectStartTimestamp>5e3&&((e-this._carryObjectStartTimestamp)%1e4<1e3?t.setValue(T.FIGURE_USE_OBJECT,1):t.setValue(T.FIGURE_USE_OBJECT,0)),this._blinkingStartTimestamp>-1&&e>this._blinkingStartTimestamp&&(t.setValue(T.FIGURE_BLINK,1),this._blinkingStartTimestamp=e+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=e+this.randomBlinkEndTimestamp()),this._blinkingEndTimestamp>0&&e>this._blinkingEndTimestamp&&(t.setValue(T.FIGURE_BLINK,0),this._blinkingEndTimestamp=0),this._effectChangeTimeStamp>0&&e>this._effectChangeTimeStamp&&(t.setValue(T.FIGURE_EFFECT,this._newEffect),this._effectChangeTimeStamp=0),this._numberValueEndTimestamp>0&&e>this._numberValueEndTimestamp&&(t.setValue(T.FIGURE_NUMBER_VALUE,0),this._numberValueEndTimestamp=0)}processUpdateMessage(e){if(!e||!this.object)return;super.processUpdateMessage(e);const t=this.object&&this.object.model;if(t){if(e instanceof W_){t.setValue(T.FIGURE_POSTURE,e.postureType),t.setValue(T.FIGURE_POSTURE_PARAMETER,e.parameter);return}if(e instanceof Y_){t.setValue(T.FIGURE_TALK,1),this._talkingEndTimestamp=this.time+e.numberOfWords*1e3;return}if(e instanceof Vp){t.setValue(T.FIGURE_IS_TYPING,e.isTyping?1:0);return}if(e instanceof wp){t.setValue(T.FIGURE_IS_MUTED,e.isMuted?1:0);return}if(e instanceof Hp){t.setValue(T.FIGURE_IS_PLAYING_GAME,e.isPlayingGame?1:0);return}if(e instanceof qu){t.setValue(T.HEAD_DIRECTION,e.headDirection),t.setValue(T.FIGURE_CAN_STAND_UP,e.canStandUp),t.setValue(T.FIGURE_VERTICAL_OFFSET,e.baseY);return}if(e instanceof Fp){t.setValue(T.FIGURE_GESTURE,e.gesture),this._gestureEndTimestamp=this.time+3e3;return}if(e instanceof Lp){t.setValue(T.FIGURE_EXPRESSION,e.expressionType),this._animationEndTimestamp=F.getExpressionTimeout(t.getValue(T.FIGURE_EXPRESSION)),this._animationEndTimestamp>-1&&(this._animationEndTimestamp+=this.time);return}if(e instanceof Np){t.setValue(T.FIGURE_DANCE,e.danceStyle);return}if(e instanceof z_){t.setValue(T.FIGURE_SLEEP,e.isSleeping?1:0),e.isSleeping?this._blinkingStartTimestamp=-1:this._blinkingStartTimestamp=this.time+this.randomBlinkStartTimestamp();return}if(e instanceof Bp){t.setValue(T.FIGURE_NUMBER_VALUE,e.value),this._numberValueEndTimestamp=this.time+3e3;return}if(e instanceof bp){this.updateAvatarEffect(e.effect,e.delayMilliseconds,t);return}if(e instanceof Pp){t.setValue(T.FIGURE_CARRY_OBJECT,e.itemType),t.setValue(T.FIGURE_USE_OBJECT,0),e.itemType===0?(this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1):(this._carryObjectStartTimestamp=this.time,e.itemType<dt.MAX_HAND_ID?(this._carryObjectEndTimestamp=0,this._allowUseCarryObject=e.itemType<=dt.MAX_HAND_USE_ID):(this._carryObjectEndTimestamp=this._carryObjectStartTimestamp+1500,this._allowUseCarryObject=!1));return}if(e instanceof jp){t.setValue(T.FIGURE_USE_OBJECT,e.itemType);return}if(e instanceof kp){t.setValue(T.FIGURE_SIGN,e.signType),this._signEndTimestamp=this.time+5e3;return}if(e instanceof Up){t.setValue(T.FIGURE_FLAT_CONTROL,e.level);return}if(e instanceof Xu){t.setValue(T.FIGURE,e.figure),t.setValue(T.GENDER,e.gender);return}if(e instanceof Ku){this._selected=e.selected,this._reportedLocation=null;return}if(e instanceof xp){t.setValue(T.OWN_USER,1);return}}}updateAvatarEffect(e,t,s){if(e===dt.EFFECT_TYPE_SPLASH)this._effectChangeTimeStamp=ve()+dt.EFFECT_SPLASH_LENGTH,this._newEffect=dt.EFFECT_TYPE_SWIM;else if(e===dt.EFFECT_TYPE_SPLASH_DARK)this._effectChangeTimeStamp=ve()+dt.EFFECT_SPLASH_LENGTH,this._newEffect=dt.EFFECT_TYPE_SWIM_DARK;else if(s.getValue(T.FIGURE_EFFECT)===dt.EFFECT_TYPE_SWIM)this._effectChangeTimeStamp=ve()+dt.EFFECT_SPLASH_LENGTH,this._newEffect=e,e=dt.EFFECT_TYPE_SPLASH;else if(s.getValue(T.FIGURE_EFFECT)===dt.EFFECT_TYPE_SWIM_DARK)this._effectChangeTimeStamp=ve()+dt.EFFECT_SPLASH_LENGTH,this._newEffect=e,e=dt.EFFECT_TYPE_SPLASH_DARK;else if(t===0)this._effectChangeTimeStamp=0;else{this._effectChangeTimeStamp=ve()+t,this._newEffect=e;return}s.setValue(T.FIGURE_EFFECT,e)}mouseEvent(e,t){let s=null;switch(e.type){case W.MOUSE_CLICK:s=re.CLICK;break;case W.DOUBLE_CLICK:s=re.DOUBLE_CLICK;break;case W.ROLL_OVER:s=re.MOUSE_ENTER,this.object.model&&this.object.model.setValue(T.FIGURE_HIGHLIGHT,1),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new B(B.MOUSE_BUTTON,this.object));break;case W.ROLL_OUT:s=re.MOUSE_LEAVE,this.object.model&&this.object.model.setValue(T.FIGURE_HIGHLIGHT,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new B(B.MOUSE_ARROW,this.object));break}s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new re(s,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown))}randomTalkingPauseStartTimestamp(){return 100+Math.random()*200}randomTalkingPauseEndTimestamp(){return 75+Math.random()*75}randomBlinkStartTimestamp(){return 4500+Math.random()*1e3}randomBlinkEndTimestamp(){return 50+Math.random()*200}}dt.MAX_HAND_ID=999999999,dt.MAX_HAND_USE_ID=999,dt.EFFECT_TYPE_SPLASH=28,dt.EFFECT_SPLASH_LENGTH=500,dt.EFFECT_TYPE_SWIM=29,dt.EFFECT_TYPE_SPLASH_DARK=184,dt.EFFECT_TYPE_SWIM_DARK=185;class Ee extends Er{constructor(){super(),this._sizeX=0,this._sizeY=0,this._sizeZ=0,this._centerX=0,this._centerY=0,this._centerZ=0,this._directions=[],this._mouseOver=!1,this._locationOffset=new y,this._bouncingStep=0,this._storedRotateMessage=null,this._directionInitialized=!1,Ee.BOUNCING_STEPS===-1&&(Ee.BOUNCING_STEPS=ue.getValue("furni.rotation.bounce.steps",8)),Ee.BOUNCING_Z===-1&&(Ee.BOUNCING_Z=ue.getValue("furni.rotation.bounce.height",.0625))}getEventTypes(){const e=[Me.STATE_CHANGE,re.CLICK,re.MOUSE_DOWN,re.MOUSE_DOWN_LONG,We.ROOM_AD_TOOLTIP_SHOW,We.ROOM_AD_TOOLTIP_HIDE,We.ROOM_AD_FURNI_DOUBLE_CLICK,We.ROOM_AD_FURNI_CLICK];return this.widget&&e.push(P.OPEN_WIDGET,P.CLOSE_WIDGET),this.contextMenu&&e.push(P.OPEN_FURNI_CONTEXT_MENU,P.CLOSE_FURNI_CONTEXT_MENU),this.mergeTypes(super.getEventTypes(),e)}initialize(e){if(!e)return;const t=this.object&&this.object.model;if(t){if(e.logic){if(e.logic.model){const s=e.logic.model.dimensions;s&&(this._sizeX=s.x,this._sizeY=s.y,this._sizeZ=s.z,this._centerX=this._sizeX/2,this._centerY=this._sizeY/2,this._centerZ=this._sizeZ/2);const i=e.logic.model.directions;if(i&&i.length){for(const n of i)this._directions.push(n);this._directions.sort((n,a)=>n-a)}}if(e.logic.customVars){const s=e.logic.customVars.variables;s&&s.length&&t.setValue(T.FURNITURE_CUSTOM_VARIABLES,s)}}t.setValue(T.FURNITURE_SIZE_X,this._sizeX),t.setValue(T.FURNITURE_SIZE_Y,this._sizeY),t.setValue(T.FURNITURE_SIZE_Z,this._sizeZ),t.setValue(T.FURNITURE_CENTER_X,this._centerX),t.setValue(T.FURNITURE_CENTER_Y,this._centerY),t.setValue(T.FURNITURE_CENTER_Z,this._centerZ),t.setValue(T.FURNITURE_ALLOWED_DIRECTIONS,this._directions),t.setValue(T.FURNITURE_ALPHA_MULTIPLIER,1)}}onDispose(){this._storedRotateMessage=null,this._directions=null,super.onDispose()}setObject(e){super.setObject(e),e&&e.getLocation().length&&(this._directionInitialized=!0)}getAdClickUrl(e){return e.getValue(T.FURNITURE_AD_URL)}handleAdClick(e,t,s){this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new We(We.ROOM_AD_FURNI_CLICK,this.object))}update(e){super.update(e),this._bouncingStep>0&&(this._bouncingStep++,this._bouncingStep>Ee.BOUNCING_STEPS&&(this._bouncingStep=0))}processUpdateMessage(e){if(e instanceof Ve){this.processDataUpdateMessage(e);return}if(e instanceof Yp){this.processObjectHeightUpdateMessage(e);return}if(e instanceof X_){this.processItemDataUpdateMessage(e);return}if(this._mouseOver=!1,e.location&&e.direction){if(!(e instanceof qi)){const t=this.object.getDirection(),s=this.object.getLocation();t.x!==e.direction.x&&this._directionInitialized&&s.x===e.location.x&&s.y===e.location.y&&s.z===e.location.z&&(this._bouncingStep=1,this._storedRotateMessage=new St(e.location,e.direction),e=null)}this._directionInitialized=!0}if(e instanceof Wo&&this.contextMenu&&this.eventDispatcher&&this.object){const t=e.selected?P.OPEN_FURNI_CONTEXT_MENU:P.CLOSE_FURNI_CONTEXT_MENU;this.eventDispatcher.dispatchEvent(new P(t,this.object))}super.processUpdateMessage(e)}processDataUpdateMessage(e){e&&(this.object.setState(e.state,0),e.data&&e.data.writeRoomObjectModel(this.object.model),e.extra!==null&&this.object.model.setValue(T.FURNITURE_EXTRAS,e.extra.toString()),this.object.model.setValue(T.FURNITURE_STATE_UPDATE_TIME,this.lastUpdateTime))}processObjectHeightUpdateMessage(e){e&&this.object.model.setValue(T.FURNITURE_SIZE_Z,e.height)}processItemDataUpdateMessage(e){e&&this.object.model.setValue(T.FURNITURE_ITEMDATA,e.data)}mouseEvent(e,t){const s=this.getAdClickUrl(this.object.model);switch(e.type){case W.MOUSE_MOVE:if(this.eventDispatcher){const i=new re(re.MOUSE_MOVE,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);i.localX=e.localX,i.localY=e.localY,i.spriteOffsetX=e.spriteOffsetX,i.spriteOffsetY=e.spriteOffsetY,this.eventDispatcher.dispatchEvent(i)}return;case W.ROLL_OVER:if(!this._mouseOver){if(this.eventDispatcher){s&&s.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new We(We.ROOM_AD_TOOLTIP_SHOW,this.object));const i=new re(re.MOUSE_ENTER,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);i.localX=e.localX,i.localY=e.localY,i.spriteOffsetX=e.spriteOffsetX,i.spriteOffsetY=e.spriteOffsetY,this.eventDispatcher.dispatchEvent(i)}this._mouseOver=!0}return;case W.ROLL_OUT:if(this._mouseOver){if(this.eventDispatcher){s&&s.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new We(We.ROOM_AD_TOOLTIP_HIDE,this.object));const i=new re(re.MOUSE_LEAVE,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);i.localX=e.localX,i.localY=e.localY,i.spriteOffsetX=e.spriteOffsetX,i.spriteOffsetY=e.spriteOffsetY,this.eventDispatcher.dispatchEvent(i)}this._mouseOver=!1}return;case W.DOUBLE_CLICK:this.useObject();return;case W.MOUSE_CLICK:if(this.eventDispatcher){const i=new re(re.CLICK,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);i.localX=e.localX,i.localY=e.localY,i.spriteOffsetX=e.spriteOffsetX,i.spriteOffsetY=e.spriteOffsetY,this.eventDispatcher.dispatchEvent(i),s&&s.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new We(We.ROOM_AD_TOOLTIP_HIDE,this.object)),s&&s.length&&this.handleAdClick(this.object.id,this.object.type,s)}return;case W.MOUSE_DOWN:if(this.eventDispatcher){const i=new re(re.MOUSE_DOWN,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);this.eventDispatcher.dispatchEvent(i)}return;case W.MOUSE_DOWN_LONG:if(this.eventDispatcher){const i=new re(re.MOUSE_DOWN_LONG,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);this.eventDispatcher.dispatchEvent(i)}return}}getLocationOffset(){return this._bouncingStep<=0?null:(this._locationOffset.x=0,this._locationOffset.y=0,this._bouncingStep<=Ee.BOUNCING_STEPS/2?this._locationOffset.z=Ee.BOUNCING_Z*this._bouncingStep:this._bouncingStep<=Ee.BOUNCING_STEPS&&(this._storedRotateMessage&&(super.processUpdateMessage(this._storedRotateMessage),this._storedRotateMessage=null),this._locationOffset.z=Ee.BOUNCING_Z*(Ee.BOUNCING_STEPS-this._bouncingStep)),this._locationOffset)}useObject(){if(!this.object||!this.eventDispatcher)return;const e=this.getAdClickUrl(this.object.model);e&&e.length&&this.eventDispatcher.dispatchEvent(new We(We.ROOM_AD_FURNI_DOUBLE_CLICK,this.object,null,e)),this.widget&&this.eventDispatcher.dispatchEvent(new P(P.OPEN_WIDGET,this.object)),this.eventDispatcher.dispatchEvent(new Me(Me.STATE_CHANGE,this.object))}tearDown(){this.object.model.getValue(T.FURNITURE_REAL_ROOM_OBJECT)===1&&(this.widget&&this.eventDispatcher.dispatchEvent(new P(P.CLOSE_WIDGET,this.object)),this.contextMenu&&this.eventDispatcher.dispatchEvent(new P(P.CLOSE_FURNI_CONTEXT_MENU,this.object))),super.tearDown()}}Ee.BOUNCING_STEPS=-1,Ee.BOUNCING_Z=-1;class zp extends Ee{getEventTypes(){const e=[P.BADGE_DISPLAY_ENGRAVING,br.LOAD_BADGE];return this.mergeTypes(super.getEventTypes(),e)}processUpdateMessage(e){if(super.processUpdateMessage(e),!!this.object){if(e instanceof Ve){const t=e.data;t instanceof Mr&&this.updateBadge(t.getValue(1));return}if(e instanceof Na){e.assetName!=="loading_icon"&&(this.object.model.setValue(T.FURNITURE_BADGE_ASSET_NAME,e.assetName),this.object.model.setValue(T.FURNITURE_BADGE_IMAGE_STATUS,1),this.update(ve()));return}}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new P(P.BADGE_DISPLAY_ENGRAVING,this.object))}updateBadge(e){e!==""&&this.eventDispatcher&&(this.object.model.setValue(T.FURNITURE_BADGE_IMAGE_STATUS,-1),this.eventDispatcher.dispatchEvent(new br(br.LOAD_BADGE,this.object,e,!1)))}}class Ps extends zp{getEventTypes(){const e=[P.ACHIEVEMENT_RESOLUTION_OPEN,P.ACHIEVEMENT_RESOLUTION_ENGRAVING,P.ACHIEVEMENT_RESOLUTION_FAILED,br.LOAD_BADGE];return this.mergeTypes(super.getEventTypes(),e)}processUpdateMessage(e){if(super.processUpdateMessage(e),e instanceof Na&&e.assetName!=="loading_icon"&&this.object.model.setValue(T.FURNITURE_BADGE_VISIBLE_IN_STATE,Ps.BADGE_VISIBLE_IN_STATE),e instanceof Wo){if(!this.eventDispatcher||!this.object)return;this.eventDispatcher.dispatchEvent(new P(P.CLOSE_FURNI_CONTEXT_MENU,this.object))}}useObject(){if(!this.object||!this.eventDispatcher)return;let e=null;switch(this.object.getState(0)){case Ps.STATE_RESOLUTION_NOT_STARTED:case Ps.STATE_RESOLUTION_IN_PROGRESS:e=new P(P.ACHIEVEMENT_RESOLUTION_OPEN,this.object);break;case Ps.STATE_RESOLUTION_ACHIEVED:e=new P(P.ACHIEVEMENT_RESOLUTION_ENGRAVING,this.object);break;case Ps.STATE_RESOLUTION_FAILED:e=new P(P.ACHIEVEMENT_RESOLUTION_FAILED,this.object);break}e&&this.eventDispatcher.dispatchEvent(e)}updateBadge(e){e!==Ps.ACH_NOT_SET&&super.updateBadge(e)}}Ps.STATE_RESOLUTION_NOT_STARTED=0,Ps.STATE_RESOLUTION_IN_PROGRESS=1,Ps.STATE_RESOLUTION_ACHIEVED=2,Ps.STATE_RESOLUTION_FAILED=3,Ps.ACH_NOT_SET="ach_0",Ps.BADGE_VISIBLE_IN_STATE=2;class Sj extends Ee{constructor(){super(),this.onRoomToObjectOwnAvatarMoveEvent=this.onRoomToObjectOwnAvatarMoveEvent.bind(this)}initialize(e){super.initialize(e),this.eventDispatcher&&this.eventDispatcher.addEventListener(vo.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent)}tearDown(){this.eventDispatcher&&this.eventDispatcher.removeEventListener(vo.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent),super.tearDown()}onRoomToObjectOwnAvatarMoveEvent(e){if(!e||!this.object)return;const t=this.object.getLocation(),s=e.targetLocation;if(!s)return;let i=this.object.model.getValue(T.FURNITURE_SIZE_X),n=this.object.model.getValue(T.FURNITURE_SIZE_Y);const a=(Math.floor(this.object.getDirection().x)+45)%360/90;(a===1||a===3)&&([i,n]=[n,i]),s.x>=t.x&&s.x<t.x+i&&s.y>=t.y&&s.y<t.y+n?this.object.setState(1,0):this.object.setState(0,0)}}class Aj extends Ee{getEventTypes(){const e=[P.CLOTHING_CHANGE];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e);const t=this.object.model.getValue(T.FURNITURE_DATA);this.updateClothingData(t)}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof Ve&&e.data&&this.updateClothingData(e.data.getLegacyString())}updateClothingData(e){if(!e||!e.length)return;const[t,s]=e.split(",");t&&t.length&&this.object.model.setValue(T.FURNITURE_CLOTHING_BOY,t),s&&s.length&&this.object.model.setValue(T.FURNITURE_CLOTHING_GIRL,s)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new P(P.CLOTHING_CHANGE,this.object))}}class yj extends Ee{getEventTypes(){const e=[Me.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),e)}mouseEvent(e,t){if(!e||!t||!this.object)return;let s=null;switch(e.type){case W.DOUBLE_CLICK:switch(e.spriteTag){case"start_stop":s=new Me(Me.STATE_CHANGE,this.object,1);break;case"reset":s=new Me(Me.STATE_CHANGE,this.object,2);break}if(this.eventDispatcher&&s){this.eventDispatcher.dispatchEvent(s);return}break}super.mouseEvent(e,t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Me(Me.STATE_CHANGE,this.object,1))}}class Cj extends Ee{processUpdateMessage(e){super.processUpdateMessage(e),this.object&&this.object.model.getValue(T.FURNITURE_REAL_ROOM_OBJECT)===1&&this.object.model.setValue(Ut.INFOSTAND_EXTRA_PARAM,Ut.CRACKABLE_FURNI)}}class Mj extends Ee{get widget(){return ie.CRAFTING}}class Pj extends Ee{getEventTypes(){const e=[P.CREDITFURNI];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e);let t=0;e.logic&&e.logic.credits&&e.logic.credits!==""&&e.logic.credits.length>0&&(t=parseInt(e.logic.credits)),this.object.model.setValue(T.FURNITURE_CREDIT_VALUE,t)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new P(P.CREDITFURNI,this.object)),super.useObject())}}class ft extends Ee{getEventTypes(){const e=[B.MOUSE_BUTTON,B.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),e)}mouseEvent(e,t){if(!(!e||!t||!this.object)){switch(e.type){case W.ROLL_OVER:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new B(B.MOUSE_BUTTON,this.object));break;case W.ROLL_OUT:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new B(B.MOUSE_ARROW,this.object));break}super.mouseEvent(e,t)}}}class Nj extends ft{constructor(){super(...arguments),this._state=1}getEventTypes(){const e=[ri.PLAY_SOUND_AT_PITCH];return this.mergeTypes(super.getEventTypes(),e)}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof Ve&&(this._state!==-1&&e.state!==this._state&&this.dispatchSoundEvent(this.object.location.z),this._state=e.state)}dispatchSoundEvent(e){const t=Math.pow(2,e-1.2);this.eventDispatcher.dispatchEvent(new ri(ri.PLAY_SOUND_AT_PITCH,this.object,"FURNITURE_cuckoo_clock",t))}}class bj extends ft{getEventTypes(){const e=[P.STACK_HEIGHT];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),this.object&&this.object.model&&this.object.model.setValue(T.FURNITURE_ALWAYS_STACKABLE,1)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new P(P.STACK_HEIGHT,this.object)),super.useObject())}}class Dj extends Ee{constructor(){super(),this._noTags=!1,this._noTagsLastStateActivate=!1}getEventTypes(){const e=[B.DICE_ACTIVATE,B.DICE_OFF];return this.mergeTypes(super.getEventTypes(),e)}mouseEvent(e,t){if(!e||!t||!this.object)return;let s=null;switch(e.type){case W.DOUBLE_CLICK:this._noTags?!this._noTagsLastStateActivate||this.object.getState(0)===0||this.object.getState(0)===100?(s=new B(B.DICE_ACTIVATE,this.object),this._noTagsLastStateActivate=!0):(s=new B(B.DICE_OFF,this.object),this._noTagsLastStateActivate=!1):e.spriteTag==="activate"||this.object.getState(0)===0||this.object.getState(0)===100?s=new B(B.DICE_ACTIVATE,this.object):e.spriteTag==="deactivate"&&(s=new B(B.DICE_OFF,this.object)),s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(s);return}super.mouseEvent(e,t)}}class Lj extends Ee{getEventTypes(){const e=[P.ECOTRONBOX];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new P(P.ECOTRONBOX,this.object))}}class Uj extends Ee{constructor(){super(),this._showStateOnceRendered=!1,this._updateCount=0}getEventTypes(){const e=[P.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),e.logic&&e.logic.action&&e.logic.action.startState===1&&(this._showStateOnceRendered=!0)}update(e){super.update(e),this._showStateOnceRendered&&(this._updateCount++,this._showStateOnceRendered&&this._updateCount>20&&(this.setAutomaticStateIndex(1),this._showStateOnceRendered=!1))}setAutomaticStateIndex(e){this.object&&this.object.model&&this.object.model.setValue(T.FURNITURE_AUTOMATIC_STATE_INDEX,e)}mouseEvent(e,t){!e||!t||(e.type===W.DOUBLE_CLICK&&this.setAutomaticStateIndex(0),super.mouseEvent(e,t))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new P(P.INERNAL_LINK,this.object))}}class Fj extends Ee{getEventTypes(){const e=[P.ROOM_LINK];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),e.logic&&e.logic.action&&e.logic.action.link&&e.logic.action.link!==""&&e.logic.action.link.length>0&&this.object&&this.object.model&&this.object.model.setValue(T.FURNITURE_INTERNAL_LINK,e.logic.action.link)}onDispose(){this._timer&&(clearTimeout(this._timer),this._timer=null),super.onDispose()}setAutomaticStateIndex(e){this.object&&this.object.model&&this.object.model.setValue(T.FURNITURE_AUTOMATIC_STATE_INDEX,e)}useObject(){this.setAutomaticStateIndex(1),this._timer&&(clearTimeout(this._timer),this._timer=null),this._timer=setTimeout(()=>{this.setAutomaticStateIndex(0),this._timer=null},2500),!(!this.object||!this.eventDispatcher)&&this.eventDispatcher.dispatchEvent(new P(P.ROOM_LINK,this.object))}}class wj extends Ee{getEventTypes(){const e=[P.EFFECTBOX_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new P(P.EFFECTBOX_OPEN_DIALOG,this.object))}get contextMenu(){return Kt.EFFECT_BOX}}class xj extends ft{getEventTypes(){const e=[P.EXTERNAL_IMAGE];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){if(super.initialize(e),!!e&&this.object&&this.object.model){let t="";e.logic&&e.logic.maskType&&e.logic.maskType!==""&&e.logic.maskType.length>0&&(t=e.logic.maskType),this.object.model.setValue(T.FURNITURE_USES_PLANE_MASK,0),this.object.model.setValue(T.FURNITURE_PLANE_MASK_TYPE,t)}}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new P(P.EXTERNAL_IMAGE,this.object)),super.useObject())}}class Gj extends Ee{getEventTypes(){const e=[Me.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),e.logic&&e.logic.particleSystems&&e.logic.particleSystems.length&&this.object.model.setValue(T.FURNITURE_FIREWORKS_DATA,e.logic.particleSystems)}mouseEvent(e,t){if(!e||!t||!this.object)return;let s=null;switch(e.type){case W.DOUBLE_CLICK:switch(e.spriteTag){case"start_stop":s=new Me(Me.STATE_CHANGE,this.object,1);break;case"reset":s=new Me(Me.STATE_CHANGE,this.object,2);break}if(this.eventDispatcher&&s){this.eventDispatcher.dispatchEvent(s);return}break}super.mouseEvent(e,t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Me(Me.STATE_CHANGE,this.object,0))}}class Ln extends ft{constructor(){super(),this._currentState=-1,this._currentLocation=null}getEventTypes(){const e=[os.ADD_HOLE,os.REMOVE_HOLE];return this.mergeTypes(super.getEventTypes(),e)}onDispose(){this._currentState===Ln.STATE_HOLE&&this.eventDispatcher.dispatchEvent(new os(os.REMOVE_HOLE,this.object)),super.onDispose()}update(e){super.update(e),this.handleAutomaticStateUpdate()}processUpdateMessage(e){if(super.processUpdateMessage(e),!this.object)return;e instanceof Ve&&this.handleStateUpdate(this.object.getState(0));const t=this.object.getLocation();this._currentLocation?(t.x!==this._currentLocation.x||t.y!==this._currentLocation.y)&&this._currentState===Ln.STATE_HOLE&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new os(os.ADD_HOLE,this.object)):this._currentLocation=new y,this._currentLocation.assign(t)}handleStateUpdate(e){e!==this._currentState&&(this.eventDispatcher&&(e===Ln.STATE_HOLE?this.eventDispatcher.dispatchEvent(new os(os.ADD_HOLE,this.object)):this._currentState===Ln.STATE_HOLE&&this.eventDispatcher.dispatchEvent(new os(os.REMOVE_HOLE,this.object))),this._currentState=e)}handleAutomaticStateUpdate(){if(!this.object)return;const e=this.object.model;if(!e)return;const t=e.getValue(T.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(t)||this.handleStateUpdate(t%2)}}Ln.STATE_HOLE=0;class Qi extends ft{constructor(){super(...arguments),this._state=-1}initialize(e){super.initialize(e),this.object&&this.object.model.setValue(T.FURNITURE_FRIENDFURNI_ENGRAVING,this.engravingDialogType)}processUpdateMessage(e){if(e instanceof Ve){const t=e.data;t?this._state=t.state:this._state=e.state}super.processUpdateMessage(e)}getEventTypes(){const e=[P.FRIEND_FURNITURE_ENGRAVING];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||(this._state===Qi.STATE_LOCKED?this.eventDispatcher.dispatchEvent(new P(P.FRIEND_FURNITURE_ENGRAVING,this.object)):super.useObject())}get engravingDialogType(){return 0}get contextMenu(){return this._state===Qi.STATE_UNLOCKED?Kt.FRIEND_FURNITURE:Kt.DUMMY}}Qi.STATE_UNINITIALIZED=-1,Qi.STATE_UNLOCKED=0,Qi.STATE_LOCKED=1;class mr extends ft{getEventTypes(){const e=[br.LOAD_BADGE,P.GUILD_FURNI_CONTEXT_MENU,P.CLOSE_FURNI_CONTEXT_MENU];return this.mergeTypes(super.getEventTypes(),e)}processUpdateMessage(e){if(super.processUpdateMessage(e),e instanceof Ve){const t=e.data;t instanceof Mr&&(this.updateGroupId(t.getValue(mr.GROUPID_KEY)),this.updateBadge(t.getValue(mr.BADGE_KEY)),this.updateColors(t.getValue(mr.COLOR1_KEY),t.getValue(mr.COLOR2_KEY)))}else e instanceof Na?e.assetName!=="loading_icon"&&(this.object.model.setValue(T.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME,e.assetName),this.update(ve())):e instanceof Wo&&(e.selected||this.eventDispatcher.dispatchEvent(new P(P.CLOSE_FURNI_CONTEXT_MENU,this.object)))}updateGroupId(e){this.object.model.setValue(T.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID,parseInt(e))}updateBadge(e){this.eventDispatcher.dispatchEvent(new br(br.LOAD_BADGE,this.object,e,!0))}updateColors(e,t){this.object.model.setValue(T.FURNITURE_GUILD_CUSTOMIZED_COLOR_1,parseInt(e,16)),this.object.model.setValue(T.FURNITURE_GUILD_CUSTOMIZED_COLOR_2,parseInt(t,16))}mouseEvent(e,t){if(!(!e||!t||!this.object)){switch(e.type){case W.MOUSE_CLICK:this.openContextMenu()}super.mouseEvent(e,t)}}openContextMenu(){this.eventDispatcher.dispatchEvent(new P(P.GUILD_FURNI_CONTEXT_MENU,this.object))}}mr.GROUPID_KEY=1,mr.BADGE_KEY=2,mr.COLOR1_KEY=3,mr.COLOR2_KEY=4;class Bj extends mr{getEventTypes(){const e=[P.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),e)}updateGroupId(e){super.updateGroupId(e),this.object.model.setValue(T.FURNITURE_INTERNAL_LINK,`groupforum/${e}`)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new P(P.INERNAL_LINK,this.object)),super.useObject())}}class Hj extends Ee{getEventTypes(){const e=[B.USE_HABBOWHEEL];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new B(B.USE_HABBOWHEEL,this.object))}}class Zu extends Ee{constructor(){super(...arguments),this._state=-1}getEventTypes(){return[P.HIGH_SCORE_DISPLAY,P.HIDE_HIGH_SCORE_DISPLAY]}tearDown(){this.object.model.getValue(T.FURNITURE_REAL_ROOM_OBJECT)===1&&this.eventDispatcher.dispatchEvent(new P(P.HIDE_HIGH_SCORE_DISPLAY,this.object)),super.tearDown()}processUpdateMessage(e){super.processUpdateMessage(e),this.object.model.getValue(T.FURNITURE_REAL_ROOM_OBJECT)===1&&e instanceof Ve&&(e.state===Zu.SHOW_WIDGET_IN_STATE?this.eventDispatcher.dispatchEvent(new P(P.HIGH_SCORE_DISPLAY,this.object)):this.eventDispatcher.dispatchEvent(new P(P.HIDE_HIGH_SCORE_DISPLAY,this.object)),this._state=e.state)}}Zu.SHOW_WIDGET_IN_STATE=1;class kj extends Ee{getEventTypes(){const e=[Me.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),e)}mouseEvent(e,t){if(!e||!t||!this.object)return;let s=null;switch(e.type){case W.DOUBLE_CLICK:switch(e.spriteTag){case"off":s=new Me(Me.STATE_CHANGE,this.object,3);break}break;case W.MOUSE_CLICK:switch(e.spriteTag){case"inc":s=new Me(Me.STATE_CHANGE,this.object,2);break;case"dec":s=new Me(Me.STATE_CHANGE,this.object,1);break}break}if(this.eventDispatcher&&s){this.eventDispatcher.dispatchEvent(s);return}super.mouseEvent(e,t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Me(Me.STATE_CHANGE,this.object,3))}}class Vj extends Qi{get engravingDialogType(){return An.HABBOWEEN}}class jj extends ft{constructor(){super(),this._nextState=0,this._nextStateTimestamp=0}update(e){if(this._nextStateTimestamp>0&&e>=this._nextStateTimestamp){this._nextStateTimestamp=0;const t=new ns;t.setString(this._nextState.toString()),super.processUpdateMessage(new Ve(this._nextState,t,this._nextStateExtra))}super.update(e)}processUpdateMessage(e){if(e instanceof Ve){this.processUpdate(e);return}super.processUpdateMessage(e)}processUpdate(e){if(!e)return;const t=~~(e.state/1e3),s=~~(e.state%1e3);if(s)this._nextState=t,this._nextStateExtra=e.extra,this._nextStateTimestamp=this.time+s;else{this._nextStateTimestamp=0;const i=new ns;i.setString(t.toString()),super.processUpdateMessage(new Ve(t,i,e.extra))}}}class Yj extends Ee{constructor(){super(...arguments),this._showStateOnceRendered=!1,this._updateCount=0}getEventTypes(){const e=[P.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),e.logic&&e.logic.action&&(this.object.model.setValue(T.FURNITURE_INTERNAL_LINK,e.logic.action.link),e.logic.action.startState===1&&(this._showStateOnceRendered=!0))}update(e){super.update(e),this._showStateOnceRendered&&(this._updateCount++,this._showStateOnceRendered&&this._updateCount===20&&(this.setAutomaticStateIndex(1),this._showStateOnceRendered=!1))}setAutomaticStateIndex(e){this.object&&this.object.model&&this.object.model.setValue(T.FURNITURE_AUTOMATIC_STATE_INDEX,e)}mouseEvent(e,t){!e||!t||(e.type===W.DOUBLE_CLICK&&this._showStateOnceRendered&&this.setAutomaticStateIndex(0),super.mouseEvent(e,t))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new P(P.INERNAL_LINK,this.object))}}class Wj extends ft{constructor(){super(...arguments),this._disposeEventsAllowed=!1,this._isInitialized=!1,this._currentState=-1}getEventTypes(){const e=[B.JUKEBOX_START,B.JUKEBOX_MACHINE_STOP,B.JUKEBOX_DISPOSE,B.JUKEBOX_INIT,P.JUKEBOX_PLAYLIST_EDITOR];return this.mergeTypes(super.getEventTypes(),e)}onDispose(){this.requestDispose(),super.onDispose()}processUpdateMessage(e){if(super.processUpdateMessage(e),this.object.model.getValue(T.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._isInitialized||this.requestInit(),this.object.model.setValue(Ut.INFOSTAND_EXTRA_PARAM,Ut.JUKEBOX),e instanceof Ve)){const t=this.object.getState(0);t!==this._currentState&&(this._currentState=t,t===1?this.requestPlayList():t===0&&this.requestStopPlaying())}}requestInit(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new B(B.JUKEBOX_INIT,this.object)),this._isInitialized=!0)}requestPlayList(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new B(B.JUKEBOX_START,this.object)))}requestStopPlaying(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new B(B.JUKEBOX_MACHINE_STOP,this.object))}requestDispose(){!this._disposeEventsAllowed||!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new B(B.JUKEBOX_DISPOSE,this.object))}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new P(P.JUKEBOX_PLAYLIST_EDITOR,this.object)),this.eventDispatcher.dispatchEvent(new Me(Me.STATE_CHANGE,this.object,-1)))}}class zj extends Qi{get engravingDialogType(){return An.LOVE_LOCK}}class Zi extends Ee{getEventTypes(){const e=[P.MANNEQUIN];return this.mergeTypes(super.getEventTypes(),e)}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof Ve&&(e.data.writeRoomObjectModel(this.object.model),this.processObjectData())}processObjectData(){if(!this.object||!this.object.model)return;const e=new Xs;e.initializeFromRoomObjectModel(this.object.model),this.object.model.setValue(T.FURNITURE_MANNEQUIN_GENDER,e.getValue(Zi.GENDER)),this.object.model.setValue(T.FURNITURE_MANNEQUIN_FIGURE,e.getValue(Zi.FIGURE)),this.object.model.setValue(T.FURNITURE_MANNEQUIN_NAME,e.getValue(Zi.OUTFIT_NAME))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new P(P.MANNEQUIN,this.object))}}Zi.GENDER="GENDER",Zi.FIGURE="FIGURE",Zi.OUTFIT_NAME="OUTFIT_NAME";class Xj extends ft{getEventTypes(){const e=[P.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new P(P.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,this.object))}get contextMenu(){return Kt.MONSTERPLANT_SEED}}class Kj extends ft{initialize(e){super.initialize(e),this.object&&this.object.model&&this.object.model.setValue(T.FURNITURE_IS_VARIABLE_HEIGHT,1)}}class qj extends ft{getEventTypes(){const e=[P.MYSTERYBOX_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new P(P.MYSTERYBOX_OPEN_DIALOG,this.object))}get contextMenu(){return Kt.MYSTERY_BOX}}class Qj extends ft{getEventTypes(){const e=[P.MYSTERYTROPHY_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new P(P.MYSTERYTROPHY_OPEN_DIALOG,this.object))}get contextMenu(){return Kt.MYSTERY_TROPHY}}class Zj extends Ee{getEventTypes(){const e=[B.ENTER_ONEWAYDOOR];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new B(B.ENTER_ONEWAYDOOR,this.object))}}class Jj extends Ee{getEventTypes(){const e=[P.PET_PRODUCT_MENU];return this.mergeTypes(super.getEventTypes(),e)}processUpdateMessage(e){super.processUpdateMessage(e),this.object&&this.object.model.getValue(T.FURNITURE_REAL_ROOM_OBJECT)===1&&this.object.model.setValue(Ut.INFOSTAND_EXTRA_PARAM,Ut.USABLE_PRODUCT)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new P(P.PET_PRODUCT_MENU,this.object))}}class $j extends Ee{getEventTypes(){const e=[P.PLACEHOLDER];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new P(P.PLACEHOLDER,this.object))}}class e3 extends Ee{initialize(e){super.initialize(e),e.logic&&e.logic.planetSystems&&this.object.model.setValue(T.FURNITURE_PLANETSYSTEM_DATA,e.logic.planetSystems)}}class er extends Ee{getEventTypes(){const e=[P.PRESENT];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),e.logic&&e.logic.particleSystems&&e.logic.particleSystems.length&&this.object.model.setValue(T.FURNITURE_FIREWORKS_DATA,e.logic.particleSystems)}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof Ve&&(e.data.writeRoomObjectModel(this.object.model),this.updateStuffData()),e instanceof Wp&&e.numberKey===T.FURNITURE_DISABLE_PICKING_ANIMATION&&this.object.model.setValue(T.FURNITURE_DISABLE_PICKING_ANIMATION,e.numberValue)}updateStuffData(){if(!this.object||!this.object.model)return;const e=new Xs;e.initializeFromRoomObjectModel(this.object.model);const t=e.getValue(er.MESSAGE),s=this.object.model.getValue(T.FURNITURE_DATA);!t&&typeof s=="string"?this.object.model.setValue(T.FURNITURE_DATA,s.substr(1)):this.object.model.setValue(T.FURNITURE_DATA,e.getValue(er.MESSAGE)),this.writeToModel(T.FURNITURE_TYPE_ID,e.getValue(er.PRODUCT_CODE)),this.writeToModel(T.FURNITURE_PURCHASER_NAME,e.getValue(er.PURCHASER_NAME)),this.writeToModel(T.FURNITURE_PURCHASER_FIGURE,e.getValue(er.PURCHASER_FIGURE))}writeToModel(e,t){t&&this.object.model.setValue(e,t)}mouseEvent(e,t){if(!(!e||!t||!this.object)){switch(e.type){case W.ROLL_OVER:this.eventDispatcher.dispatchEvent(new B(B.MOUSE_BUTTON,this.object));break;case W.ROLL_OUT:this.eventDispatcher.dispatchEvent(new B(B.MOUSE_ARROW,this.object));break}super.mouseEvent(e,t)}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new P(P.PRESENT,this.object))}}er.MESSAGE="MESSAGE",er.PRODUCT_CODE="PRODUCT_CODE",er.EXTRA_PARAM="EXTRA_PARAM",er.PURCHASER_NAME="PURCHASER_NAME",er.PURCHASER_FIGURE="PURCHASER_FIGURE";class t3 extends ft{getEventTypes(){const e=[P.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new P(P.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,this.object))}get contextMenu(){return Kt.PURCHASABLE_CLOTHING}}class Ei extends ft{constructor(){super(),this.updateInterval=Er.DEFAULT_UPDATE_INTERVAL,this._oldLocation=new y}processUpdateMessage(e){if(!e)return;const t=e instanceof qi;if(this.object&&!t&&e.location){const s=this.object.getLocation(),i=y.dif(e.location,s);if(i&&Math.abs(i.x)<2&&Math.abs(i.y)<2){let n=s;(Math.abs(i.x)>1||Math.abs(i.y)>1)&&(n=y.sum(s,y.product(i,.5))),super.processUpdateMessage(new qi(n,e.location,e.direction));return}}if(e.location&&!t&&super.processUpdateMessage(new qi(e.location,e.location,e.direction)),e instanceof Ve){e.state>0?this.updateInterval=Er.DEFAULT_UPDATE_INTERVAL/this.getUpdateIntervalValue(e.state):this.updateInterval=1,this.handleDataUpdate(e);return}t&&e.isSlide&&(this.updateInterval=Er.DEFAULT_UPDATE_INTERVAL),super.processUpdateMessage(e)}getUpdateIntervalValue(e){return e/Ei.MAX_ANIMATION_COUNT}getAnimationValue(e){return e%Ei.MAX_ANIMATION_COUNT}handleDataUpdate(e){const t=this.getAnimationValue(e.state);if(t!==e.state){const s=new ns;s.setString(t.toString()),e=new Ve(t,s,e.extra)}super.processUpdateMessage(e)}update(e){this.object&&(this._oldLocation.assign(this.object.getLocation()),super.update(e),y.dif(this.object.getLocation(),this._oldLocation).length===0&&this.object.getState(0)!==Ei.ANIMATION_NOT_MOVING&&this.object.setState(Ei.ANIMATION_NOT_MOVING,0))}}Ei.ANIMATION_NOT_MOVING=0,Ei.ANIMATION_MOVING=1,Ei.MAX_ANIMATION_COUNT=10;class s3 extends Ee{getEventTypes(){const e=[Me.STATE_RANDOM];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Me(Me.STATE_RANDOM,this.object))}}class r3 extends ft{get contextMenu(){return Kt.RANDOM_TELEPORT}}class i3 extends Ee{getEventTypes(){const e=[Qs.RODRE_CURRENT_USER_ID];return this.mergeTypes(super.getEventTypes(),e)}update(e){if(super.update(e),this.object&&this.object.model){this.object.model.getValue(T.SESSION_CURRENT_USER_ID)||this.eventDispatcher.dispatchEvent(new Qs(Qs.RODRE_CURRENT_USER_ID,this.object));const t=this.object.model.getValue(T.FURNITURE_DATA).renterId,s=this.object.model.getValue(T.SESSION_CURRENT_USER_ID);t?parseInt(t)===s?this.object.setState(2,0):this.object.setState(1,0):this.object.setState(0,0)}}get widget(){return ie.RENTABLESPACE}}class n3 extends ft{constructor(){super(),this._roomColorUpdated=!1}getEventTypes(){const e=[P.BACKGROUND_COLOR,Hi.ROOM_BACKGROUND_COLOR];return this.mergeTypes(super.getEventTypes(),e)}onDispose(){this._roomColorUpdated&&(this.eventDispatcher&&this.object&&this.object.model.getValue(T.FURNITURE_REAL_ROOM_OBJECT)===1&&this.eventDispatcher.dispatchEvent(new Hi(Hi.ROOM_BACKGROUND_COLOR,this.object,!1,0,0,0)),this._roomColorUpdated=!1),super.onDispose()}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof Ve&&(e.data.writeRoomObjectModel(this.object.model),this.object.model.getValue(T.FURNITURE_REAL_ROOM_OBJECT)===1&&this.processColorUpdate())}processColorUpdate(){if(!this.object||!this.object.model)return;const e=new ei;e.initializeFromRoomObjectModel(this.object.model);const t=e.getValue(0),s=e.getValue(1),i=e.getValue(2),n=e.getValue(3);t>-1&&s>-1&&i>-1&&n>-1&&(this.object.model.setValue(T.FURNITURE_ROOM_BACKGROUND_COLOR_HUE,s),this.object.model.setValue(T.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION,i),this.object.model.setValue(T.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS,n),this.object.setState(t,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Hi(Hi.ROOM_BACKGROUND_COLOR,this.object,t===1,s,i,n)),this._roomColorUpdated=!0)}mouseEvent(e,t){if(!(!e||!t||!this.object)){switch(e.type){case W.DOUBLE_CLICK:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new P(P.BACKGROUND_COLOR,this.object));return}super.mouseEvent(e,t)}}}var Da={},a3={},Ji={};Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.loop=Ji.conditional=Ji.parse=void 0;var HQ=function r(e,t){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:s;if(Array.isArray(t))t.forEach(function(a){return r(e,a,s,i)});else if(typeof t=="function")t(e,s,i,r);else{var n=Object.keys(t)[0];Array.isArray(t[n])?(i[n]={},r(e,t[n],s,i[n])):i[n]=t[n](e,s,i,r)}return s};Ji.parse=HQ;var kQ=function(e,t){return function(s,i,n,a){t(s,i,n)&&a(s,e,i,n)}};Ji.conditional=kQ;var VQ=function(e,t){return function(s,i,n,a){for(var o=[],u=s.pos;t(s,i,n);){var l={};if(a(s,e,i,l),s.pos===u)break;u=s.pos,o.push(l)}return o}};Ji.loop=VQ;var Pt={};Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.readBits=Pt.readArray=Pt.readUnsigned=Pt.readString=Pt.peekBytes=Pt.readBytes=Pt.peekByte=Pt.readByte=Pt.buildStream=void 0;var jQ=function(e){return{data:e,pos:0}};Pt.buildStream=jQ;var o3=function(){return function(e){return e.data[e.pos++]}};Pt.readByte=o3;var YQ=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function(t){return t.data[t.pos+e]}};Pt.peekByte=YQ;var K_=function(e){return function(t){return t.data.subarray(t.pos,t.pos+=e)}};Pt.readBytes=K_;var WQ=function(e){return function(t){return t.data.subarray(t.pos,t.pos+e)}};Pt.peekBytes=WQ;var zQ=function(e){return function(t){return Array.from(K_(e)(t)).map(function(s){return String.fromCharCode(s)}).join("")}};Pt.readString=zQ;var XQ=function(e){return function(t){var s=K_(2)(t);return e?(s[1]<<8)+s[0]:(s[0]<<8)+s[1]}};Pt.readUnsigned=XQ;var KQ=function(e,t){return function(s,i,n){for(var a=typeof t=="function"?t(s,i,n):t,o=K_(e),u=new Array(a),l=0;l<a;l++)u[l]=o(s);return u}};Pt.readArray=KQ;var qQ=function(e,t,s){for(var i=0,n=0;n<s;n++)i+=e[t+n]&&Math.pow(2,s-n-1);return i},QQ=function(e){return function(t){for(var s=o3()(t),i=new Array(8),n=0;n<8;n++)i[7-n]=!!(s&1<<n);return Object.keys(e).reduce(function(a,o){var u=e[o];return u.length?a[o]=qQ(i,u.index,u.length):a[o]=i[u.index],a},{})}};Pt.readBits=QQ,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var e=Ji,t=Pt,s={blocks:function(_){for(var f=0,g=[],I=_.data.length,p=0,R=(0,t.readByte)()(_);R!==f&&R;R=(0,t.readByte)()(_)){if(_.pos+R>=I){var S=I-_.pos;g.push((0,t.readBytes)(S)(_)),p+=S;break}g.push((0,t.readBytes)(R)(_)),p+=R}for(var O=new Uint8Array(p),A=0,C=0;C<g.length;C++)O.set(g[C],A),A+=g[C].length;return O}},i=(0,e.conditional)({gce:[{codes:(0,t.readBytes)(2)},{byteSize:(0,t.readByte)()},{extras:(0,t.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,t.readUnsigned)(!0)},{transparentColorIndex:(0,t.readByte)()},{terminator:(0,t.readByte)()}]},function(c){var _=(0,t.peekBytes)(2)(c);return _[0]===33&&_[1]===249}),n=(0,e.conditional)({image:[{code:(0,t.readByte)()},{descriptor:[{left:(0,t.readUnsigned)(!0)},{top:(0,t.readUnsigned)(!0)},{width:(0,t.readUnsigned)(!0)},{height:(0,t.readUnsigned)(!0)},{lct:(0,t.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,e.conditional)({lct:(0,t.readArray)(3,function(c,_,f){return Math.pow(2,f.descriptor.lct.size+1)})},function(c,_,f){return f.descriptor.lct.exists}),{data:[{minCodeSize:(0,t.readByte)()},s]}]},function(c){return(0,t.peekByte)()(c)===44}),a=(0,e.conditional)({text:[{codes:(0,t.readBytes)(2)},{blockSize:(0,t.readByte)()},{preData:function(_,f,g){return(0,t.readBytes)(g.text.blockSize)(_)}},s]},function(c){var _=(0,t.peekBytes)(2)(c);return _[0]===33&&_[1]===1}),o=(0,e.conditional)({application:[{codes:(0,t.readBytes)(2)},{blockSize:(0,t.readByte)()},{id:function(_,f,g){return(0,t.readString)(g.blockSize)(_)}},s]},function(c){var _=(0,t.peekBytes)(2)(c);return _[0]===33&&_[1]===255}),u=(0,e.conditional)({comment:[{codes:(0,t.readBytes)(2)},s]},function(c){var _=(0,t.peekBytes)(2)(c);return _[0]===33&&_[1]===254}),l=[{header:[{signature:(0,t.readString)(3)},{version:(0,t.readString)(3)}]},{lsd:[{width:(0,t.readUnsigned)(!0)},{height:(0,t.readUnsigned)(!0)},{gct:(0,t.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,t.readByte)()},{pixelAspectRatio:(0,t.readByte)()}]},(0,e.conditional)({gct:(0,t.readArray)(3,function(c,_){return Math.pow(2,_.lsd.gct.size+1)})},function(c,_){return _.lsd.gct.exists}),{frames:(0,e.loop)([i,o,u,n,a],function(c){var _=(0,t.peekByte)()(c);return _===33||_===44})}],d=l;r.default=d}(a3);var q_={};Object.defineProperty(q_,"__esModule",{value:!0}),q_.deinterlace=void 0;var ZQ=function(e,t){for(var s=new Array(e.length),i=e.length/t,n=function(_,f){var g=e.slice(f*t,(f+1)*t);s.splice.apply(s,[_*t,t].concat(g))},a=[0,4,2,1],o=[8,8,4,2],u=0,l=0;l<4;l++)for(var d=a[l];d<i;d+=o[l])n(d,u),u++;return s};q_.deinterlace=ZQ;var Q_={};Object.defineProperty(Q_,"__esModule",{value:!0}),Q_.lzw=void 0;var JQ=function(e,t,s){var i=4096,n=-1,a=s,o,u,l,d,c,_,f,M,g,I,C,p,N,L,D,b,R=new Array(s),S=new Array(i),O=new Array(i),A=new Array(i+1);for(p=e,u=1<<p,c=u+1,o=u+2,f=n,d=p+1,l=(1<<d)-1,g=0;g<u;g++)S[g]=0,O[g]=g;var C,M,N,L,b,D;for(C=M=N=L=b=D=0,I=0;I<a;){if(L===0){if(M<d){C+=t[D]<<M,M+=8,D++;continue}if(g=C&l,C>>=d,M-=d,g>o||g==c)break;if(g==u){d=p+1,l=(1<<d)-1,o=u+2,f=n;continue}if(f==n){A[L++]=O[g],f=g,N=g;continue}for(_=g,g==o&&(A[L++]=N,g=f);g>u;)A[L++]=O[g],g=S[g];N=O[g]&255,A[L++]=N,o<i&&(S[o]=f,O[o]=N,o++,!(o&l)&&o<i&&(d++,l+=o)),f=_}L--,R[b++]=A[L],I++}for(I=b;I<a;I++)R[I]=0;return R};Q_.lzw=JQ,Object.defineProperty(Da,"__esModule",{value:!0});var h3=Da.decompressFrames=Da.decompressFrame=u3=Da.parseGIF=void 0,$Q=iZ(a3),eZ=Ji,tZ=Pt,sZ=q_,rZ=Q_;function iZ(r){return r&&r.__esModule?r:{default:r}}var nZ=function(e){var t=new Uint8Array(e);return(0,eZ.parse)((0,tZ.buildStream)(t),$Q.default)},u3=Da.parseGIF=nZ,aZ=function(e){for(var t=e.pixels.length,s=new Uint8ClampedArray(t*4),i=0;i<t;i++){var n=i*4,a=e.pixels[i],o=e.colorTable[a]||[0,0,0];s[n]=o[0],s[n+1]=o[1],s[n+2]=o[2],s[n+3]=a!==e.transparentIndex?255:0}return s},l3=function(e,t,s){if(!e.image){console.warn("gif frame does not have associated image.");return}var i=e.image,n=i.descriptor.width*i.descriptor.height,a=(0,rZ.lzw)(i.data.minCodeSize,i.data.blocks,n);i.descriptor.lct.interlaced&&(a=(0,sZ.deinterlace)(a,i.descriptor.width));var o={pixels:a,dims:{top:e.image.descriptor.top,left:e.image.descriptor.left,width:e.image.descriptor.width,height:e.image.descriptor.height}};return i.descriptor.lct&&i.descriptor.lct.exists?o.colorTable=i.lct:o.colorTable=t,e.gce&&(o.delay=(e.gce.delay||10)*10,o.disposalType=e.gce.extras.disposal,e.gce.extras.transparentColorGiven&&(o.transparentIndex=e.gce.transparentColorIndex)),s&&(o.patch=aZ(o)),o};Da.decompressFrame=l3;var oZ=function(e,t){return e.frames.filter(function(s){return s.image}).map(function(s){return l3(s,e.gct,t)})};h3=Da.decompressFrames=oZ;class Nt extends Ee{constructor(){super(),this._disableFurnitureSelection=!0,this._hasClickUrl=!1}getEventTypes(){const e=[We.ROOM_AD_LOAD_IMAGE];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),this._disableFurnitureSelection&&this.object.model.setValue(T.FURNITURE_SELECTION_DISABLED,1)}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof Ve&&this.processAdDataUpdateMessage(e),e instanceof fs&&this.processAdUpdate(e)}processAdDataUpdateMessage(e){if(!e)return;const t=new Xs;t.initializeFromRoomObjectModel(this.object.model);const s=parseInt(t.getValue(Nt.STATE));!isNaN(s)&&this.object.getState(0)!==s&&this.object.setState(s,0);const i=t.getValue(Nt.IMAGEURL_KEY),n=this.object.model.getValue(T.FURNITURE_BRANDING_IMAGE_URL);(!n||n!==i)&&(this.object.model.setValue(T.FURNITURE_BRANDING_IMAGE_URL,i),this.object.model.setValue(T.FURNITURE_BRANDING_IMAGE_STATUS,0),this.downloadBackground());const a=t.getValue(Nt.CLICKURL_KEY);if(a){const c=this.object.model.getValue(T.FURNITURE_BRANDING_URL);(!c||c!==a)&&this.object.model&&this.object.model.setValue(T.FURNITURE_BRANDING_URL,a)}const o=parseInt(t.getValue(Nt.OFFSETX_KEY)),u=parseInt(t.getValue(Nt.OFFSETY_KEY)),l=parseInt(t.getValue(Nt.OFFSETZ_KEY));isNaN(o)||this.object.model.setValue(T.FURNITURE_BRANDING_OFFSET_X,o),isNaN(u)||this.object.model.setValue(T.FURNITURE_BRANDING_OFFSET_Y,u),isNaN(l)||this.object.model.setValue(T.FURNITURE_BRANDING_OFFSET_Z,l);let d=Nt.IMAGEURL_KEY+"="+(i!==null?i:"")+"	";this._hasClickUrl&&(d=d+(Nt.CLICKURL_KEY+"="+(a!==null?a:"")+"	")),d=d+(Nt.OFFSETX_KEY+"="+o+"	"),d=d+(Nt.OFFSETY_KEY+"="+u+"	"),d=d+(Nt.OFFSETZ_KEY+"="+l+"	"),this.object.model.setValue(Ut.INFOSTAND_EXTRA_PARAM,Ut.BRANDING_OPTIONS+d)}processAdUpdate(e){if(!(!e||!this.object))switch(e.type){case fs.IMAGE_LOADED:this.object.model.setValue(T.FURNITURE_BRANDING_IMAGE_STATUS,1);break;case fs.IMAGE_LOADING_FAILED:this.object.model.setValue(T.FURNITURE_BRANDING_IMAGE_STATUS,-1);break}}mouseEvent(e,t){!e||!t||e.type===W.MOUSE_MOVE||e.type===W.DOUBLE_CLICK||super.mouseEvent(e,t)}downloadBackground(){return mt(this,void 0,void 0,function*(){const e=this.object&&this.object.model;if(!e)return;const t=e.getValue(T.FURNITURE_BRANDING_IMAGE_URL),s=e.getValue(T.FURNITURE_BRANDING_IMAGE_STATUS);if(!(!t||t===""||s===1))if(t.endsWith(".gif"))this.object.model.setValue(T.FURNITURE_BRANDING_IS_ANIMATED,!0),fetch(t).then(i=>i.arrayBuffer()).then(i=>u3(i)).then(i=>{const n=i.lsd.width,a=i.lsd.height,o=n*a,u=h3(i,!1),l=[],d=[];let c=new Uint8Array(o*4);for(let _=0;_<u.length;_++){_>0&&(c=c.slice(0));const f=u[_].pixels,g=u[_].colorTable,I=u[_].transparentIndex,p=u[_].dims;for(let S=0;S<p.height;S++)for(let O=0;O<p.width;O++){const A=f[S*p.width+O],C=(S+p.top)*n+(O+p.left);if(I!==A){const M=g[A];c[4*C]=M[0],c[4*C+1]=M[1],c[4*C+2]=M[2],c[4*C+3]=255}}const R=Qe.fromBuffer(c,n,a);l.push(new Re(R)),d.push(u[_].delay)}X.instance.roomEngine.roomContentLoader.createGifCollection(t,l,d),this.processUpdateMessage(new fs(fs.IMAGE_LOADED))}).catch(i=>{this.processUpdateMessage(new fs(fs.IMAGE_LOADING_FAILED))});else{const i=Ws();if(!i)return;if(!i.getTexture(t)){(yield i.downloadAsset(t))?this.processUpdateMessage(new fs(fs.IMAGE_LOADED)):this.processUpdateMessage(new fs(fs.IMAGE_LOADING_FAILED));return}this.processUpdateMessage(new fs(fs.IMAGE_LOADED))}})}}Nt.STATE="state",Nt.IMAGEURL_KEY="imageUrl",Nt.CLICKURL_KEY="clickUrl",Nt.OFFSETX_KEY="offsetX",Nt.OFFSETY_KEY="offsetY",Nt.OFFSETZ_KEY="offsetZ";class c3 extends Nt{getAdClickUrl(e){return null}}class _3 extends Nt{constructor(){super(),this._hasClickUrl=!0}getAdClickUrl(e){return e.getValue(T.FURNITURE_BRANDING_URL)}handleAdClick(e,t,s){if(s.indexOf("http")===0){Ti.openWebPage(s);return}this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new We(We.ROOM_AD_FURNI_CLICK,this.object,"",s))}}class d3 extends Ee{constructor(){super(),this._roomColorUpdated=!1}getEventTypes(){const e=[P.DIMMER,P.WIDGET_REMOVE_DIMMER,Bi.DIMMER_STATE];return this.mergeTypes(super.getEventTypes(),e)}onDispose(){this._roomColorUpdated&&this.eventDispatcher&&this.object&&(this.object.model.getValue(T.FURNITURE_REAL_ROOM_OBJECT)===1&&(this.eventDispatcher.dispatchEvent(new Bi(this.object,0,1,1,16777215,255)),this.eventDispatcher.dispatchEvent(new P(P.WIDGET_REMOVE_DIMMER,this.object))),this._roomColorUpdated=!1),super.onDispose()}processUpdateMessage(e){if(e instanceof Ve){if(e.data){const t=e.data.getLegacyString();this.object.model.getValue(T.FURNITURE_REAL_ROOM_OBJECT)===1&&this.processDimmerData(t),super.processUpdateMessage(new Ve(this.getStateFromDimmerData(t),e.data))}return}super.processUpdateMessage(e)}getStateFromDimmerData(e){if(!e)return 0;const t=e.split(",");return t.length>=5?parseInt(t[0])-1:0}processDimmerData(e){if(!e)return;const t=e.split(",");if(t.length>=5){const s=this.getStateFromDimmerData(e),i=parseInt(t[1]),n=parseInt(t[2]),a=t[3];let o=parseInt(a.substr(1),16),u=parseInt(t[4]);s||(o=16777215,u=255),this.eventDispatcher&&this.object&&(this.eventDispatcher.dispatchEvent(new Bi(this.object,s,i,n,o,u)),this._roomColorUpdated=!0)}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new P(P.DIMMER,this.object))}update(e){super.update(e)}}class $i extends Ee{constructor(){super(),this._score=0,this._scoreIncreaser=50,this._scoreTimer=0}processUpdateMessage(e){if(e instanceof Ve)return this.updateScore(e.state);super.processUpdateMessage(e)}updateScore(e){this._score=e;const t=this.object.getState(0);if(this._score!==t){let s=this._score-t;s<0&&(s=-s),s*$i.UPDATE_INTERVAL>$i.MAX_UPDATE_TIME?this._scoreIncreaser=$i.MAX_UPDATE_TIME/s:this._scoreIncreaser=$i.UPDATE_INTERVAL,this._scoreTimer=ve()}}update(e){super.update(e);const t=this.object.getState(0);if(t!==this._score&&e>=this._scoreTimer+this._scoreIncreaser){const s=e-this._scoreTimer;let i=s/this._scoreIncreaser,n=1;this._score<t&&(n=-1),i>n*(this._score-t)&&(i=n*(this._score-t)),this.object.setState(t+n*i,0),this._scoreTimer=e-(s-i*this._scoreIncreaser)}}}$i.UPDATE_INTERVAL=50,$i.MAX_UPDATE_TIME=3e3;class f3 extends Ee{processUpdateMessage(e){if(super.processUpdateMessage(e),this.object.model.getValue(T.FURNITURE_REAL_ROOM_OBJECT)===1){const t=this.object.model.getValue(T.FURNITURE_EXTRAS),s=parseInt(t);this.object.model.setValue(Ut.INFOSTAND_EXTRA_PARAM,Ut.SONGDISK+s)}}}class tr extends ft{constructor(){super(...arguments),this._state=-1,this._sampleId=-1,this._noPitch=!1,this._lastLocZ=0}getEventTypes(){const e=[ut.ROOM_OBJECT_INITIALIZED,ut.ROOM_OBJECT_DISPOSED,ut.PLAY_SAMPLE,ut.CHANGE_PITCH];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),e.logic&&e.logic.soundSample&&(this._sampleId=e.logic.soundSample.id,this._noPitch=e.logic.soundSample.noPitch),this.object.model.setValue(T.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,1)}onDispose(){this._state!==tr.STATE_UNINITIALIZED&&this.eventDispatcher.dispatchEvent(new ut(ut.ROOM_OBJECT_DISPOSED,this.object,this._sampleId)),super.onDispose()}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof Ve&&this.updateSoundBlockMessage(e)}updateSoundBlockMessage(e){if(!e)return;const t=this.object&&this.object.model,s=this.object&&this.object.location;!t||!s||(this._state===tr.STATE_UNINITIALIZED&&t.getValue(T.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._lastLocZ=s.z,this.eventDispatcher.dispatchEvent(new ut(ut.ROOM_OBJECT_INITIALIZED,this.object,this._sampleId,this.getPitchForHeight(s.z)))),this._state!==tr.STATE_UNINITIALIZED&&t.getValue(T.FURNITURE_REAL_ROOM_OBJECT)===1&&this._lastLocZ!==s.z&&(this._lastLocZ=s.z,this.eventDispatcher.dispatchEvent(new ut(ut.CHANGE_PITCH,this.object,this._sampleId,this.getPitchForHeight(s.z)))),this._state!==tr.STATE_UNINITIALIZED&&e.state!==this._state&&this.playSoundAt(s.z),this._state=e.state)}playSoundAt(e){if(!this.object)return;const t=this.getPitchForHeight(e);this.object.model.setValue(T.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,t),this.eventDispatcher.dispatchEvent(new ut(ut.PLAY_SAMPLE,this.object,this._sampleId,t))}getPitchForHeight(e){if(this._noPitch)return 1;let t=e*2;return t>tr.HIGHEST_SEMITONE&&(t=Math.min(0,tr.LOWEST_SEMITONE+(t-tr.HIGHEST_SEMITONE-1))),Math.pow(2,t/12)}}tr.HIGHEST_SEMITONE=12,tr.LOWEST_SEMITONE=-12,tr.STATE_UNINITIALIZED=-1;class g3 extends ft{constructor(){super(...arguments),this._disposeEventsAllowed=!1,this._isInitialized=!1,this._currentState=-1}getEventTypes(){const e=[B.SOUND_MACHINE_START,B.SOUND_MACHINE_STOP,B.SOUND_MACHINE_DISPOSE,B.SOUND_MACHINE_INIT];return this.mergeTypes(super.getEventTypes(),e)}onDispose(){this.requestDispose(),super.onDispose()}processUpdateMessage(e){if(super.processUpdateMessage(e),this.object.model.getValue(T.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._isInitialized||this.requestInit(),this.object.model.setValue(Ut.INFOSTAND_EXTRA_PARAM,Ut.JUKEBOX),e instanceof Ve)){const t=this.object.getState(0);t!==this._currentState&&(this._currentState=t,t===1?this.requestPlayList():t===0&&this.requestStopPlaying())}}requestInit(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new B(B.SOUND_MACHINE_INIT,this.object)),this._isInitialized=!0)}requestPlayList(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new B(B.SOUND_MACHINE_START,this.object)))}requestStopPlaying(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new B(B.SOUND_MACHINE_STOP,this.object))}requestDispose(){!this._disposeEventsAllowed||!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new B(B.SOUND_MACHINE_DISPOSE,this.object))}}class Ju extends Ee{getEventTypes(){const e=[P.STICKIE,B.STICKIE];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),this.updateColor(),this.object&&this.object.model.setValue(T.FURNITURE_IS_STICKIE,"")}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof X_&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new P(P.STICKIE,this.object)),this.updateColor()}updateColor(){if(!this.object)return;const e=this.object.model.getValue(T.FURNITURE_DATA);let t=Ju.STICKIE_COLORS.indexOf(e);t<0&&(t=3),this.object.model.setValue(T.FURNITURE_COLOR,t+1)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new B(B.STICKIE,this.object))}}Ju.STICKIE_COLORS=["9CCEFF","FF9CFF","9CFF9C","FFFF33"];class E3 extends Ee{getEventTypes(){const e=[P.TROPHY];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new P(P.TROPHY,this.object))}}class en extends ft{constructor(){super(),this._total=0,this._lastUpdate=0,this._interval=33}processUpdateMessage(e){if(super.processUpdateMessage(e),e instanceof Ve){const t=e.data;if(!t)return;this.updateTotal(t.result)}}updateTotal(e){if(this._total=e,!this._lastUpdate){this.object.model.setValue(T.FURNITURE_VOTE_COUNTER_COUNT,e),this._lastUpdate=ve();return}if(this._total!==this.currentTotal){const t=Math.abs(this._total-this.currentTotal);t*en.UPDATE_INTERVAL>en.MAX_UPDATE_TIME?this._interval=en.MAX_UPDATE_TIME/t:this._interval=en.UPDATE_INTERVAL,this._lastUpdate=ve()}}update(e){if(super.update(e),this.object&&this.currentTotal!==this._total&&e>=this._lastUpdate+this._interval){const t=e-this._lastUpdate;let s=t/this._interval,i=1;this._total<this.currentTotal&&(i=-1),s>i*(this._total-this.currentTotal)&&(s=i*(this._total-this.currentTotal)),this.object.model.setValue(T.FURNITURE_VOTE_COUNTER_COUNT,this.currentTotal+i*s),this._lastUpdate=e-(t-s*this._interval)}}get currentTotal(){return this.object.model.getValue(T.FURNITURE_VOTE_COUNTER_COUNT)}}en.UPDATE_INTERVAL=33,en.MAX_UPDATE_TIME=1e3;class m3 extends ft{processUpdateMessage(e){if(super.processUpdateMessage(e),!!this.object&&e instanceof Ve){const t=e.data;t instanceof ca&&this.object.model.setValue(T.FURNITURE_VOTE_MAJORITY_RESULT,t.result)}}}class p3 extends ft{mouseEvent(e,t){!e||!t||(e.type===W.DOUBLE_CLICK&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Me(Me.STATE_CHANGE,this.object)),super.mouseEvent(e,t))}}class I3 extends ft{initialize(e){super.initialize(e);let t="";e.logic&&e.logic.maskType&&e.logic.maskType!==""&&e.logic.maskType.length>0&&(t=e.logic.maskType),this.object.model.setValue(T.FURNITURE_USES_PLANE_MASK,1),this.object.model.setValue(T.FURNITURE_PLANE_MASK_TYPE,t)}}class T3 extends Ee{getEventTypes(){const e=[P.YOUTUBE,Qs.RODRE_URL_PREFIX];return this.mergeTypes(super.getEventTypes(),e)}update(e){super.update(e),this.object.model.getValue(T.SESSION_URL_PREFIX)||this.eventDispatcher.dispatchEvent(new Qs(Qs.RODRE_URL_PREFIX,this.object))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new P(P.YOUTUBE,this.object))}}class R3 extends Er{constructor(){super(),this._selected=!1,this._reportedLocation=null,this._postureIndex=0,this._gestureIndex=0,this._headDirectionDelta=0,this._directions=[],this._talkingEndTimestamp=0,this._gestureEndTimestamp=0,this._expressionEndTimestamp=0}getEventTypes(){const e=[re.CLICK,hs.POSITION_CHANGED];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){if(!e)return;const t=this.object&&this.object.model;if(t){if(e.logic&&e.logic.model){const s=e.logic.model.directions;if(s&&s.length){for(const i of s)this._directions.push(i);this._directions.sort()}}t.setValue(T.PET_ALLOWED_DIRECTIONS,this._directions)}}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new hs(hs.OBJECT_REMOVED,this.object)),this._directions=null,this._reportedLocation=null}update(e){if(super.update(e),this._selected&&this.object&&this.eventDispatcher){const t=this.object.getLocation();(!this._reportedLocation||this._reportedLocation.x!==t.x||this._reportedLocation.y!==t.y||this._reportedLocation.z!==t.z)&&(this._reportedLocation||(this._reportedLocation=new y),this._reportedLocation.assign(t),this.eventDispatcher.dispatchEvent(new hs(hs.POSITION_CHANGED,this.object)))}this.object&&this.object.model&&this.updateModel(e,this.object.model)}updateModel(e,t){this._gestureEndTimestamp>0&&e>this._gestureEndTimestamp&&(t.setValue(T.FIGURE_GESTURE,null),this._gestureEndTimestamp=0),this._talkingEndTimestamp>0&&e>this._talkingEndTimestamp&&(t.setValue(T.FIGURE_TALK,0),this._talkingEndTimestamp=0),this._expressionEndTimestamp>0&&e>this._expressionEndTimestamp&&(t.setValue(T.FIGURE_EXPRESSION,0),this._expressionEndTimestamp=0)}processUpdateMessage(e){if(!e||!this.object)return;super.processUpdateMessage(e);const t=this.object&&this.object.model;if(t){if(e instanceof qu){t.setValue(T.HEAD_DIRECTION,e.headDirection);return}if(e instanceof Xu){const s=new ul(e.figure);t.setValue(T.FIGURE,e.figure),t.setValue(T.RACE,e.subType),t.setValue(T.PET_PALETTE_INDEX,s.paletteId),t.setValue(T.PET_COLOR,s.color),t.setValue(T.PET_TYPE,s.typeId),t.setValue(T.PET_CUSTOM_LAYER_IDS,s.customLayerIds),t.setValue(T.PET_CUSTOM_PARTS_IDS,s.customPartIds),t.setValue(T.PET_CUSTOM_PALETTE_IDS,s.customPaletteIds),t.setValue(T.PET_IS_RIDING,e.isRiding?1:0);return}if(e instanceof W_){t.setValue(T.FIGURE_POSTURE,e.postureType);return}if(e instanceof Y_){t.setValue(T.FIGURE_TALK,1),this._talkingEndTimestamp=this.time+e.numberOfWords*1e3;return}if(e instanceof z_){t.setValue(T.FIGURE_SLEEP,e.isSleeping?1:0);return}if(e instanceof Gp){t.setValue(T.FIGURE_GESTURE,e.gesture),this._gestureEndTimestamp=this.time+3e3;return}if(e instanceof Ku){this._selected=e.selected,this._reportedLocation=null;return}if(e instanceof Dp){t.setValue(T.FIGURE_EXPERIENCE_TIMESTAMP,this.time),t.setValue(T.FIGURE_GAINED_EXPERIENCE,e.gainedExperience);return}}}mouseEvent(e,t){let s=null;switch(e.type){case W.MOUSE_CLICK:s=re.CLICK;break;case W.DOUBLE_CLICK:break;case W.MOUSE_DOWN:{this.object.model.getValue(T.PET_TYPE)===be.MONSTERPLANT&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new re(re.MOUSE_DOWN,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown));break}}s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new re(s,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown))}}class Xp{constructor(){this._width=0,this._height=0,this._wallHeight=0,this._fixedWallsHeight=0,this._tileMap=[],this._holeMap=[],this._doors=[],this._dimensions={minX:0,maxX:0,minY:0,maxY:0},this._restrictsDragging=!1,this._restrictedScale=1,this._restrictsScaling=!1}get width(){return this._width}set width(e){this._width=e}get height(){return this._height}set height(e){this._height=e}get wallHeight(){return this._wallHeight}set wallHeight(e){this._wallHeight=e}get fixedWallsHeight(){return this._fixedWallsHeight}set fixedWallsHeight(e){this._fixedWallsHeight=e}get tileMap(){return this._tileMap}get holeMap(){return this._holeMap}get doors(){return this._doors}get dimensions(){return this._dimensions}get restrictsDragging(){return this._restrictsDragging}set restrictsDragging(e){this._restrictsDragging=e}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(e){this._restrictsScaling=e}get restrictedScale(){return this._restrictedScale}set restrictedScale(e){this._restrictedScale=e}}class Un{constructor(e,t,s){this.type=e,this.loc=t,this.category=s}get loc(){return this._loc}set loc(e){this._loc||(this._loc=new y),this._loc.assign(e)}get type(){return this._type}set type(e){this._type=e}get category(){return this._category}set category(e){this._category=e}dispose(){this._loc=null}}Un.WINDOW="window",Un.HOLE="hole";class v3{constructor(){this._masks=[]}get masks(){return this._masks}}class Kp{constructor(){this._masks=new Map}get maskCount(){return this._masks.size}dispose(){this._masks&&(this.reset(),this._masks=null)}initialize(e){if(!e)return!1;if(this._masks.clear(),e.masks.length)for(const t of e.masks){if(!t)continue;const s=t.locations.length?t.locations[0]:null;s&&this._masks.set(t.id,new Un(t.type,s,t.category))}return!0}reset(){for(const e of this._masks.values())e&&e.dispose();this._masks.clear()}addMask(e,t,s,i){const n=new Un(t,s,i);this._masks.delete(e),this._masks.set(e,n)}removeMask(e){const t=this._masks.get(e);return t?(this._masks.delete(e),t.dispose(),!0):!1}getXML(){const e=new v3;for(const[t,s]of this._masks.entries()){if(!s)continue;const i=this.getMaskType(s),n=this.getMaskCategory(s),a=this.getMaskLocation(s);if(i&&n&&a){const o={id:t,type:i,category:n,locations:[{x:a.x,y:a.y,z:a.z}]};e.masks.push(o)}}return e}getMaskLocation(e){return e?e.loc:null}getMaskType(e){return e?e.type:null}getMaskCategory(e){return e?e.category:null}get masks(){return this._masks}}class O3{constructor(e,t,s,i){this._leftSideLoc=0,this._rightSideLoc=0,this._leftSideLength=0,this._rightSideLength=0,this._leftSideLoc=e,this._rightSideLoc=t,this._leftSideLength=s,this._rightSideLength=i}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}get leftSideLength(){return this._leftSideLength}get rightSideLength(){return this._rightSideLength}}class $e{constructor(e,t,s,i,n){this._type=0,this._loc=null,this._leftSide=null,this._rightSide=null,this._normal=null,this._normalDirection=null;let a,o,u,l,d,c,_,f;if(this._secondaryNormals=[],this._masks=[],this._loc=new y,this._loc.assign(t),this._leftSide=new y,this._leftSide.assign(s),this._rightSide=new y,this._rightSide.assign(i),this._type=e,s!=null&&i!=null&&(this._normal=y.crossProduct(s,i),a=0,o=0,u=0,l=0,d=0,this.normal.x!=0||this.normal.y!=0?(l=this.normal.x,d=this.normal.y,a=360+Math.atan2(d,l)/Math.PI*180,a>=360&&(a=a-360),l=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y),d=this.normal.z,o=360+Math.atan2(d,l)/Math.PI*180,o>=360&&(o=o-360)):this.normal.z<0?o=90:o=270,this._normalDirection=new y(a,o,u)),n!=null&&n.length>0)for(c=0;c<n.length;)_=n[c],_!=null&&_.length>0&&(f=new y,f.assign(_),f.multiply(1/f.length),this._secondaryNormals.push(f)),c++}get type(){return this._type}get loc(){return this._loc}get leftSide(){return this._leftSide}get rightSide(){return this._rightSide}get normal(){return this._normal}get normalDirection(){return this._normalDirection}get secondaryNormalCount(){return this._secondaryNormals.length}get maskCount(){return this._masks.length}getSecondaryNormal(e){if(e<0||e>=this.secondaryNormalCount)return null;const t=new y;return t.assign(this._secondaryNormals[e]),t}addMask(e,t,s,i){const n=new O3(e,t,s,i);this._masks.push(n)}getMask(e){return e<0||e>=this.maskCount?null:this._masks[e]}getMaskLeftSideLoc(e){const t=this.getMask(e);return t!=null?t.leftSideLoc:-1}getMaskRightSideLoc(e){const t=this.getMask(e);return t!=null?t.rightSideLoc:-1}getMaskLeftSideLength(e){const t=this.getMask(e);return t!=null?t.leftSideLength:-1}getMaskRightSideLength(e){const t=this.getMask(e);return t!=null?t.rightSideLength:-1}}$e.PLANE_UNDEFINED=0,$e.PLANE_FLOOR=1,$e.PLANE_WALL=2,$e.PLANE_LANDSCAPE=3,$e.PLANE_BILLBOARD=4;class S3{constructor(e,t,s,i){this._x=e,this._y=t,this._width=s,this._height=i}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}}class xs{constructor(){this._corners=[],this._endPoints=[],this._directions=[],this._lengths=[],this._leftTurns=[],this._borders=[],this._hideWalls=[],this._manuallyLeftCut=[],this._manuallyRightCut=[],this._addDuplicates=!1,this._count=0}addWall(e,t,s,i,n){(this._addDuplicates||this.checkIsNotDuplicate(e,t,s,i,n))&&(this._corners.push(e),this._directions.push(t),this._lengths.push(s),this._borders.push(i),this._leftTurns.push(n),this._hideWalls.push(!1),this._manuallyLeftCut.push(!1),this._manuallyRightCut.push(!1),this._count++)}checkIsNotDuplicate(e,t,s,i,n){let a=0;for(;a<this._count;){if(this._corners[a].x==e.x&&this._corners[a].y==e.y&&this._directions[a]==t&&this._lengths[a]==s&&this._borders[a]==i&&this._leftTurns[a]==n)return!1;a++}return!0}get count(){return this._count}getCorner(e){return this._corners[e]}getEndPoint(e){return this.calculateWallEndPoints(),this._endPoints[e]}getLength(e){return this._lengths[e]}getDirection(e){return this._directions[e]}getBorder(e){return this._borders[e]}getHideWall(e){return this._hideWalls[e]}getLeftTurn(e){return this._leftTurns[e]}getManuallyLeftCut(e){return this._manuallyLeftCut[e]}getManuallyRightCut(e){return this._manuallyRightCut[e]}setHideWall(e,t){this._hideWalls[e]=t}setLength(e,t){t<this._lengths[e]&&(this._lengths[e]=t,this._manuallyRightCut[e]=!0)}moveCorner(e,t){let s;if(t>0&&t<this._lengths[e]){const i=this._corners[e];s=xs.WALL_DIRECTION_VECTORS[this.getDirection(e)],this._corners[e]=new k(i.x+t*s.x,i.y+t*s.y),this._lengths[e]=this._lengths[e]-t,this._manuallyLeftCut[e]=!0}}calculateWallEndPoints(){let e,t,s,i,n;if(this._endPoints.length!=this.count)for(this._endPoints=[],e=0;e<this.count;)t=this.getCorner(e),s=new k(t.x,t.y),i=xs.WALL_DIRECTION_VECTORS[this.getDirection(e)],n=this.getLength(e),s.x=s.x+i.x*n,s.y=s.y+i.y*n,this._endPoints.push(s),e++}}xs.WALL_DIRECTION_VECTORS=[new y(1,0,0),new y(0,1,0),new y(-1,0,0),new y(0,-1,0)],xs.WALL_NORMAL_VECTORS=[new y(0,1,0),new y(-1,0,0),new y(0,-1,0),new y(1,0,0)];class te{constructor(){this._width=0,this._height=0,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._fixedWallHeight=-1,this._floorHeight=0,this._restrictsScaling=!1,this._restrictedScale=1,this._tileMatrix=[],this._tileMatrixOriginal=[],this._planes=[],this._floorHoleMatrix=[],this._wallHeight=3.6,this._wallThicknessMultiplier=1,this._floorThicknessMultiplier=1,this._floorHoles=new Map}static getFloorHeight(e){const t=e.length;if(!t)return 0;let s=0,i=0;for(;i<t;){const n=e[i];let a=0;for(;a<n.length;){const o=n[a];o>s&&(s=o),a++}i++}return s}static findEntranceTile(e){if(!e)return null;const t=e.length;if(!t)return null;const s=[];let i=0;for(;i<t;){const n=e[i];if(!n||!n.length)return null;let a=0;for(;a<n.length;){if(n[a]>=0){s.push(a);break}a++}s.length<i+1&&s.push(n.length+1),i++}for(i=1;i<s.length-1;){if(Math.trunc(s[i])<=Math.trunc(s[i-1])-1&&Math.trunc(s[i])<=Math.trunc(s[i+1])-1)return new k(Math.trunc(s[i]|0),i);i++}return null}static expandFloorTiles(e){let t,s,i,n,a,o,u,l,d,c,_,f;const g=e.length,I=e[0].length,p=[];for(s=0;s<g*4;)p[s]=[],s++;let R=0;for(s=0;s<g;){for(a=0,t=0;t<I;){if(o=e[s][t],o<0||o<=255)for(n=0;n<4;){for(i=0;i<4;)p[R+n]===void 0&&(p[R+n]=[]),p[R+n][a+i]=o<0?o:o*4,i++;n++}else{for(u=(o&255)*4,l=u+(o>>11&1)*3,d=u+(o>>10&1)*3,c=u+(o>>9&1)*3,_=u+(o>>8&1)*3,i=0;i<3;)f=i+1,p[R][a+i]=(l*(3-i)+d*i)/3,p[R+3][a+f]=(c*(3-f)+_*f)/3,p[R+f][a]=(l*(3-f)+c*f)/3,p[R+i][a+3]=(d*(3-i)+_*i)/3,i++;p[R+1][a+1]=l>u?u+2:u+1,p[R+1][a+2]=d>u?u+2:u+1,p[R+2][a+1]=c>u?u+2:u+1,p[R+2][a+2]=_>u?u+2:u+1}a=a+4,t++}R=R+4,s++}return p}static addTileTypes(e){let t,s,i,n,a,o,u,l,d,c,_,f,g;const I=e.length-1,p=e[0].length-1;for(s=1;s<I;){for(t=1;t<p;)i=e[s][t],i<0||(n=e[s-1][t-1]&255,a=e[s-1][t]&255,o=e[s-1][t+1]&255,u=e[s][t-1]&255,l=e[s][t+1]&255,d=e[s+1][t-1]&255,c=e[s+1][t]&255,_=e[s+1][t+1]&255,f=i+1,g=(n==f||a==f||u==f?8:0)|(o==f||a==f||l==f?4:0)|(d==f||c==f||u==f?2:0)|(_==f||c==f||l==f?1:0),g==15&&(g=0),e[s][t]=i|g<<8),t++;s++}}static unpadHeightMap(e){e.shift(),e.pop();for(const t of e)t.shift(),t.pop()}static padHeightMap(e){const t=[],s=[];for(const i of e)i.push(te.TILE_BLOCKED),i.unshift(te.TILE_BLOCKED);for(const i of e[0])t.push(te.TILE_BLOCKED),s.push(te.TILE_BLOCKED);e.push(s),e.unshift(t)}get minX(){return this._minX}get maxX(){return this._maxX}get minY(){return this._minY}get maxY(){return this._maxY}get tileMapWidth(){return this._width}get tileMapHeight(){return this._height}get planeCount(){return this._planes.length}get floorHeight(){return this._fixedWallHeight!=-1?this._fixedWallHeight:this._floorHeight}get wallHeight(){return this._fixedWallHeight!=-1?this._fixedWallHeight+3.6:this._wallHeight}set wallHeight(e){e<0&&(e=0),this._wallHeight=e}get wallThicknessMultiplier(){return this._wallThicknessMultiplier}set wallThicknessMultiplier(e){e<0&&(e=0),this._wallThicknessMultiplier=e}get floorThicknessMultiplier(){return this._floorThicknessMultiplier}set floorThicknessMultiplier(e){e<0&&(e=0),this._floorThicknessMultiplier=e}dispose(){this._planes=null,this._tileMatrix=null,this._tileMatrixOriginal=null,this._floorHoleMatrix=null,this._floorHoles!=null&&(this._floorHoles.clear(),this._floorHoles=null)}reset(){this._planes=[],this._tileMatrix=[],this._tileMatrixOriginal=[],this._width=0,this._height=0,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._floorHeight=0,this._floorHoleMatrix=[]}initializeTileMap(e,t){e<0&&(e=0),t<0&&(t=0),this._tileMatrix=[],this._tileMatrixOriginal=[],this._floorHoleMatrix=[];let s=0;for(;s<t;){const i=[],n=[],a=[];let o=0;for(;o<e;)i[o]=te.TILE_BLOCKED,n[o]=te.TILE_BLOCKED,a[o]=!1,o++;this._tileMatrix.push(i),this._tileMatrixOriginal.push(n),this._floorHoleMatrix.push(a),s++}return this._width=e,this._height=t,this._minX=this._width,this._maxX=-1,this._minY=this._height,this._maxY=-1,!0}setTileHeight(e,t,s){let i,n,a,o,u;if(e>=0&&e<this._width&&t>=0&&t<this._height){if(i=this._tileMatrix[t],i[e]=s,s>=0)e<this._minX&&(this._minX=e),e>this._maxX&&(this._maxX=e),t<this._minY&&(this._minY=t),t>this._maxY&&(this._maxY=t);else{if(e==this._minX||e==this._maxX){for(n=!1,a=this._minY;a<this._maxY;){if(this.getTileHeightInternal(e,a)>=0){n=!0;break}a++}n||(e==this._minX&&this._minX++,e==this._maxX&&this._maxX--)}if(t==this._minY||t==this._maxY){for(o=!1,u=this._minX;u<this._maxX;){if(this.getTileHeight(u,t)>=0){o=!0;break}u++}o||(t==this._minY&&this._minY++,t==this._maxY&&this._maxY--)}}return!0}return!1}getTileHeight(e,t){if(e<0||e>=this._width||t<0||t>=this._height)return te.TILE_BLOCKED;const s=this._tileMatrix[t];return s[e]===void 0?0:Math.abs(s[e])}getTileHeightOriginal(e,t){return e<0||e>=this._width||t<0||t>=this._height?te.TILE_BLOCKED:this._floorHoleMatrix[t][e]?te.TILE_HOLE:this._tileMatrixOriginal[t][e]}getTileHeightInternal(e,t){return e<0||e>=this._width||t<0||t>=this._height?te.TILE_BLOCKED:this._tileMatrix[t][e]}initializeFromTileData(e=-1){let t,s;for(this._fixedWallHeight=e,s=0;s<this._height;){for(t=0;t<this._width;)this._tileMatrixOriginal[s]===void 0&&(this._tileMatrixOriginal[s]=[]),this._tileMatrixOriginal[s][t]=this._tileMatrix[s][t],t++;s++}const i=te.findEntranceTile(this._tileMatrix);for(s=0;s<this._height;){for(t=0;t<this._width;)this._floorHoleMatrix[s]===void 0&&(this._floorHoleMatrix[s]=[]),this._floorHoleMatrix[s][t]&&this.setTileHeight(t,s,te.TILE_HOLE),t++;s++}return this.initialize(i)}initialize(e){let t=0;e!=null&&(t=this.getTileHeight(e.x,e.y),this.setTileHeight(e.x,e.y,te.TILE_BLOCKED)),this._floorHeight=te.getFloorHeight(this._tileMatrix),this.createWallPlanes();const s=[];for(const n of this._tileMatrix)s.push(n.concat());te.padHeightMap(s),te.addTileTypes(s),te.unpadHeightMap(s);const i=te.expandFloorTiles(s);return this.extractPlanes(i),e!=null&&(this.setTileHeight(e.x,e.y,t),this.addFloor(new y(e.x+.5,e.y+.5,t),new y(-1,0,0),new y(0,-1,0),!1,!1,!1,!1)),!0}generateWallData(e,t){let s,i,n,a,o;const u=new xs,l=[this.extractTopWall.bind(this),this.extractRightWall.bind(this),this.extractBottomWall.bind(this),this.extractLeftWall.bind(this)];let d=0,c=new k(e.x,e.y),_=0;for(;_++<1e3;){if(s=!1,i=!1,n=d,(c.x<this.minX||c.x>this.maxX||c.y<this.minY||c.y>this.maxY)&&(s=!0),a=l[d](c,t),a==null)return null;if(o=Math.abs(a.x-c.x)+Math.abs(a.y-c.y),c.x==a.x||c.y==a.y?(d=(d-1+l.length)%l.length,o=o+1,i=!0):(d=(d+1)%l.length,o--),u.addWall(c,n,o,s,i),a.x==e.x&&a.y==e.y&&(a.x!=c.x||a.y!=c.y))break;c=a}return u.count==0?null:u}hidePeninsulaWallChains(e){let t,s,i,n,a=0;const o=e.count;for(;a<o;){const u=a;for(t=a,s=0,i=!1;!e.getBorder(a)&&a<o;)e.getLeftTurn(a)?s++:s>0&&s--,s>1&&(i=!0),t=a,a++;if(i)for(n=u;n<=t;)e.setHideWall(n,!0),n++;a++}}updateWallsNextToHoles(e){let t,s,i,n,a,o,u;const l=e.count;let d=0;for(;d<l;){if(!e.getHideWall(d)){for(t=e.getCorner(d),s=e.getDirection(d),i=e.getLength(d),n=xs.WALL_DIRECTION_VECTORS[s],a=xs.WALL_NORMAL_VECTORS[s],o=0,u=0;u<i;){if(this.getTileHeightInternal(t.x+u*n.x-a.x,t.y+u*n.y-a.y)==te.TILE_HOLE){if(u>0&&o==0){e.setLength(d,u);break}o++}else if(o>0){e.moveCorner(d,o);break}u++}o==i&&e.setHideWall(d,!0)}d++}}resolveOriginalWallIndex(e,t,s){let i,n,a,o,u,l;const d=Math.min(e.y,t.y),c=Math.max(e.y,t.y),_=Math.min(e.x,t.x),f=Math.max(e.x,t.x),g=s.count;let I=0;for(;I<g;){if(i=s.getCorner(I),n=s.getEndPoint(I),e.x==t.x){if(i.x==e.x&&n.x==e.x&&(a=Math.min(i.y,n.y),o=Math.max(i.y,n.y),a<=d&&c<=o))return I}else if(e.y==t.y&&i.y==e.y&&n.y==e.y&&(u=Math.min(i.x,n.x),l=Math.max(i.x,n.x),u<=_&&f<=l))return I;I++}return-1}hideOriginallyHiddenWalls(e,t){let s,i,n,a,o;const u=e.count;let l=0;for(;l<u;)e.getHideWall(l)||(s=e.getCorner(l),i=new k(s.x,s.y),n=xs.WALL_DIRECTION_VECTORS[e.getDirection(l)],a=e.getLength(l),i.x=i.x+n.x*a,i.y=i.y+n.y*a,o=this.resolveOriginalWallIndex(s,i,t),o>=0?t.getHideWall(o)&&e.setHideWall(l,!0):e.setHideWall(l,!0)),l++}checkWallHiding(e,t){this.hidePeninsulaWallChains(t),this.updateWallsNextToHoles(e),this.hideOriginallyHiddenWalls(e,t)}addWalls(e,t){const s=e.count,i=t.count;let n=0;for(;n<s;){if(!e.getHideWall(n)){const a=e.getCorner(n),o=e.getDirection(n),u=e.getLength(n),l=xs.WALL_DIRECTION_VECTORS[o],d=xs.WALL_NORMAL_VECTORS[o];let c=-1,_=0;for(;_<u;){const x=this.getTileHeightInternal(a.x+_*l.x+d.x,a.y+_*l.y+d.y);x>=0&&(x<c||c<0)&&(c=x),_++}const f=c;let g=new y(a.x,a.y,f);g=y.sum(g,y.product(d,.5)),g=y.sum(g,y.product(l,-.5));const I=this.wallHeight+Math.min(te.MAX_WALL_ADDITIONAL_HEIGHT,this.floorHeight)-c,p=y.product(l,-u),R=new y(0,0,I);g=y.dif(g,p);const S=this.resolveOriginalWallIndex(a,e.getEndPoint(n),t);let O=0,A=0;S>=0?(O=t.getDirection((S+1)%i),A=t.getDirection((S-1+i)%i)):(O=e.getDirection((n+1)%s),A=e.getDirection((n-1+s)%s));let C=null;(O-o+4)%4==3?C=xs.WALL_NORMAL_VECTORS[O]:(o-A+4)%4==3&&(C=xs.WALL_NORMAL_VECTORS[A]);const M=e.getLeftTurn(n),N=e.getLeftTurn((n-1+s)%s),L=e.getHideWall((n+1)%s),b=e.getManuallyLeftCut(n),D=e.getManuallyRightCut(n);this.addWall(g,p,R,C,!N||b,!M||D,!L)}n++}}createWallPlanes(){const e=this._tileMatrix;if(e==null)return!1;let t,s,i;const n=e.length;let a=0;if(n==0)return!1;for(t=0;t<n;){if(i=e[t],i==null||i.length==0)return!1;a>0?a=Math.min(a,i.length):a=i.length,t++}const o=Math.min(te.MAX_WALL_ADDITIONAL_HEIGHT,this._fixedWallHeight!=-1?this._fixedWallHeight:te.getFloorHeight(e)),u=this.minX;let l=this.minY;for(l=this.minY;l<=this.maxY;){if(this.getTileHeightInternal(u,l)>te.TILE_HOLE){l--;break}l++}if(l>this.maxY)return!1;const d=new k(u,l),c=this.generateWallData(d,!0),_=this.generateWallData(d,!1);for(c!=null&&(c.count,_.count,this.checkWallHiding(c,_),this.addWalls(c,_)),s=0;s<this.tileMapHeight;){for(t=0;t<this.tileMapWidth;)this.getTileHeightInternal(t,s)<0&&this.setTileHeight(t,s,-(o+this.wallHeight)),t++;s++}return!0}extractTopWall(e,t){if(e==null)return null;let s=1,i=te.TILE_HOLE;for(t||(i=te.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(e.x+s,e.y)>i)return new k(e.x+s-1,e.y);if(this.getTileHeightInternal(e.x+s,e.y+1)<=i)return new k(e.x+s,e.y+1);s++}return null}extractRightWall(e,t){if(e==null)return null;let s=1,i=te.TILE_HOLE;for(t||(i=te.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(e.x,e.y+s)>i)return new k(e.x,e.y+(s-1));if(this.getTileHeightInternal(e.x-1,e.y+s)<=i)return new k(e.x-1,e.y+s);s++}return null}extractBottomWall(e,t){if(e==null)return null;let s=1,i=te.TILE_HOLE;for(t||(i=te.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(e.x-s,e.y)>i)return new k(e.x-(s-1),e.y);if(this.getTileHeightInternal(e.x-s,e.y-1)<=i)return new k(e.x-s,e.y-1);s++}return null}extractLeftWall(e,t){if(e==null)return null;let s=1,i=te.TILE_HOLE;for(t||(i=te.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(e.x,e.y-s)>i)return new k(e.x,e.y-(s-1));if(this.getTileHeightInternal(e.x+1,e.y-s)<=i)return new k(e.x+1,e.y-s);s++}return null}addWall(e,t,s,i,n,a,o){this.addPlane($e.PLANE_WALL,e,t,s,[i]),this.addPlane($e.PLANE_LANDSCAPE,e,t,s,[i]);const u=te.WALL_THICKNESS*this._wallThicknessMultiplier,l=te.FLOOR_THICKNESS*this._floorThicknessMultiplier,d=y.crossProduct(t,s),c=y.product(d,1/d.length*-u);if(this.addPlane($e.PLANE_WALL,y.sum(e,s),t,c,[d,i]),n&&this.addPlane($e.PLANE_WALL,y.sum(y.sum(e,t),s),y.product(s,-(s.length+l)/s.length),c,[d,i]),a&&(this.addPlane($e.PLANE_WALL,y.sum(e,y.product(s,-l/s.length)),y.product(s,(s.length+l)/s.length),c,[d,i]),o)){const _=y.product(t,u/t.length);this.addPlane($e.PLANE_WALL,y.sum(y.sum(e,s),y.product(_,-1)),_,c,[d,t,i])}}addFloor(e,t,s,i,n,a,o){let u,l,d;this.addPlane($e.PLANE_FLOOR,e,t,s)!=null&&(u=te.FLOOR_THICKNESS*this._floorThicknessMultiplier,l=new y(0,0,u),d=y.dif(e,l),a&&this.addPlane($e.PLANE_FLOOR,d,t,l),o&&this.addPlane($e.PLANE_FLOOR,y.sum(d,y.sum(t,s)),y.product(t,-1),l),i&&this.addPlane($e.PLANE_FLOOR,y.sum(d,s),y.product(s,-1),l),n&&this.addPlane($e.PLANE_FLOOR,y.sum(d,t),s,l))}initializeFromMapData(e){if(!e)return!1;this.reset(),this.resetFloorHoles();const t=e.width,s=e.height,i=e.wallHeight,n=e.fixedWallsHeight;if(this.initializeTileMap(t,s),e.tileMap){let a=0;for(;a<e.tileMap.length;){const o=e.tileMap[a];if(o){let u=0;for(;u<o.length;){const l=o[u];l&&this.setTileHeight(u,a,l.height),u++}}a++}}if(e.holeMap&&e.holeMap.length){let a=0;for(;a<e.holeMap.length;){const o=e.holeMap[a];o&&(this.addFloorHole(o.id,o.x,o.y,o.width,o.height),a++)}this.initializeHoleMap()}return this.wallHeight=i,this.restrictsDragging=e.restrictsDragging,this.restrictsScaling=e.restrictsScaling,this.restrictedScale=e.restrictedScale,this.initializeFromTileData(n),!0}addPlane(e,t,s,i,n=null){if(s.length==0||i.length==0)return null;const a=new $e(e,t,s,i,n);return this._planes.push(a),a}getMapData(){const e=new Xp;e.width=this._width,e.height=this._height,e.wallHeight=this._wallHeight,e.fixedWallsHeight=this._fixedWallHeight,e.dimensions.minX=this.minX,e.dimensions.maxX=this.maxX,e.dimensions.minY=this.minY,e.dimensions.maxY=this.maxY,e.restrictsDragging=this.restrictsDragging,e.restrictsScaling=this.restrictsScaling,e.restrictedScale=this.restrictedScale;let t=0;for(;t<this._height;){const s=[],i=this._tileMatrixOriginal[t];let n=0;for(;n<this._width;){const a=i[n];s.push({height:a}),n++}e.tileMap.push(s),t++}for(const[s,i]of this._floorHoles.entries())i&&e.holeMap.push({id:s,x:i.x,y:i.y,width:i.width,height:i.height});return e}getPlaneLocation(e){if(e<0||e>=this.planeCount)return null;const t=this._planes[e];return t?t.loc:null}getPlaneNormal(e){if(e<0||e>=this.planeCount)return null;const t=this._planes[e];return t?t.normal:null}getPlaneLeftSide(e){if(e<0||e>=this.planeCount)return null;const t=this._planes[e];return t?t.leftSide:null}getPlaneRightSide(e){if(e<0||e>=this.planeCount)return null;const t=this._planes[e];return t?t.rightSide:null}getPlaneNormalDirection(e){if(e<0||e>=this.planeCount)return null;const t=this._planes[e];return t?t.normalDirection:null}getPlaneSecondaryNormals(e){let t,s;if(e<0||e>=this.planeCount)return null;const i=this._planes[e];if(i!=null){for(t=[],s=0;s<i.secondaryNormalCount;)t.push(i.getSecondaryNormal(s)),s++;return t}return null}getPlaneType(e){if(e<0||e>=this.planeCount)return $e.PLANE_UNDEFINED;const t=this._planes[e];return t?t.type:$e.PLANE_UNDEFINED}getPlaneMaskCount(e){if(e<0||e>=this.planeCount)return 0;const t=this._planes[e];return t?t.maskCount:0}getPlaneMaskLeftSideLoc(e,t){if(e<0||e>=this.planeCount)return-1;const s=this._planes[e];return s?s.getMaskLeftSideLoc(t):-1}getPlaneMaskRightSideLoc(e,t){if(e<0||e>=this.planeCount)return-1;const s=this._planes[e];return s?s.getMaskRightSideLoc(t):-1}getPlaneMaskLeftSideLength(e,t){if(e<0||e>=this.planeCount)return-1;const s=this._planes[e];return s?s.getMaskLeftSideLength(t):-1}getPlaneMaskRightSideLength(e,t){if(e<0||e>=this.planeCount)return-1;const s=this._planes[e];return s?s.getMaskRightSideLength(t):-1}addFloorHole(e,t,s,i,n){this.removeFloorHole(e),this._floorHoles.set(e,new S3(t,s,i,n))}removeFloorHole(e){this._floorHoles.delete(e)}resetFloorHoles(){this._floorHoles.clear()}initializeHoleMap(){let e,t,s,i,n,a,o,u;for(t=0;t<this._height;){for(s=this._floorHoleMatrix[t],e=0;e<this._width;)s[e]=!1,e++;t++}for(const l of this._floorHoles.values())if(i=l,i!=null)for(n=i.x,a=i.x+i.width-1,o=i.y,u=i.y+i.height-1,n=n<0?0:n,a=a>=this._width?this._width-1:a,o=o<0?0:o,u=u>=this._height?this._height-1:u,t=o;t<=u;){for(s=this._floorHoleMatrix[t],e=n;e<=a;)s[e]=!0,e++;t++}}extractPlanes(e){let t,s,i,n,a,o,u,l,d,c,_,f,g,I,p;const R=e.length,S=e[0].length,O=[];let A=0;for(;A<R;)O[A]=[],A++;let C=0;for(;C<R;){for(t=0;t<S;){if(s=e[C][t],!(s<0||O[C][t])){for(a=t==0||e[C][t-1]!=s,o=C==0||e[C-1][t]!=s,i=t+1;i<S&&!(e[C][i]!=s||O[C][i]||C>0&&e[C-1][i]==s==o);)i++;for(u=i==S||e[C][i]!=s,_=!1,n=C+1;n<R&&!_;){for(l=e[n][t]!=s,_=l||t>0&&e[n][t-1]==s==a||i<S&&e[n][i]==s==u,d=t;d<i;){if(e[n][d]==s==l){_=!0,i=d;break}d++}if(_)break;n++}for(l=l||n==R,u=i==S||e[C][i]!=s,c=C;c<n;){for(d=t;d<i;)O[c][d]=!0,d++;c++}f=t/4-.5,g=C/4-.5,I=(i-t)/4,p=(n-C)/4,this.addFloor(new y(f+I,g+p,s/4),new y(-I,0,0),new y(0,-p,0),u,a,l,o)}t++}C++}}get restrictsDragging(){return this._restrictsDragging}set restrictsDragging(e){this._restrictsDragging=e}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(e){this._restrictsScaling=e}get restrictedScale(){return this._restrictedScale}set restrictedScale(e){this._restrictedScale=e}}te.FLOOR_THICKNESS=.25,te.WALL_THICKNESS=.25,te.MAX_WALL_ADDITIONAL_HEIGHT=20,te.TILE_BLOCKED=-110,te.TILE_HOLE=-100;class A3 extends mu{constructor(){super(),this._planeParser=new te,this._planeBitmapMaskParser=new Kp,this._color=16777215,this._light=255,this._originalColor=16777215,this._originalLight=255,this._targetColor=16777215,this._targetLight=255,this._colorChangedTime=0,this._colorTransitionLength=1500,this._lastHoleUpdate=0,this._needsMapUpdate=!1,this._skipColorTransition=!1}getEventTypes(){const e=[re.MOUSE_MOVE,re.CLICK];return this.mergeTypes(super.getEventTypes(),e)}dispose(){super.dispose(),this._planeParser&&(this._planeParser.dispose(),this._planeParser=null),this._planeBitmapMaskParser&&(this._planeBitmapMaskParser.dispose(),this._planeBitmapMaskParser=null)}initialize(e){!e||!this.object||e instanceof Xp&&this._planeParser.initializeFromMapData(e)&&(this.object.model.setValue(T.ROOM_MAP_DATA,e),this.object.model.setValue(T.ROOM_BACKGROUND_COLOR,16777215),this.object.model.setValue(T.ROOM_FLOOR_VISIBILITY,1),this.object.model.setValue(T.ROOM_WALL_VISIBILITY,1),this.object.model.setValue(T.ROOM_LANDSCAPE_VISIBILITY,1),this._skipColorTransition=ue.getValue("room.color.skip.transition")===!0)}update(e){if(super.update(e),this.updateBackgroundColor(e),this._needsMapUpdate){if(this._lastHoleUpdate&&e-this._lastHoleUpdate<5)return;const t=this.object&&this.object.model;if(t){const s=this._planeParser.getMapData();t.setValue(T.ROOM_MAP_DATA,s),t.setValue(T.ROOM_FLOOR_HOLE_UPDATE_TIME,e),this._planeParser.initializeFromMapData(s)}this._lastHoleUpdate=0,this._needsMapUpdate=!1}}updateBackgroundColor(e){if(!this.object||!this._colorChangedTime)return;let t=this._color,s=this._light;if(e-this._colorChangedTime>=this._colorTransitionLength)t=this._targetColor,s=this._targetLight,this._colorChangedTime=0;else{let n=this._originalColor>>16&255,a=this._originalColor>>8&255,o=this._originalColor&255;const u=this._targetColor>>16&255,l=this._targetColor>>8&255,d=this._targetColor&255,c=(e-this._colorChangedTime)/this._colorTransitionLength;n=n+(u-n)*c,a=a+(l-a)*c,o=o+(d-o)*c,t=(n<<16)+(a<<8)+o,s=this._originalLight+(this._targetLight-this._originalLight)*c,this._color=t,this._light=s}let i=Zs.rgbToHSL(t);i=(i&16776960)+s,t=Zs.hslToRGB(i),this.object.model&&this.object.model.setValue(T.ROOM_BACKGROUND_COLOR,t)}processUpdateMessage(e){if(!e||!this.object)return;const t=this.object.model;if(t){if(e instanceof wt){this.onObjectRoomUpdateMessage(e,t);return}if(e instanceof Ft){this.onObjectRoomMaskUpdateMessage(e,t);return}if(e instanceof fi){this.onObjectRoomPlaneVisibilityUpdateMessage(e,t);return}if(e instanceof di){this.onObjectRoomPlanePropertyUpdateMessage(e,t);return}if(e instanceof _i){this.onObjectRoomFloorHoleUpdateMessage(e,t);return}if(e instanceof Qu){this.onObjectRoomColorUpdateMessage(e,t);return}e instanceof Yo&&this.onObjectRoomMapUpdateMessage(e)}}onObjectRoomUpdateMessage(e,t){switch(e.type){case wt.ROOM_FLOOR_UPDATE:t.setValue(T.ROOM_FLOOR_TYPE,e.value);return;case wt.ROOM_WALL_UPDATE:t.setValue(T.ROOM_WALL_TYPE,e.value);return;case wt.ROOM_LANDSCAPE_UPDATE:t.setValue(T.ROOM_LANDSCAPE_TYPE,e.value);return}}onObjectRoomMaskUpdateMessage(e,t){let s=null,i=!1;switch(e.type){case Ft.ADD_MASK:s=Un.WINDOW,e.maskCategory===Ft.HOLE&&(s=Un.HOLE),this._planeBitmapMaskParser.addMask(e.maskId,e.maskType,e.maskLocation,s),i=!0;break;case Ft.REMOVE_MASK:i=this._planeBitmapMaskParser.removeMask(e.maskId);break}i&&t.setValue(T.ROOM_PLANE_MASK_XML,this._planeBitmapMaskParser.getXML())}onObjectRoomPlaneVisibilityUpdateMessage(e,t){let s=0;switch(e.visible&&(s=1),e.type){case fi.FLOOR_VISIBILITY:t.setValue(T.ROOM_FLOOR_VISIBILITY,s);return;case fi.WALL_VISIBILITY:t.setValue(T.ROOM_WALL_VISIBILITY,s),t.setValue(T.ROOM_LANDSCAPE_VISIBILITY,s);return}}onObjectRoomPlanePropertyUpdateMessage(e,t){switch(e.type){case di.FLOOR_THICKNESS:t.setValue(T.ROOM_FLOOR_THICKNESS,e.value);return;case di.WALL_THICKNESS:t.setValue(T.ROOM_WALL_THICKNESS,e.value);return}}onObjectRoomFloorHoleUpdateMessage(e,t){switch(e.type){case _i.ADD:this._planeParser.addFloorHole(e.id,e.x,e.y,e.width,e.height),this._needsMapUpdate=!0;return;case _i.REMOVE:this._planeParser.removeFloorHole(e.id),this._needsMapUpdate=!0;return}this._lastHoleUpdate=this.time}onObjectRoomColorUpdateMessage(e,t){!e||!t||(this._originalColor=this._color,this._originalLight=this._light,this._targetColor=e.color,this._targetLight=e.light,this._colorChangedTime=this.time,this._skipColorTransition?this._colorTransitionLength=0:this._colorTransitionLength=1500,t.setValue(T.ROOM_COLORIZE_BG_ONLY,e.backgroundOnly))}onObjectRoomMapUpdateMessage(e){!e||!e.mapData||(this.object.model.setValue(T.ROOM_MAP_DATA,e.mapData),this.object.model.setValue(T.ROOM_FLOOR_HOLE_UPDATE_TIME,this.time),this._planeParser.initializeFromMapData(e.mapData))}mouseEvent(e,t){if(!e||!t||!this.object||!this.object.model)return;const s=e.spriteTag;let i=0;if(s&&s.indexOf("@")>=0&&(i=parseInt(s.substr(s.indexOf("@")+1))),i<1||i>this._planeParser.planeCount){e.type===W.ROLL_OUT&&this.object.model.setValue(T.ROOM_SELECTED_PLANE,0);return}i--;let n=null;const a=this._planeParser.getPlaneLocation(i),o=this._planeParser.getPlaneLeftSide(i),u=this._planeParser.getPlaneRightSide(i),l=this._planeParser.getPlaneNormalDirection(i),d=this._planeParser.getPlaneType(i);if(a==null||o==null||u==null||l==null)return;const c=o.length,_=u.length;if(c==0||_==0)return;const f=e.screenX,g=e.screenY,I=new k(f,g);if(n=t.getPlanePosition(I,a,o,u),!n){this.object.model.setValue(T.ROOM_SELECTED_PLANE,0);return}const p=y.product(o,n.x/c);p.add(y.product(u,n.y/_)),p.add(a);const R=p.x,S=p.y,O=p.z;if(n.x>=0&&n.x<c&&n.y>=0&&n.y<_)this.object.model.setValue(T.ROOM_SELECTED_X,R),this.object.model.setValue(T.ROOM_SELECTED_Y,S),this.object.model.setValue(T.ROOM_SELECTED_Z,O),this.object.model.setValue(T.ROOM_SELECTED_PLANE,i+1);else{this.object.model.setValue(T.ROOM_SELECTED_PLANE,0);return}let A=null;switch(e.type===W.MOUSE_MOVE||e.type===W.ROLL_OVER?A=re.MOUSE_MOVE:e.type===W.MOUSE_CLICK&&(A=re.CLICK),e.type){case W.MOUSE_MOVE:case W.ROLL_OVER:case W.MOUSE_CLICK:{let C=null;if(d===$e.PLANE_FLOOR)C=new ii(A,this.object,e.eventId,R,S,O,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);else if(d===$e.PLANE_WALL||d===$e.PLANE_LANDSCAPE){let M=90;l&&(M=l.x+90,M>360&&(M-=360));const N=o.length*n.x/c,L=u.length*n.y/_;C=new ma(A,this.object,e.eventId,a,o,u,N,L,M,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown)}this.eventDispatcher&&this.eventDispatcher.dispatchEvent(C);return}}}}class y3 extends mu{initialize(e){this.object&&(this.object.model.setValue(T.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(1,0))}processUpdateMessage(e){if(super.processUpdateMessage(e),e instanceof gi&&this.object)switch(e.type){case gi.ENABLED:this.object.setState(0,0);return;case gi.DISABLED:this.object.setState(1,0);return}}}class Fr extends mu{constructor(){super(),this._lastEventId=null,this._isHidden=!1}initialize(e){this.object&&(this.object.model.setValue(T.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(Fr.CURSOR_HIDDEN_STATE,0))}processUpdateMessage(e){e instanceof ba&&(this._lastEventId&&this._lastEventId===e.sourceEventId||(e.toggleVisibility&&(this._isHidden=!this._isHidden),super.processUpdateMessage(e),this.object&&(this._isHidden?this.object.setState(Fr.CURSOR_HIDDEN_STATE,0):e.visible?(this.object.model.setValue(T.TILE_CURSOR_HEIGHT,e.height),this.object.setState(e.height>.8?Fr.CURSOR_HEIGHT_STATE:Fr.CURSOR_VISIBLE_STATE)):this.object.setState(Fr.CURSOR_HIDDEN_STATE,0)),this._lastEventId=e.sourceEventId))}}Fr.CURSOR_VISIBLE_STATE=0,Fr.CURSOR_HIDDEN_STATE=1,Fr.CURSOR_HEIGHT_STATE=6;class qp{constructor(e,t,s){this._id=e,this._type=t,this._visualization=s}dispose(){this._visualization=null}update(e,t){}animate(e){return!1}get id(){return this._id}get type(){return this._type}get visualization(){return this._visualization}}class Ns extends qp{constructor(e,t,s){super(e,t,s),this._asset=null,this._startTime=ve(),this._delta=0,this._offsetY=0,this._scale=0,this._state=0}update(e,t){if(!e)return;this._scale=t;let s=64,i=0;if(t<48?(this._asset=this.visualization.getAvatarRenderAsset("avatar_addition_user_blowkiss_small"),this.visualization.angle===90||this.visualization.angle===270?i=0:this.visualization.angle===135||this.visualization.angle===180||this.visualization.angle===225?i=6:i=-6,this._offsetY=-38,s=32):(this._asset=this.visualization.getAvatarRenderAsset("avatar_addition_user_blowkiss"),this.visualization.angle===90||this.visualization.angle===270?i=-3:this.visualization.angle===135||this.visualization.angle===180||this.visualization.angle===225?i=22:i=-30,this._offsetY=-70),this.visualization.posture===F.POSTURE_SIT?this._offsetY+=s/2:this.visualization.posture===F.POSTURE_LAY&&(this._offsetY+=s),this._asset){e.texture=this._asset,e.offsetX=i,e.offsetY=this._offsetY,e.relativeDepth=-.02,e.alpha=0;const n=this._delta;this.animate(e),this._delta=n}}animate(e){if(!e)return!1;if(this._asset&&(e.texture=this._asset),this._state===Ns.STATE_DELAY)return ve()-this._startTime<Ns.DELAY_BEFORE_ANIMATION?!1:(this._state=Ns.STATE_FADE_IN,e.alpha=0,e.visible=!0,this._delta=0,!0);if(this._state===Ns.STATE_FADE_IN)return this._delta+=.1,e.offsetY=this._offsetY,e.alpha=Math.pow(this._delta,.9)*255,this._delta>=1&&(e.alpha=255,this._delta=0,this._state=Ns.STATE_FLOAT),!0;if(this._state===Ns.STATE_FLOAT){const t=Math.pow(this._delta,.9);this._delta+=.05;const s=this._scale<48?-30:-40;return e.offsetY=this._offsetY+(this._delta<1?t:1)*s,e.alpha=(1-t)*255,e.alpha<=0&&(e.visible=!1,this._state=Ns.STATE_COMPLETE),!0}return!1}}Ns.DELAY_BEFORE_ANIMATION=300,Ns.STATE_DELAY=0,Ns.STATE_FADE_IN=1,Ns.STATE_FLOAT=2,Ns.STATE_COMPLETE=3;class La{static getExpressionAddition(e,t,s){switch(t){case this.BLOW:return new Ns(e,this.BLOW,s);default:return new qp(e,t,s)}}}La.WAVE=1,La.BLOW=2,La.LAUGH=3,La.CRY=4,La.IDLE=5;class Qt{constructor(e,t){this._id=e,this._visualization=t,this._asset=null,this._startTime=ve(),this._offsetY=0,this._scale=0,this._state=0}dispose(){this._visualization=null,this._asset=null}getSpriteAssetName(e){let t="left";return(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270)&&(t="right"),"avatar_addition_user_idle_"+t+"_"+e+(this._scale<48?"_small":"")}update(e,t){if(!e)return;this._scale=t,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(this._state===Qt.STATE_FRAME_A?1:2));let s=64,i=0;t<48?(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270?i=10:i=-16,this._offsetY=-38,s=32):(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270?i=22:i=-30,this._offsetY=-70),this._visualization.posture===F.POSTURE_SIT?this._offsetY+=s/2:this._visualization.posture===F.POSTURE_LAY&&(this._offsetY+=s-.3*s),this._asset&&(e.texture=this._asset,e.offsetX=i,e.offsetY=this._offsetY,e.relativeDepth=-.02,e.alpha=0)}animate(e){if(!e)return!1;const t=ve();return this._state===Qt.STATE_DELAY&&t-this._startTime>=Qt.DELAY_BEFORE_ANIMATION&&(this._state=Qt.STATE_FRAME_A,this._startTime=t,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(1))),this._state===Qt.STATE_FRAME_A&&t-this._startTime>=Qt.DELAY_PER_FRAME&&(this._state=Qt.STATE_FRAME_B,this._startTime=t,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(2))),this._state===Qt.STATE_FRAME_B&&t-this._startTime>=Qt.DELAY_PER_FRAME&&(this._state=Qt.STATE_FRAME_A,this._startTime=t,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(1))),this._asset?(e.texture=this._asset,e.alpha=255,e.visible=!0):e.visible=!1,!1}get id(){return this._id}}Qt.DELAY_BEFORE_ANIMATION=2e3,Qt.DELAY_PER_FRAME=2e3,Qt.STATE_DELAY=0,Qt.STATE_FRAME_A=1,Qt.STATE_FRAME_B=2;class wr{constructor(e){this._id=e,this._asset=null,this._disposed=!1}dispose(){this._asset=null}update(e,t){if(e){if(!this._asset){const s=new Ze(Re.WHITE);s.alpha=0,s.width=wr.WIDTH,s.height=wr.HEIGHT,this._asset=Je.generateTexture(s)}e.visible=!0,e.texture=this._asset,e.offsetX=wr.OFFSET_X,e.offsetY=wr.OFFSET_Y,e.alphaTolerance=Ks.MATCH_ALL_PIXELS}}animate(e){return!1}get id(){return this._id}}wr.WIDTH=46,wr.HEIGHT=60,wr.OFFSET_X=-23,wr.OFFSET_Y=-48;class C3{constructor(e,t,s){this._id=e,this._visualization=t,this._asset=null,this._relativeDepth=0,this._status=s}dispose(){this._visualization=null,this._asset=null}update(e,t){if(!e)return;e.visible=!0,e.relativeDepth=this._relativeDepth,e.alpha=255;let s=64,i=0,n=0;this._asset=this._visualization.getAvatarRenderAsset(this._status===ar.GUIDE?"avatar_addition_user_guide_bubble":"avatar_addition_user_guide_requester_bubble"),t<48?(i=-19,n=-80,s=32):(i=-19,n=-120),this._visualization.posture===F.POSTURE_SIT?n+=s/2:this._visualization.posture===F.POSTURE_LAY&&(n+=t),this._asset&&(e.texture=this._asset,e.offsetX=i,e.offsetY=n,e.relativeDepth=-.02+0)}animate(e){return this._asset&&e&&(e.texture=this._asset),!1}get id(){return this._id}get relativeDepth(){return this._relativeDepth}set relativeDepth(e){this._relativeDepth=e}}class M3{constructor(e,t){this._id=e,this._visualization=t,this._asset=null}dispose(){this._visualization=null,this._asset=null}update(e,t){if(!e)return;let s=64,i=0,n=0;t<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_muted_small"),s=32,i=-12,n=-66):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_muted"),i=-15,n=-110),this._visualization.posture===F.POSTURE_SIT?n+=s/2:this._visualization.posture===F.POSTURE_LAY&&(n+=t),this._asset?(e.visible=!0,e.texture=this._asset,e.offsetX=i,e.offsetY=n,e.relativeDepth=-.02):e.visible=!1}animate(e){return this._asset&&e&&(e.texture=this._asset),!1}get id(){return this._id}}class P3{constructor(e,t,s){this._id=e,this._visualization=s,this._asset=null,this._scale=0,this._number=t,this._numberValueFadeDirection=0,this._numberValueMoving=!1,this._numberValueMoveCounter=0}dispose(){this._visualization=null,this._asset=null}update(e,t){if(!e)return;this._scale=t;let s=64,i=0,n=0;this._number>0?(t<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_number_"+this._number+"_small"),s=32,i=-6,n=-52):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_number_"+this._number),i=-8,n=-105),this._visualization.posture===F.POSTURE_SIT?n+=s/2:this._visualization.posture===F.POSTURE_LAY&&(n+=t),this._asset?(e.visible=!0,e.texture=this._asset,e.offsetX=i,e.offsetY=n,e.relativeDepth=-.01,e.alpha=0,this._numberValueFadeDirection=1,this._numberValueMoving=!0,this._numberValueMoveCounter=0):e.visible=!1):e.visible&&(this._numberValueFadeDirection=-1)}animate(e){if(!e)return!1;this._asset&&(e.texture=this._asset);let t=e.alpha,s=!1;if(this._numberValueMoving){if(this._numberValueMoveCounter++,this._numberValueMoveCounter<10)return!1;if(this._numberValueFadeDirection<0)this._scale<48?e.offsetY-=2:e.offsetY-=4;else{let i=4;this._scale<48&&(i=8),this._numberValueMoveCounter%i||(e.offsetY--,s=!0)}}return this._numberValueFadeDirection>0?(t<255&&(t+=32),t>=255&&(t=255,this._numberValueFadeDirection=0),e.alpha=t,!0):this._numberValueFadeDirection<0?(t>=0&&(t-=32),t<=0&&(this._numberValueFadeDirection=0,this._numberValueMoving=!1,t=0,e.visible=!1),e.alpha=t,!0):s}get id(){return this._id}}class N3{constructor(e,t){this._id=e,this._visualization=t,this._asset=null,this._relativeDepth=0}dispose(){this._visualization=null,this._asset=null}update(e,t){if(!e)return;e.visible=!0,e.relativeDepth=this._relativeDepth,e.alpha=255;let s=64,i=0,n=0;t<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_typing_small"),i=3,n=-42,s=32):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_typing"),i=14,n=-83),this._visualization.posture===F.POSTURE_SIT?n+=s/2:this._visualization.posture===F.POSTURE_LAY&&(n+=t),this._asset&&(e.texture=this._asset,e.offsetX=i,e.offsetY=n,e.relativeDepth=-.02+0)}animate(e){return this._asset&&e&&(e.texture=this._asset),!1}get id(){return this._id}get relativeDepth(){return this._relativeDepth}set relativeDepth(e){this._relativeDepth=e}}class $u extends Ss{constructor(){super()}initialize(e){return!0}onDispose(){this._avatarRenderer=null}createAvatarImage(e,t,s=null,i=null,n=null){let a=null;return t>48?a=this._avatarRenderer.createAvatarImage(e,Cr.LARGE,s,i,n):a=this._avatarRenderer.createAvatarImage(e,Cr.SMALL,s,i,n),a}getAvatarRendererAsset(e){return this._avatarRenderer?this._avatarRenderer.assets.getTexture(e):null}get avatarManager(){return this._avatarRenderer}set avatarManager(e){this._avatarRenderer=e}get layerCount(){return 0}}class z extends Mn{constructor(){super(),this._data=null,this._avatarImage=null,this._cachedAvatars=new Ot,this._cachedAvatarEffects=new Ot,this._shadow=null,this._lastUpdate=-1e3,this._disposed=!1,this._figure=null,this._gender=null,this._direction=-1,this._headDirection=-1,this._posture="",this._postureParameter="",this._canStandUp=!1,this._postureOffset=0,this._verticalOffset=0,this._angle=-1,this._headAngle=-1,this._talk=!1,this._expression=0,this._sleep=!1,this._blink=!1,this._gesture=0,this._sign=-1,this._highlightEnabled=!1,this._highlight=!1,this._dance=0,this._effect=0,this._carryObject=0,this._useObject=0,this._ownUser=!1,this._isLaying=!1,this._layInside=!1,this._isAnimating=!1,this._extraSpritesStartIndex=2,this._forcedAnimFrames=0,this._updatesUntilFrameUpdate=0,this._isAvatarReady=!1,this._needsUpdate=!1,this._geometryUpdateCounter=-1,this._additions=new Map}initialize(e){return e instanceof $u?(this._data=e,this.createSprites(z.INITIAL_RESERVED_SPRITES),super.initialize(e),!0):!1}dispose(){this._disposed||(super.dispose(),this._avatarImage&&this._avatarImage.dispose(),this._shadow=null,this._disposed=!0)}update(e,t,s,i){if(!this.object||!e||!this._data||t<this._lastUpdate+z.UPDATE_TIME_INCREASER)return;this._lastUpdate+=z.UPDATE_TIME_INCREASER,this._lastUpdate+z.UPDATE_TIME_INCREASER<t&&(this._lastUpdate=t-z.UPDATE_TIME_INCREASER);const n=this.object.model,a=e.scale,o=this._effect;let u=!1,l=!1,d=!1,c=!1;const _=this.updateModel(n,a);if(_||a!==this._scale||!this._avatarImage){if(a!==this._scale&&(u=!0,this.updateScale(a)),o!==this._effect&&(l=!0),u||!this._avatarImage||l){if(this._avatarImage=this.createAvatarImage(a,this._effect),!this._avatarImage)return;d=!0;const I=this.getSprite(z.AVATAR_LAYER_ID);I&&this._avatarImage&&this._avatarImage.isPlaceholder()?I.alpha=150:I&&(I.alpha=255)}if(!this._avatarImage)return;if(l&&this._avatarImage.animationHasResetOnToggle&&this._avatarImage.resetAnimationFrameCounter(),this.updateShadow(a),c=this.updateObject(this.object,e,s,!0),this.processActionsForAvatar(this._avatarImage),this._additions){let I=this._extraSpritesStartIndex;for(const p of this._additions.values())p.update(this.getSprite(I++),a)}this._scale=a}else c=this.updateObject(this.object,e,s);if(this._additions){let I=this._extraSpritesStartIndex;for(const p of this._additions.values())p.animate(this.getSprite(I++))&&this.updateSpriteCounter++}const f=c||_||u,g=(this._isAnimating||this._forcedAnimFrames>0)&&s;if(f&&(this._forcedAnimFrames=z.ANIMATION_FRAME_UPDATE_INTERVAL),f||g){if(this.updateSpriteCounter++,this._forcedAnimFrames--,this._updatesUntilFrameUpdate--,this._updatesUntilFrameUpdate<=0||u||_||d)this._avatarImage.updateAnimationByFrames(1),this._updatesUntilFrameUpdate=z.ANIMATION_FRAME_UPDATE_INTERVAL;else return;let I=this._avatarImage.getCanvasOffsets();(!I||I.length<3)&&(I=z.DEFAULT_CANVAS_OFFSETS);const p=this.getSprite(z.SPRITE_INDEX_AVATAR);if(p){const A=this.object.model.getValue(T.FIGURE_HIGHLIGHT_ENABLE)===1&&this.object.model.getValue(T.FIGURE_HIGHLIGHT)===1,C=this._avatarImage.getImage(rs.FULL,A);C&&(p.texture=C,A||(p.filters=[])),p.texture&&(p.offsetX=-1*a/2+I[0]-(p.texture.width-a)/2,p.offsetY=-p.texture.height+a/4+I[1]+this._postureOffset),this._isLaying?this._layInside?p.relativeDepth=-.5:p.relativeDepth=z.AVATAR_SPRITE_LAYING_DEPTH+I[2]:p.relativeDepth=z.AVATAR_SPRITE_DEFAULT_DEPTH+I[2],this._ownUser?(p.relativeDepth-=z.AVATAR_OWN_DEPTH_ADJUST,p.spriteType=cs.AVATAR_OWN):p.spriteType=cs.AVATAR}const R=this.getAddition(z.TYPING_BUBBLE_ID);R&&(this._isLaying?R.relativeDepth=z.AVATAR_SPRITE_LAYING_DEPTH-.01+I[2]:R.relativeDepth=z.AVATAR_SPRITE_DEFAULT_DEPTH-.01+I[2]),this._isAnimating=this._avatarImage.isAnimating();let S=z.INITIAL_RESERVED_SPRITES;const O=this._avatarImage.getDirection();for(const A of this._avatarImage.getSprites())if(A.id===z.AVATAR){const C=this.getSprite(z.SPRITE_INDEX_AVATAR);if(C){const M=this._avatarImage.getLayerData(A);let N=A.getDirectionOffsetX(O),L=A.getDirectionOffsetY(O);M&&(N+=M.dx,L+=M.dy),a<48&&(N/=2,L/=2),this._canStandUp||(C.offsetX+=N,C.offsetY+=L)}}else{const C=this.getSprite(S);if(C){C.alphaTolerance=Ks.MATCH_NOTHING,C.visible=!0;const M=this._avatarImage.getLayerData(A);let N=0,L=A.getDirectionOffsetX(O),b=A.getDirectionOffsetY(O);const D=A.getDirectionOffsetZ(O);let x=0;A.hasDirections&&(x=O),M&&(N=M.animationFrame,L+=M.dx,b+=M.dy,x+=M.dd),a<48&&(L/=2,b/=2),x<0?x+=8:x>7&&(x-=8);const q=this._avatarImage.getScale()+"_"+A.member+"_"+x+"_"+N,$=this._avatarImage.getAsset(q);if(!$)continue;C.texture=$.texture,C.offsetX=$.offsetX-a/2+L,C.offsetY=$.offsetY+b,C.flipH=$.flipH,A.hasStaticY?C.offsetY+=this._verticalOffset*a/(2*z.BASE_Y_SCALE):C.offsetY+=this._postureOffset,this._isLaying?C.relativeDepth=z.AVATAR_SPRITE_LAYING_DEPTH-.001*this.totalSprites*D:C.relativeDepth=z.AVATAR_SPRITE_DEFAULT_DEPTH-.001*this.totalSprites*D,A.ink===33?C.blendMode=se.ADD:C.blendMode=se.NORMAL}S++}}}createAvatarImage(e,t){let s=null,i="avatarImage"+e.toString();if(t?(i+="-"+t,s=this._cachedAvatarEffects.getValue(i)):s=this._cachedAvatars.getValue(i),!s&&(s=this._data.createAvatarImage(this._figure,e,this._gender,this,this),s))if(!t)this._cachedAvatars.add(i,s);else{if(this._cachedAvatarEffects.length>=z.MAX_EFFECT_CACHE){const n=this._cachedAvatarEffects.remove(this._cachedAvatarEffects.getKey(0));n&&n.dispose()}this._cachedAvatarEffects.add(i,s)}return s}updateObject(e,t,s,i=!1){if(!i&&this.updateObjectCounter===e.updateCounter&&this._geometryUpdateCounter===t.updateId)return!1;let n=e.getDirection().x-t.direction.x,a=this._headDirection-t.direction.x;return this._posture==="float"&&(a=n),n=(n%360+360)%360,a=(a%360+360)%360,this._posture==="sit"&&this._canStandUp&&(n-=n%90-45,a-=a%90-45),(n!==this._angle||i)&&(s=!0,this._angle=n,n=n-(135-22.5),n=(n+360)%360,this._avatarImage.setDirectionAngle(rs.FULL,n)),(a!==this._headAngle||i)&&(s=!0,this._headAngle=a,this._headAngle!==this._angle&&(a=a-(135-22.5),a=(a+360)%360,this._avatarImage.setDirectionAngle(rs.HEAD,a))),this._geometryUpdateCounter=t.updateId,this.updateObjectCounter=this.object.updateCounter,s}updateModel(e,t){if(!e||this.updateModelCounter===e.updateCounter)return!1;let s=!1;const i=e.getValue(T.FIGURE_TALK)>0;i!==this._talk&&(this._talk=i,s=!0);const n=e.getValue(T.FIGURE_EXPRESSION);n!==this._expression&&(this._expression=n,s=!0);const a=e.getValue(T.FIGURE_SLEEP)>0;a!==this._sleep&&(this._sleep=a,s=!0);const o=e.getValue(T.FIGURE_BLINK)>0;o!==this._blink&&(this._blink=o,s=!0);const u=e.getValue(T.FIGURE_GESTURE)||0;u!==this._gesture&&(this._gesture=u,s=!0);const l=e.getValue(T.FIGURE_POSTURE);l!==this._posture&&(this._posture=l,s=!0);const d=e.getValue(T.FIGURE_POSTURE_PARAMETER);d!==this._postureParameter&&(this._postureParameter=d,s=!0);const c=e.getValue(T.FIGURE_CAN_STAND_UP);c!==this._canStandUp&&(this._canStandUp=c,s=!0);const _=e.getValue(T.FIGURE_VERTICAL_OFFSET)*z.BASE_Y_SCALE;_!==this._verticalOffset&&(this._verticalOffset=_,s=!0);const f=e.getValue(T.FIGURE_DANCE)||0;f!==this._dance&&(this._dance=f,s=!0);const g=e.getValue(T.FIGURE_EFFECT)||0;g!==this._effect&&(this._effect=g,s=!0);const I=e.getValue(T.FIGURE_CARRY_OBJECT)||0;I!==this._carryObject&&(this._carryObject=I,s=!0);const p=e.getValue(T.FIGURE_USE_OBJECT)||0;p!==this._useObject&&(this._useObject=p,s=!0);const R=e.getValue(T.HEAD_DIRECTION);R!==this._headDirection&&(this._headDirection=R,s=!0),this._carryObject>0&&p>0?this._useObject!==this._carryObject&&(this._useObject=this._carryObject,s=!0):this._useObject!==0&&(this._useObject=0,s=!0);let S=this.getAddition(z.FLOATING_IDLE_Z_ID);this._sleep?(S||(S=this.addAddition(new Qt(z.FLOATING_IDLE_Z_ID,this))),s=!0):S&&this.removeAddition(z.FLOATING_IDLE_Z_ID);const O=e.getValue(T.FIGURE_IS_MUTED)>0;let A=this.getAddition(z.MUTED_BUBBLE_ID);if(O)A||(A=this.addAddition(new M3(z.MUTED_BUBBLE_ID,this))),s=!0;else{A&&(this.removeAddition(z.MUTED_BUBBLE_ID),s=!0);const j=e.getValue(T.FIGURE_IS_TYPING)>0;let Q=this.getAddition(z.TYPING_BUBBLE_ID);j?(Q||(Q=this.addAddition(new N3(z.TYPING_BUBBLE_ID,this))),s=!0):Q&&(this.removeAddition(z.TYPING_BUBBLE_ID),s=!0)}const C=e.getValue(T.FIGURE_GUIDE_STATUS)||0;C!==ar.NONE?(this.removeAddition(z.GUIDE_BUBBLE_ID),this.addAddition(new C3(z.GUIDE_BUBBLE_ID,this,C)),s=!0):this.getAddition(z.GUIDE_BUBBLE_ID)&&(this.removeAddition(z.GUIDE_BUBBLE_ID),s=!0);const M=e.getValue(T.FIGURE_IS_PLAYING_GAME)>0;let N=this.getAddition(z.GAME_CLICK_TARGET_ID);M?(N||(N=this.addAddition(new wr(z.GAME_CLICK_TARGET_ID))),s=!0):N&&this.removeAddition(z.GAME_CLICK_TARGET_ID);const L=e.getValue(T.FIGURE_NUMBER_VALUE);let b=this.getAddition(z.NUMBER_BUBBLE_ID);L>0?(b||(b=this.addAddition(new P3(z.NUMBER_BUBBLE_ID,L,this))),s=!0):b&&this.removeAddition(z.NUMBER_BUBBLE_ID);let D=this.getAddition(z.EXPRESSION_ID);this._expression>0?D||(D=La.getExpressionAddition(z.EXPRESSION_ID,this._expression,this),D&&this.addAddition(D)):D&&this.removeAddition(z.EXPRESSION_ID),this.updateScale(t);const x=e.getValue(T.GENDER);x!==this._gender&&(this._gender=x,s=!0),this.updateFigure(e.getValue(T.FIGURE))&&(s=!0);let q=e.getValue(T.FIGURE_SIGN);q===null&&(q=-1),this._sign!==q&&(this._sign=q,s=!0);const $=e.getValue(T.FIGURE_HIGHLIGHT_ENABLE)>0;if($!==this._highlightEnabled&&(this._highlightEnabled=$,s=!0),this._highlightEnabled){const j=e.getValue(T.FIGURE_HIGHLIGHT)>0;j!==this._highlight&&(this._highlight=j,s=!0)}const Te=e.getValue(T.OWN_USER)>0;return Te!==this._ownUser&&(this._ownUser=Te,s=!0),this.updateModelCounter=e.updateCounter,s}setDirection(e){this._direction!==e&&(this._direction=e,this._needsUpdate=!0)}updateScale(e){e<48&&(this._blink=!1),this._posture==="sit"||this._posture==="lay"?this._postureOffset=e/2:this._postureOffset=0,this._layInside=!1,this._isLaying=!1,this._posture==="lay"&&(this._isLaying=!0,parseInt(this._postureParameter)<0&&(this._layInside=!0))}processActionsForAvatar(e){if(!e)return;if(e.initActionAppends(),e.appendAction(F.POSTURE,this._posture,this._postureParameter),this._gesture>0&&this._avatarImage.appendAction(F.GESTURE,F.getGesture(this._gesture)),this._dance>0&&this._avatarImage.appendAction(F.DANCE,this._dance),this._sign>-1&&this._avatarImage.appendAction(F.SIGN,this._sign),this._carryObject>0&&this._avatarImage.appendAction(F.CARRY_OBJECT,this._carryObject),this._useObject>0&&this._avatarImage.appendAction(F.USE_OBJECT,this._useObject),this._talk&&this._avatarImage.appendAction(F.TALK),(this._sleep||this._blink)&&this._avatarImage.appendAction(F.SLEEP),this._expression>0){const s=F.getExpression(this._expression);if(s!=="")switch(s){case F.DANCE:this._avatarImage.appendAction(F.DANCE,2);break;default:this._avatarImage.appendAction(s);break}}this._effect>0&&this._avatarImage.appendAction(F.EFFECT,this._effect),e.endActionAppends(),this._isAnimating=e.isAnimating();let t=z.INITIAL_RESERVED_SPRITES;for(const s of this._avatarImage.getSprites())s.id!==z.AVATAR&&t++;if(t!==this.totalSprites&&this.createSprites(t),this._extraSpritesStartIndex=t,this._additions)for(const s of this._additions.values())this.createSprite()}updateFigure(e){return this._figure===e?!1:(this._figure=e,this.clearAvatar(),!0)}resetFigure(e){this.clearAvatar()}resetEffect(e){this.clearAvatar()}clearAvatar(){for(const t of this._cachedAvatars.getValues())t&&t.dispose();for(const t of this._cachedAvatarEffects.getValues())t&&t.dispose();this._cachedAvatars.reset(),this._cachedAvatarEffects.reset(),this._avatarImage=null;const e=this.getSprite(z.AVATAR_LAYER_ID);e&&(e.texture=Re.EMPTY,e.alpha=255)}getAddition(e){if(!this._additions)return null;const t=this._additions.get(e);return t||null}addAddition(e){if(!this.getAddition(e.id))return this._additions.set(e.id,e),e}removeAddition(e){const t=this.getAddition(e);t&&(this._additions.delete(t.id),t.dispose())}updateShadow(e){this._shadow=null;const t=this.getSprite(z.SHADOW_LAYER_ID);if(!t)return;let s=this._posture==="mv"||this._posture==="std"||this._posture==="sit"&&this._canStandUp;if(this._effect===z.SNOWBOARDING_EFFECT&&(s=!1),s){if(t.visible=!0,!this._shadow||e!==this._scale){let i=0,n=0;e<48?(t.libraryAssetName="sh_std_sd_1_0_0",this._shadow=this._avatarImage.getAsset(t.libraryAssetName),i=-8,n=this._canStandUp?6:-3):(t.libraryAssetName="h_std_sd_1_0_0",this._shadow=this._avatarImage.getAsset(t.libraryAssetName),i=-17,n=this._canStandUp?10:-7),this._shadow?(t.texture=this._shadow.texture,t.offsetX=i,t.offsetY=n,t.alpha=50,t.relativeDepth=1):t.visible=!1}}else this._shadow=null,t.visible=!1}getAvatarRenderAsset(e){return this._data?this._data.getAvatarRendererAsset(e):null}get direction(){return this._direction}get posture(){return this._posture}get angle(){return this._angle}get disposed(){return this._disposed}}z.AVATAR="avatar",z.FLOATING_IDLE_Z_ID=1,z.TYPING_BUBBLE_ID=2,z.EXPRESSION_ID=3,z.NUMBER_BUBBLE_ID=4,z.GAME_CLICK_TARGET_ID=5,z.MUTED_BUBBLE_ID=6,z.GUIDE_BUBBLE_ID=7,z.OWN_USER_ID=4,z.UPDATE_TIME_INCREASER=41,z.AVATAR_LAYER_ID=0,z.SHADOW_LAYER_ID=1,z.SNOWBOARDING_EFFECT=97,z.INITIAL_RESERVED_SPRITES=2,z.ANIMATION_FRAME_UPDATE_INTERVAL=2,z.DEFAULT_CANVAS_OFFSETS=[0,0,0],z.MAX_EFFECT_CACHE=2,z.SPRITE_INDEX_AVATAR=0,z.BASE_Y_SCALE=1e3,z.AVATAR_SPRITE_DEFAULT_DEPTH=-.01,z.AVATAR_OWN_DEPTH_ADJUST=.001,z.AVATAR_SPRITE_LAYING_DEPTH=-.409;class xt{static allocate(e,t,s,i,n,a,o=-1,u=0){const l=xt.POOL.length?xt.POOL.pop():new xt;return i<1&&(i=1),n<0&&(n=xt.FRAME_REPEAT_FOREVER),l._id=e,l._x=t||0,l._y=s||0,l._repeats=i,l._frameRepeats=n,l._remainingFrameRepeats=n,l._isLastFrame=a,l._isRecycled=!1,o>=0?(l._activeSequence=o,l._activeSequenceOffset=u):(l._activeSequence=-1,l._activeSequenceOffset=0),l}get id(){return this._id>=0?this._id:-this._id*Math.random()}get x(){return this._x}get y(){return this._y}get repeats(){return this._repeats}get frameRepeats(){return this._frameRepeats}get isLastFrame(){return this._isLastFrame}get remainingFrameRepeats(){return this._frameRepeats<0?xt.FRAME_REPEAT_FOREVER:this._remainingFrameRepeats}set remainingFrameRepeats(e){e<0&&(e=0),this._frameRepeats>0&&e>this._frameRepeats&&(e=this._frameRepeats),this._remainingFrameRepeats=e}get activeSequence(){return this._activeSequence}get activeSequenceOffset(){return this._activeSequenceOffset}recycle(){this._isRecycled||(this._isRecycled=!0,xt.POOL.length<xt.POOL_SIZE_LIMIT&&xt.POOL.push(this))}}xt.FRAME_REPEAT_FOREVER=-1,xt.SEQUENCE_NOT_DEFINED=-1,xt.POOL_SIZE_LIMIT=3e3,xt.POOL=[];class Qp{constructor(e,t,s,i,n,a){this._id=0,this._x=0,this._y=0,this._randomX=0,this._randomY=0,this._repeats=1,this._id=e,this._x=t,this._y=s,this._randomX=i,this._randomY=n,this._repeats=a}get id(){return this._id}hasDirectionalOffsets(){return!1}getX(e){return this._x}getY(e){return this._y}get x(){return this._x}get y(){return this._x}get randomX(){return this._randomX}get randomY(){return this._randomY}get repeats(){return this._repeats}}class b3 extends Qp{constructor(e,t,s,i,n,a,o){super(e,t,s,i,n,o),this._directionalOffsets=a}hasDirectionalOffsets(){return this._directionalOffsets!==null}getX(e){return this._directionalOffsets?this._directionalOffsets.getXOffset(e,super.getX(e)):super.getX(e)}getY(e){return this._directionalOffsets?this._directionalOffsets.getYOffset(e,super.getY(e)):super.getY(e)}}class D3{constructor(e,t){this._frames=[],this._frameIndexes=[],this._frameRepeats=[],this._isRandom=t,this._loopCount=e<1?1:e}get isRandom(){return this._isRandom}get frameCount(){return this._frameIndexes.length*this._loopCount}dispose(){this._frames=[]}initialize(){let e=this._frameIndexes.length-1,t=-1,s=1;for(;e>=0;)this._frameIndexes[e]===t?s++:(t=this._frameIndexes[e],s=1),this._frameRepeats[e]=s,e--}addFrame(e,t,s,i,n,a){let o=1;if(this._frames.length>0){const l=this._frames[this._frames.length-1];l.id===e&&!l.hasDirectionalOffsets()&&l.x===t&&l.y===s&&l.randomX===i&&i===0&&l.randomY===n&&n===0&&(o+=l.repeats,this._frames.pop())}const u=a?new b3(e,t,s,i,n,a,o):new Qp(e,t,s,i,n,o);this._frames.push(u),this._frameIndexes.push(this._frames.length-1),this._frameRepeats.push(1)}getFrame(e){return!this._frames.length||e<0||e>=this.frameCount?null:this._frames[this._frameIndexes[e%this._frameIndexes.length]]}getFrameIndex(e){return e<0||e>=this.frameCount?-1:(this._isRandom&&(e=Math.round(Math.random()*this._frameIndexes.length),e===this._frameIndexes.length&&e--),e)}getRepeats(e){return e<0||e>=this.frameCount?0:this._frameRepeats[e%this._frameRepeats.length]}}class L3{constructor(e,t,s){this._frameSequences=[],this._frameCount=-1,this._loopCount=e<0?0:e,this._frameRepeat=t<1?1:t,this._isRandom=s}get frameCount(){return this._frameCount<0&&this.calculateLength(),this._frameCount}dispose(){if(!(!this._frameSequences||!this._frameSequences.length)){for(const e of this._frameSequences)e&&e.dispose();this._frameSequences=[]}}addFrameSequence(e,t){const s=new D3(e,t);return this._frameSequences.push(s),s}calculateLength(){this._frameCount=0;for(const e of this._frameSequences)e&&(this._frameCount+=e.frameCount)}getFrame(e,t){if(this._frameCount<1)return null;if(t=t/this._frameRepeat,!this._isRandom){const n=Math.floor(t/this._frameCount);t=Math.floor(t%this._frameCount);let a=!1,o=null;(this._loopCount>0&&n>=this._loopCount||this._loopCount<=0&&this._frameCount===1)&&(t=this._frameCount-1,a=!0);let u=0,l=0;for(;l<this._frameSequences.length;){if(o=this._frameSequences[l],o){if(t<u+o.frameCount)break;u+=o.frameCount}l++}return this.getFrameFromSpecificSequence(e,o,l,t-u,a)}const s=Math.trunc(this._frameSequences.length*Math.random()),i=this._frameSequences[s];return i.frameCount<1?null:this.getFrameFromSpecificSequence(e,i,s,0,!1)}getFrameFromSequence(e,t,s,i){if(t<0||t>=this._frameSequences.length)return null;const n=this._frameSequences[t];return n?s>=n.frameCount?this.getFrame(e,i):this.getFrameFromSpecificSequence(e,n,t,s,!1):null}getFrameFromSpecificSequence(e,t,s,i,n){if(!t)return null;const a=t.getFrameIndex(i),o=t.getFrame(a);if(!o)return null;let u=o.getX(e),l=o.getY(e);const d=o.randomX,c=o.randomY;let _=o.repeats,f=!1;d&&(u=Math.trunc(u+d*Math.random())),c&&(l=Math.trunc(l+c*Math.random())),_>1&&(_=t.getRepeats(a));let g=this._frameRepeat*_;return n&&(g=xt.FRAME_REPEAT_FOREVER),!this._isRandom&&!t.isRandom&&s===this._frameSequences.length-1&&i===t.frameCount-1&&(f=!0),xt.allocate(o.id,u,l,_,g,f,s,i)}}class Zp{constructor(){this._offsetX=new Map,this._offsetY=new Map}getXOffset(e,t){const s=this._offsetX.get(e);return s??t}getYOffset(e,t){const s=this._offsetY.get(e);return s??t}setDirection(e,t,s){this._offsetX.set(e,t),this._offsetY.set(e,s)}}class st{constructor(){this._layers=new Map,this._frameCount=-1,this._randomStart=!1,this._immediateChanges=null}static getTransitionToAnimationId(e){return st.TRANSITION_TO_ANIMATION_OFFSET+e}static getTransitionFromAnimationId(e){return st.TRANSITION_FROM_ANIMATION_OFFSET+e}static isTransitionToAnimation(e){return e>=st.TRANSITION_TO_ANIMATION_OFFSET&&e<st.TRANSITION_FROM_ANIMATION_OFFSET}static isTransitionFromAnimation(e){return e>=st.TRANSITION_FROM_ANIMATION_OFFSET}dispose(){for(const e of this._layers.values())e&&e.dispose();this._layers.clear(),this._immediateChanges=null}setImmediateChanges(e){this._immediateChanges=e}isImmediateChange(e){return!(!this._immediateChanges||this._immediateChanges.indexOf(e)===-1)}getStartFrame(e){return this._randomStart?Math.random()*this._frameCount:0}initialize(e){if(e.randomStart&&(this._randomStart=!0),e.layers)for(const t in e.layers){const s=e.layers[t];if(!s)return!1;const i=parseInt(t),n=s.loopCount!==void 0?s.loopCount:1,a=s.frameRepeat!==void 0?s.frameRepeat:1,o=s.random!==void 0&&s.random!==0;if(!this.addLayer(i,n,a,o,s))return!1}return!0}addLayer(e,t,s,i,n){const a=new L3(t,s,i);if(n.frameSequences)for(const u in n.frameSequences){const l=n.frameSequences[u];if(!l)continue;const d=l.loopCount!==void 0?l.loopCount:1,c=l.random!==void 0&&l.random!==0,_=a.addFrameSequence(d,c);if(l.frames)for(const f in l.frames){const g=l.frames[f];if(!g)return a.dispose(),!1;_.addFrame(g.id,g.x||0,g.y||0,g.randomX||0,g.randomY||0,this.readDirectionalOffsets(g))}_.initialize()}a.calculateLength(),this._layers.set(e,a);const o=a.frameCount;return o>this._frameCount&&(this._frameCount=o),!0}readDirectionalOffsets(e){let t=null;if(e&&e.offsets)for(const s in e.offsets){const i=e.offsets[s];i&&(t||(t=new Zp),t.setDirection(i.direction,i.x,i.y))}return t}getFrame(e,t,s){const i=this._layers.get(t);return i?i.getFrame(e,s):null}getFrameFromSequence(e,t,s,i,n){const a=this._layers.get(t);return a?a.getFrameFromSequence(e,s,i,n):null}}st.TRANSITION_TO_ANIMATION_OFFSET=1e6,st.TRANSITION_FROM_ANIMATION_OFFSET=2e6,st.DEFAULT_FRAME_NUMBER=0;class mi{constructor(e){this._colors=[],this.createColors(e)}createColors(e){if(e)for(let t=0;t<e;t++)this._colors.push(mi.DEFAULT_COLOR)}dispose(){this._colors=[]}getLayerColor(e){const t=this._colors[e];return t||mi.DEFAULT_COLOR}setColorLayer(e,t){this._colors[e]&&(this._colors[e]=t)}}mi.DEFAULT_COLOR=16777215;class fe{constructor(){this._tag=fe.DEFAULT_TAG,this._ink=fe.DEFAULT_INK,this._alpha=fe.DEFAULT_ALPHA,this._ignoreMouse=fe.DEFAULT_IGNORE_MOUSE,this._xOffset=fe.DEFAULT_XOFFSET,this._yOffset=fe.DEFAULT_YOFFSET,this._zOffset=fe.DEFAULT_ZOFFSET}setFromLayer(e){e&&(this._tag=e.tag,this._ink=e.ink,this._alpha=e.alpha,this._ignoreMouse=e.ignoreMouse,this._xOffset=e.xOffset,this._yOffset=e.yOffset,this._zOffset=e.zOffset)}get tag(){return this._tag}set tag(e){this._tag=e}get ink(){return this._ink}set ink(e){this._ink=e}get alpha(){return this._alpha}set alpha(e){this._alpha=e}get ignoreMouse(){return this._ignoreMouse}set ignoreMouse(e){this._ignoreMouse=e}get xOffset(){return this._xOffset}set xOffset(e){this._xOffset=e}get yOffset(){return this._yOffset}set yOffset(e){this._yOffset=e}get zOffset(){return this._zOffset}set zOffset(e){this._zOffset=e}}fe.DEFAULT_COUNT=0,fe.DEFAULT_DIRECTION=0,fe.DEFAULT_TAG="",fe.DEFAULT_INK=se.NORMAL,fe.DEFAULT_ALPHA=255,fe.DEFAULT_IGNORE_MOUSE=!1,fe.DEFAULT_XOFFSET=0,fe.DEFAULT_YOFFSET=0,fe.DEFAULT_ZOFFSET=0;class Fn{constructor(e){this._layers=[],this.createLayers(e)}createLayers(e){if(e)for(let t=0;t<e;t++)this._layers.push(new fe)}dispose(){this._layers=[]}setFromDirection(e){if(!e)return;const t=this.layerCount;if(t===e.layerCount)for(let s=0;s<t;s++){const i=this.getLayer(s),n=e.getLayer(s);i&&i.setFromLayer(n)}}getLayer(e){const t=this._layers[e];return t||null}getLayerTag(e){const t=this.getLayer(e);return t?t.tag:fe.DEFAULT_TAG}setLayerTag(e,t){const s=this.getLayer(e);s&&(s.tag=t)}getLayerInk(e){const t=this.getLayer(e);return t?t.ink:fe.DEFAULT_INK}setLayerInk(e,t){const s=this.getLayer(e);s&&(isNaN(t)||(s.ink=t))}getLayerAlpha(e){const t=this.getLayer(e);return t?t.alpha:fe.DEFAULT_ALPHA}setLayerAlpha(e,t){const s=this.getLayer(e);s&&(isNaN(t)||(s.alpha=t))}getLayerIgnoreMouse(e){const t=this.getLayer(e);return t?t.ignoreMouse:fe.DEFAULT_IGNORE_MOUSE}setLayerIgnoreMouse(e,t){const s=this.getLayer(e);s&&(s.ignoreMouse=t||!1)}getLayerXOffset(e){const t=this.getLayer(e);return t?t.xOffset:fe.DEFAULT_XOFFSET}setLayerXOffset(e,t){const s=this.getLayer(e);s&&(isNaN(t)||(s.xOffset=t))}getLayerYOffset(e){const t=this.getLayer(e);return t?t.yOffset:fe.DEFAULT_YOFFSET}setLayerYOffset(e,t){const s=this.getLayer(e);s&&(isNaN(t)||(s.yOffset=t))}getLayerZOffset(e){const t=this.getLayer(e);return t?t.zOffset:fe.DEFAULT_ZOFFSET}setLayerZOffset(e,t){const s=this.getLayer(e);s&&(isNaN(t)||(s.zOffset=t))}get layerCount(){return this._layers.length}}Fn.USE_DEFAULT_DIRECTION=-1;class Ua{constructor(e,t){this._layerCount=e<0?0:e>Ua.MAX_LAYERS?Ua.MAX_LAYERS:e,this._angle=t<1?1:t>360?360:t,this._defaultDirection=new Fn(this._layerCount),this._directions=new Map,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1}dispose(){this._defaultDirection&&this._defaultDirection.dispose();for(const e of this._directions.values())e&&e.dispose();for(const e of this._colors)e&&e.dispose();this.reset()}reset(){this._defaultDirection=null,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1,this._directions.clear()}processLayers(e){return e?this.setDirectionLayers(this._defaultDirection,e):!1}processDirections(e){if(!e)return!1;for(const t in e){const s=e[t];if(!s)continue;const i=parseInt(t);if(this._directions.get(i))return!1;const n=new Fn(this._layerCount);n.setFromDirection(this._defaultDirection),this.setDirectionLayers(n,s.layers),this._directions.set(i,n),this._lastDirectionData=null,this._lastDirection=-1}return!0}processColors(e){if(!e)return!1;for(const t in e){const s=e[t];if(!s)continue;const i=parseInt(t);if(this._colors[i])return!1;const n=new mi(this._layerCount);for(const a in s.layers){const o=s.layers[a];if(!o)continue;const u=parseInt(a),l=o.color;n.setColorLayer(u,l)}this._colors[i]=n}return!0}setDirectionLayers(e,t){if(!e||!t)return!1;for(const s in t){const i=t[s];if(!i)continue;const n=parseInt(s);if(n<0||n>=this._layerCount)return!1;i.ink!==void 0&&e.setLayerInk(n,XO.inkToBlendMode(i.ink)),i.tag!==void 0&&e.setLayerTag(n,i.tag),i.alpha!==void 0&&e.setLayerAlpha(n,i.alpha),i.ignoreMouse!==void 0&&e.setLayerIgnoreMouse(n,i.ignoreMouse),i.x!==void 0&&e.setLayerXOffset(n,i.x),i.y!==void 0&&e.setLayerYOffset(n,i.y),i.z!==void 0&&e.setLayerZOffset(n,i.z/-1e3)}return!0}getValidDirection(e){if(this._directions.get(e))return e;e=(e%360+360)%360;let s=-1,i=-1;for(const n of this._directions.keys()){let a=(n*this._angle-e+360)%360;a>180&&(a=360-a),(a<s||s<0)&&(s=a,i=n)}return i>=0?Math.trunc(i):0}getDirectionData(e){if(e===this._lastDirection&&this._lastDirectionData)return this._lastDirectionData;let t=this._directions.get(e);return t||(t=this._defaultDirection),this._lastDirection=e,this._lastDirectionData=t,this._lastDirectionData}getLayerTag(e,t){const s=this.getDirectionData(e);return s?s.getLayerTag(t):fe.DEFAULT_TAG}getLayerInk(e,t){const s=this.getDirectionData(e);return s?s.getLayerInk(t):fe.DEFAULT_INK}getLayerAlpha(e,t){const s=this.getDirectionData(e);return s?s.getLayerAlpha(t):fe.DEFAULT_ALPHA}getLayerColor(e,t){const s=this._colors[t];return s?s.getLayerColor(e):mi.DEFAULT_COLOR}getLayerIgnoreMouse(e,t){const s=this.getDirectionData(e);return s?s.getLayerIgnoreMouse(t):fe.DEFAULT_IGNORE_MOUSE}getLayerXOffset(e,t){const s=this.getDirectionData(e);return s?s.getLayerXOffset(t):fe.DEFAULT_XOFFSET}getLayerYOffset(e,t){const s=this.getDirectionData(e);return s?s.getLayerYOffset(t):fe.DEFAULT_YOFFSET}getLayerZOffset(e,t){const s=this.getDirectionData(e);return s?s.getLayerZOffset(t):fe.DEFAULT_ZOFFSET}get layerCount(){return this._layerCount}}Ua.MAX_LAYERS=26;class el extends Ua{constructor(e,t){super(e,t),this._animations=new Map,this._animationIds=[]}dispose(){super.dispose();for(const e of this._animations.values())e&&e.dispose();this._animations.clear(),this._animationIds=[]}defineAnimations(e){if(!e)return!0;for(const t in e){const s=e[t];if(!s)return!1;let i=parseInt(t.split("_")[0]),n=!1;const a=s.transitionTo,o=s.transitionFrom;a!==void 0&&(i=st.getTransitionToAnimationId(a),n=!0),o!==void 0&&(i=st.getTransitionFromAnimationId(o),n=!0);const u=this.createAnimationData();if(!u.initialize(s))return u.dispose(),!1;const l=s.immediateChangeFrom;if(l!==void 0){const d=l.split(","),c=[];for(const _ of d){const f=parseInt(_);c.indexOf(f)===-1&&c.push(f)}u.setImmediateChanges(c)}this._animations.set(i,u),n||this._animationIds.push(i)}return!0}createAnimationData(){return new st}hasAnimation(e){return!!this._animations.get(e)}getAnimationCount(){return this._animationIds.length||0}getAnimationId(e){const t=this.getAnimationCount();return e<0||t<=0?0:this._animationIds[e%t]}isImmediateChange(e,t){const s=this._animations.get(e);return s?s.isImmediateChange(t):!1}getStartFrame(e,t){const s=this._animations.get(e);return s?s.getStartFrame(t):0}getFrame(e,t,s,i){const n=this._animations.get(e);return n?n.getFrame(t,s,i):null}getFrameFromSequence(e,t,s,i,n,a){const o=this._animations.get(e);return o?o.getFrameFromSequence(t,s,i,n,a):null}}class Jp{constructor(){this._animationId=-1,this._animationAfterTransitionId=0,this._animationOver=!1,this._frameCounter=0,this._frames=[],this._lastFramePlayed=[],this._animationPlayed=[],this._layerCount=0}get animationOver(){return this._animationOver}set animationOver(e){this._animationOver=e}get frameCounter(){return this._frameCounter}set frameCounter(e){this._frameCounter=e}get animationId(){return this._animationId}set animationId(e){e!==this._animationId&&(this._animationId=e,this.resetAnimationFrames(!1))}get animationAfterTransitionId(){return this._animationAfterTransitionId}set animationAfterTransitionId(e){this._animationAfterTransitionId=e}dispose(){this.recycleFrames(),this._frames=null,this._lastFramePlayed=null,this._animationPlayed=null}setLayerCount(e){this._layerCount=e,this.resetAnimationFrames()}resetAnimationFrames(e=!0){(e||!this._frames)&&(this.recycleFrames(),this._frames=[]),this._lastFramePlayed=[],this._animationPlayed=[],this._animationOver=!1,this._frameCounter=0;let t=0;for(;t<this._layerCount;){if(e||this._frames.length<=t)this._frames[t]=null;else{const s=this._frames[t];s&&(s.recycle(),this._frames[t]=xt.allocate(s.id,s.x,s.y,s.repeats,0,s.isLastFrame))}this._lastFramePlayed[t]=!1,this._animationPlayed[t]=!1,t++}}recycleFrames(){if(!(!this._frames||!this._frames.length))for(const e of this._frames)e&&e.recycle()}getFrame(e){return e<0||e>=this._layerCount?null:this._frames[e]}setFrame(e,t){if(e<0||e>=this._layerCount)return;const s=this._frames[e];s&&s.recycle(),this._frames[e]=t}getAnimationPlayed(e){return e<0||e>=this._layerCount?!0:this._animationPlayed[e]}setAnimationPlayed(e,t){e<0||e>=this._layerCount||(this._animationPlayed[e]=t)}getLastFramePlayed(e){return e<0||e>=this._layerCount?!0:this._lastFramePlayed[e]}setLastFramePlayed(e,t){e<0||e>=this._layerCount||(this._lastFramePlayed[e]=t)}}class tn extends el{constructor(e,t){super(e,t),this._posturesToAnimations=new Map,this._gesturesToAnimations=new Map,this._defaultPosture=null}processPostures(e){if(!e||(e.defaultPosture&&e.defaultPosture.length&&(this._defaultPosture=e.defaultPosture),!e.postures))return!1;for(const t of e.postures)this._posturesToAnimations.get(t.id)||(this._defaultPosture===null&&(this._defaultPosture=t.id),this._posturesToAnimations.set(t.id,t.animationId));return this._posturesToAnimations.get(this._defaultPosture)!==void 0}processGestures(e){if(!e)return!1;for(const t of e)this._gesturesToAnimations.get(t.id)||this._gesturesToAnimations.set(t.id,t.animationId);return!0}postureToAnimation(e){return this._posturesToAnimations.get(e)||(e=this._defaultPosture),this._posturesToAnimations.get(e)}getGestureDisabled(e){return e==="ded"}gestureToAnimation(e){return this._gesturesToAnimations.get(e)?this._gesturesToAnimations.get(e):tn.DEFAULT}animationToPosture(e,t){if(e>=0&&e<this._posturesToAnimations.size){const s=this._posturesToAnimations.keys();for(;;){const i=s.next();if(i.done)return null;if(e<=0)return i.value;--e}}return t?this._defaultPosture:null}animationToGesture(e){if(e>=0&&e<this._gesturesToAnimations.size){const t=this._gesturesToAnimations.keys();for(;;){const s=t.next();if(s.done)return null;if(e<=0)return s.value;--e}}return null}getGestureForAnimationId(e){for(const t of this._gesturesToAnimations.keys())if(this._gesturesToAnimations.get(t)===e)return t;return null}get totalPostures(){return this._posturesToAnimations.size}get totalGestures(){return this._gesturesToAnimations.size}}tn.DEFAULT=-1;class pi{constructor(){this._type="",this._sizes=[],this._sizeDatas=new Map,this._lastSize=-1,this._lastSizeScale=-1,this._lastSizeData=null,this._lastSizeDataScale=-1}initialize(e){return this.reset(),e?(this._type=e.name,this.defineVisualizations(e.visualizations)?!0:(this.reset(),!1)):!1}dispose(){if(this._sizeDatas&&this._sizeDatas.size){for(const e of this._sizeDatas.values())e&&e.dispose();this._sizeDatas=null}this._lastSizeData=null,this._sizes=null}reset(){if(this._type="",this._sizeDatas&&this._sizeDatas.size)for(const e of this._sizeDatas.values())e&&e.dispose();this._sizeDatas.clear(),this._sizes=[],this._lastSizeData=null,this._lastSizeDataScale=-1}createSizeData(e,t,s){return new Ua(t,s)}defineVisualizations(e){if(!e)return!1;for(const t in e){const s=e[t],i=s.layerCount,n=s.angle;let a=s.size;if(a<1&&(a=1),this._sizeDatas.get(a))return!1;const o=this.createSizeData(a,i,n);if(!o)return!1;for(const u in s){const l=s[u];if(!this.processVisualElement(o,u,l))return o.dispose(),!1}this._sizeDatas.set(a,o),this._sizes.push(a)}return this._sizes.sort(),!0}processVisualElement(e,t,s){if(!e||!t||!s)return!1;switch(t){case"layers":if(!e.processLayers(s))return!1;break;case"directions":if(!e.processDirections(s))return!1;break;case"colors":if(!e.processColors(s))return!1;break}return!0}getValidSize(e){if(e===this._lastSizeScale)return this._lastSize;const t=this.getSizeIndex(e);let s=-1;return t<this._sizes.length&&(s=this._sizes[t]),this._lastSizeScale=e,this._lastSize=s,s}getSizeIndex(e){if(e<=0)return 0;let t=0,s=1;for(;s<this._sizes.length;){if(this._sizes[s]>e){this._sizes[s]/e<e/this._sizes[s-1]&&(t=s);break}t=s,s++}return t}getSizeData(e){if(e===this._lastSizeDataScale)return this._lastSizeData;const t=this.getSizeIndex(e);return t<this._sizes.length?this._lastSizeData=this._sizeDatas.get(this._sizes[t]):this._lastSizeData=null,this._lastSizeDataScale=e,this._lastSizeData}getLayerCount(e){const t=this.getSizeData(e);return t?t.layerCount:fe.DEFAULT_COUNT}getValidDirection(e,t){const s=this.getSizeData(e);return s?s.getValidDirection(t):fe.DEFAULT_DIRECTION}getLayerTag(e,t,s){const i=this.getSizeData(e);return i?i.getLayerTag(t,s):fe.DEFAULT_TAG}getLayerInk(e,t,s){const i=this.getSizeData(e);return i?i.getLayerInk(t,s):fe.DEFAULT_INK}getLayerAlpha(e,t,s){const i=this.getSizeData(e);return i?i.getLayerAlpha(t,s):fe.DEFAULT_ALPHA}getLayerColor(e,t,s){const i=this.getSizeData(e);return i?i.getLayerColor(t,s):mi.DEFAULT_COLOR}getLayerIgnoreMouse(e,t,s){const i=this.getSizeData(e);return i?i.getLayerIgnoreMouse(t,s):fe.DEFAULT_IGNORE_MOUSE}getLayerXOffset(e,t,s){const i=this.getSizeData(e);return i?i.getLayerXOffset(t,s):fe.DEFAULT_XOFFSET}getLayerYOffset(e,t,s){const i=this.getSizeData(e);return i?i.getLayerYOffset(t,s):fe.DEFAULT_YOFFSET}getLayerZOffset(e,t,s){const i=this.getSizeData(e);return i?i.getLayerZOffset(t,s):fe.DEFAULT_ZOFFSET}get type(){return this._type}}pi.LAYER_LETTERS=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];class Z_ extends pi{createSizeData(e,t,s){return new el(t,s)}processVisualElement(e,t,s){if(!e||!t||!s)return!1;switch(t){case"animations":if(!(e instanceof el)||!e.defineAnimations(s))return!1;break;default:if(!super.processVisualElement(e,t,s))return!1;break}return!0}hasAnimation(e,t){const s=this.getSizeData(e);return s?s.hasAnimation(t):null}getAnimationCount(e){const t=this.getSizeData(e);return t?t.getAnimationCount():null}getAnimationId(e,t){const s=this.getSizeData(e);return s?s.getAnimationId(t):null}isImmediateChange(e,t,s){const i=this.getSizeData(e);return i?i.isImmediateChange(t,s):null}getStartFrame(e,t,s){const i=this.getSizeData(e);return i?i.getStartFrame(t,s):null}getFrame(e,t,s,i,n){const a=this.getSizeData(e);return a?a.getFrame(t,s,i,n):null}getFrameFromSequence(e,t,s,i,n,a,o){const u=this.getSizeData(e);return u?u.getFrameFromSequence(t,s,i,n,a,o):null}}class pr extends Mn{constructor(){super(),this._data=null,this._type=null,this._direction=0,this._lastCameraAngle=NaN,this._selectedColor=0,this._furnitureLift=0,this._alphaMultiplier=1,this._alphaChanged=!1,this._clickUrl=null,this._clickHandling=!1,this._cacheDirection=-1,this._cacheScale=0,this._cacheSize=-1,this._layerCount=0,this._shadowLayerIndex=-1,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._animationNumber=0}initialize(e){return this.reset(),e instanceof pi?(this._type=e.type,this._data=e,!0):!1}dispose(){super.dispose(),this._data=null,this._updatedLayers=null,this._assetNames=null,this._spriteTags=null,this._spriteInks=null,this._spriteAlphas=null,this._spriteColors=null,this._spriteMouseCaptures=null,this._spriteXOffsets=null,this._spriteYOffsets=null,this._spriteZOffsets=null}reset(){super.reset(),this.setDirection(-1),this._data=null,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this.createSprites(0)}resetLayers(e,t){this._cacheDirection===t&&this._cacheScale===e||(this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._cacheDirection=t,this._cacheScale=e,this._cacheSize=this.getValidSize(e),this.setLayerCount((this._data&&this._data.getLayerCount(e)||0)+this.getAdditionalLayerCount()))}update(e,t,s,i){if(!e)return;const n=e.scale;let a=!1;this.updateObject(n,e.direction.x)&&(a=!0),this.updateModel(n)&&(a=!0);let o=0;i?this._animationNumber=this._animationNumber|this.updateAnimation(n):(o=this.updateAnimation(n)|this._animationNumber,this._animationNumber=0),(a||o!==0)&&(this.updateSprites(n,a,o),this._scale=n,this.updateSpriteCounter++)}updateObject(e,t){if(!this.object||this.updateObjectCounter===this.object.updateCounter&&e===this._scale&&this._lastCameraAngle===t)return!1;let s=this.object.getDirection().x-(t+135);if(s=(s%360+360)%360,this._data){const i=this._data.getValidDirection(e,s);this.setDirection(i)}return this._lastCameraAngle=t,this._scale=e,this.updateObjectCounter=this.object.updateCounter,this.resetLayers(e,this._direction),!0}updateModel(e){const t=this.object&&this.object.model;if(!t||this.updateModelCounter===t.updateCounter)return!1;this._selectedColor=t.getValue(T.FURNITURE_COLOR),this._clickUrl=t.getValue(T.FURNITURE_AD_URL),this._clickHandling=this._clickUrl&&this._clickUrl!==""&&this._clickUrl.indexOf("http")===0||!1,this._furnitureLift=t.getValue(T.FURNITURE_LIFT_AMOUNT)||0;let s=t.getValue(T.FURNITURE_ALPHA_MULTIPLIER);return isNaN(s)&&(s=1),this._alphaMultiplier!==s&&(this._alphaMultiplier=s,this._alphaChanged=!0),this.updateModelCounter=t.updateCounter,!0}updateSprites(e,t,s){if(this._layerCount!==this.totalSprites&&this.createSprites(this._layerCount),t){let i=this.totalSprites-1;for(;i>=0;)this.updateSprite(e,i),i--}else{let i=0;for(;s>0;)s&&this.updateSprite(e,i),i++,s=s>>1}this._alphaChanged=!1}updateSprite(e,t){const s=this.getSpriteAssetName(e,t),i=this.getSprite(t);if(s&&i){const n=this.getAsset(s,t);if(n&&n.texture){i.visible=!0,i.type=this._type,i.texture=n.texture,i.flipH=n.flipH,i.flipV=n.flipV,i.direction=this._direction;let a=0;t!==this._shadowLayerIndex?(i.tag=this.getLayerTag(e,this._direction,t),i.alpha=this.getLayerAlpha(e,this._direction,t),i.color=this.getLayerColor(e,t,this._selectedColor),i.offsetX=n.offsetX+this.getLayerXOffset(e,this._direction,t),i.offsetY=n.offsetY+this.getLayerYOffset(e,this._direction,t),i.blendMode=this.getLayerInk(e,this._direction,t),i.alphaTolerance=this.getLayerIgnoreMouse(e,this._direction,t)?Ks.MATCH_NOTHING:Ks.MATCH_OPAQUE_PIXELS,a=this.getLayerZOffset(e,this._direction,t),a=a-t*.001):(i.offsetX=n.offsetX,i.offsetY=n.offsetY+this.getLayerYOffset(e,this._direction,t),i.alpha=48*this._alphaMultiplier,i.alphaTolerance=Ks.MATCH_NOTHING,a=1),i.relativeDepth=a*pr.DEPTH_MULTIPLIER,i.name=s,i.libraryAssetName=this.getLibraryAssetNameForSprite(n,i),i.posture=this.getPostureForAsset(e,n.source),i.clickHandling=this._clickHandling}else this.resetSprite(i)}else i&&this.resetSprite(i)}getLibraryAssetNameForSprite(e,t){return e.source}getPostureForAssetFile(e,t){return null}resetSprite(e){e&&(e.texture=null,e.libraryAssetName="",e.posture="",e.tag="",e.offsetX=0,e.offsetY=0,e.flipH=!1,e.flipV=!1,e.relativeDepth=0,e.clickHandling=!1)}getSpriteAssetName(e,t){if(!this._data||t>=pi.LAYER_LETTERS.length)return"";let s=this._assetNames[t],i=this._updatedLayers[t];return(!s||!s.length)&&(s=this.cacheSpriteAssetName(e,t,!0),i=this._cacheSize!==1),i&&(s+=this.getFrameNumber(e,t)),s}cacheSpriteAssetName(e,t,s){this._type;const i=s?this._cacheSize:this.getValidSize(e);let n="";const a=i!==1;if(t!==this._shadowLayerIndex?n=pi.LAYER_LETTERS[t]||"":n="sd",n==="")return null;const o=this._type+(a?"_"+i+"_"+n+"_"+this._direction+"_":"_icon_"+n);return s&&(this._assetNames[t]=o,this._updatedLayers[t]=a),o}getLayerTag(e,t,s){const i=this._spriteTags[s];if(i!==void 0)return i;if(!this._data)return fe.DEFAULT_TAG;const n=this._data.getLayerTag(e,t,s);return this._spriteTags[s]=n,n}getLayerInk(e,t,s){const i=this._spriteInks[s];if(i!==void 0)return i;if(!this._data)return fe.DEFAULT_INK;const n=this._data.getLayerInk(e,t,s);return this._spriteInks[s]=n,n}getLayerAlpha(e,t,s){if(!this._alphaChanged){const n=this._spriteAlphas[s];if(n!==void 0)return n}if(!this._data)return fe.DEFAULT_ALPHA;let i=this._data.getLayerAlpha(e,t,s);return this._alphaMultiplier!==null&&(i=i*this._alphaMultiplier),this._spriteAlphas[s]=i,i}getLayerColor(e,t,s){const i=this._spriteColors[t];if(i!==void 0)return i;if(!this._data)return mi.DEFAULT_COLOR;const n=this._data.getLayerColor(e,t,s);return this._spriteColors[t]=n,n}getLayerIgnoreMouse(e,t,s){const i=this._spriteMouseCaptures[s];if(i!==void 0)return i;if(!this._data)return fe.DEFAULT_IGNORE_MOUSE;const n=this._data.getLayerIgnoreMouse(e,t,s);return this._spriteMouseCaptures[s]=n,n}getLayerXOffset(e,t,s){const i=this._spriteXOffsets[s];if(i!==void 0)return i;if(!this._data)return fe.DEFAULT_XOFFSET;const n=this._data.getLayerXOffset(e,t,s);return this._spriteXOffsets[s]=n,n}getLayerYOffset(e,t,s){if(s===this._shadowLayerIndex)return Math.ceil(this._furnitureLift*(e/2));const i=this._spriteYOffsets[s];if(i!==void 0)return i;if(!this._data)return fe.DEFAULT_YOFFSET;const n=this._data.getLayerYOffset(e,t,s);return this._spriteYOffsets[s]=n,n}getLayerZOffset(e,t,s){const i=this._spriteZOffsets[s];if(i!==void 0)return i;if(!this._data)return fe.DEFAULT_ZOFFSET;const n=this._data.getLayerZOffset(e,t,s);return this._spriteZOffsets[s]=n,n}getValidSize(e){return this._data?this._data.getValidSize(e):e}setLayerCount(e){this._layerCount=e,this._shadowLayerIndex=e-this.getAdditionalLayerCount()}setDirection(e){this._direction!==e&&(this._direction=e)}getAdditionalLayerCount(){return 1}updateAnimation(e){return 0}getFrameNumber(e,t){return 0}getPostureForAsset(e,t){return null}getAsset(e,t=-1){return this.asset?this.asset.getAsset(e):null}get direction(){return this._direction}get data(){return this._data}}pr.DEPTH_MULTIPLIER=Math.sqrt(.5),pr.TYPE=G.FURNITURE_STATIC;class rt extends pr{constructor(){super(),this._state=-1,this._frameIncrease=1,this._animationData=new Jp,this._animationScale=0,this._animationChangeTime=0,this._animatedLayerCount=0,this._directionChanged=!1}initialize(e){return e instanceof Z_?super.initialize(e):!1}dispose(){super.dispose(),this._animationData&&(this._animationData.dispose(),this._animationData=null)}get animatedLayerCount(){return this._animatedLayerCount}get animationId(){return this._animationData.animationId}getAnimationId(e){return this.animationId!==rt.DEFAULT_ANIMATION_ID&&this.data.hasAnimation(this._animationScale,this.animationId)?this.animationId:rt.DEFAULT_ANIMATION_ID}updateObject(e,t){if(super.updateObject(e,t)){const s=this.object.getState(0);return s!==this._state&&(this.setAnimation(s),this._state=s,this._animationChangeTime=this.object.model.getValue(T.FURNITURE_STATE_UPDATE_TIME)||0),!0}return!1}updateModel(e){if(super.updateModel(e)){if(this.usesAnimationResetting()){const s=this.object.model.getValue(T.FURNITURE_STATE_UPDATE_TIME);s>this._animationChangeTime&&(this._animationChangeTime=s,this.setAnimation(this._state))}const t=this.object.model.getValue(T.FURNITURE_AUTOMATIC_STATE_INDEX);if(!isNaN(t)){const s=this.data.getAnimationId(this._animationScale,t);this.setAnimation(s)}return!0}return!1}isPlayingTransition(e,t){return!(!st.isTransitionFromAnimation(e.animationId)&&!st.isTransitionToAnimation(e.animationId)||t!==e.animationAfterTransitionId||e.animationOver)}getCurrentState(e){const t=e.animationId;return!st.isTransitionFromAnimation(t)&&!st.isTransitionToAnimation(t)?t:e.animationAfterTransitionId}setAnimation(e){this.data&&this.setSubAnimation(this._animationData,e,this._state>=0)}setSubAnimation(e,t,s=!0){const i=e.animationId;if(s){if(this.isPlayingTransition(e,t))return!1;const n=this.getCurrentState(e);if(t!==n){if(!this.data.isImmediateChange(this._animationScale,t,n)){let a=st.getTransitionFromAnimationId(n);this.data.hasAnimation(this._animationScale,a)?(e.animationAfterTransitionId=t,t=a):(a=st.getTransitionToAnimationId(t),this.data.hasAnimation(this._animationScale,a)&&(e.animationAfterTransitionId=t,t=a))}}else if(st.isTransitionFromAnimation(e.animationId)){const a=st.getTransitionToAnimationId(t);this.data.hasAnimation(this._animationScale,a)&&(e.animationAfterTransitionId=t,t=a)}else if(!st.isTransitionToAnimation(e.animationId)&&this.usesAnimationResetting()){const a=st.getTransitionFromAnimationId(n);if(this.data.hasAnimation(this._animationScale,a))e.animationAfterTransitionId=t,t=a;else{const o=st.getTransitionToAnimationId(t);this.data.hasAnimation(this._animationScale,o)&&(e.animationAfterTransitionId=t,t=o)}}}return i!==t?(e.animationId=t,!0):!1}getLastFramePlayed(e){return this._animationData.getLastFramePlayed(e)}resetAllAnimationFrames(){this._animationData&&this._animationData.setLayerCount(this._animatedLayerCount)}updateAnimation(e){if(!this.data)return 0;e!==this._animationScale&&(this._animationScale=e,this._animatedLayerCount=this.data.getLayerCount(e),this.resetAllAnimationFrames());const t=this.updateAnimations(e);return this._directionChanged=!1,t}updateAnimations(e){if(this._animationData.animationOver&&!this._directionChanged)return 0;const t=this.updateFramesForAnimation(this._animationData,e);return this._animationData.animationOver&&(st.isTransitionFromAnimation(this._animationData.animationId)||st.isTransitionToAnimation(this._animationData.animationId))&&(this.setAnimation(this._animationData.animationAfterTransitionId),this._animationData.animationOver=!1),t}updateFramesForAnimation(e,t){if(e.animationOver&&!this._directionChanged)return 0;const s=this.getAnimationId(e);let i=e.frameCounter;i||(i=this.data.getStartFrame(t,s,this._direction)),i+=this.frameIncrease,e.frameCounter=i,e.animationOver=!0;let n=!1,a=this._animatedLayerCount-1,o=0,u=1<<this._animatedLayerCount-1;for(;a>=0;){let l=0;if(n=e.getAnimationPlayed(a),!n||this._directionChanged){let d=e.getLastFramePlayed(a),c=e.getFrame(a);c&&c.isLastFrame&&c.remainingFrameRepeats<=this.frameIncrease&&(d=!0),(this._directionChanged||!c||c.remainingFrameRepeats>=0&&(c.remainingFrameRepeats=c.remainingFrameRepeats-this.frameIncrease)<=0)&&(l=xt.SEQUENCE_NOT_DEFINED,c&&(l=c.activeSequence),l===xt.SEQUENCE_NOT_DEFINED?c=this.data.getFrame(t,s,this._direction,a,i):c=this.data.getFrameFromSequence(t,s,this._direction,a,l,c.activeSequenceOffset+c.repeats,i),e.setFrame(a,c),o=o|u),!c||c.remainingFrameRepeats==xt.FRAME_REPEAT_FOREVER?(d=!0,n=!0):e.animationOver=!1,e.setLastFramePlayed(a,d),e.setAnimationPlayed(a,n)}u=u>>1,a--}return o}getFrameNumber(e,t){const s=this._animationData.getFrame(t);return s?s.id:super.getFrameNumber(e,t)}getLayerXOffset(e,t,s){const i=super.getLayerXOffset(e,t,s),n=this._animationData.getFrame(s);return n?i+n.x:i}getLayerYOffset(e,t,s){const i=super.getLayerYOffset(e,t,s),n=this._animationData.getFrame(s);return n?i+n.y:i}usesAnimationResetting(){return!1}setDirection(e){this._direction!==e&&(super.setDirection(e),this._directionChanged=!0)}get frameIncrease(){return this._frameIncrease}get data(){return this._data}}rt.TYPE=G.FURNITURE_ANIMATED,rt.DEFAULT_ANIMATION_ID=0;class Fa extends rt{constructor(){super(),this._badgeId="",this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale="",this._badgeVisibleInState=-1}updateModel(e){let t=super.updateModel(e);const s=this.object.model.getValue(T.FURNITURE_BADGE_IMAGE_STATUS),i=this.object.model.getValue(T.FURNITURE_BADGE_ASSET_NAME);if(s===-1)this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale="";else if(s===1&&i!==this._badgeId){this._badgeId=i,this._badgeAssetNameNormalScale=this._badgeId,this._badgeAssetNameSmallScale===""&&(this._badgeAssetNameSmallScale=this._badgeAssetNameNormalScale+"_32");const n=this.object.model.getValue(T.FURNITURE_BADGE_VISIBLE_IN_STATE);isNaN(n)||(this._badgeVisibleInState=n),t=!0}return t}getSpriteAssetName(e,t){return this.getLayerTag(e,this.direction,t)!==Fa.BADGE||this._badgeVisibleInState!==-1&&this.object.getState(0)!==this._badgeVisibleInState?super.getSpriteAssetName(e,t):e===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale}getLayerXOffset(e,t,s){let i=super.getLayerXOffset(e,t,s);if(this.getLayerTag(e,t,s)===Fa.BADGE){const n=this.getAsset(e===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,s);n&&(e===64?i+=(40-n.width)/2:i+=(20-n.width)/2)}return i}getLayerYOffset(e,t,s){let i=super.getLayerYOffset(e,t,s);if(this.getLayerTag(e,t,s)===Fa.BADGE){const n=this.getAsset(e===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,s);n&&(e===64?i+=(40-n.height)/2:i+=(20-n.height)/2)}return i}}Fa.BADGE="BADGE";class gs extends pr{constructor(){super(),this._imageUrl=null,this._shortUrl=null,this._imageReady=!1,this._isAnimated=!1,this._gifCollection=null,this._offsetX=0,this._offsetY=0,this._offsetZ=0,this._currentFrame=-1,this._totalFrames=-1}dispose(){super.dispose(),this._imageUrl&&this.asset&&this.asset.disposeAsset(this._imageUrl)}updateObject(e,t){return super.updateObject(e,t)?(this._imageReady&&this.checkAndCreateImageForCurrentState(),!0):!1}updateModel(e){const t=super.updateModel(e);if(t&&(this._offsetX=this.object.model.getValue(T.FURNITURE_BRANDING_OFFSET_X)||0,this._offsetY=this.object.model.getValue(T.FURNITURE_BRANDING_OFFSET_Y)||0,this._offsetZ=this.object.model.getValue(T.FURNITURE_BRANDING_OFFSET_Z)||0,this._isAnimated=this.object.model.getValue(T.FURNITURE_BRANDING_IS_ANIMATED)||!1),this._imageReady){if(this.checkIfImageChanged())return this._imageReady=!1,this._imageUrl=null,!0}else if(this._imageReady=this.checkIfImageReady(),this._imageReady)return this.checkAndCreateImageForCurrentState(),!0;return t}checkIfImageChanged(){const e=this.object.model.getValue(T.FURNITURE_BRANDING_IMAGE_URL);return e&&e===this._imageUrl?!1:(this._gifCollection,this.asset&&this.asset.disposeAsset(this._imageUrl),!0)}checkIfImageReady(){if(!(this.object&&this.object.model))return!1;const t=this.object.model.getValue(T.FURNITURE_BRANDING_IMAGE_URL);if(!t||this._imageUrl&&this._imageUrl===t)return!1;if(this.object.model.getValue(T.FURNITURE_BRANDING_IMAGE_STATUS)===1){let i=null;if(this._isAnimated){const n=X.instance.roomEngine.roomContentLoader.getGifCollection(t);n&&(this._gifCollection=n,i=n.textures[0])}else i=Ws().getTexture(t);return i?(this.imageReady(i,t),!0):!1}return!1}imageReady(e,t){if(!e){this._imageUrl=null;return}this._imageUrl=t}checkAndCreateImageForCurrentState(){if(this._isAnimated){this.buildAssetsForGif();return}if(!this._imageUrl)return;const e=Ws().getTexture(this._imageUrl);if(!e)return;const t=this.object.getState(0);this.addBackgroundAsset(e,t,0)}buildAssetsForGif(){if(!this._gifCollection)return;const e=this._gifCollection.textures,t=this._gifCollection.durations;if(!e.length||!t.length||e.length!==t.length)return;const s=this.object.getState(0);for(let i=0;i<e.length;i++){const n=e[i];t[i],n&&this.addBackgroundAsset(n,s,i)}this._currentFrame=-1,this._totalFrames=e.length}addBackgroundAsset(e,t,s){let i=0,n=0,a=!1,o=!1;switch(t){case gs.STATE_0:i=0,n=0,a=!1,o=!1;break;case gs.STATE_1:i=-e.width,n=0,a=!0,o=!1;break;case gs.STATE_2:i=-e.width,n=-e.height,a=!0,o=!0;break;case gs.STATE_3:i=0,n=-e.height,a=!1,o=!0;break}this.asset.addAsset(`${this._imageUrl}_${s}`,e,!0,i,n,a,o)}getSpriteAssetName(e,t){return this.getLayerTag(e,this._direction,t)===gs.BRANDED_IMAGE&&this._imageUrl?`${this._imageUrl}_${this.getFrameNumber(e,t)}`:super.getSpriteAssetName(e,t)}updateAnimation(e){return!this._imageReady||!this._isAnimated||this._totalFrames<=0?0:1}getFrameNumber(e,t){if(!this._imageReady||!this._isAnimated||this._totalFrames<=0)return 0;if(this.getLayerTag(e,this._direction,t)===gs.BRANDED_IMAGE&&this._imageUrl){let i=this._currentFrame;return i<0?i=0:i+=1,i===this._totalFrames&&(i=0),this._currentFrame=i,this._currentFrame}return 0}}gs.BRANDED_IMAGE="branded_image",gs.STATE_0=0,gs.STATE_1=1,gs.STATE_2=2,gs.STATE_3=3;class $p extends gs{getLayerXOffset(e,t,s){return super.getLayerXOffset(e,t,s)+this._offsetX}getLayerYOffset(e,t,s){return super.getLayerYOffset(e,t,s)+this._offsetY}getLayerZOffset(e,t,s){return super.getLayerZOffset(e,t,s)+this._offsetZ}}class sn extends rt{constructor(){super(),this._stateQueue=[],this._running=!1}setAnimation(e){if(e===-1&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(sn.ANIMATION_ID_ROLL);return}if(e>=0&&e<=7){if(this._running){this._running=!1,this._stateQueue=[],this._stateQueue.push(sn.ANIMATION_ID_OFFSET_SLOW1),this._stateQueue.push(sn.ANIMATION_ID_OFFSET_SLOW2+e),this._stateQueue.push(e);return}super.setAnimation(e)}}updateAnimation(e){return this.getLastFramePlayed(0)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(e)}}sn.ANIMATION_ID_OFFSET_SLOW1=20,sn.ANIMATION_ID_OFFSET_SLOW2=9,sn.ANIMATION_ID_ROLL=-1;class U3 extends pr{}class xr extends rt{getFrameNumber(e,t){const s=this.getLayerTag(e,this.direction,t),i=this.object.getState(0);switch(s){case xr.SECONDS_SPRITE:return Math.floor(i%60%10);case xr.TEN_SECONDS_SPRITE:return Math.floor(i%60/10);case xr.MINUTES_SPRITE:return Math.floor(i/60%10);case xr.TEN_MINUTES_SPRITE:return Math.floor(i/60/10%10);default:return super.getFrameNumber(e,t)}}get animationId(){return 0}}xr.SECONDS_SPRITE="seconds_sprite",xr.TEN_SECONDS_SPRITE="ten_seconds_sprite",xr.MINUTES_SPRITE="minutes_sprite",xr.TEN_MINUTES_SPRITE="ten_minutes_sprite";class F3 extends Mn{}class wa extends rt{constructor(){super(),this._thumbnailAssetNameNormal=null,this._thumbnailImageNormal=null,this._thumbnailDirection=-1,this._thumbnailChanged=!1,this._hasOutline=!1}get hasThumbnailImage(){return this._thumbnailImageNormal!=null}setThumbnailImages(e){this._thumbnailImageNormal=e,this._thumbnailChanged=!0}updateModel(e){const t=super.updateModel(e);return!this._thumbnailChanged&&this._thumbnailDirection===this.direction?t:(this.refreshThumbnail(),!0)}refreshThumbnail(){this.asset!=null&&(this._thumbnailImageNormal?this.addThumbnailAsset(this._thumbnailImageNormal,64):this.asset.disposeAsset(this.getThumbnailAssetName(64)),this._thumbnailChanged=!1,this._thumbnailDirection=this.direction)}addThumbnailAsset(e,t){let s=0;for(;s<this.totalSprites;){if(this.getLayerTag(t,this.direction,s)===wa.THUMBNAIL){const i=this.cacheSpriteAssetName(t,s,!1)+this.getFrameNumber(t,s),n=this.getAsset(i,s);if(n){const a=this.generateTransformedThumbnail(e,n),o=this.getThumbnailAssetName(t);this.asset.disposeAsset(o),this.asset.addAsset(o,a,!0,n.offsetX,n.offsetY,!1,!1)}return}s++}}generateTransformedThumbnail(e,t){if(this._hasOutline){const o=new ot,u=new ot(ig.WHITE);u.tint=0,u.width=e.width+40,u.height=e.height+40;const l=new ot(e),d=(u.width-l.width)/2,c=(u.height-l.height)/2;l.position.set(d,c),o.addChild(u,l),e=Je.generateTexture(o)}const s=1.1,i=new Ye,n=t.width/e.width;switch(this.direction){case 2:i.a=n,i.b=-.5*n,i.c=0,i.d=n*s,i.tx=0,i.ty=.5*n*e.width;break;case 0:case 4:i.a=n,i.b=.5*n,i.c=0,i.d=n*s,i.tx=0,i.ty=0;break;default:i.a=n,i.b=0,i.c=0,i.d=n,i.tx=0,i.ty=0}const a=new ot(e);return a.transform.setFromMatrix(i),Je.generateTexture(a)}getSpriteAssetName(e,t){return this._thumbnailImageNormal&&this.getLayerTag(e,this.direction,t)===wa.THUMBNAIL?this.getThumbnailAssetName(e):super.getSpriteAssetName(e,t)}getThumbnailAssetName(e){return this._thumbnailAssetNameNormal=this.getFullThumbnailAssetName(this.object.id,64),this._thumbnailAssetNameNormal}getFullThumbnailAssetName(e,t){return[this._type,e,"thumb",t].join("_")}}wa.THUMBNAIL="THUMBNAIL";class eI extends wa{constructor(){super(),this._cachedUrl=null,this._hasOutline=!0}updateModel(e){if(this.object){const t=this.getThumbnailURL();if(this._cachedUrl!==t)if(this._cachedUrl=t,this._cachedUrl&&this._cachedUrl!==""){const s=new Image;s.src=t,s.crossOrigin="*",s.onload=()=>{const i=Re.from(s);i.baseTexture.scaleMode=Ds.LINEAR,this.setThumbnailImages(i)}}else this.setThumbnailImages(null)}return super.updateModel(e)}getThumbnailURL(){throw new Error("This method must be overridden!")}}class w3 extends eI{constructor(){super(),this._url=null,this._typePrefix=null}getThumbnailURL(){if(!this.object)return null;if(this._url)return this._url;const e=this.object.model.getValue(T.FURNITURE_DATA);if(!e||e==="")return null;this.object.type.indexOf("")>=0&&(this._typePrefix=this.object.type.indexOf("")>=0?"":"postcards/selfie/");let s=JSON.parse(e).w||"";return s=this.buildThumbnailUrl(s),this._url=s,this._url}buildThumbnailUrl(e){return e=e.replace(".png","_small.png"),e.indexOf(".png")===-1&&(e=e+"_small.png"),e}}class tI{constructor(){this._hasMoved=!1,this._age=0,this._isEmitter=!1,this._fade=!1,this._alphaMultiplier=1}init(e,t,s,i,n,a,o,u=!1,l=null,d=!1){this._x=e,this._y=t,this._z=s,this._particleDirection=new Hs(i.x,i.y,i.z),this._particleDirection.scaleBy(n),this._lastX=this._x-this._particleDirection.x*a,this._lastY=this._y-this._particleDirection.y*a,this._lastZ=this._z-this._particleDirection.z*a,this._age=0,this._hasMoved=!1,this._lifeTime=o,this._isEmitter=u,this._frames=l,this._fade=d,this._alphaMultiplier=1,this._fadeTime=.5+Math.random()*.5}dispose(){this._particleDirection=null}update(){this._age++,this._age===this._lifeTime&&this.ignite(),this._fade&&this._age/this._lifeTime>this._fadeTime&&(this._alphaMultiplier=(this._lifeTime-this._age)/(this._lifeTime*(1-this._fadeTime)))}getAsset(){return this._frames&&this._frames.length>0?this._frames[this._age%this._frames.length]:null}ignite(){}get fade(){return this._fade}get alphaMultiplier(){return this._alphaMultiplier}get direction(){return this._particleDirection}get age(){return this._age}get isEmitter(){return this._isEmitter}get isAlive(){return this._age<=this._lifeTime}get x(){return this._x}set x(e){this._x=e}get y(){return this._y}set y(e){this._y=e}get z(){return this._z}set z(e){this._z=e}get lastX(){return this._lastX}set lastX(e){this._hasMoved=!0,this._lastX=e}get lastY(){return this._lastY}set lastY(e){this._hasMoved=!0,this._lastY=e}get lastZ(){return this._lastZ}set lastZ(e){this._hasMoved=!0,this._lastZ=e}get hasMoved(){return this._hasMoved}toString(){return[this._x,this._y,this._z].toString()}copy(e,t){this._x=e._x*t,this._y=e._y*t,this._z=e._z*t,this._lastX=e._lastX*t,this._lastY=e._lastY*t,this._lastZ=e._lastZ*t,this._hasMoved=e.hasMoved,this._particleDirection=e._particleDirection,this._age=e._age,this._lifeTime=e._lifeTime,this._isEmitter=e._isEmitter,this._fade=e._fade,this._fadeTime=e._fadeTime,this._alphaMultiplier=e._alphaMultiplier}}class rn extends tI{constructor(e="",t=-1){super(),this._roomObjectSpriteId=-1,this._timeStep=.1,this._fuseTime=10,this._energy=1,this._hasIgnited=!1,this._burstPulse=1,this._particles=[],this._name=e,this._roomObjectSpriteId=t,this._particleConfigurations=[]}dispose(){for(const e of this._particles)e.dispose();this._particles=null,this._particleConfigurations=null,super.dispose()}setup(e,t,s,i,n,a,o,u,l,d){this._maxNumberOfParticles=e,this._particlesPerFrame=t,this._force=s,this._emitterDirection=i,this._emitterDirection.normalize(),this._gravity=n,this._airFriction=a,this._explosionShape=o,this._fuseTime=l,this._energy=u,this._burstPulse=d,this.reset()}reset(){for(const e of this._particles)e.dispose();this._particles=[],this._emittedParticles=0,this._hasIgnited=!1,this.init(0,0,0,this._emitterDirection,this._force,this._timeStep,this._fuseTime,!0)}copyStateFrom(e,t){super.copy(e,t),this._force=e._force,this._emitterDirection=e._emitterDirection,this._gravity=e._gravity,this._airFriction=e._airFriction,this._explosionShape=e._explosionShape,this._fuseTime=e._fuseTime,this._energy=e._energy,this._burstPulse=e._burstPulse,this._timeStep=e._timeStep,this._hasIgnited=e._hasIgnited}configureParticle(e,t,s,i){const n={};n.lifeTime=e,n.isEmitter=t,n.frames=s,n.fade=i,this._particleConfigurations.push(n)}ignite(){this._hasIgnited=!0,this._emittedParticles<this._maxNumberOfParticles&&this.age>1&&this.releaseParticles(this,this.direction)}releaseParticles(e,t=null){t||(t=new Hs);const s=new Hs,i=this.getRandomParticleConfiguration();let n=0;for(;n<this._particlesPerFrame;){switch(this._explosionShape){case rn.CONE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=-(Math.random()+1),s.z=this.randomBoolean(.5)?Math.random():-Math.random();break;case rn.PLANE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=0,s.z=this.randomBoolean(.5)?Math.random():-Math.random();break;case rn.SPHERE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=this.randomBoolean(.5)?Math.random():-Math.random(),s.z=this.randomBoolean(.5)?Math.random():-Math.random();break}s.normalize();const a=new tI;let o=0,u=!1,l=!1,d=[];i?(o=Math.floor(Math.random()*i.lifeTime+10),u=i.isEmitter,d=i.frames,l=i.fade):(o=Math.trunc(Math.floor(Math.random()*20+10)),u=!1,d=[]),a.init(e.x,e.y,e.z,s,this._energy,this._timeStep,o,u,d,l),this._particles.push(a),this._emittedParticles++,n++}}getRandomParticleConfiguration(){const e=Math.trunc(Math.floor(Math.random()*this._particleConfigurations.length));return this._particleConfigurations[e]}update(){super.update(),this.accumulateForces(),this.verlet(),this.satisfyConstraints(),!this.isAlive&&this._emittedParticles<this._maxNumberOfParticles&&this.age%this._burstPulse===0&&this.releaseParticles(this,this.direction)}verlet(){if(this.isAlive||this._emittedParticles<this._maxNumberOfParticles){const t=this.x,s=this.y,i=this.z;this.x=(2-this._airFriction)*this.x-(1-this._airFriction)*this.lastX,this.y=(2-this._airFriction)*this.y-(1-this._airFriction)*this.lastY+this._gravity*this._timeStep*this._timeStep,this.z=(2-this._airFriction)*this.z-(1-this._airFriction)*this.lastZ,this.lastX=t,this.lastY=s,this.lastZ=i}const e=[];for(const t of this._particles){t.update();const s=t.x,i=t.y,n=t.z;t.x=(2-this._airFriction)*t.x-(1-this._airFriction)*t.lastX,t.y=(2-this._airFriction)*t.y-(1-this._airFriction)*t.lastY+this._gravity*this._timeStep*this._timeStep,t.z=(2-this._airFriction)*t.z-(1-this._airFriction)*t.lastZ,t.lastX=s,t.lastY=i,t.lastZ=n,(t.y>10||!t.isAlive)&&e.push(t)}for(const t of e)t.isEmitter,this._particles.splice(this._particles.indexOf(t),1),t.dispose()}satisfyConstraints(){}accumulateForces(){for(const e of this._particles);}get particles(){return this._particles}get hasIgnited(){return this._hasIgnited}randomBoolean(e){return Math.random()<e}get roomObjectSpriteId(){return this._roomObjectSpriteId}}rn.CONE="cone",rn.PLANE="plane",rn.SPHERE="sphere";class x3{constructor(e){this._canvasId=-1,this._hasIgnited=!1,this._centerX=0,this._centerY=0,this._scaleMultiplier=1,this._blend=1,this._bgColor=4278190080,this._isDone=!1,this._emitters=new Ot,this._visualization=e,this._blackOverlayAlphaTransform=new sg,this._blackOverlayAlphaTransform.alpha=1,this._particleColorTransform=new sg,this._identityMatrix=new Ye,this._translationMatrix=new Ye}dispose(){for(const e of this._emitters.getValues())e.dispose();this._emitters=null,this._canvasTexture&&(this._canvasTexture.destroy(),this._canvasTexture=null),this._blackOverlay&&(this._blackOverlay.destroy(),this._blackOverlay=null),this._emptySprite&&(this._emptySprite.destroy(),this._emptySprite=null),this._blackOverlayAlphaTransform=null,this._particleColorTransform=null,this._identityMatrix=null,this._translationMatrix=null}reset(){this._currentEmitter&&this._currentEmitter.reset(),this._currentEmitter=null,this._hasIgnited=!1,this._isDone=!1,this.updateCanvas()}setAnimation(e){this._currentEmitter&&this._currentEmitter.reset(),this._currentEmitter=this._emitters.getValue(e),this._hasIgnited=!1,this._isDone=!1,this.updateCanvas()}updateCanvas(){if(!(!this._currentEmitter||this._canvasId===-1)&&(this._roomSprite=this._visualization.getSprite(this._canvasId),this._roomSprite&&this._roomSprite.texture)){if(this._roomSprite.width<=1||this._roomSprite.height<=1)return;this._canvasTexture&&(this._canvasTexture.width!==this._roomSprite.width||this._canvasTexture.height!==this._roomSprite.height)&&(this._canvasTexture=null),this.clearCanvas(),this._centerX=-this._roomSprite.offsetX,this._centerY=-this._roomSprite.offsetY,this._roomSprite.texture=this._canvasTexture}}getLayerYOffset(e,t,s){return this._currentEmitter&&this._currentEmitter.roomObjectSpriteId===s?this._currentEmitter.y*this._scaleMultiplier:0}controlsSprite(e){return this._currentEmitter?this._currentEmitter.roomObjectSpriteId==e:!1}updateSprites(){!this._currentEmitter||!this._roomSprite||(this._canvasTexture&&this._roomSprite.texture!==this._canvasTexture&&(this._roomSprite.texture=this._canvasTexture),this._hasIgnited&&this._currentEmitter.roomObjectSpriteId>=0&&(this._visualization.getSprite(this._currentEmitter.roomObjectSpriteId).visible=!1))}updateAnimation(){if(!this._currentEmitter||!this._roomSprite||this._isDone)return;const e=10;!this._hasIgnited&&this._currentEmitter.hasIgnited&&(this._hasIgnited=!0);const t=this._offsetY*this._scaleMultiplier;if(this._currentEmitter.update(),this._hasIgnited){this._currentEmitter.roomObjectSpriteId>=0&&(this._visualization.getSprite(this._currentEmitter.roomObjectSpriteId).visible=!1),this._canvasTexture||this.updateCanvas(),this.clearCanvas();for(const s of this._currentEmitter.particles){const i=this._centerX+(s.x-s.z)*e/10*this._scaleMultiplier,n=this._centerY-t+(s.y+(s.x+s.z)/2)*e/10*this._scaleMultiplier,a=s.getAsset();if(a&&a.texture)if(s.fade&&s.alphaMultiplier<1){this._translationMatrix.identity(),this._translationMatrix.translate(i+a.offsetX,n+a.offsetY);const o=new ot(a.texture);this._particleColorTransform.alpha=s.alphaMultiplier,o.filters=[this._particleColorTransform],_t.instance.renderer.render(o,{renderTexture:this._canvasTexture,transform:this._translationMatrix,clear:!1})}else{const o=new Hh(i+a.offsetX,n+a.offsetY),u=new ot(a.texture);u.x=o.x,u.y=o.y,_t.instance.renderer.render(u,{renderTexture:this._canvasTexture,clear:!1})}else{const o=new ot(Re.WHITE);o.tint=16777215,o.x=i-1,o.y=n-1,o.width=2,o.height=2,_t.instance.renderer.render(o,{renderTexture:this._canvasTexture,clear:!1})}}if(!this._currentEmitter.particles.length){this._isDone=!0;return}}}parseData(e){this._size=e.size,this._canvasId=e.canvasId!==void 0?e.canvasId:-1,this._offsetY=e.offsetY!==void 0?e.offsetY:10,this._scaleMultiplier=this._size/64,this._blend=e.blend!==void 0?e.blend:1,this._blend=Math.min(this._blend,1),this._blackOverlayAlphaTransform.alpha=this._blend;const t=e.bgColor!==void 0?e.bgColor:"0";if(this._bgColor=parseInt(t,16)||0,!(!e.emitters||!e.emitters.length))for(const s of e.emitters){const i=s.id,n=s.name,a=s.spriteId,o=new rn(n,a);this._emitters.add(i,o);const u=s.maxNumParticles,l=s.particlesPerFrame,d=s.burstPulse!==void 0?s.burstPulse:1,c=s.fuseTime,_=s.simulation.force,f=s.simulation.direction,g=s.simulation.gravity,I=s.simulation.airFriction,p=s.simulation.shape,R=s.simulation.energy;for(const S of s.particles){const O=S.lifeTime,A=S.isEmitter||!1,C=S.fade||!1,M=[];for(const N of S.frames)M.push(this._visualization.asset.getAsset(N));o.configureParticle(O,A,M,C)}o.setup(u,l,_,new Hs(0,f,0),g,I,p,R,c,d)}}copyStateFrom(e){let t=0;e._emitters&&e._currentEmitter&&(t=e._emitters.getKey(e._emitters.getValues().indexOf(e._currentEmitter))),this.setAnimation(t),this._currentEmitter&&this._currentEmitter.copyStateFrom(e._currentEmitter,e._size/this._size),this._canvasTexture=null}clearCanvas(){this._emptySprite||(this._emptySprite=new ot(Re.EMPTY),this._emptySprite.alpha=0),this._canvasTexture?_t.instance.renderer.render(this._emptySprite,{renderTexture:this._canvasTexture,clear:!0}):this._canvasTexture=kt.create({width:this._roomSprite.width,height:this._roomSprite.height})}}class sI extends rt{dispose(){if(super.dispose(),this._currentParticleSystem=null,this._particleSystems){for(const e of this._particleSystems.getValues())e.dispose();this._particleSystems=null}}updateObject(e,t){if(super.updateObject(e,t)){if(!this._particleSystems)this.readDefinition(),this._particleSystems?this._currentParticleSystem=this._particleSystems.getValue(e):Y.log("ERROR Particle systems could not be read!",this.object.type);else if(e!==this._scale||this._particleSystems.getValue(e)!==this._currentParticleSystem){const s=this._particleSystems.getValue(e);s.copyStateFrom(this._currentParticleSystem),this._currentParticleSystem&&this._currentParticleSystem.reset(),this._currentParticleSystem=s}return!0}return!1}updateSprites(e,t,s){super.updateSprites(e,t,s),this._currentParticleSystem&&this._currentParticleSystem.updateSprites()}updateAnimation(e){return this._currentParticleSystem&&this._currentParticleSystem.updateAnimation(),super.updateAnimation(e)}setAnimation(e){this._currentParticleSystem&&this._currentParticleSystem.setAnimation(e),super.setAnimation(e)}getLayerYOffset(e,t,s){return this._currentParticleSystem&&this._currentParticleSystem.controlsSprite(s)?this._currentParticleSystem.getLayerYOffset(e,t,s):super.getLayerYOffset(e,t,s)}readDefinition(){if(!this.object||!this.object.model)return!1;const e=this.object.model.getValue(T.FURNITURE_FIREWORKS_DATA);if(!e||!e.length)return!1;this._particleSystems=new Ot;for(const t of e){const s=t.size,i=new x3(this);i.parseData(t),this._particleSystems.add(s,i)}return!0}}class nn extends sI{constructor(){super(...arguments),this._packetType=0,this._ribbonType=0,this._lastAnimationId=0}update(e,t,s,i){this.updatePresentWrap(),super.update(e,t,s,i)}updatePresentWrap(){if(!this.object)return;const e=1e3,t=this.object.model.getValue(T.FURNITURE_EXTRAS),s=parseInt(t),i=Math.floor(s/e),n=s%e;this._packetType=i>nn.MAX_PACKET_TYPE_VALUE?0:i,this._ribbonType=n>nn.MAX_RIBBON_TYPE_VALUE?0:n}getFrameNumber(e,t){if(this._lastAnimationId===nn.PRESENT_DEFAULT_STATE){if(t<=1)return this._packetType;if(t===2)return this._ribbonType}return super.getFrameNumber(e,t)}getSpriteAssetName(e,t){const s=this.getValidSize(e);let i=this._type,n="";t<this.spriteCount-1?n=String.fromCharCode("a".charCodeAt(0)+t):n="sd";const a=this.getFrameNumber(e,t);return i=i+("_"+s+"_"+n+"_"+this.direction),i=i+("_"+a),i}setAnimation(e){this._lastAnimationId=e,super.setAnimation(e)}}nn.PRESENT_DEFAULT_STATE=0,nn.MAX_PACKET_TYPE_VALUE=9,nn.MAX_RIBBON_TYPE_VALUE=11;class G3 extends pr{constructor(){super(...arguments),this._packetType=0,this._ribbonType=0}update(e,t,s,i){this.updatePresentWrap(),super.update(e,t,s,i)}updatePresentWrap(){if(!this.object)return;const e=this.object.model.getValue(T.FURNITURE_EXTRAS),t=1e3,s=parseInt(e);this._packetType=Math.floor(s/t),this._ribbonType=s%t}getFrameNumber(e,t){return t<=1?this._packetType:this._ribbonType}getSpriteAssetName(e,t){const s=this.getValidSize(e);let i=this._type,n="";t<this.spriteCount-1?n=String.fromCharCode("a".charCodeAt(0)+t):n="sd";const a=this.getFrameNumber(e,t);return i=i+("_"+s+"_"+n+"_"+this.direction),i=i+("_"+a),i}}class Es extends rt{constructor(){super(),this._color1=Es.DEFAULT_COLOR_1,this._color2=Es.DEFAULT_COLOR_2,this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale=""}updateModel(e){const t=super.updateModel(e);if(this._badgeAssetNameNormalScale===""){const n=this.object.model.getValue(T.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME);n&&(this._badgeAssetNameNormalScale=n,this._badgeAssetNameSmallScale=this._badgeAssetNameNormalScale+"_32")}const s=this.object.model.getValue(T.FURNITURE_GUILD_CUSTOMIZED_COLOR_1);this._color1=s||Es.DEFAULT_COLOR_1;const i=this.object.model.getValue(T.FURNITURE_GUILD_CUSTOMIZED_COLOR_2);return this._color2=i||Es.DEFAULT_COLOR_2,t}getLayerColor(e,t,s){switch(this.getLayerTag(e,this._direction,t)){case Es.PRIMARY_COLOUR_SPRITE_TAG:return this._color1;case Es.SECONDARY_COLOUR_SPRITE_TAG:return this._color2}return super.getLayerColor(e,t,s)}getSpriteAssetName(e,t){return this.getLayerTag(e,this._direction,t)===Es.BADGE?e===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale:super.getSpriteAssetName(e,t)}getLibraryAssetNameForSprite(e,t){return t.tag===Es.BADGE?"%group.badge.url%"+t.libraryAssetName.replace("badge_",""):super.getLibraryAssetNameForSprite(e,t)}}Es.PRIMARY_COLOUR_SPRITE_TAG="COLOR1",Es.SECONDARY_COLOUR_SPRITE_TAG="COLOR2",Es.BADGE="BADGE",Es.DEFAULT_COLOR_1=15658734,Es.DEFAULT_COLOR_2=4934475;class Ir extends wa{updateModel(e){const t=super.updateModel(e);if(!this.hasThumbnailImage){const n=this.object.model.getValue(T.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME);n&&n.length&&this.setThumbnailImages(this.getBitmapAsset(n))}const s=this.object.model.getValue(T.FURNITURE_GUILD_CUSTOMIZED_COLOR_1);this._color1=s||Ir.DEFAULT_COLOR_1;const i=this.object.model.getValue(T.FURNITURE_GUILD_CUSTOMIZED_COLOR_2);return this._color2=i||Ir.DEFAULT_COLOR_2,t}generateTransformedThumbnail(e,t){const i=new Ye,n=t.width/e.width;switch(this.direction){case 2:i.a=n,i.b=-.5*n,i.c=0,i.d=n*1.1,i.tx=0,i.ty=.5*n*e.width;break;case 0:case 4:i.a=n,i.b=.5*n,i.c=0,i.d=n*1.1,i.tx=0,i.ty=0;break;default:i.a=n,i.b=0,i.c=0,i.d=n,i.tx=0,i.ty=0}const a=new ot(e);return a.transform.setFromMatrix(i),a.position.set(0),Je.generateTexture(a)}getLayerColor(e,t,s){switch(this.getLayerTag(e,this._direction,t)){case Ir.PRIMARY_COLOUR_SPRITE_TAG:return this._color1;case Ir.SECONDARY_COLOUR_SPRITE_TAG:return this._color2}return super.getLayerColor(e,t,s)}getLibraryAssetNameForSprite(e,t){return t.tag===Ir.THUMBNAIL&&this.object&&this.object.model.getValue(T.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME)?"%group.badge.url%"+this.object.model.getValue(T.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME):super.getLibraryAssetNameForSprite(e,t)}getBitmapAsset(e){const t=this.asset.getAsset(e);return!t||!t.texture?null:t.texture}}Ir.PRIMARY_COLOUR_SPRITE_TAG="COLOR1",Ir.SECONDARY_COLOUR_SPRITE_TAG="COLOR2",Ir.DEFAULT_COLOR_1=15658734,Ir.DEFAULT_COLOR_2=4934475;class Tr extends rt{constructor(){super(),this._stateQueue=[],this._running=!1}setAnimation(e){if(e===-1&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(Tr.ANIMATION_ID_START_ROLL),this._stateQueue.push(Tr.ANIMATION_ID_ROLL);return}if(e>0&&e<=Tr.ANIMATION_ID_OFFSET_SLOW1){if(this._running){this._running=!1,this._stateQueue=[],this._stateQueue.push(Tr.ANIMATION_ID_OFFSET_SLOW1+e),this._stateQueue.push(Tr.ANIMATION_ID_OFFSET_SLOW2+e),this._stateQueue.push(e);return}super.setAnimation(e)}}updateAnimation(e){return this.getLastFramePlayed(1)&&this.getLastFramePlayed(2)&&this.getLastFramePlayed(3)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(e)}}Tr.ANIMATION_ID_OFFSET_SLOW1=10,Tr.ANIMATION_ID_OFFSET_SLOW2=20,Tr.ANIMATION_ID_START_ROLL=31,Tr.ANIMATION_ID_ROLL=32;class B3 extends $p{constructor(){super(...arguments),this._needsTransform=!0}transformGifTextures(e){if(!this._gifCollection)return;const t=this._gifCollection.textures;if(t.length){for(let s=0;s<t.length;s++){const i=t[s];if(!i||!this.getAsset(`${this._imageUrl}_${s}`))continue;const a=1.1,o=new Ye,u=e.width/i.width;switch(this.direction){case 2:o.a=u,o.b=-.5*u,o.c=0,o.d=u*a,o.tx=0,o.ty=.5*u*i.width;break;case 0:case 4:o.a=u,o.b=.5*u,o.c=0,o.d=u*a,o.tx=0,o.ty=0;break;default:o.a=u,o.b=0,o.c=0,o.d=u,o.tx=0,o.ty=0}const l=new ot(i),d=kt.create({width:e.width+o.tx,height:e.height+o.ty});_t.instance.renderer.render(l,{renderTexture:d,clear:!0,transform:o}),this.asset.disposeAsset(`${this._imageUrl}_${s}`),this.asset.addAsset(`${this._imageUrl}_${s}`,d,!0,e.x,e.y,e.flipH,e.flipV)}this._needsTransform=!1}}generateTransformedImage(e,t){const i=new Ye,n=t.width/e.width;switch(this.direction){case 2:i.a=n,i.b=-.5*n,i.c=0,i.d=n*1.1,i.tx=0,i.ty=.5*n*e.width;break;case 0:case 4:i.a=n,i.b=.5*n,i.c=0,i.d=n*1.1,i.tx=0,i.ty=0;break;default:i.a=n,i.b=0,i.c=0,i.d=n,i.tx=0,i.ty=0}const a=new ot(e),o=kt.create({width:t.width+i.tx,height:t.height+i.ty});_t.instance.renderer.render(a,{renderTexture:o,clear:!0,transform:i}),this.asset.disposeAsset(`${this._imageUrl}_0`),this.asset.addAsset(`${this._imageUrl}_0`,o,!0,a.x,a.y,t.flipH,t.flipV),this._needsTransform=!1}checkAndCreateImageForCurrentState(){super.checkAndCreateImageForCurrentState(),this._needsTransform=!0}getSpriteAssetName(e,t){return this.getLayerTag(e,this._direction,t)===gs.BRANDED_IMAGE&&this._imageUrl?(this._needsTransform&&(this._isAnimated?this.transformGifTextures(this.getAsset(super.getSpriteAssetName(e,t))):this.generateTransformedImage(Ws().getTexture(this._imageUrl),this.getAsset(super.getSpriteAssetName(e,t)))),`${this._imageUrl}_${this.getFrameNumber(e,t)}`):super.getSpriteAssetName(e,t)}}class J_ extends pi{constructor(){super(),this._avatarData=new $u}dispose(){super.dispose(),this._avatarData&&(this._avatarData.dispose(),this._avatarData=null)}createAvatarImage(e,t,s=null,i=null,n=null){return this._avatarData.createAvatarImage(e,t,s,i,n)}set avatarManager(e){this._avatarData.avatarManager=e}}class xa extends pr{constructor(){super(),this._mannequinScale=-1,this._figure=null,this._gender=null,this._dynamicAssetName=null,this._needsUpdate=!1,this._placeHolderFigure="hd-99999-99998",this._disposed=!1}initialize(e){return e instanceof J_?super.initialize(e):!1}dispose(){this._disposed||(this._disposed=!0,this._dynamicAssetName&&this.asset&&(this.asset.disposeAsset(this._dynamicAssetName),this._dynamicAssetName=null),super.dispose())}updateObject(e,t){const s=super.updateObject(e,t);return s&&this._mannequinScale!==e&&(this._mannequinScale=e,this.updateAvatar()),s}updateModel(e){let t=super.updateModel(e);if(t){const s=this.object.model.getValue(T.FURNITURE_MANNEQUIN_FIGURE)||null;s&&(this._figure=s+"."+this._placeHolderFigure,this._gender=this.object.model.getValue(T.FURNITURE_MANNEQUIN_GENDER)||null,this.updateAvatar())}return t=t||this._needsUpdate,this._needsUpdate=!1,t}updateAvatar(e=!1){if(!this.avatarExists()||e){const t=this.data.createAvatarImage(this._figure,this._mannequinScale,this._gender,this);t&&(t.setDirection(rs.FULL,this.direction),this._dynamicAssetName&&this.asset.disposeAsset(this._dynamicAssetName),this.asset.addAsset(this.getAvatarAssetName(),t.getImage(rs.FULL,!1,1,!1),!0),this._dynamicAssetName=this.getAvatarAssetName(),this._needsUpdate=!0,t.dispose())}}avatarExists(){return this._figure&&this.getAsset(this.getAvatarAssetName())!==null}getAvatarAssetName(){return"mannequin_"+this._figure+"_"+this._mannequinScale+"_"+this.direction+"_"+this.object.id}resetFigure(e){e===this._figure&&this.updateAvatar(!0)}getSpriteAssetName(e,t){const s=this.getLayerTag(e,this.direction,t);return this._figure&&s===xa.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?this.getAvatarAssetName():super.getSpriteAssetName(e,t)}getLayerXOffset(e,t,s){return this.getLayerTag(e,t,s)===xa.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?-this.getSprite(s).width/2:super.getLayerXOffset(e,t,s)}getLayerYOffset(e,t,s){return this.getLayerTag(e,t,s)===xa.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?-this.getSprite(s).height:super.getLayerYOffset(e,t,s)}get disposed(){return this._disposed}get data(){return this._data}}xa.AVATAR_IMAGE_SPRITE_TAG="avatar_image";class Gs extends rt{constructor(){super(),this._animOffsetIndex=[]}updateAnimation(e){this._animSpeedIndex||this.initItems(e);let t=this.getSprite(2);return t&&(this._animOffsetIndex[0]=this.getNewPoint(e,0)),t=this.getSprite(3),t&&(this._animOffsetIndex[1]=this.getNewPoint(e,1)),super.updateAnimation(e)}getNewPoint(e,t){let s=0,i=this._animPhaseIndex[t],n=this._animDirectionIndex[t];const a=this._animSpeedIndex[t],o=this._animFactorIndex[t];let u=1;e==32?(s=Gs.AREA_DIAMETER_SMALL,u=.5):s=Gs.AREA_DIAMETER_LARGE;const l=i+n*a;Math.abs(l)>=s&&(n>0?i=i-(l-s):i=i+(-s-l),n=-n,this._animDirectionIndex[t]=n);const d=(s-Math.abs(i))*o;let c=n*Math.sin(Math.abs(i/4))*d;return n>0?c=c-d:c=c+d,i=i+n*a*u,this._animPhaseIndex[t]=i,Math.trunc(c)==0&&(this._animFactorIndex[t]=this.getRandomAmplitudeFactor()),new Hh(i,c)}initItems(e){let t;e===32?t=Gs.AREA_DIAMETER_SMALL:t=Gs.AREA_DIAMETER_LARGE,this._animPhaseIndex=[],this._animPhaseIndex.push(Math.random()*t*1.5),this._animPhaseIndex.push(Math.random()*t*1.5),this._animDirectionIndex=[],this._animDirectionIndex.push(1),this._animDirectionIndex.push(-1),this._animSpeedIndex=[],this._animSpeedIndex.push(Gs.ANIM_SPEED_FAST),this._animSpeedIndex.push(Gs.ANIM_SPEED_SLOW),this._animFactorIndex=[],this._animFactorIndex.push(this.getRandomAmplitudeFactor()),this._animFactorIndex.push(this.getRandomAmplitudeFactor())}getLayerXOffset(e,t,s){return(s===2||s===3)&&this._animOffsetIndex.length==2?this._animOffsetIndex[s-2].x:super.getLayerXOffset(e,t,s)}getLayerYOffset(e,t,s){return(s===2||s===3)&&this._animOffsetIndex.length==2?this._animOffsetIndex[s-2].y:super.getLayerYOffset(e,t,s)}getRandomAmplitudeFactor(){return Math.random()*30/100+.15}}Gs.UPDATE_INTERVAL=2,Gs.AREA_DIAMETER_SMALL=15,Gs.AREA_DIAMETER_LARGE=31,Gs.ANIM_SPEED_FAST=2,Gs.ANIM_SPEED_SLOW=1;class tl{constructor(e,t,s,i,n,a){this._name=e,this._index=t,this._radius=s,this._arcSpeed=i*Math.PI*2/360,this._arcOffset=n*Math.PI*2/360,this._height=a,this._position=0,this._positionVector=new y(0,0,0),this._children=[]}dispose(){for(;this._children.length>0;)this._children.shift().dispose()}update(e,t,s){this._position=this._position+this._arcSpeed/tl.SYSTEM_TEMPO,e[this._index]=this.getPositionVector(t,s);for(const i of this._children)i.update(e,this._positionVector,s)}getPositionVector(e,t){const s=this._radius*Math.cos(this._position+this._arcOffset),i=this._radius*Math.sin(this._position+this._arcOffset);return this._positionVector.x=(s-i)*(t/2),this._positionVector.y=(i+s)*(t/2)*.5-this._height*(t/2),this._positionVector.z=-Math.trunc(4*(s+i)-.7),e&&this._positionVector.add(e),this._positionVector}addChild(e){this._children.indexOf(e)>=0||this._children.push(e)}hasChild(e){return!!this.getChild(e)}getChild(e){for(const t of this._children){if(t.name===e)return t;if(t.hasChild(e))return t.getChild(e)}return null}get name(){return this._name}}tl.SYSTEM_TEMPO=30;class H3 extends rt{constructor(){super(),this._offsetArray=[],this._rootPosition=new y}dispose(){if(this._planetIndex)for(;this._planetIndex.length>0;)this._planetIndex.shift().dispose();this._planetIndex=null,this._planetNameIndex=null}updateAnimation(e){if(!this._planetIndex&&this.spriteCount>0&&!this.processPlanets())return 0;if(this._planetIndex){for(const t of this._planetIndex)t.update(this._offsetArray,this._rootPosition,e);return super.updateAnimation(e)}return 0}getLayerXOffset(e,t,s){return this._offsetArray[s]?this._offsetArray[s].x:super.getLayerXOffset(e,t,s)}getLayerYOffset(e,t,s){return this._offsetArray[s]?this._offsetArray[s].y:super.getLayerYOffset(e,t,s)}getLayerZOffset(e,t,s){return this._offsetArray[s]?this._offsetArray[s].z:super.getLayerZOffset(e,t,s)}processPlanets(){if(!this.object||!this.object.model)return;const e=this.object.model.getValue(T.FURNITURE_PLANETSYSTEM_DATA);if(!e)return!1;this._planetIndex=[],this._planetNameIndex=[];for(const t of e)this.getSprite(t.id)&&this.addPlanet(t.name,t.id,t.parent,t.radius||0,t.arcSpeed||0,t.arcOffset||0,t.height||0);return!0}addPlanet(e,t,s,i,n,a,o){if(!this._planetIndex)return;const u=new tl(e,t,i,n,a,o),l=this.getPlanet(s);l?l.addChild(u):(this._planetIndex.push(u),this._planetNameIndex.push(e))}getPlanet(e){for(const t of this._planetIndex){if(t.name===e)return t;if(t.hasChild(e))return t.getChild(e)}return null}}class k3 extends rt{}class Ii extends rt{constructor(){super(),this._stateQueue=[],this._animationCounter=-1}setAnimation(e){return e===Ii.ANIMATION_ID_ROLL_ONCE&&(this._stateQueue=[],this._stateQueue.push(Ii.ANIMATION_ID_NORMAL),this._animationCounter=Ii.ANIMATION_DURATION),super.setAnimation(e)}updateAnimation(e){return this._animationCounter>0&&this._animationCounter--,this._animationCounter||this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(e)}usesAnimationResetting(){return!0}}Ii.ANIMATION_ID_ROLL=3,Ii.ANIMATION_ID_ROLL_ONCE=2,Ii.ANIMATION_ID_NORMAL=1,Ii.ANIMATION_DURATION=15;class V3 extends rt{usesAnimationResetting(){return!0}}class j3 extends gs{imageReady(e,t){super.imageReady(e,t),e&&this.setImageOffset(e.width,e.height)}setImageOffset(e,t){const s=new Zp;s.setDirection(1,0,-t),s.setDirection(3,0,0),s.setDirection(5,-e,0),s.setDirection(7,-e,-t),s.setDirection(4,-e/2,-t/2),this._imageOffset=s}getLayerXOffset(e,t,s){if(this._imageOffset){const i=this._imageOffset.getXOffset(t,0);if(i!==void 0)return i+this._offsetX}return super.getLayerXOffset(e,t,s)+this._offsetX}getLayerYOffset(e,t,s){if(this._imageOffset){const i=this._imageOffset.getYOffset(t,0);if(i!==void 0)return i+this._offsetY}return super.getLayerYOffset(e,t,s)+this._offsetY}getLayerZOffset(e,t,s){return super.getLayerZOffset(e,t,s)+-this._offsetZ}getLayerIgnoreMouse(e,t,s){return!0}}class Gr extends rt{getFrameNumber(e,t){const s=this.getLayerTag(e,this.direction,t),i=this.object.getState(0);switch(s){case Gr.ONES_SPRITE:return Math.floor(i%10);case Gr.TENS_SPRITE:return Math.floor(i/10%10);case Gr.HUNDREDS_SPRITE:return Math.floor(i/100%10);case Gr.THOUSANDS_SPRITE:return Math.floor(i/1e3%10);default:return super.getFrameNumber(e,t)}}}Gr.ONES_SPRITE="ones_sprite",Gr.TENS_SPRITE="tens_sprite",Gr.HUNDREDS_SPRITE="hundreds_sprite",Gr.THOUSANDS_SPRITE="thousands_sprite";class Y3 extends rt{constructor(){super(...arguments),this._internalFrameIncreaseCounter=0}updateAnimations(e){return this._internalFrameIncreaseCounter=this._internalFrameIncreaseCounter+this.object.model.getValue(T.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED),this._frameIncrease=this._internalFrameIncreaseCounter,this._internalFrameIncreaseCounter=this._internalFrameIncreaseCounter-this._frameIncrease,super.updateAnimations(e)}}class W3 extends pr{getLayerColor(e,t,s){return this._data?this._data.getLayerColor(e,t,s):mi.DEFAULT_COLOR}}class Zt extends rt{constructor(){super(),this._stateQueue=[],this._running=!1,super.setAnimation(Zt.ANIMATION_ID_OFF)}setAnimation(e){if(e===0&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(Zt.ANIMATION_ID_START_ROLL),this._stateQueue.push(Zt.ANIMATION_ID_ROLL);return}if(e>0&&e<=Zt.ANIMATION_ID_OFFSET_SLOW2){if(this._running){this._running=!1,this._stateQueue=[],this.direction===2?(this._stateQueue.push(Zt.ANIMATION_ID_OFFSET_SLOW1+5),this._stateQueue.push(Zt.ANIMATION_ID_OFFSET_SLOW2+5)):(this._stateQueue.push(Zt.ANIMATION_ID_OFFSET_SLOW1+e),this._stateQueue.push(Zt.ANIMATION_ID_OFFSET_SLOW2+e)),this._stateQueue.push(Zt.ANIMATION_ID_OFF);return}super.setAnimation(Zt.ANIMATION_ID_OFF)}}updateAnimation(e){return this.getLastFramePlayed(11)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(e)}}Zt.ANIMATION_ID_OFFSET_SLOW1=20,Zt.ANIMATION_ID_OFFSET_SLOW2=10,Zt.ANIMATION_ID_START_ROLL=31,Zt.ANIMATION_ID_ROLL=32,Zt.ANIMATION_ID_OFF=30;class Bs extends rt{updateObject(e,t){return super.updateObject(e,t),!0}getFrameNumber(e,t){const s=this.object.model.getValue(T.FURNITURE_VOTE_COUNTER_COUNT);switch(this.getLayerTag(e,this.direction,t)){case Bs.ONES_SPRITE:return s%10;case Bs.TENS_SPRITE:return s/10%10;case Bs.HUNDREDS_SPRITE:return s/100%10;default:return super.getFrameNumber(e,t)}}getLayerAlpha(e,t,s){if(this.object.model.getValue(T.FURNITURE_VOTE_COUNTER_COUNT)===Bs.HIDE_COUNTER_SCORE)switch(this.getLayerTag(e,t,s)){case Bs.ONES_SPRITE:case Bs.TENS_SPRITE:case Bs.HUNDREDS_SPRITE:return 0}return super.getLayerAlpha(e,t,s)}}Bs.ONES_SPRITE="ones_sprite",Bs.TENS_SPRITE="tens_sprite",Bs.HUNDREDS_SPRITE="hundreds_sprite",Bs.HIDE_COUNTER_SCORE=-1;class ms extends rt{getFrameNumber(e,t){const s=this.object.model.getValue(T.FURNITURE_VOTE_MAJORITY_RESULT);switch(this.getLayerTag(e,this.direction,t)){case ms.ONES_SPRITE:return s%10;case ms.TENS_SPRITE:return s/10%10;case ms.HUNDREDS_SPRITE:return s/100%10;default:return super.getFrameNumber(e,t)}}getLayerAlpha(e,t,s){const i=this.object.model.getValue(T.FURNITURE_VOTE_MAJORITY_RESULT);if(ms.HIDE_RESULTS_STATES.indexOf(this.object.getState(0))!==-1||i===ms.HIDE_RESULTS_VALUE)switch(this.getLayerTag(e,t,s)){case ms.ONES_SPRITE:case ms.TENS_SPRITE:case ms.HUNDREDS_SPRITE:return 0}return super.getLayerAlpha(e,t,s)}}ms.ONES_SPRITE="ones_sprite",ms.TENS_SPRITE="tens_sprite",ms.HUNDREDS_SPRITE="hundreds_sprite",ms.HIDE_RESULTS_STATES=[-1,1],ms.HIDE_RESULTS_VALUE=-1;class z3 extends rt{}class sl extends eI{getThumbnailURL(){if(!this.object)return null;const e=this.object.model.getValue(T.FURNITURE_DATA);return e&&e[sl.THUMBNAIL_URL]||null}}sl.THUMBNAIL_URL="THUMBNAIL_URL";/*!
 * @pixi/text - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/text is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var rI=function(r,e){return rI=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var i in s)s.hasOwnProperty(i)&&(t[i]=s[i])},rI(r,e)};function hZ(r,e){rI(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var $_;(function(r){r[r.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",r[r.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"})($_||($_={}));var iI={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:$_.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},uZ=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],X3=function(){function r(e){this.styleID=0,this.reset(),aI(this,e,e)}return r.prototype.clone=function(){var e={};return aI(e,this,iI),new r(e)},r.prototype.reset=function(){aI(this,iI,iI)},Object.defineProperty(r.prototype,"align",{get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"breakWords",{get:function(){return this._breakWords},set:function(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(e){var t=nI(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fill",{get:function(){return this._fill},set:function(e){var t=nI(e);this._fill!==t&&(this._fill=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(e){lZ(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"leading",{get:function(){return this._leading},set:function(e){this._leading!==e&&(this._leading=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"padding",{get:function(){return this._padding},set:function(e){this._padding!==e&&(this._padding=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"stroke",{get:function(){return this._stroke},set:function(e){var t=nI(e);this._stroke!==t&&(this._stroke=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"trim",{get:function(){return this._trim},set:function(e){this._trim!==e&&(this._trim=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)},enumerable:!1,configurable:!0}),r.prototype.toFontString=function(){var e=typeof this.fontSize=="number"?this.fontSize+"px":this.fontSize,t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(var s=t.length-1;s>=0;s--){var i=t[s].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&uZ.indexOf(i)<0&&(i='"'+i+'"'),t[s]=i}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+e+" "+t.join(",")},r}();function K3(r){return typeof r=="number"?bT(r):(typeof r=="string"&&r.indexOf("0x")===0&&(r=r.replace("0x","#")),r)}function nI(r){if(Array.isArray(r)){for(var e=0;e<r.length;++e)r[e]=K3(r[e]);return r}else return K3(r)}function lZ(r,e){if(!Array.isArray(r)||!Array.isArray(e)||r.length!==e.length)return!1;for(var t=0;t<r.length;++t)if(r[t]!==e[t])return!1;return!0}function aI(r,e,t){for(var s in t)Array.isArray(e[s])?r[s]=e[s].slice():r[s]=e[s]}var ed={willReadFrequently:!0},wn=function(){function r(e,t,s,i,n,a,o,u,l){this.text=e,this.style=t,this.width=s,this.height=i,this.lines=n,this.lineWidths=a,this.lineHeight=o,this.maxLineWidth=u,this.fontProperties=l}return r.measureText=function(e,t,s,i){i===void 0&&(i=r._canvas),s=s??t.wordWrap;var n=t.toFontString(),a=r.measureFont(n);a.fontSize===0&&(a.fontSize=t.fontSize,a.ascent=t.fontSize);var o=i.getContext("2d",ed);o.font=n;for(var u=s?r.wordWrap(e,t,i):e,l=u.split(/(?:\r\n|\r|\n)/),d=new Array(l.length),c=0,_=0;_<l.length;_++){var f=o.measureText(l[_]).width+(l[_].length-1)*t.letterSpacing;d[_]=f,c=Math.max(c,f)}var g=c+t.strokeThickness;t.dropShadow&&(g+=t.dropShadowDistance);var I=t.lineHeight||a.fontSize+t.strokeThickness,p=Math.max(I,a.fontSize+t.strokeThickness)+(l.length-1)*(I+t.leading);return t.dropShadow&&(p+=t.dropShadowDistance),new r(e,t,g,p,l,d,I+t.leading,c,a)},r.wordWrap=function(e,t,s){s===void 0&&(s=r._canvas);for(var i=s.getContext("2d",ed),n=0,a="",o="",u=Object.create(null),l=t.letterSpacing,d=t.whiteSpace,c=r.collapseSpaces(d),_=r.collapseNewlines(d),f=!c,g=t.wordWrapWidth+l,I=r.tokenize(e),p=0;p<I.length;p++){var R=I[p];if(r.isNewline(R)){if(!_){o+=r.addLine(a),f=!c,a="",n=0;continue}R=" "}if(c){var S=r.isBreakingSpace(R),O=r.isBreakingSpace(a[a.length-1]);if(S&&O)continue}var A=r.getFromCache(R,l,u,i);if(A>g)if(a!==""&&(o+=r.addLine(a),a="",n=0),r.canBreakWords(R,t.breakWords))for(var C=r.wordWrapSplit(R),M=0;M<C.length;M++){for(var N=C[M],L=1;C[M+L];){var b=C[M+L],D=N[N.length-1];if(!r.canBreakChars(D,b,R,M,t.breakWords))N+=b;else break;L++}M+=N.length-1;var x=r.getFromCache(N,l,u,i);x+n>g&&(o+=r.addLine(a),f=!1,a="",n=0),a+=N,n+=x}else{a.length>0&&(o+=r.addLine(a),a="",n=0);var q=p===I.length-1;o+=r.addLine(R,!q),f=!1,a="",n=0}else A+n>g&&(f=!1,o+=r.addLine(a),a="",n=0),(a.length>0||!r.isBreakingSpace(R)||f)&&(a+=R,n+=A)}return o+=r.addLine(a,!1),o},r.addLine=function(e,t){return t===void 0&&(t=!0),e=r.trimRight(e),e=t?e+`
`:e,e},r.getFromCache=function(e,t,s,i){var n=s[e];if(typeof n!="number"){var a=e.length*t;n=i.measureText(e).width+a,s[e]=n}return n},r.collapseSpaces=function(e){return e==="normal"||e==="pre-line"},r.collapseNewlines=function(e){return e==="normal"},r.trimRight=function(e){if(typeof e!="string")return"";for(var t=e.length-1;t>=0;t--){var s=e[t];if(!r.isBreakingSpace(s))break;e=e.slice(0,-1)}return e},r.isNewline=function(e){return typeof e!="string"?!1:r._newlines.indexOf(e.charCodeAt(0))>=0},r.isBreakingSpace=function(e,t){return typeof e!="string"?!1:r._breakingSpaces.indexOf(e.charCodeAt(0))>=0},r.tokenize=function(e){var t=[],s="";if(typeof e!="string")return t;for(var i=0;i<e.length;i++){var n=e[i],a=e[i+1];if(r.isBreakingSpace(n,a)||r.isNewline(n)){s!==""&&(t.push(s),s=""),t.push(n);continue}s+=n}return s!==""&&t.push(s),t},r.canBreakWords=function(e,t){return t},r.canBreakChars=function(e,t,s,i,n){return!0},r.wordWrapSplit=function(e){return e.split("")},r.measureFont=function(e){if(r._fonts[e])return r._fonts[e];var t={ascent:0,descent:0,fontSize:0},s=r._canvas,i=r._context;i.font=e;var n=r.METRICS_STRING+r.BASELINE_SYMBOL,a=Math.ceil(i.measureText(n).width),o=Math.ceil(i.measureText(r.BASELINE_SYMBOL).width),u=Math.ceil(r.HEIGHT_MULTIPLIER*o);o=o*r.BASELINE_MULTIPLIER|0,s.width=a,s.height=u,i.fillStyle="#f00",i.fillRect(0,0,a,u),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(n,0,o);var l=i.getImageData(0,0,a,u).data,d=l.length,c=a*4,_=0,f=0,g=!1;for(_=0;_<o;++_){for(var I=0;I<c;I+=4)if(l[f+I]!==255){g=!0;break}if(!g)f+=c;else break}for(t.ascent=o-_,f=d-c,g=!1,_=u;_>o;--_){for(var I=0;I<c;I+=4)if(l[f+I]!==255){g=!0;break}if(!g)f-=c;else break}return t.descent=_-o,t.fontSize=t.ascent+t.descent,r._fonts[e]=t,t},r.clearMetrics=function(e){e===void 0&&(e=""),e?delete r._fonts[e]:r._fonts={}},Object.defineProperty(r,"_canvas",{get:function(){if(!r.__canvas){var e=void 0;try{var t=new OffscreenCanvas(0,0),s=t.getContext("2d",ed);if(s&&s.measureText)return r.__canvas=t,t;e=J.ADAPTER.createCanvas()}catch{e=J.ADAPTER.createCanvas()}e.width=e.height=10,r.__canvas=e}return r.__canvas},enumerable:!1,configurable:!0}),Object.defineProperty(r,"_context",{get:function(){return r.__context||(r.__context=r._canvas.getContext("2d",ed)),r.__context},enumerable:!1,configurable:!0}),r}();wn._fonts={},wn.METRICS_STRING="|q",wn.BASELINE_SYMBOL="M",wn.BASELINE_MULTIPLIER=1.4,wn.HEIGHT_MULTIPLIER=2,wn._newlines=[10,13],wn._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var cZ={texture:!0,children:!1,baseTexture:!0},_Z=function(r){hZ(e,r);function e(t,s,i){var n=this,a=!1;i||(i=J.ADAPTER.createCanvas(),a=!0),i.width=3,i.height=3;var o=Re.from(i);return o.orig=new he,o.trim=new he,n=r.call(this,o)||this,n._ownCanvas=a,n.canvas=i,n.context=i.getContext("2d",{willReadFrequently:!0}),n._resolution=J.RESOLUTION,n._autoResolution=!0,n._text=null,n._style=null,n._styleListener=null,n._font="",n.text=t,n.style=s,n.localStyleID=-1,n}return e.prototype.updateText=function(t){var s=this._style;if(this.localStyleID!==s.styleID&&(this.dirty=!0,this.localStyleID=s.styleID),!(!this.dirty&&t)){this._font=this._style.toFontString();var i=this.context,n=wn.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),a=n.width,o=n.height,u=n.lines,l=n.lineHeight,d=n.lineWidths,c=n.maxLineWidth,_=n.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,a)+s.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+s.padding*2)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=s.strokeThickness,i.textBaseline=s.textBaseline,i.lineJoin=s.lineJoin,i.miterLimit=s.miterLimit;for(var f,g,I=s.dropShadow?2:1,p=0;p<I;++p){var R=s.dropShadow&&p===0,S=R?Math.ceil(Math.max(1,o)+s.padding*2):0,O=S*this._resolution;if(R){i.fillStyle="black",i.strokeStyle="black";var A=s.dropShadowColor,C=Nl(typeof A=="number"?A:F6(A)),M=s.dropShadowBlur*this._resolution,N=s.dropShadowDistance*this._resolution;i.shadowColor="rgba("+C[0]*255+","+C[1]*255+","+C[2]*255+","+s.dropShadowAlpha+")",i.shadowBlur=M,i.shadowOffsetX=Math.cos(s.dropShadowAngle)*N,i.shadowOffsetY=Math.sin(s.dropShadowAngle)*N+O}else i.fillStyle=this._generateFillStyle(s,u,n),i.strokeStyle=s.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;var L=(l-_.fontSize)/2;(!e.nextLineHeightBehavior||l-_.fontSize<0)&&(L=0);for(var b=0;b<u.length;b++)f=s.strokeThickness/2,g=s.strokeThickness/2+b*l+_.ascent+L,s.align==="right"?f+=c-d[b]:s.align==="center"&&(f+=(c-d[b])/2),s.stroke&&s.strokeThickness&&this.drawLetterSpacing(u[b],f+s.padding,g+s.padding-S,!0),s.fill&&this.drawLetterSpacing(u[b],f+s.padding,g+s.padding-S)}this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,s,i,n){n===void 0&&(n=!1);var a=this._style,o=a.letterSpacing,u=e.experimentalLetterSpacing&&("letterSpacing"in CanvasRenderingContext2D.prototype||"textLetterSpacing"in CanvasRenderingContext2D.prototype);if(o===0||u){u&&(this.context.letterSpacing=o,this.context.textLetterSpacing=o),n?this.context.strokeText(t,s,i):this.context.fillText(t,s,i);return}for(var l=s,d=Array.from?Array.from(t):t.split(""),c=this.context.measureText(t).width,_=0,f=0;f<d.length;++f){var g=d[f];n?this.context.strokeText(g,l,i):this.context.fillText(g,l,i);for(var I="",p=f+1;p<d.length;++p)I+=d[p];_=this.context.measureText(I).width,l+=c-_+o,c=_}},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var s=k6(t);s.data&&(t.width=s.width,t.height=s.height,this.context.putImageData(s.data,0,0))}var i=this._texture,n=this._style,a=n.trim?0:n.padding,o=i.baseTexture;i.trim.width=i._frame.width=t.width/this._resolution,i.trim.height=i._frame.height=t.height/this._resolution,i.trim.x=-a,i.trim.y=-a,i.orig.width=i._frame.width-a*2,i.orig.height=i._frame.height-a*2,this._onTextureUpdate(),o.setRealSize(t.width,t.height,this._resolution),i.updateUvs(),this.dirty=!1},e.prototype._render=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),r.prototype._render.call(this,t)},e.prototype.updateTransform=function(){this.updateText(!0),r.prototype.updateTransform.call(this)},e.prototype.getBounds=function(t,s){return this.updateText(!0),this._textureID===-1&&(t=!1),r.prototype.getBounds.call(this,t,s)},e.prototype.getLocalBounds=function(t){return this.updateText(!0),r.prototype.getLocalBounds.call(this,t)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._generateFillStyle=function(t,s,i){var n=t.fill;if(Array.isArray(n)){if(n.length===1)return n[0]}else return n;var a,o=t.dropShadow?t.dropShadowDistance:0,u=t.padding||0,l=this.canvas.width/this._resolution-o-u*2,d=this.canvas.height/this._resolution-o-u*2,c=n.slice(),_=t.fillGradientStops.slice();if(!_.length)for(var f=c.length+1,g=1;g<f;++g)_.push(g/f);if(c.unshift(n[0]),_.unshift(0),c.push(n[n.length-1]),_.push(1),t.fillGradientType===$_.LINEAR_VERTICAL){a=this.context.createLinearGradient(l/2,u,l/2,d+u);for(var I=i.fontProperties.fontSize+t.strokeThickness,g=0;g<s.length;g++){var p=i.lineHeight*(g-1)+I,R=i.lineHeight*g,S=R;g>0&&p>R&&(S=(R+p)/2);var O=R+I,A=i.lineHeight*(g+1),C=O;g+1<s.length&&A<O&&(C=(O+A)/2);for(var M=(C-S)/d,N=0;N<c.length;N++){var L=0;typeof _[N]=="number"?L=_[N]:L=N/c.length;var b=Math.min(1,Math.max(0,S/d+L*M));b=Number(b.toFixed(5)),a.addColorStop(b,c[N])}}}else{a=this.context.createLinearGradient(u,d/2,l+u,d/2);for(var D=c.length+1,x=1,g=0;g<c.length;g++){var q=void 0;typeof _[g]=="number"?q=_[g]:q=x/D,a.addColorStop(q,c[g]),x++}}return a},e.prototype.destroy=function(t){typeof t=="boolean"&&(t={children:t}),t=Object.assign({},cZ,t),r.prototype.destroy.call(this,t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(e.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var s=Ja(this.scale.x)||1;this.scale.x=s*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var s=Ja(this.scale.y)||1;this.scale.y=s*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){t=t||{},t instanceof X3?this._style=t:this._style=new X3(t),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),e.nextLineHeightBehavior=!1,e.experimentalLetterSpacing=!1,e}(Ze);class q3{constructor(e){this._sprite=new ot(e),this._texture=null,this._amount=-1,this._alpha=0}renderBubble(e){if(!this._sprite||this._amount===e)return null;const t=new nr;t.addChild(this._sprite);const s=new _Z("+"+e,{fontFamily:"Arial",fontSize:9,fill:16777215,align:"center"});return s.anchor.x=.5,s.x=this._sprite.width/2,s.y=19,t.addChild(s),this._texture?_t.instance.renderer.render(t,{renderTexture:this._texture,clear:!0}):this._texture=Je.generateTexture(t),this._texture}get amount(){return this._amount}set amount(e){this._amount=e}get alpha(){return this._alpha}set alpha(e){this._alpha=e}}class oI extends Z_{constructor(){super(),this._isAllowedToTurnHead=!0}createSizeData(e,t,s){return e>1?new tn(t,s):new el(t,s)}defineVisualizations(e){return this._isAllowedToTurnHead=!0,super.defineVisualizations(e)}processVisualElement(e,t,s){if(!e||!t||!s)return!1;switch(t){case"postures":if(!(e instanceof tn)||!e.processPostures(s))return!1;break;case"gestures":if(!(e instanceof tn)||!e.processGestures(s))return!1;break;default:if(!super.processVisualElement(e,t,s))return!1;break}return!0}postureToAnimation(e,t){const s=this.getSizeData(e);return s?s.postureToAnimation(t):tn.DEFAULT}getGestureDisabled(e,t){const s=this.getSizeData(e);return s?s.getGestureDisabled(t):!1}gestureToAnimation(e,t){const s=this.getSizeData(e);return s?s.gestureToAnimation(t):tn.DEFAULT}animationToPosture(e,t,s){const i=this.getSizeData(e);return i?i.animationToPosture(t,s):null}animationToGesture(e,t){const s=this.getSizeData(e);return s?s.animationToGesture(t):null}getGestureForAnimationId(e,t){const s=this.getSizeData(e);return s?s.getGestureForAnimationId(t):null}totalPostures(e){const t=this.getSizeData(e);return t?t.totalPostures:0}totalGestures(e){const t=this.getSizeData(e);return t?t.totalGestures:0}get isAllowedToTurnHead(){return this._isAllowedToTurnHead}}class et extends rt{constructor(){for(super(),this._posture="",this._gesture="",this._isSleeping=!1,this._headDirection=-1,this._headOnly=!1,this._nonHeadSprites=[],this._headSprites=[],this._saddleSprites=[],this._animationOver=!1,this._paletteIndex=-1,this._paletteName="",this._customLayerIds=[],this._customPartIds=[],this._customPaletteIds=[],this._isRiding=!1,this._color=16777215,this._experience=0,this._experienceTimestamp=0,this._experienceData=null,this._previousAnimationDirection=-1,this._animationStates=[];this._animationStates.length<et.ANIMATION_INDEX_COUNT;)this._animationStates.push(new Jp)}initialize(e){if(!(e instanceof oI))return!1;const t=this.getPetAdditionAsset(et.PET_EXPERIENCE_BUBBLE);return t&&(this._experienceData=new q3(t)),super.initialize(e)}dispose(){if(super.dispose(),this._animationStates){for(;this._animationStates.length;){const e=this._animationStates[0];e&&e.dispose(),this._animationStates.pop()}this._animationStates=null}}getAnimationId(e){return e.animationId}update(e,t,s,i){super.update(e,t,s,i),this.updateExperienceBubble(t)}updateExperienceBubble(e){if(this._experienceData&&(this._experienceData.alpha=0,this._experienceTimestamp)){const t=e-this._experienceTimestamp;t<et.EXPERIENCE_BUBBLE_VISIBLE_IN_MS?this._experienceData.alpha=Math.sin(t/et.EXPERIENCE_BUBBLE_VISIBLE_IN_MS*Math.PI)*255:this._experienceTimestamp=0;const s=this.getSprite(this.totalSprites-1);if(s){if(this._experienceData.alpha>0){const i=this._experienceData.renderBubble(this._experience);if(i){s.texture=i,s.offsetX=-20,s.offsetY=-80,s.alpha=this._experienceData.alpha,s.visible=!0,s.relativeDepth=-.2;return}}s.texture=null,s.visible=!1}}}updateModel(e){const t=this.object&&this.object.model;if(!t||this.updateModelCounter===t.updateCounter)return!1;const s=t.getValue(T.FIGURE_POSTURE),i=t.getValue(T.FIGURE_GESTURE);this.setPostureAndGesture(s,i);let n=t.getValue(T.FURNITURE_ALPHA_MULTIPLIER)||null;(n===null||isNaN(n))&&(n=1),this._alphaMultiplier!==n&&(this._alphaMultiplier=n,this._alphaChanged=!0),this._isSleeping=t.getValue(T.FIGURE_SLEEP)>0;const a=t.getValue(T.HEAD_DIRECTION);!isNaN(a)&&this.data.isAllowedToTurnHead?this._headDirection=a:this._headDirection=this.object.getDirection().x,this._experience=t.getValue(T.FIGURE_GAINED_EXPERIENCE),this._experienceTimestamp=t.getValue(T.FIGURE_EXPERIENCE_TIMESTAMP);const o=t.getValue(T.PET_PALETTE_INDEX),u=t.getValue(T.PET_CUSTOM_LAYER_IDS),l=t.getValue(T.PET_CUSTOM_PARTS_IDS),d=t.getValue(T.PET_CUSTOM_PALETTE_IDS),c=t.getValue(T.PET_IS_RIDING),_=t.getValue(T.PET_HEAD_ONLY),f=t.getValue(T.PET_COLOR);return o!==this._paletteIndex&&(this._paletteIndex=o,this._paletteName=this._paletteIndex.toString()),this._customLayerIds=u||[],this._customPartIds=l||[],this._customPaletteIds=d||[],this._isRiding=!isNaN(c)&&c>0,this._headOnly=!isNaN(_)&&_>0,!isNaN(f)&&this._color!==f&&(this._color=f),this.updateModelCounter=t.updateCounter,!0}updateAnimation(e){if(this.object){const t=this.object.getDirection().x;t!==this._previousAnimationDirection&&(this._previousAnimationDirection=t,this.resetAllAnimationFrames())}return super.updateAnimation(e)}setPostureAndGesture(e,t){this.data&&(e!==this._posture&&(this._posture=e,this.setAnimationForIndex(et.POSTURE_ANIMATION_INDEX,this.data.postureToAnimation(this._scale,e))),this.data.getGestureDisabled(this._scale,e)&&(t=null),t!==this._gesture&&(this._gesture=t,this.setAnimationForIndex(et.GESTURE_ANIMATION_INDEX,this.data.gestureToAnimation(this._scale,t))))}getAnimationStateData(e){return e>=0&&e<this._animationStates.length?this._animationStates[e]:null}setAnimationForIndex(e,t){const s=this.getAnimationStateData(e);s&&this.setSubAnimation(s,t)&&(this._animationOver=!1)}resetAllAnimationFrames(){this._animationOver=!1;let e=this._animationStates.length-1;for(;e>=0;){const t=this._animationStates[e];t&&t.setLayerCount(this.animatedLayerCount),e--}}updateAnimations(e){if(this._animationOver)return 0;let t=!0,s=0,i=0;for(;i<this._animationStates.length;){const n=this._animationStates[i];if(n&&!n.animationOver){const a=this.updateFramesForAnimation(n,e);s=s|a,n.animationOver?(st.isTransitionFromAnimation(n.animationId)||st.isTransitionToAnimation(n.animationId))&&(this.setAnimationForIndex(i,n.animationAfterTransitionId),t=!1):t=!1}i++}return this._animationOver=t,s}getSpriteAssetName(e,t){if(this._headOnly&&this.isNonHeadSprite(t)||this._isRiding&&this._parser3(t))return null;const s=this.totalSprites;if(t<s-et.ADDITIONAL_SPRITE_COUNT){const i=this.getValidSize(e);if(t<s-(1+et.ADDITIONAL_SPRITE_COUNT)){if(t>=pi.LAYER_LETTERS.length)return null;const n=pi.LAYER_LETTERS[t];return i===1?this._type+"_icon_"+n:this._type+"_"+i+"_"+n+"_"+this.getDirection(e,t)+"_"+this.getFrameNumber(i,t)}return this._type+"_"+i+"_sd_"+this.getDirection(e,t)+"_0"}return null}getLayerColor(e,t,s){return t<this.totalSprites-et.ADDITIONAL_SPRITE_COUNT?this._color:16777215}getLayerXOffset(e,t,s){let i=super.getLayerXOffset(e,t,s),n=this._animationStates.length-1;for(;n>=0;){const a=this._animationStates[n];if(a){const o=a.getFrame(s);o&&(i+=o.x)}n--}return i}getLayerYOffset(e,t,s){let i=super.getLayerYOffset(e,t,s),n=this._animationStates.length-1;for(;n>=0;){const a=this._animationStates[n];if(a){const o=a.getFrame(s);o&&(i+=o.y)}n--}return i}getLayerZOffset(e,t,s){return this.data?this.data.getLayerZOffset(e,this.getDirection(e,s),s):fe.DEFAULT_ZOFFSET}getDirection(e,t){return this.isHeadSprite(t)?this.data.getValidDirection(e,this._headDirection):this._direction}getFrameNumber(e,t){let s=this._animationStates.length-1;for(;s>=0;){const i=this._animationStates[s];if(i){const n=i.getFrame(t);if(n)return n.id}s--}return super.getFrameNumber(e,t)}isHeadSprite(e){if(this._headSprites[e]===void 0){const t=this.data.getLayerTag(this._scale,Fn.USE_DEFAULT_DIRECTION,e)===et.HEAD,s=this.data.getLayerTag(this._scale,Fn.USE_DEFAULT_DIRECTION,e)===et.HAIR;t||s?this._headSprites[e]=!0:this._headSprites[e]=!1}return this._headSprites[e]}isNonHeadSprite(e){if(this._nonHeadSprites[e]===void 0)if(e<this.totalSprites-(1+et.ADDITIONAL_SPRITE_COUNT)){const t=this.data.getLayerTag(this._scale,Fn.USE_DEFAULT_DIRECTION,e);t&&t.length>0&&t!==et.HEAD&&t!==et.HAIR?this._nonHeadSprites[e]=!0:this._nonHeadSprites[e]=!1}else this._nonHeadSprites[e]=!0;return this._nonHeadSprites[e]}_parser3(e){return this._saddleSprites[e]===void 0&&(this.data.getLayerTag(this._scale,Fn.USE_DEFAULT_DIRECTION,e)===et.SADDLE?this._saddleSprites[e]=!0:this._saddleSprites[e]=!1),this._saddleSprites[e]}getAsset(e,t=-1){if(!this.asset)return null;const s=this._customLayerIds.indexOf(t);let i=this._paletteName,n=-1,a=-1;return s>-1&&(n=this._customPartIds[s],a=this._customPaletteIds[s],i=a>-1?a.toString():this._paletteName),!isNaN(n)&&n>-1&&(e=e+"_"+n),this.asset.getAssetWithPalette(e,i)}getAdditionalLayerCount(){return super.getAdditionalLayerCount()+et.ADDITIONAL_SPRITE_COUNT}setLayerCount(e){super.setLayerCount(e),this._headSprites=[]}getPostureForAsset(e,t){const s=t.split("_");let i=s.length,n=0;for(;n<s.length;){if(s[n]==="64"||s[n]==="32"){i=n+3;break}n++}let a=null;if(i<s.length){let o=s[i];o=o.split("@")[0],a=this.data.animationToPosture(e,parseInt(o)/100,!1),a||(a=this.data.getGestureForAnimationId(e,parseInt(o)/100))}return a}getPetAdditionAsset(e){return Ws().getTexture(e)}get data(){return this._data}}et.TYPE=G.PET_ANIMATED,et.HEAD="head",et.SADDLE="saddle",et.HAIR="hair",et.ADDITIONAL_SPRITE_COUNT=1,et.EXPERIENCE_BUBBLE_VISIBLE_IN_MS=1e3,et.PET_EXPERIENCE_BUBBLE="avatar_addition_pet_experience_bubble",et.POSTURE_ANIMATION_INDEX=0,et.GESTURE_ANIMATION_INDEX=1,et.ANIMATION_INDEX_COUNT=2;class td{constructor(e,t=-1,s=1,i=-1,n=1){this._normalMinX=t,this._normalMaxX=s,this._normalMinY=i,this._normalMaxY=n,this._asset=e}get asset(){return this._asset}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}dispose(){this._asset=null}}td.MIN_NORMAL_COORDINATE_VALUE=-1,td.MAX_NORMAL_COORDINATE_VALUE=1;class xn{constructor(){this._bitmaps=[]}dispose(){for(const e of this._bitmaps)e&&e.dispose();this._bitmaps=null}addBitmap(e,t=-1,s=1,i=-1,n=1){this._bitmaps.push(new td(e,t,s,i,n))}getAsset(e){if(!e)return null;for(const t of this._bitmaps)if(t&&e.x>=t.normalMinX&&e.x<=t.normalMaxX&&e.y>=t.normalMinY&&e.y<=t.normalMaxY)return t.asset;return null}}xn.MIN_NORMAL_COORDINATE_VALUE=-1,xn.MAX_NORMAL_COORDINATE_VALUE=1;class Q3{constructor(){this._sizes=[],this._maskVisualizations=new Map,this._assetNames=new Map,this._lastMaskVisualization=null,this._lastSize=-1}dispose(){if(this._maskVisualizations){for(const e of this._maskVisualizations.values())e&&e.dispose();this._maskVisualizations=null}this._lastMaskVisualization=null,this._sizes=null}createMaskVisualization(e){if(this._maskVisualizations.get(e))return null;const s=new xn;return this._maskVisualizations.set(e,s),this._sizes.push(e),this._sizes.sort(),s}getSizeIndex(e){let t=0,s=1;for(;s<this._sizes.length;){if(this._sizes[s]>e){this._sizes[s]-e<e-this._sizes[s-1]&&(t=s);break}t=s,s++}return t}getMaskVisualization(e){if(e===this._lastSize)return this._lastMaskVisualization;const t=this.getSizeIndex(e);return t<this._sizes.length?this._lastMaskVisualization=this._maskVisualizations.get(this._sizes[t]):this._lastMaskVisualization=null,this._lastSize=e,this._lastMaskVisualization}getGraphicAsset(e,t){const s=this.getMaskVisualization(e);return s?s.getAsset(t):null}getAssetName(e){return this._assetNames&&this._assetNames.get(e)||null}setAssetName(e,t){this._assetNames&&this._assetNames.set(e,t)}}class Z3{constructor(){this._assetCollection=null,this._masks=new Map,this._data=null}get data(){return this._data}dispose(){if(this._assetCollection=null,this._data=null,this._masks&&this._masks.size){for(const e of this._masks.values())e&&e.dispose();this._masks.clear()}}initialize(e){this._data=e}initializeAssetCollection(e){this.data&&(this._assetCollection=e,this.parseMasks(this.data,e))}parseMasks(e,t){if(!(!e||!t)&&e.masks&&e.masks.length){let s=0;for(;s<e.masks.length;){const i=e.masks[s];if(i){const n=i.id;if(this._masks.get(n))continue;const o=new Q3;if(i.visualizations&&i.visualizations.length){let u=0;for(;u<i.visualizations.length;){const l=i.visualizations[u];if(l){const d=l.size,c=o.createMaskVisualization(d);if(c){const _=this.parseMaskBitmaps(l.bitmaps,c,t);o.setAssetName(d,_)}}u++}}this._masks.set(n,o)}s++}}}parseMaskBitmaps(e,t,s){if(!e||!e.length)return null;let i=null;for(const n of e){if(!n)continue;const a=n.assetName,o=s.getAsset(a);if(!o)continue;let u=xn.MIN_NORMAL_COORDINATE_VALUE,l=xn.MAX_NORMAL_COORDINATE_VALUE,d=xn.MIN_NORMAL_COORDINATE_VALUE,c=xn.MAX_NORMAL_COORDINATE_VALUE;n.normalMinX!==void 0&&(u=n.normalMinX),n.normalMaxX!==void 0&&(l=n.normalMaxX),n.normalMinY!==void 0&&(d=n.normalMinY),n.normalMaxY!==void 0&&(c=n.normalMaxY),o.flipH||(i=a),t.addBitmap(o,u,l,d,c)}return i}updateMask(e,t,s,i,n,a){const o=this._masks.get(t);if(!o)return!0;const u=o.getGraphicAsset(s,i);if(!u)return!0;const l=u.texture;if(!l)return!0;const d=new k(n+u.offsetX,a+u.offsetY),c=new Ye;let _=1,f=1,g=0,I=0,p=d.x+g,R=d.y+I;return u.flipH&&(_=-1,g=l.width,p=d.x+g-l.width),u.flipV&&(f=-1,I=l.height,R=d.y+I-l.height),c.scale(_,f),c.translate(p,R),_t.instance.renderer.render(new Ze(l),{renderTexture:e,clear:!1,transform:c}),!0}getMask(e){return!this._masks||!this._masks.size?null:this._masks.get(e)||null}}class zo{constructor(e=null,t=0,s=!1){this._assetNames=[],this._maskAssetNames=[],this._maskAssetLocations=[],this._maskAssetFlipHs=[],this._maskAssetFlipVs=[],e!=null&&(this._maskAssetNames=e._maskAssetNames,this._maskAssetLocations=e._maskAssetLocations,this._maskAssetFlipHs=e._maskAssetFlipHs,this._maskAssetFlipVs=e._maskAssetFlipVs),this._color=t,this._alignBottom=s}addMask(e,t,s,i){this._maskAssetNames.push(e),this._maskAssetLocations.push(t),this._maskAssetFlipHs.push(s),this._maskAssetFlipVs.push(i)}addAssetColumn(e){this._assetNames.push(e)}set z(e){this._z=e}get z(){return this._z}set cornerPoints(e){this._points=e}get cornerPoints(){return this._points}get color(){return this._color}get maskAssetNames(){return this._maskAssetNames}get maskAssetLocations(){return this._maskAssetLocations}get maskAssetFlipHs(){return this._maskAssetFlipHs}get maskAssetFlipVs(){return this._maskAssetFlipVs}isBottomAligned(){return this._alignBottom}get assetNameColumns(){return this._assetNames}}class J3{constructor(e,t,s,i,n){this._x=e,this._y=t,this._speedX=s,this._speedY=i,this._asset=n,isNaN(this._x)&&(this._x=0),isNaN(this._y)&&(this._y=0),isNaN(this._speedX)&&(this._speedX=0),isNaN(this._speedY)&&(this._speedY=0)}get bitmapData(){return this._asset}dispose(){this._asset=null}getPosition(e,t,s,i,n){let a=this._x,o=this._y;s>0&&(a=a+this._speedX/s*n/1e3),i>0&&(o=o+this._speedY/i*n/1e3);const u=Math.trunc(a%1*e),l=Math.trunc(o%1*t);return new k(u,l)}}class Jt{constructor(e,t,s,i=0){this._material=e,this._offset=i,this._align=s,this._color=t,this._isDisposed=!1}get offset(){return this._offset}get align(){return this._align}get disposed(){return this._isDisposed}dispose(){this._isDisposed=!0,this._material=null,this.clearCache()}clearCache(){}render(e,t,s,i,n,a,o,u,l){const d=this._color>>16,c=this._color>>8&255,_=this._color&255,f=d<255||c<255||_<255;if(this._material){const g=this._material.render(e,t,f?null:s,i,n,a,o,u,l+this.offset,this.align===Jt.ALIGN_TOP);if(g&&f){const I=new Ze(g);f&&(I.tint=this._color),t.writeToRenderTexture(I,s,!1)}}else{const g=t.createAndFillRenderTexture(i,n,e,this._color);t.writeToRenderTexture(new Ze(g),s,!1)}return s}getMaterial(){return this._material}getColor(){return this._color}}Jt.DEFAULT_OFFSET=0,Jt.ALIGN_TOP=1,Jt.ALIGN_BOTTOM=2,Jt.ALIGN_DEFAULT=Jt.ALIGN_TOP;class $3{constructor(e,t,s){this._layers=[],this._geometry=s,this._cachedBitmapNormal=new y,this._isCached=!1,this._hasAnimationLayers=!1,t<0&&(t=0);let i=0;for(;i<t;)this._layers.push(null),i++}get geometry(){return this._geometry}get hasAnimationLayers(){return this._hasAnimationLayers}dispose(){if(this._layers&&this._layers.length){for(const e of this._layers)e&&e.dispose();this._layers=null}this._geometry=null,this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapNormal&&this._cachedBitmapNormal.assign(new y),this._layers&&this._layers.length)for(const e of this._layers){if(!e)continue;e.clearCache()}this._isCached=!1}}setLayer(e,t,s,i,n=0){if(e<0||e>this._layers.length)return!1;let a=this._layers[e];return a&&a.dispose(),a=new Jt(t,s,i,n),this._layers[e]=a,!0}setAnimationLayer(e,t,s){if(e<0||e>this._layers.length)return!1;let i=this._layers[e];return i&&i.dispose(),i=new hI(t,s),this._layers[e]=i,this._hasAnimationLayers=!0,!0}getLayers(){return this._layers}render(e,t,s,i,n,a,o,u=0,l=0,d=0,c=0,_=0,f=0,g=0){i<1&&(i=1),n<1&&(n=1),(!s||s.width!==i||s.height!==n)&&(s=null),this._isCached=!0;const I=t.createAndFillRenderTexture(i,n,e);if(this._cachedBitmapNormal.assign(a),this._layers&&this._layers.length)for(const p of this._layers)p&&(p instanceof Jt?p.render(`${e}:${this._layers.indexOf(p)}`,t,I,i,n,a,o,u,l):p instanceof hI&&p.render(t,I,i,n,a,u,l,d,c,_,f,g));return I}}class sd{constructor(){this._planeVisualizations=new Map,this._sizes=[],this._lastPlaneVisualization=null,this._lastSize=-1}isStatic(e){return!0}dispose(){for(const e of this._planeVisualizations.values())e&&e.dispose();this._planeVisualizations=null,this._lastPlaneVisualization=null,this._sizes=null,this._lastSize=-1}clearCache(){for(const e of this._planeVisualizations.values())e&&e.clearCache()}createPlaneVisualization(e,t,s){if(this._planeVisualizations.get(e.toString()))return null;const n=new $3(e,t,s);return this._planeVisualizations.set(e.toString(),n),this._sizes.push(e),this._sizes.sort(),n}getSizeIndex(e){let t=0,s=1;for(;s<this._sizes.length;){if(this._sizes[s]>e){this._sizes[s]-e<e-this._sizes[s-1]&&(t=s);break}t=s,s++}return t}getPlaneVisualization(e){if(e===this._lastSize)return this._lastPlaneVisualization;const t=this.getSizeIndex(e);return t<this._sizes.length?this._lastPlaneVisualization=this._planeVisualizations.get(this._sizes[t].toString()):this._lastPlaneVisualization=null,this._lastSize=e,this._lastPlaneVisualization}getLayers(){return this.getPlaneVisualization(this._lastSize).getLayers()}}class Gn extends sd{render(e,t,s,i,n,a,o,u,l,d){const c=this.getPlaneVisualization(a);if(!c||!c.geometry)return null;const _=c.geometry.getScreenPoint(new y(0,0,0)),f=c.geometry.getScreenPoint(new y(0,n/c.geometry.scale,0)),g=c.geometry.getScreenPoint(new y(i/c.geometry.scale,0,0));let I=0,p=0;if(_&&f&&g){i=Math.round(Math.abs(_.x-g.x)),n=Math.round(Math.abs(_.x-f.x));const R=_.x-c.geometry.getScreenPoint(new y(1,0,0)).x;I=l*Math.trunc(Math.abs(R)),p=d*Math.trunc(Math.abs(R))}return c.render(e,t,s,i,n,o,u,I,p)}}Gn.DEFAULT_COLOR=16777215,Gn.HORIZONTAL_ANGLE_DEFAULT=45,Gn.VERTICAL_ANGLE_DEFAULT=30;class rl{constructor(e,t){this._texture=e,this._timeStamp=t}dispose(){this._texture=null}get texture(){return this._texture}get timeStamp(){return this._timeStamp}}class it{constructor(){this._seed=1,this._modulus=16777216,this._multiplier=69069,this._increment=5}static setSeed(e=1){it._randomizer||(it._randomizer=new it),it._randomizer.seed=e}static setModulus(e=16777216){it._randomizer||(it._randomizer=new it),it._randomizer.modulus=e}static getValues(e,t,s){return it._randomizer||(it._randomizer=new it),it._randomizer.getRandomValues(e,t,s)}static getArray(e,t){return it._randomizer||(it._randomizer=new it),it._randomizer.getRandomArray(e,t)}set seed(e){this._seed=e}set modulus(e){e<1&&(e=1),this._modulus=e}dispose(){}getRandomValues(e,t,s){const i=[];let n=0;for(;n<e;)i.push(this.iterateScaled(t,s-t)),n++;return i}getRandomArray(e,t){if(e>t||t>1e3)return null;const s=[];let i=0;for(;i<=t;)s.push(i),i++;const n=[];let a=0;for(;a<e;){const o=this.iterateScaled(0,s.length-1);n.push(s[o]),s.splice(o,1),a++}return n}iterate(){let e=EI(Math.trunc(this._multiplier*this._seed)+this._increment);return e<0&&(e=-e),e=e%this._modulus,this._seed=e,e}iterateScaled(e,t){let s=this.iterate();return t<1?e:(s=Math.trunc(e+s/this._modulus*t),s)}}it.DEFAULT_SEED=1,it.DEFAULT_MODULUS=16777216,it._randomizer=null;class vt{constructor(e,t,s=1){if(this._cells=[],this._repeatMode=s,this._width=e<1?1:e,this._cachedBitmapData=null,this._cachedBitmapNormal=null,this._cachedBitmapDataOffsetX=0,this._cachedBitmapDataOffsetY=0,this._isCached=!1,this._isStatic=!0,t&&t.length){let i=0;for(;i<t.length;){const n=t[i];n&&(this._cells.push(n),n.isStatic||(this._isStatic=!1)),i++}}}get isStatic(){return this._isStatic}isRepeated(){return this._repeatMode!==vt.REPEAT_MODE_NONE}get width(){return this._width}dispose(){if(this._cells&&this._cells.length){for(const e of this._cells)e&&e.dispose();this._cells=null}this._cachedBitmapData=null,this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapData&&(this._cachedBitmapData=null),this._cachedBitmapNormal&&(this._cachedBitmapNormal.x=0,this._cachedBitmapNormal.y=0,this._cachedBitmapNormal.z=0),this._cells&&this._cells.length)for(const e of this._cells)e&&e.clearCache();this._isCached=!1}}render(e,t,s,i,n,a){if(this._repeatMode===vt.REPEAT_MODE_NONE&&(s=this.getCellsHeight(this._cells,i)),this._cachedBitmapNormal||(this._cachedBitmapNormal=new y),this.isStatic){if(this._cachedBitmapData){if(this._cachedBitmapData.height===s&&y.isEqual(this._cachedBitmapNormal,i)&&this._cachedBitmapDataOffsetX===n&&this._cachedBitmapDataOffsetY===a)return this._cachedBitmapData;this._cachedBitmapData=null}}else this._cachedBitmapData=null;if(this._isCached=!0,this._cachedBitmapData||(this._cachedBitmapData=t.createRenderTexture(this._width,s,`${e}:column`)),this._cachedBitmapNormal.assign(i),this._cachedBitmapDataOffsetX=n,this._cachedBitmapDataOffsetY=a,!this._cells.length)return this._cachedBitmapData;switch(this._repeatMode){case vt.REPEAT_MODE_NONE:this.renderRepeatNone(i);break;case vt.REPEAT_MODE_BORDERS:this.renderRepeatBorders(i);break;case vt.REPEAT_MODE_CENTER:this.renderRepeatCenter(i);break;case vt.REPEAT_MODE_FIRST:this.renderRepeatFirst(i);break;case vt.REPEAT_MODE_LAST:this.renderRepeatLast(i);break;default:this.renderRepeatAll(i,n,a);break}return this._cachedBitmapData}getCellsHeight(e,t){if(!e||!e.length)return 0;let s=0,i=0;for(;i<e.length;){const n=e[i];n&&(s+=n.getHeight(t)),i++}return s}renderCells(e,t,s,i,n=0,a=0){if(!e||!e.length||!this._cachedBitmapData)return t;let o=0;for(;o<e.length;){let u=null;if(s?u=e[o]:u=e[e.length-1-o],u){const l=u.render(i,n,a);if(l&&(s||(t-=l.height),l.y=t,Je.writeToRenderTexture(l,this._cachedBitmapData,!1),s&&(t=t+l.height),s&&t>=this._cachedBitmapData.height||!s&&t<=0))return t}o++}return t}renderRepeatNone(e){!this._cells.length||!this._cachedBitmapData||this.renderCells(this._cells,0,!0,e)}renderRepeatAll(e,t,s){if(!this._cells.length||!this._cachedBitmapData)return;let i=0;for(;i<this._cachedBitmapData.height;)if(i=this.renderCells(this._cells,i,!0,e,t,s),!i)return}renderRepeatBorders(e){if(!this._cells.length||!this._cachedBitmapData)return;const t=[];let s=0,i=1;for(;i<this._cells.length-1;){const u=this._cells[i];if(u){const l=u.getHeight(e);l>0&&(s=s+l,t.push(u))}i++}if(this._cells.length==1){const u=this._cells[0];if(u){const l=u.getHeight(e);l>0&&(s=s+l,t.push(u))}}let n=this._cachedBitmapData.height-s>>1,a=this.renderCells(t,n,!0,e),o=this._cells[0];if(o){const u=[o];for(;n>=0;)n=this.renderCells(u,n,!1,e)}if(o=this._cells[this._cells.length-1],o){const u=[o];for(;a<this._cachedBitmapData.height;)a=this.renderCells(u,a,!0,e)}}renderRepeatCenter(e){if(!this._cells.length||!this._cachedBitmapData)return;const t=[],s=[];let i=0,n=0,a=0;for(;a<this._cells.length>>1;){const l=this._cells[a];if(l){const d=l.getHeight(e);d>0&&(i=i+d,t.push(l))}a++}for(a=(this._cells.length>>1)+1;a<this._cells.length;){const l=this._cells[a];if(l){const d=l.getHeight(e);d>0&&(n=n+d,s.push(l))}a++}let o=0,u=this._cachedBitmapData.height;if(i+n>this._cachedBitmapData.height&&(o=i+n-this._cachedBitmapData.height,u=u+(o-(o>>1))),o==0){const l=this._cells[this._cells.length>>1];if(l){const d=l.getHeight(e);if(d>0){const c=this._cachedBitmapData.height-(i+n),_=Math.ceil(c/d)*d;let f=i-(_-c>>1);const g=f+_,I=[l];for(;f<g;)f=this.renderCells(I,f,!0,e)}}}this.renderCells(t,0,!0,e),this.renderCells(s,u,!1,e)}renderRepeatFirst(e){if(!this._cells.length||!this._cachedBitmapData)return;let t=this.renderCells(this._cells,this._cachedBitmapData.height,!1,e);const s=this._cells[0];if(!s)return;const i=[s];for(;t>=0;)t=this.renderCells(i,t,!1,e)}renderRepeatLast(e){if(!this._cells.length||!this._cachedBitmapData)return;let t=this.renderCells(this._cells,0,!0,e);const s=this._cells[this._cells.length-1];if(!s)return;const i=[s];for(;t<this._cachedBitmapData.height;)t=this.renderCells(i,t,!0,e)}getCells(){return this._cells}}vt.REPEAT_MODE_NONE=0,vt.REPEAT_MODE_ALL=1,vt.REPEAT_MODE_BORDERS=2,vt.REPEAT_MODE_CENTER=3,vt.REPEAT_MODE_FIRST=4,vt.REPEAT_MODE_LAST=5;class ye{constructor(e,t=1,s=1,i=-1,n=1,a=-1,o=1){this._repeatMode=1,this._align=1,this._cachedBitmapNormal=null,this._cachedBitmapHeight=0,this._isCached=!1,this._isStatic=!0,this._normalMinX=-1,this._normalMaxX=1,this._normalMinY=-1,this._normalMaxY=1,this._columns=[],e<1&&(e=1);let u=0;for(;u<e;)this._columns.push(null),u++;this._repeatMode=t,this._align=s,this._normalMinX=i,this._normalMaxX=n,this._normalMinY=a,this._normalMaxY=o,this._repeatMode===ye.REPEAT_MODE_RANDOM&&(this._isStatic=!1)}static nextRandomColumnIndex(e){return it.getValues(1,0,e*17631)[0]%e}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}isBottomAligned(){return this._align===ye.ALIGN_BOTTOM}get isStatic(){return this._isStatic}dispose(){this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapNormal&&(this._cachedBitmapNormal.x=0,this._cachedBitmapNormal.y=0,this._cachedBitmapNormal.z=0),this._columns&&this._columns.length)for(const e of this._columns)e&&e.clearCache();this._isCached=!1}}createColumn(e,t,s,i=1){if(e<0||e>=this._columns.length)return!1;const n=new vt(t,s,i),a=this._columns[e];return a&&a.dispose(),this._columns[e]=n,n&&!n.isStatic&&(this._isStatic=!1),!0}render(e,t,s,i,n,a,o,u,l,d){if(i<1&&(i=1),n<1&&(n=1),this._cachedBitmapNormal||(this._cachedBitmapNormal=new y),this.isStatic){if(this._cachedBitmapData){if(this._cachedBitmapData.baseTexture&&this._cachedBitmapData.width===i&&this._cachedBitmapData.height===n&&y.isEqual(this._cachedBitmapNormal,a))return s?(this.copyCachedBitmapOnCanvas(s,this._cachedBitmapHeight,l,d),s):this._cachedBitmapData;this._cachedBitmapData=null}}else this._cachedBitmapData=null;if(this._isCached=!0,this._cachedBitmapNormal.assign(a),!o)return this._cachedBitmapHeight=n,this._cachedBitmapData?t.clearAndFillRenderTexture(this._cachedBitmapData):this._cachedBitmapData=t.createAndFillRenderTexture(i,n,`${e}:matrix`),this._cachedBitmapData;this._cachedBitmapData||(this._cachedBitmapHeight=n,this._cachedBitmapData=t.createRenderTexture(i,n,`${e}:matrix`),t.clearRenderTexture(this._cachedBitmapData));const c=[];let _=0;for(;_<this._columns.length;){const g=this._columns[_];if(g){const I=g.render(e,t,n,a,u,l);I&&c.push(I)}_++}if(!c.length)return s||this._cachedBitmapData;let f=0;switch(this._repeatMode){case ye.REPEAT_MODE_BORDERS:Y.log("REPEAT_MODE_BORDERS");break;case ye.REPEAT_MODE_CENTER:Y.log("REPEAT_MODE_CENTER");break;case ye.REPEAT_MODE_FIRST:Y.log("REPEAT_MODE_FIRST");break;case ye.REPEAT_MODE_LAST:Y.log("REPEAT_MODE_LAST");break;case ye.REPEAT_MODE_RANDOM:f=this.renderRepeatRandom(this._cachedBitmapData,c);break;default:f=this.renderRepeatAll(this._cachedBitmapData,c);break}return this._cachedBitmapHeight=f,s?(this.copyCachedBitmapOnCanvas(s,f,l,d),s):this._cachedBitmapData}copyCachedBitmapOnCanvas(e,t,s,i){if(!e||!this._cachedBitmapData||e===this._cachedBitmapData)return;i||(s=e.height-t-s);let n=null;this._align===ye.ALIGN_TOP?n=new he(0,0,this._cachedBitmapData.width,this._cachedBitmapHeight):n=new he(0,this._cachedBitmapData.height-this._cachedBitmapHeight,this._cachedBitmapData.width,this._cachedBitmapHeight);const a=new kt(this._cachedBitmapData.baseTexture,n),o=new Ze(a);o.position.set(0,s),Je.writeToRenderTexture(o,e,!1)}getColumnsWidth(e){if(!e||!e.length)return 0;let t=0;for(const s of e)s&&(t+=s.width);return t}renderColumns(e,t,s,i){if(!e||!t||!t.length)return new k(s,0);let n=0,a=0;for(;a<t.length;){const o=i?t[a]:t[t.length-1-a];if(o){i||(s=s-o.width);let u=0;this._align==ye.ALIGN_BOTTOM&&(u=e.height-o.height);const l=new Ze(o);if(l.position.set(s,u),Je.writeToRenderTexture(l,e,!1),o.height>n&&(n=o.height),i&&(s=s+o.width),i&&s>=e.width||!i&&s<=0)return new k(s,n)}a++}return new k(s,n)}renderRepeatAll(e,t){if(!e||!t||!t.length)return 0;this.getColumnsWidth(t);let s=0,i=0;for(;s<e.width;){const n=this.renderColumns(e,t,s,!0);if(s=n.x,n.y>i&&(i=n.y),!n.x)return i}return i}renderRepeatRandom(e,t){if(!e||!t||!t.length)return 0;let s=0,i=0;for(;i<e.width;){const n=t[ye.nextRandomColumnIndex(t.length)];if(n!=null){const a=this.renderColumns(e,[n],i,!0);i=a.x,a.y>s&&(s=a.y)}else return s}return s}getColumns(e){if(this._repeatMode===ye.REPEAT_MODE_RANDOM){const t=[];let s=0;for(;s<e;){const i=this._columns[ye.nextRandomColumnIndex(this._columns.length)];if(i)if(t.push(i),i.width>1)s+=i.width;else break;else break}return t}return this._columns}}ye.REPEAT_MODE_ALL=1,ye.REPEAT_MODE_BORDERS=2,ye.REPEAT_MODE_CENTER=3,ye.REPEAT_MODE_FIRST=4,ye.REPEAT_MODE_LAST=5,ye.REPEAT_MODE_RANDOM=6,ye.REPEAT_MODE_DEFAULT=ye.REPEAT_MODE_ALL,ye.MIN_NORMAL_COORDINATE_VALUE=-1,ye.MAX_NORMAL_COORDINATE_VALUE=1,ye.ALIGN_TOP=1,ye.ALIGN_BOTTOM=2,ye.ALIGN_DEFAULT=ye.ALIGN_TOP;class rd{constructor(){this._planeMaterialItems=[],this._isCached=!1}dispose(){if(this._planeMaterialItems&&this._planeMaterialItems.length){for(const e of this._planeMaterialItems)e&&e.dispose();this._planeMaterialItems=null}this._isCached=!1}clearCache(){if(this._isCached){if(this._planeMaterialItems&&this._planeMaterialItems.length)for(const e of this._planeMaterialItems)e&&e.clearCache();this._isCached=!1}}addMaterialCellMatrix(e,t,s,i=-1,n=1,a=-1,o=1){const u=new ye(e,t,s,i,n,a,o);return this._planeMaterialItems.push(u),u}getMaterialCellMatrix(e){if(!e)return null;if(this._planeMaterialItems&&this._planeMaterialItems.length){for(const t of this._planeMaterialItems)if(t&&e.x>=t.normalMinX&&e.x<=t.normalMaxX&&e.y>=t.normalMinY&&e.y<=t.normalMaxY)return t}return null}render(e,t,s,i,n,a,o,u,l,d){i<1&&(i=1),n<1&&(n=1);const c=this.getMaterialCellMatrix(a);return c?(this._isCached=!0,c.render(e,t,s,i,n,a,o,u,l,d)):null}}rd.MIN_NORMAL_COORDINATE_VALUE=-1,rd.MAX_NORMAL_COORDINATE_VALUE=1;class eY{constructor(e,t=null,s=null,i=0){if(this._extraItemCount=0,this._texture=e,this._extraItemOffsets=[],this._extraItemAssets=[],this._extraItemCount=0,t&&t.length&&i>0){let n=0;for(;n<t.length;){const a=t[n];a&&this._extraItemAssets.push(a),n++}if(this._extraItemAssets.length){if(s){let a=0;for(;a<s.length;){const o=s[a];o&&this._extraItemOffsets.push(new k(o.x,o.y)),a++}}this._extraItemCount=i}}}get isStatic(){return this._extraItemCount===0}dispose(){this._texture&&(this._texture.dispose(),this._texture=null),this._extraItemAssets=null,this._extraItemOffsets=null,this._extraItemCount=0}clearCache(){}getHeight(e){if(this._texture){const t=this._texture.getBitmap(e);if(t)return t.height}return 0}render(e,t,s){if(!this._texture)return null;const i=this._texture.getBitmap(e);if(!i)return null;const n=new UQ(i,i.width,i.height);if(t!==0||s!==0){for(;t<0;)t+=i.width;for(;s<0;)s+=i.height;n.tilePosition.set(t%i.width,s%i.height),n.uvRespectAnchor=!0,t&&(n.anchor.x=1,n.scale.x=-1),s&&(n.anchor.y=1,n.scale.y=-1)}if(!this.isStatic){const a=Math.min(this._extraItemCount,this._extraItemOffsets.length),o=Math.max(this._extraItemCount,this._extraItemOffsets.length),u=it.getArray(this._extraItemCount,o);let l=0;for(;l<a;){const d=this._extraItemOffsets[u[l]],c=this._extraItemAssets[l%this._extraItemAssets.length];if(d&&c){const _=c.texture;if(_){let f=c.offsetX,g=c.offsetY,I=1,p=1,R=0,S=0;c.flipH&&(I=-1,R=_.width,f=-(c.width+c.x)),c.flipV&&(p=-1,S=_.height,g=-(c.height+c.y));const O=new k(d.x+f,d.y+g),A=new Ye;let C=O.x+R;C=C>>1<<1,A.scale(I,p),A.translate(C,O.y+S);const M=new Ze(_);M.transform.setFromMatrix(A),n.addChild(M)}}l++}}return n}getAssetName(e){return this._texture==null?null:this._texture.getAssetName(e)}}class id{constructor(e,t=-1,s=1,i=-1,n=1,a=null){this._bitmap=e,this._normalMinX=t,this._normalMaxX=s,this._normalMinY=i,this._normalMaxY=n,this._assetName=a}get bitmap(){return this._bitmap}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}get assetName(){return this._assetName}dispose(){this._bitmap=null}}id.MIN_NORMAL_COORDINATE_VALUE=-1,id.MAX_NORMAL_COORDINATE_VALUE=1;class Bn{constructor(){this._bitmaps=[]}dispose(){if(this._bitmaps){for(const e of this._bitmaps)e&&e.dispose();this._bitmaps=null}}addBitmap(e,t=-1,s=1,i=-1,n=1,a=null){this._bitmaps.push(new id(e,t,s,i,n,a))}getBitmap(e){const t=this.getPlaneTextureBitmap(e);return t?t.bitmap:null}getPlaneTextureBitmap(e){if(!e)return null;for(const t of this._bitmaps)if(t&&e.x>=t.normalMinX&&e.x<=t.normalMaxX&&e.y>=t.normalMinY&&e.y<=t.normalMaxY)return t;return null}getAssetName(e){const t=this.getPlaneTextureBitmap(e);return t?t.assetName:null}}Bn.MIN_NORMAL_COORDINATE_VALUE=-1,Bn.MAX_NORMAL_COORDINATE_VALUE=1;class an{constructor(){this._assetCollection=null,this._textures=new Map,this._materials=new Map,this._planes=new Map,this._geometries=new Map,this._data=null}get data(){return this._data}get assetCollection(){return this._assetCollection}initializeDimensions(e,t){return!0}dispose(){if(this._planes){for(const e of this._planes.values())e&&e.dispose();this._planes=null}if(this._materials&&(this.resetMaterials(),this._materials=null),this._textures&&(this.resetTextures(),this._textures=null),this._geometries){for(const e of this._geometries.values())e&&e.dispose();this._geometries=null}this._data=null,this._assetCollection=null}clearCache(){for(const e of this._planes.values())e&&e.clearCache();for(const e of this._materials.values())e&&e.clearCache()}initialize(e){this._data=e}reinitialize(){this.resetTextures(),this.resetMaterials(),this.initializeAll()}resetMaterials(){for(const e of this._materials.values())e&&e.dispose();this._materials.clear()}resetTextures(){for(const e of this._textures.values())e&&e.dispose();this._textures.clear()}getTexture(e){return this._textures.get(e)}getMaterial(e){return this._materials.get(e)}getPlane(e){return this._planes.get(e)}addPlane(e,t){return t?this._planes.get(e)?!1:(this._planes.set(e,t),!0):!1}initializeAssetCollection(e){this._data&&(this._assetCollection=e,this.initializeAll())}initializeAll(){this._data&&(this.initializeTexturesAndMaterials(),this.initializePlanes())}initializeTexturesAndMaterials(){this._data.textures&&this._data.textures.length&&this.parseTextures(this._data.textures,this.assetCollection),this._data.materials&&this._data.materials.length&&this.parsePlaneMaterials(this._data.materials)}initializePlanes(){}parseTextures(e,t){if(!(!e||!t)&&e.length)for(const s of e){if(!s)continue;const i=s.id;if(!this._textures.get(i)){const n=new Bn;if(s.bitmaps&&s.bitmaps.length)for(const a of s.bitmaps){if(!a)continue;const o=a.assetName;let u=Bn.MIN_NORMAL_COORDINATE_VALUE,l=Bn.MAX_NORMAL_COORDINATE_VALUE,d=Bn.MIN_NORMAL_COORDINATE_VALUE,c=Bn.MAX_NORMAL_COORDINATE_VALUE;a.normalMinX!==void 0&&(u=a.normalMinX),a.normalMaxX!==void 0&&(l=a.normalMaxX),a.normalMinY!==void 0&&(d=a.normalMinY),a.normalMaxY!==void 0&&(c=a.normalMaxY);const _=t.getAsset(o);if(_){const f=_.texture;if(f){let g=f;_.flipH?g=zO.getFlipHBitmapData(f):g=g.clone(),n.addBitmap(g,u,l,d,c,o)}}}this._textures.set(i,n)}}}parsePlaneMaterials(e){if(!(!e||!e.length))for(const t of e){if(!t)continue;const s=t.id,i=new rd;if(t.matrices&&t.matrices.length)for(const n of t.matrices){if(!n)continue;let a=ye.REPEAT_MODE_DEFAULT,o=ye.ALIGN_DEFAULT,u=ye.MIN_NORMAL_COORDINATE_VALUE,l=ye.MAX_NORMAL_COORDINATE_VALUE,d=ye.MIN_NORMAL_COORDINATE_VALUE,c=ye.MAX_NORMAL_COORDINATE_VALUE;switch(n.normalMinX!==void 0&&(u=n.normalMinX),n.normalMaxX!==void 0&&(l=n.normalMaxX),n.normalMinY!==void 0&&(d=n.normalMinY),n.normalMaxY!==void 0&&(c=n.normalMaxY),n.repeatMode){case"borders":a=ye.REPEAT_MODE_BORDERS;break;case"center":a=ye.REPEAT_MODE_CENTER;break;case"first":a=ye.REPEAT_MODE_FIRST;break;case"last":a=ye.REPEAT_MODE_LAST;break;case"random":a=ye.REPEAT_MODE_RANDOM;break;default:a=ye.REPEAT_MODE_DEFAULT;break}switch(n.align){case"top":o=ye.ALIGN_TOP;break;case"bottom":o=ye.ALIGN_BOTTOM;break;default:o=ye.ALIGN_DEFAULT;break}if(n.columns&&n.columns.length){const _=i.addMaterialCellMatrix(n.columns.length,a,o,u,l,d,c);let f=0;for(;f<n.columns.length;){const g=n.columns[f];g&&this.parsePlaneMaterialCellColumn(g,_,f),f++}}}this._materials.set(s,i)}}parsePlaneMaterialCellColumn(e,t,s){if(!e||!t)return;let i=vt.REPEAT_MODE_ALL;const n=e.width,a=this.parsePlaneMaterialCells(e);switch(e.repeatMode){case"borders":i=vt.REPEAT_MODE_BORDERS;break;case"center":i=vt.REPEAT_MODE_CENTER;break;case"first":i=vt.REPEAT_MODE_FIRST;break;case"last":i=vt.REPEAT_MODE_LAST;break;case"none":i=vt.REPEAT_MODE_NONE;break;default:i=vt.REPEAT_MODE_ALL;break}t.createColumn(s,n,a,i)}parsePlaneMaterialCells(e){if(!e||!e.cells||!e.cells.length)return null;const t=[];let s=0;for(;s<e.cells.length;){const i=e.cells[s];if(i){const n=i.textureId;let a=null,o=null,u=null,l=0;if(i.extraData){const _=i.extraData.extraItemTypes,f=i.extraData.offsets;_&&f&&_.length&&f.length&&(a=this.parseExtraItemTypes(_),o=this.parseExtraItemOffsets(f),l=o.length,i.extraData.limitMax!==void 0&&(l=i.extraData.limitMax))}if(a&&a.length){u=[];for(const _ of a){if(!_)continue;const f=this._assetCollection.getAsset(_);f&&u.push(f)}}const d=this.getTexture(n),c=new eY(d,u,o,l);t.push(c)}s++}return!t||!t.length?null:t}parseExtraItemTypes(e){const t=[];if(e&&e.length){let s=0;for(;s<e.length;){const i=e[s];i&&t.push(i),s++}}return t}parseExtraItemOffsets(e){const t=[];if(e&&e.length){let s=0;for(;s<e.length;){const[i,n]=e[s];t.push(new k(i,n)),s++}}return t}getGeometry(e,t,s){t=Math.abs(t),t>90&&(t=90),s=Math.abs(s),s>90&&(s=90);const i=`${e}_${Math.round(t)}_${Math.round(s)}`;let n=this._geometries.get(i);return n||(n=new ys(e,new y(t,s),new y(-10,0,0)),this._geometries.set(i,n),n)}parseVisualizations(e,t){if(!(!e||!t)&&t&&t.length)for(const s of t){if(!s)continue;const i=s.size;let n=Gn.HORIZONTAL_ANGLE_DEFAULT,a=Gn.VERTICAL_ANGLE_DEFAULT;s.horizontalAngle!==void 0&&(n=s.horizontalAngle),s.verticalAngle!==void 0&&(a=s.verticalAngle);const o=s.allLayers,u=e.createPlaneVisualization(i,o&&o.length||0,this.getGeometry(i,n,a));if(u&&o&&o.length){let l=0;for(;l<o.length;){const d=o[l];if(d){let c=null,_=Jt.ALIGN_DEFAULT,f=Gn.DEFAULT_COLOR,g=Jt.DEFAULT_OFFSET;d.materialId&&(c=this.getMaterial(d.materialId)),d.color&&(f=d.color),d.offset&&(g=d.offset),d.align&&(d.align==="bottom"?_=Jt.ALIGN_BOTTOM:d.align=="top"&&(_=Jt.ALIGN_TOP)),u.setLayer(l,c,f,_,g)}l++}}}}render(e,t,s,i,n,a,o,u,l,d=0,c=0,_=0,f=0,g=0){return null}getTextureIdentifier(e,t){return e.toString()}getLayers(e){let t=this.getPlane(e);return t||(t=this.getPlane(an.DEFAULT)),t.getLayers()}}an.DEFAULT="default";class tY extends an{initializePlanes(){if(!this.data)return;const e=this.data.planes;e&&e.length&&this.parseFloors(e)}parseFloors(e){if(e)for(const t in e){const s=e[t];if(!s)continue;const i=s.id,n=s.visualizations,a=new Gn;this.parseVisualizations(a,n),this.addPlane(i,a)||a.dispose()}}render(e,t,s,i,n,a,o,u,l,d=0,c=0,_=0,f=0,g=0){let I=this.getPlane(i);if(I||(I=this.getPlane(an.DEFAULT)),!I)return null;s&&t.clearAndFillRenderTexture(s);let p=I.render(e,t,s,n,a,o,u,l,d,c);return p&&p!==s&&(p=new kt(p.baseTexture),!p)?null:new rl(p,-1)}}class il extends sd{render(e,t,s,i,n,a,o,u){const l=this.getPlaneVisualization(a);if(!l||!l.geometry)return null;const d=l.geometry.getScreenPoint(new y(0,0,0)),c=l.geometry.getScreenPoint(new y(0,0,n/l.geometry.scale)),_=l.geometry.getScreenPoint(new y(0,i/l.geometry.scale,0));return d&&c&&_&&(i=Math.round(Math.abs(d.x-_.x)),n=Math.round(Math.abs(d.y-c.y))),l.render(e,t,s,i,n,o,u)}}il.DEFAULT_COLOR=16777215,il.HORIZONTAL_ANGLE_DEFAULT=45,il.VERTICAL_ANGLE_DEFAULT=30;class sY extends an{initializePlanes(){if(!this.data)return;const e=this.data.planes;e&&e.length&&this.parseWalls(e)}parseWalls(e){if(e)for(const t in e){const s=e[t];if(!s)continue;const i=s.id,n=s.visualizations,a=new il;this.parseVisualizations(a,n),this.addPlane(i,a)||a.dispose()}}render(e,t,s,i,n,a,o,u,l,d=0,c=0,_=0,f=0,g=0){let I=this.getPlane(i);if(I||(I=this.getPlane(an.DEFAULT)),!I)return null;s&&t.clearAndFillRenderTexture(s);let p=I.render(e,t,s,n,a,o,u,l);return p&&p!==s&&(p=new kt(p.baseTexture),!p)?null:new rl(p,-1)}getTextureIdentifier(e,t){return t?`${e}_${t.x}_${t.y}_${t.z}`:super.getTextureIdentifier(e,t)}}class Hn extends sd{constructor(){super(...arguments),this._width=0,this._height=0}isStatic(e){const t=this.getPlaneVisualization(e);return t?!t.hasAnimationLayers:super.isStatic(e)}initializeDimensions(e,t){e<0&&(e=0),t<0&&(t=0),(e!==this._width||t!==this._height)&&(this._width=e,this._height=t)}render(e,t,s,i,n,a,o,u,l,d,c,_,f){const g=this.getPlaneVisualization(a);if(!g||!g.geometry)return null;const I=g.geometry.getScreenPoint(new y(0,0,0)),p=g.geometry.getScreenPoint(new y(0,0,1)),R=g.geometry.getScreenPoint(new y(0,1,0));if(I&&p&&R){i=Math.round(Math.abs((I.x-R.x)*i/g.geometry.scale)),n=Math.round(Math.abs((I.y-p.y)*n/g.geometry.scale));const S=Math.trunc(l*Math.abs(I.x-R.x)),O=Math.trunc(d*Math.abs(I.y-p.y)),A=Math.trunc(c*Math.abs(I.x-R.x)),C=Math.trunc(_*Math.abs(I.y-p.y));return g.render(e,t,s,i,n,o,u,S,O,A,C,c,_,f)}return null}}Hn.DEFAULT_COLOR=16777215,Hn.HORIZONTAL_ANGLE_DEFAULT=45,Hn.VERTICAL_ANGLE_DEFAULT=30;class Rr extends an{constructor(){super(...arguments),this._landscapeWidth=0,this._landscapeHeight=0,this._cachedBitmap=null}initializeDimensions(e,t){return e<0&&(e=0),t<0&&(t=0),this._landscapeWidth=e,this._landscapeHeight=t,!0}initializePlanes(){if(!this.data)return;const e=this.data.planes;e&&e.length&&this.parseLandscapes(e)}parseLandscapes(e){var t;if(!e)return;const s=Math.trunc(Math.random()*654321);for(const i in e){const n=e[i];if(!n)continue;const a=n.id,o=n.animatedVisualization,u=new Hn;for(const l of o){if(!l)continue;const d=l.size;let c=Hn.HORIZONTAL_ANGLE_DEFAULT,_=Hn.VERTICAL_ANGLE_DEFAULT;l.horizontalAngle!==void 0&&(c=l.horizontalAngle),l.verticalAngle!==void 0&&(_=l.verticalAngle);const f=(t=l.allLayers.length)!==null&&t!==void 0?t:0,g=u.createPlaneVisualization(d,f||0,this.getGeometry(d,c,_));if(g){it.setSeed(s);let I=0;for(;I<f;){const p=l.allLayers[I];if(p){if(p.items===void 0){const R=p;let S=null,O=Jt.ALIGN_DEFAULT,A=Hn.DEFAULT_COLOR,C=Jt.DEFAULT_OFFSET;R.materialId&&(S=this.getMaterial(R.materialId)),R.color&&(A=R.color),R.offset&&(C=R.offset),R.align&&(R.align==="bottom"?O=Jt.ALIGN_BOTTOM:R.align==="top"&&(O=Jt.ALIGN_TOP)),g.setLayer(I,S,A,O,C)}else{const S=p.items,O=[];if(S&&S.length){for(const A of S)if(A){A.id;const C=A.assetId,M=this.getCoordinateValue(A.x||"",A.randomX||""),N=this.getCoordinateValue(A.y||"",A.randomY||""),L=A.speedX,b=A.speedY;O.push({asset:C,x:M,y:N,speedX:L,speedY:b})}}g.setAnimationLayer(I,O,this.assetCollection)}I++}}}}this.addPlane(a,u)||u.dispose()}}getCoordinateValue(e,t){let s=0;if(e.length>0&&e.charAt(e.length-1)==="%"&&(e=e.substr(0,e.length-1),s=parseFloat(e)/100),t.length>0){const a=it.getValues(1,0,1e4)[0]/1e4;t.charAt(t.length-1)==="%"&&(t=t.substr(0,t.length-1),s=s+a*parseFloat(t)/100)}return s}render(e,t,s,i,n,a,o,u,l,d=0,c=0,_=0,f=0,g=0){let I=this.getPlane(i);if(I||(I=this.getPlane(Rr.DEFAULT)),!I)return null;s&&t.clearRenderTexture(s);let p=I.render(e,t,s,n,a,o,u,l,d,c,_,f,g);if(p&&p!==s&&(p=new kt(p.baseTexture),!p))return null;let R=null;return!I.isStatic(o)&&Rr.UPDATE_INTERVAL>0?R=new rl(p,Math.round(g/Rr.UPDATE_INTERVAL)*Rr.UPDATE_INTERVAL+Rr.UPDATE_INTERVAL):R=new rl(p,-1),R}getTextureIdentifier(e,t){return t?t.x<0?e+"_0":e+"_1":super.getTextureIdentifier(e,t)}}Rr.LANDSCAPES_ENABLED=!0,Rr.LANDSCAPE_DEFAULT_COLOR=8828617,Rr.UPDATE_INTERVAL=500;class hI{constructor(e,t){if(this._color=0,this._isDisposed=!1,this._color=0,this._isDisposed=!1,this._items=[],e&&t)for(const s of e){if(!s)continue;const i=s.asset;if(i){const n=t.getAsset(i);n&&this._items.push(new J3(s.x,s.y,s.speedX,s.speedY,n))}}}get disposed(){return this._isDisposed}dispose(){if(this._isDisposed=!0,this._items){for(const e of this._items)e&&e.dispose();this._items=[]}}clearCache(){}render(e,t,s,i,n,a,o,u,l,d,c,_){if(u>0&&l>0){let f=0;for(;f<this._items.length;){const g=this._items[f];if(g){const I=g.getPosition(u,l,d,c,_);if(I.x=Math.trunc(I.x-a),I.y=Math.trunc(I.y-o),g.bitmapData){if(I.x>-g.bitmapData.width&&I.x<t.width&&I.y>-g.bitmapData.height&&I.y<t.height){const p=new Ze(g.bitmapData.texture);p.position.set(I.x,I.y),e.writeToRenderTexture(p,t,!1)}if(I.x-u>-g.bitmapData.width&&I.x-u<t.width&&I.y>-g.bitmapData.height&&I.y<t.height){const p=new Ze(g.bitmapData.texture);p.position.set(I.x-u,I.y),e.writeToRenderTexture(p,t,!1)}if(I.x>-g.bitmapData.width&&I.x<t.width&&I.y-l>-g.bitmapData.height&&I.y-l<t.height){const p=new Ze(g.bitmapData.texture);p.position.set(I.x,I.y-l),e.writeToRenderTexture(p,t,!1)}if(I.x-u>-g.bitmapData.width&&I.x-u<t.width&&I.y-l>-g.bitmapData.height&&I.y-l<t.height){const p=new Ze(g.bitmapData.texture);p.position.set(I.x-u,I.y-l),e.writeToRenderTexture(p,t,!1)}}}f++}}return t}}class uI{constructor(e,t,s){this._type=e,this._leftSideLoc=t,this._rightSideLoc=s}get type(){return this._type}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}}class lI{constructor(e,t,s,i){this._leftSideLoc=e,this._rightSideLoc=t,this._leftSideLength=s,this._rightSideLength=i}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}get leftSideLength(){return this._leftSideLength}get rightSideLength(){return this._rightSideLength}}class Ie{constructor(e,t,s,i,n,a,o,u,l,d=0,c=0,_=0,f=0){if(this._maskManager=null,this._width=0,this._height=0,this._textureCache=e,this._secondaryNormals=[],this._bitmapMasks=[],this._rectangleMasks=[],this._bitmapMasksOld=[],this._rectangleMasksOld=[],this._randomSeed=l,this._bitmapData=null,this._maskBitmapData=null,this._maskChanged=!1,this._activeTexture=null,this._origin=new y,this._origin.assign(t),this._location=new y,this._location.assign(s),this._leftSide=new y,this._leftSide.assign(i),this._rightSide=new y,this._rightSide.assign(n),this._normal=y.crossProduct(this._leftSide,this._rightSide),this._normal.length>0&&this._normal.multiply(1/this._normal.length),u!=null)for(const g of u){if(!g)continue;const I=new y;I.assign(g),this._secondaryNormals.push(I)}this._disposed=!1,this._isVisible=!1,this._id=null,this._hasTexture=!0,this._geometryUpdateId=-1,this._offset=new k,this._relativeDepth=0,this._type=a,this._color=0,this._rasterizer=null,this._canBeVisible=!0,this._cornerA=new y,this._cornerB=new y,this._cornerC=new y,this._cornerD=new y,this._width=0,this._height=0,this._textureOffsetX=d,this._textureOffsetY=c,this._textureMaxX=_,this._textureMaxY=f,this._useMask=o,this._uniqueId=++Ie._uniqueIdCounter}static blend(e,t){return Zs.colorize(t,e|4278190080)&16777215}set canBeVisible(e){e!==this._canBeVisible&&(this._canBeVisible||this.resetTextureCache(),this._canBeVisible=e)}get canBeVisible(){return this._canBeVisible}get bitmapData(){return!this.visible||!this._bitmapData?null:this._bitmapData}get maskBitmapData(){return!this.visible||!this._maskBitmapData?null:this._maskBitmapData}get visible(){return this._isVisible&&this._canBeVisible}get offset(){return this._offset}get relativeDepth(){return this._relativeDepth}get color(){return this._color}set color(e){this._color=e}get type(){return this._type}get leftSide(){return this._leftSide}get rightSide(){return this._rightSide}get location(){return this._location}get normal(){return this._normal}get hasTexture(){return this._hasTexture}set hasTexture(e){this._hasTexture=e}set rasterizer(e){this._rasterizer=e}set maskManager(e){this._maskManager=e}set id(e){e!==this._id&&(this.resetTextureCache(),this._id=e)}get uniqueId(){return this._uniqueId}dispose(){this._activeTexture=null,this._location=null,this._origin=null,this._leftSide=null,this._rightSide=null,this._normal=null,this._rasterizer=null,this._cornerA=null,this._cornerB=null,this._cornerC=null,this._cornerD=null,this._bitmapMasks=null,this._rectangleMasks=null,this._maskPixels=null,this._maskBitmapData&&(this._maskBitmapData.destroy(!0),this._maskBitmapData=null),this._disposed=!0}copyBitmapData(e){return!this.visible||!this._bitmapData||!e||this._bitmapData.width!==e.width||this._bitmapData.height!==e.height?null:e}resetTextureCache(e=null){this._activeTexture=null}getTextureIdentifier(e){return this._rasterizer?this._rasterizer.getTextureIdentifier(e,this.normal):e.toString()}needsNewTexture(e,t){if(!e)return!1;const s=this._activeTexture;return this.updateMaskChangeStatus(),!!(this._canBeVisible&&(!s||s.timeStamp>=0&&t>s.timeStamp||this._maskChanged))}getTexture(e,t){if(!e)return null;let s=null;if(this.needsNewTexture(e,t)){this.getTextureIdentifier(e.scale);const i=this._leftSide.length*e.scale,n=this._rightSide.length*e.scale,a=e.getCoordinatePosition(this._normal);s=this._rasterizer.render(this._uniqueId.toString(),this._textureCache,null,this._id,i,n,e.scale,a,this._hasTexture,this._textureOffsetX,this._textureOffsetY,this._textureMaxX,this._textureMaxY,t),s&&this.updateMask(s.texture,e)}else this._activeTexture&&(s=this._activeTexture);return s?(this._activeTexture=s,s.texture):null}resolveMasks(e){if(!this._useMask)return null;const t=new zo,s=0;for(;s<this._bitmapMasks.length;){const i=this._bitmapMasks[s];if(i){const n=this._maskManager.getMask(i.type);if(n){const a=n.getAssetName(e.scale);if(a){const o=e.getCoordinatePosition(this._normal),u=n.getGraphicAsset(e.scale,o);if(u){const l=this._maskBitmapData.width*(1-i.leftSideLoc/this._leftSide.length),d=this._maskBitmapData.height*(1-i.rightSideLoc/this._rightSide.length);t.addMask(a,new k(l+u.offsetX,d+u.offsetY),u.flipH,u.flipV)}}}}}return t}screenWidth(e){const t=e.getScreenPoint(new y(0,0,0)),s=e.getScreenPoint(new y(0,1,0));return Math.round(this._leftSide.length*Math.abs(t.x-s.x))}getDrawingDatas(e){const t=[];if(this._isVisible){const s=this.resolveMasks(e),i=this._rasterizer.getLayers(this._id);for(const n of i)if(this._hasTexture&&n.getMaterial()){const a=e.getCoordinatePosition(this._normal),o=n.getMaterial().getMaterialCellMatrix(a),u=new zo(s,Ie.blend(this._color,n.getColor()),o.isBottomAligned());it.setSeed(this._randomSeed);for(const l of o.getColumns(this.screenWidth(e))){const d=[];for(const c of l.getCells()){const _=c.getAssetName(a);_&&d.push(_)}d.length>0&&(l.isRepeated()||d.push(""),u.addAssetColumn(d))}u.assetNameColumns.length>0&&t.push(u)}else{const a=new zo(s,Ie.blend(this._color,n.getColor()));t.push(a)}t.length||t.push(new zo(s,this._color))}return t}update(e,t){if(!e||this._disposed)return!1;let s=!1;if(this._geometryUpdateId!=e.updateId&&(s=!0),(!s||!this._canBeVisible)&&!this.visible)return!1;if(s){this._activeTexture=null;let i=0;if(i=y.cosAngle(e.directionAxis,this.normal),i>-.001)return this._isVisible?(this._isVisible=!1,!0):!1;let n=0;for(;n<this._secondaryNormals.length;){if(i=y.cosAngle(e.directionAxis,this._secondaryNormals[n]),i>-.001)return this._isVisible?(this._isVisible=!1,!0):!1;n++}this.updateCorners(e);const o=e.getScreenPosition(this._origin).z;let u=Math.max(this._cornerA.z,this._cornerB.z,this._cornerC.z,this._cornerD.z)-o;this._type===Ie.TYPE_FLOOR&&(u=u-(this._location.z+Math.min(0,this._leftSide.z,this._rightSide.z))*8),this._type===Ie.TYPE_LANDSCAPE&&(u=u+.02),this._relativeDepth=u,this._isVisible=!0,this._geometryUpdateId=e.updateId}if(s||this.needsNewTexture(e,t)){if(!this._bitmapData||this._width!==this._bitmapData.width||this._height!==this._bitmapData.height){if(this._bitmapData)if(this._width!==this._bitmapData.width||this._height!==this._bitmapData.height){if(this._bitmapData.destroy(),this._bitmapData=null,this._width<1||this._height<1)return!0;this._bitmapData=this._textureCache.createAndFillRenderTexture(this._width,this._height)}else{if(this._width<1||this._height<1)return this._bitmapData.destroy(),this._bitmapData=null,!0;this._textureCache.clearAndFillRenderTexture(this._bitmapData)}else{if(this._width<1||this._height<1)return!1;this._bitmapData=this._textureCache.createAndFillRenderTexture(this._width,this._height)}if(!this._bitmapData)return!1}else this._textureCache.clearAndFillRenderTexture(this._bitmapData);it.setSeed(this._randomSeed);const i=this.getTexture(e,t);if(i)this.renderTexture(e,i);else return this.dispose(),!1;return i!==null||s}return!1}updateCorners(e){this._cornerA.assign(e.getScreenPosition(this._location)),this._cornerB.assign(e.getScreenPosition(y.sum(this._location,this._rightSide))),this._cornerC.assign(e.getScreenPosition(y.sum(y.sum(this._location,this._leftSide),this._rightSide))),this._cornerD.assign(e.getScreenPosition(y.sum(this._location,this._leftSide))),this._offset=e.getScreenPoint(this._origin),this._cornerA.x=Math.round(this._cornerA.x),this._cornerA.y=Math.round(this._cornerA.y),this._cornerB.x=Math.round(this._cornerB.x),this._cornerB.y=Math.round(this._cornerB.y),this._cornerC.x=Math.round(this._cornerC.x),this._cornerC.y=Math.round(this._cornerC.y),this._cornerD.x=Math.round(this._cornerD.x),this._cornerD.y=Math.round(this._cornerD.y),this._offset.x=Math.round(this._offset.x),this._offset.y=Math.round(this._offset.y);const t=Math.min(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x),s=Math.max(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x)-t,i=Math.min(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y),n=Math.max(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y)-i;this._offset.x=this._offset.x-t,this._cornerA.x=this._cornerA.x-t,this._cornerB.x=this._cornerB.x-t,this._cornerC.x=this._cornerC.x-t,this._cornerD.x=this._cornerD.x-t,this._offset.y=this._offset.y-i,this._cornerA.y=this._cornerA.y-i,this._cornerB.y=this._cornerB.y-i,this._cornerC.y=this._cornerC.y-i,this._cornerD.y=this._cornerD.y-i,this._width=s,this._height=n}getMatrixForDimensions(e,t){let s=this._cornerD.x-this._cornerC.x,i=this._cornerD.y-this._cornerC.y,n=this._cornerB.x-this._cornerC.x,a=this._cornerB.y-this._cornerC.y;(this._type===Ie.TYPE_WALL||this._type===Ie.TYPE_LANDSCAPE)&&(Math.abs(n-e)<=1&&(n=e),Math.abs(a-e)<=1&&(a=e),Math.abs(s-t)<=1&&(s=t),Math.abs(i-t)<=1&&(i=t));const o=n/e,u=a/e,l=s/t,d=i/t,c=new Ye(o,u,l,d);return c.translate(this._cornerC.x,this._cornerC.y),c}renderTexture(e,t){this._cornerA==null||this._cornerB==null||this._cornerC==null||this._cornerD==null||t==null||this._bitmapData==null||this.draw(t,this.getMatrixForDimensions(t.width,t.height))}draw(e,t){this._textureCache.writeToRenderTexture(new Ze(e),this._bitmapData,!0,t)}resetBitmapMasks(){this._disposed||!this._useMask||!this._bitmapMasks.length||(this._maskChanged=!0,this._bitmapMasks=[])}addBitmapMask(e,t,s){if(!this._useMask)return!1;for(const n of this._bitmapMasks)if(n&&n.type===e&&n.leftSideLoc===t&&n.rightSideLoc===s)return!1;const i=new uI(e,t,s);return this._bitmapMasks.push(i),this._maskChanged=!0,!0}resetRectangleMasks(){!this._useMask||!this._rectangleMasks.length||(this._maskChanged=!0,this._rectangleMasks=[])}addRectangleMask(e,t,s,i){if(this._useMask){for(const a of this._rectangleMasks)if(a&&a.leftSideLoc===e&&a.rightSideLoc===t&&a.leftSideLength===s&&a.rightSideLength===i)return!1;const n=new lI(e,t,s,i);return this._rectangleMasks.push(n),this._maskChanged=!0,!0}return!1}updateMaskChangeStatus(){if(!this._maskChanged)return;let e=!0;if(this._bitmapMasks.length===this._bitmapMasksOld.length)for(const t of this._bitmapMasks){if(!t)continue;let s=!1;for(const i of this._bitmapMasksOld)if(i&&i.type===t.type&&i.leftSideLoc===t.leftSideLoc&&i.rightSideLoc===t.rightSideLoc){s=!0;break}if(!s){e=!1;break}}else e=!1;this._rectangleMasks.length>this._rectangleMasksOld.length&&(e=!1),e&&(this._maskChanged=!1)}updateMask(e,t){if(!e||!t||!this._useMask||!this._bitmapMasks.length&&!this._rectangleMasks.length&&!this._maskChanged||!this._maskManager)return;const s=e.width,i=e.height;if(this.updateMaskChangeStatus(),(!this._maskBitmapData||this._maskBitmapData.width!==s||this._maskBitmapData.height!==i)&&(this._maskBitmapData=this._textureCache.createAndFillRenderTexture(s,i,"mask"),this._maskChanged=!0),this._maskChanged){this._bitmapMasksOld=[],this._rectangleMasksOld=[],this._maskBitmapData&&this._textureCache.clearAndFillRenderTexture(this._maskBitmapData),this.resetTextureCache(e);const n=t.getCoordinatePosition(this._normal);let a=null,o=0,u=0,l=0;for(;l<this._bitmapMasks.length;){const d=this._bitmapMasks[l];d&&(a=d.type,o=this._maskBitmapData.width-this._maskBitmapData.width*d.leftSideLoc/this._leftSide.length,u=this._maskBitmapData.height-this._maskBitmapData.height*d.rightSideLoc/this._rightSide.length,this._maskManager.updateMask(this._maskBitmapData,a,t.scale,n,o,u),this._bitmapMasksOld.push(new uI(a,d.leftSideLoc,d.rightSideLoc))),l++}for(l=0;l<this._rectangleMasks.length;){const d=this._rectangleMasks[l];if(d){o=this._maskBitmapData.width-this._maskBitmapData.width*d.leftSideLoc/this._leftSide.length,u=this._maskBitmapData.height-this._maskBitmapData.height*d.rightSideLoc/this._rightSide.length;const c=this._maskBitmapData.width*d.leftSideLength/this._leftSide.length,_=this._maskBitmapData.height*d.rightSideLength/this._rightSide.length,f=new Ze(Re.WHITE);f.tint=0,f.width=c,f.height=_,f.position.set(o-c,u-_),this._textureCache.writeToRenderTexture(f,this._maskBitmapData,!1),this._rectangleMasksOld.push(new lI(d.leftSideLength,d.rightSideLoc,d.leftSideLength,d.rightSideLength))}l++}this._maskPixels=this._textureCache.getPixels(this._maskBitmapData),this._maskChanged=!1}this.combineTextureMask(e,this._maskPixels)}combineTextureMask(e,t){var s,i;if(!e||!t)return;const n=this._textureCache.getPixels(e);for(let u=0;u<n.length;u+=4){const l=t[u],d=t[u+1],c=t[u+2];t[u+3],!l&&!d&&!c&&(n[u+3]=0)}const a=(s=e.baseTexture._glTextures[1])===null||s===void 0?void 0:s.texture,o=(i=_t.instance.renderer)===null||i===void 0?void 0:i.gl;!a||!o||(o.bindTexture(o.TEXTURE_2D,a),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,e.width,e.height,0,o.RGBA,o.UNSIGNED_BYTE,n),o.bindTexture(o.TEXTURE_2D,null))}}Ie.ZERO_POINT=new k(0,0),Ie.TYPE_UNDEFINED=0,Ie.TYPE_WALL=1,Ie.TYPE_FLOOR=2,Ie.TYPE_LANDSCAPE=3,Ie._uniqueIdCounter=1;class cI extends Ss{constructor(){super(),this._wallRasterizer=new sY,this._floorRasterizer=new tY,this._landscapeRasterizer=new Rr,this._maskManager=new Z3,this._initialized=!1}initialize(e){if(!e.roomVisualization)return!1;const t=e.roomVisualization.wallData;t&&this._wallRasterizer.initialize(t);const s=e.roomVisualization.floorData;s&&this._floorRasterizer.initialize(s);const i=e.roomVisualization.landscapeData;i&&this._landscapeRasterizer.initialize(i);const n=e.roomVisualization.maskData;return n&&this._maskManager.initialize(n),!0}onDispose(){this._wallRasterizer&&(this._wallRasterizer.dispose(),this._wallRasterizer=null),this._floorRasterizer&&(this._floorRasterizer.dispose(),this._floorRasterizer=null),this._landscapeRasterizer&&(this._landscapeRasterizer.dispose(),this._landscapeRasterizer=null),this._maskManager&&(this._maskManager.dispose(),this._maskManager=null),super.onDispose()}setGraphicAssetCollection(e){this._initialized||(this._wallRasterizer.initializeAssetCollection(e),this._floorRasterizer.initializeAssetCollection(e),this._landscapeRasterizer.initializeAssetCollection(e),this._maskManager.initializeAssetCollection(e),this._initialized=!0)}clearCache(){this._wallRasterizer&&this._wallRasterizer.clearCache(),this._floorRasterizer&&this._floorRasterizer.clearCache(),this._landscapeRasterizer&&this._landscapeRasterizer.clearCache()}get wallRasterizer(){return this._wallRasterizer}get floorRasterizer(){return this._floorRasterizer}get landscapeRasterizer(){return this._landscapeRasterizer}get maskManager(){return this._maskManager}}class qe extends Mn{constructor(){super(),this._data=null,this._roomPlaneParser=new te,this._roomPlaneBitmapMaskParser=new Kp,this._geometryUpdateId=-1,this._directionX=0,this._directionY=0,this._directionZ=0,this._floorThickness=1,this._wallThickness=1,this._holeUpdateTime=NaN,this._planes=[],this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[],this._roomScale=0,this._lastUpdateTime=-1e3,this._updateIntervalTime=250,this._wallType=null,this._floorType=null,this._landscapeType=null,this._colorBackgroundOnly=!0,this._color=16777215,this._redColor=255,this._greenColor=255,this._blueColor=255,this._typeVisibility=[],this._assetUpdateCounter=0,this._maskData=null,this._isPlaneSet=!1,this._textureCache=new Vh,this._typeVisibility[Ie.TYPE_UNDEFINED]=!1,this._typeVisibility[Ie.TYPE_FLOOR]=!0,this._typeVisibility[Ie.TYPE_WALL]=!0,this._typeVisibility[Ie.TYPE_LANDSCAPE]=!0}initialize(e){return e instanceof cI?(this._data=e,super.initialize(e),this._data.setGraphicAssetCollection(this.asset),!0):!1}dispose(){super.dispose(),this.clearPlanes(),this._planes=null,this._visiblePlanes=null,this._visiblePlaneSpriteNumbers=null,this._roomPlaneParser&&(this._roomPlaneParser.dispose(),this._roomPlaneParser=null),this._roomPlaneBitmapMaskParser&&(this._roomPlaneBitmapMaskParser.dispose(),this._roomPlaneBitmapMaskParser=null),this._data&&(this._data.clearCache(),this._data=null),this._textureCache&&this._textureCache.clearCache()}reset(){super.reset(),this._floorType=null,this._wallType=null,this._landscapeType=null,this._maskData=null,this._geometryUpdateId=-1,this._roomScale=0}update(e,t,s,i){if(!this.object||!e)return;const n=this.updateGeometry(e),a=this.object.model;let o=!1;if(this.updateThickness(a)&&(o=!0),this.updateHole(a)&&(o=!0),this.initializeRoomPlanes(),o=this.updateMasks(a),!(t<this._lastUpdateTime+this._updateIntervalTime&&!n&&!o)){if(this.updatePlaneTexturesAndVisibilities(a)&&(o=!0),this.updatePlanes(e,n,t)&&(o=!0),o){let u=0;for(;u<this._visiblePlanes.length;){const l=this._visiblePlaneSpriteNumbers[u],d=this.getSprite(l),c=this._visiblePlanes[u];if(d&&c&&c.type!==Ie.TYPE_LANDSCAPE)if(this._colorBackgroundOnly){let _=c.color;const f=(_&255)*this._redColor/255,g=(_>>8&255)*this._greenColor/255,I=(_>>16&255)*this._blueColor/255;_=(_>>24<<24)+(I<<16)+(g<<8)+f,d.color=_}else d.color=c.color;u++}this.updateSpriteCounter++}this.updateModelCounter=a.updateCounter,this._lastUpdateTime=t}}updateGeometry(e){if(!e||this._geometryUpdateId===e.updateId)return!1;this._geometryUpdateId=e.updateId,this._boundingRectangle=null;const t=e.direction;return t&&(t.x!==this._directionX||t.y!==this._directionY||t.z!==this._directionZ||e.scale!==this._roomScale)?(this._directionX=t.x,this._directionY=t.y,this._directionZ=t.z,this._roomScale=e.scale,!0):!1}updateThickness(e){if(this.updateModelCounter===e.updateCounter)return!1;const t=e.getValue(T.ROOM_FLOOR_THICKNESS),s=e.getValue(T.ROOM_WALL_THICKNESS);return!isNaN(t)&&!isNaN(s)&&(t!==this._floorThickness||s!==this._wallThickness)?(this._floorThickness=t,this._wallThickness=s,this.clearPlanes(),!0):!1}updateHole(e){if(this.updateModelCounter===e.updateCounter)return!1;const t=e.getValue(T.ROOM_FLOOR_HOLE_UPDATE_TIME);return!isNaN(t)&&t!==this._holeUpdateTime?(this._holeUpdateTime=t,this.clearPlanes(),!0):!1}updateMasks(e){if(this.updateModelCounter===e.updateCounter)return!1;let t=!1;const s=e.getValue(T.ROOM_PLANE_MASK_XML);s!==this._maskData&&(this.updatePlaneMasks(s),this._maskData=s,t=!0);const i=e.getValue(T.ROOM_BACKGROUND_COLOR);i!==this._color&&(this._color=i,this._redColor=this._color&255,this._greenColor=this._color>>8&255,this._blueColor=this._color>>16&255,t=!0);const n=e.getValue(T.ROOM_COLORIZE_BG_ONLY)||!1;return n!==this._colorBackgroundOnly&&(this._colorBackgroundOnly=n,t=!0),t}updatePlaneTexturesAndVisibilities(e){if(this.updateModelCounter===e.updateCounter)return!1;const t=e.getValue(T.ROOM_FLOOR_TYPE),s=e.getValue(T.ROOM_WALL_TYPE),i=e.getValue(T.ROOM_LANDSCAPE_TYPE),n=e.getValue(T.ROOM_FLOOR_VISIBILITY)===1,a=e.getValue(T.ROOM_WALL_VISIBILITY)===1,o=e.getValue(T.ROOM_LANDSCAPE_VISIBILITY)===1;return this.updatePlaneTypes(t,s,i)||this.updatePlaneVisibility(n,a,o)}clearPlanes(){if(this._planes){for(;this._planes.length;){const e=this._planes[0];e&&e.dispose(),this._planes.pop()}this._planes=[],this._planes=[]}this._isPlaneSet=!1,this._assetUpdateCounter=this._assetUpdateCounter+1,this.reset()}initializeRoomPlanes(){if(!this.object||this._isPlaneSet)return;isNaN(this._floorThickness)||(this._roomPlaneParser.floorThicknessMultiplier=this._floorThickness),isNaN(this._wallThickness)||(this._roomPlaneParser.wallThicknessMultiplier=this._wallThickness);const e=this.object.model.getValue(T.ROOM_MAP_DATA);if(!this._roomPlaneParser.initializeFromMapData(e))return;const t=this.getLandscapeWidth(),s=this.getLandscapeHeight();let i=0,n=this.object.model.getValue(T.ROOM_RANDOM_SEED),a=0;for(;a<this._roomPlaneParser.planeCount;){const o=this._roomPlaneParser.getPlaneLocation(a),u=this._roomPlaneParser.getPlaneLeftSide(a),l=this._roomPlaneParser.getPlaneRightSide(a),d=this._roomPlaneParser.getPlaneSecondaryNormals(a),c=this._roomPlaneParser.getPlaneType(a);let _=null;if(o&&u&&l){const f=y.crossProduct(u,l);if(n=EI(Math.trunc(n*7613+517)>>>0),_=null,c===$e.PLANE_FLOOR){const g=o.x+u.x+.5,I=o.y+l.y+.5,p=Math.trunc(g)-g,R=Math.trunc(I)-I;_=new Ie(this._textureCache,this.object.getLocation(),o,u,l,Ie.TYPE_FLOOR,!0,d,n,-p,-R),f.z!==0?_.color=qe.FLOOR_COLOR:_.color=f.x!==0?qe.FLOOR_COLOR_RIGHT:qe.FLOOR_COLOR_LEFT,this._data&&(_.rasterizer=this._data.floorRasterizer)}else c===$e.PLANE_WALL?(_=new Ie(this._textureCache,this.object.getLocation(),o,u,l,Ie.TYPE_WALL,!0,d,n),(u.length<1||l.length<1)&&(_.hasTexture=!1),f.x===0&&f.y===0?_.color=qe.WALL_COLOR_BORDER:f.y>0?_.color=qe.WALL_COLOR_TOP:f.y===0?_.color=qe.WALL_COLOR_SIDE:_.color=qe.WALL_COLOR_BOTTOM,this._data&&(_.rasterizer=this._data.wallRasterizer)):c===$e.PLANE_LANDSCAPE?(_=new Ie(this._textureCache,this.object.getLocation(),o,u,l,Ie.TYPE_LANDSCAPE,!0,d,n,i,0,t,s),f.y>0?_.color=qe.LANDSCAPE_COLOR_TOP:f.y==0?_.color=qe.LANDSCAPE_COLOR_SIDE:_.color=qe.LANDSCAPE_COLOR_BOTTOM,this._data&&(_.rasterizer=this._data.landscapeRasterizer),i=i+u.length):c==$e.PLANE_BILLBOARD&&(_=new Ie(this._textureCache,this.object.getLocation(),o,u,l,Ie.TYPE_WALL,!0,d,n),(u.length<1||l.length<1)&&(_.hasTexture=!1),f.x==0&&f.y==0?_.color=qe.WALL_COLOR_BORDER:f.y>0?_.color=qe.WALL_COLOR_TOP:f.y==0?_.color=qe.WALL_COLOR_SIDE:_.color=qe.WALL_COLOR_BOTTOM);if(_){_.maskManager=this._data.maskManager;let g=0;for(;g<this._roomPlaneParser.getPlaneMaskCount(a);){const I=this._roomPlaneParser.getPlaneMaskLeftSideLoc(a,g),p=this._roomPlaneParser.getPlaneMaskRightSideLoc(a,g),R=this._roomPlaneParser.getPlaneMaskLeftSideLength(a,g),S=this._roomPlaneParser.getPlaneMaskRightSideLength(a,g);_.addRectangleMask(I,p,R,S),g++}this._planes.push(_)}}else return;a++}this._isPlaneSet=!0,this.defineSprites()}defineSprites(){this.createSprites(this._planes.length);let e=0;for(;e<this._planes.length;){const t=this._planes[e],s=this.getSprite(e);t&&s&&t.leftSide&&t.rightSide&&(t.type===Ie.TYPE_WALL&&(t.leftSide.length<1||t.rightSide.length<1)?s.alphaTolerance=Ks.MATCH_NOTHING:s.alphaTolerance=Ks.MATCH_OPAQUE_PIXELS,t.type===Ie.TYPE_WALL?s.tag="plane.wall@"+(e+1):t.type===Ie.TYPE_FLOOR?s.tag="plane.floor@"+(e+1):s.tag="plane@"+(e+1),s.spriteType=cs.ROOM_PLANE),e++}}getLandscapeWidth(){let e=0,t=0;for(;t<this._roomPlaneParser.planeCount;){if(this._roomPlaneParser.getPlaneType(t)===$e.PLANE_LANDSCAPE){const i=this._roomPlaneParser.getPlaneLeftSide(t);e+=i.length}t++}return e}getLandscapeHeight(){let e=0,t=0;for(;t<this._roomPlaneParser.planeCount;){if(this._roomPlaneParser.getPlaneType(t)===$e.PLANE_LANDSCAPE){const i=this._roomPlaneParser.getPlaneRightSide(t);i.length>e&&(e=i.length)}t++}return e>5&&(e=5),e}updatePlaneTypes(e,t,s){if(e!==this._floorType?this._floorType=e:e=null,t!==this._wallType?this._wallType=t:t=null,s!==this._landscapeType?this._landscapeType=s:s=null,!e&&!t&&!s)return!1;let i=0;for(;i<this._planes.length;){const n=this._planes[i];n&&(n.type===Ie.TYPE_FLOOR&&e?n.id=e:n.type===Ie.TYPE_WALL&&t?n.id=t:n.type===Ie.TYPE_LANDSCAPE&&s&&(n.id=s)),i++}return!0}updatePlaneVisibility(e,t,s){return e===this._typeVisibility[Ie.TYPE_FLOOR]&&t===this._typeVisibility[Ie.TYPE_WALL]&&s===this._typeVisibility[Ie.TYPE_LANDSCAPE]?!1:(this._typeVisibility[Ie.TYPE_FLOOR]=e,this._typeVisibility[Ie.TYPE_WALL]=t,this._typeVisibility[Ie.TYPE_LANDSCAPE]=s,this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[],!0)}updatePlanes(e,t,s){if(!e||!this.object)return!1;this._assetUpdateCounter++,t&&(this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[]);const i=this._visiblePlanes.length>0;let n=this._visiblePlanes;this._visiblePlanes.length||(n=this._planes);let a=0,o=!1,u=0;for(;u<n.length;){let l=u;i&&(l=this._visiblePlaneSpriteNumbers[u]);const d=this.getSprite(l);if(d){const c=n[u];c?(d.id=c.uniqueId,c.update(e,s)&&(c.visible&&(a=c.relativeDepth+this.floorRelativeDepth+l/1e3,c.type!==Ie.TYPE_FLOOR&&(a=c.relativeDepth+this.wallRelativeDepth+l/1e3,(c.leftSide.length<1||c.rightSide.length<1)&&(a=a+qe.ROOM_DEPTH_OFFSET*.5)),this.updateSprite(d,e,c,`plane ${l} ${e.scale}`,a)),o=!0),d.visible!=(c.visible&&this._typeVisibility[c.type])&&(d.visible=!d.visible,o=!0),d.visible&&(i||(this._visiblePlanes.push(c),this._visiblePlaneSpriteNumbers.push(u)))):(d.id=0,d.visible&&(d.visible=!1,o=!0))}u++}return o}updatePlaneMasks(e){if(!e)return;this._roomPlaneBitmapMaskParser.initialize(e);const t=[],s=[];let i=!1,n=0;for(;n<this._planes.length;){const a=this._planes[n];a&&(a.resetBitmapMasks(),a.type===Ie.TYPE_LANDSCAPE&&t.push(n)),n++}for(const a of this._roomPlaneBitmapMaskParser.masks.values()){const o=this._roomPlaneBitmapMaskParser.getMaskType(a),u=this._roomPlaneBitmapMaskParser.getMaskLocation(a),l=this._roomPlaneBitmapMaskParser.getMaskCategory(a);if(u){let d=0;for(;d<this._planes.length;){const c=this._planes[d];if((c.type===Ie.TYPE_WALL||c.type===Ie.TYPE_LANDSCAPE)&&c&&c.location&&c.normal){const _=y.dif(u,c.location);if(Math.abs(y.scalarProjection(_,c.normal))<.01&&c.leftSide&&c.rightSide){const g=y.scalarProjection(_,c.leftSide),I=y.scalarProjection(_,c.rightSide);c.type===Ie.TYPE_WALL||c.type===Ie.TYPE_LANDSCAPE&&l===Un.HOLE?c.addBitmapMask(o,g,I):c.type===Ie.TYPE_LANDSCAPE&&(c.canBeVisible||(i=!0),c.canBeVisible=!0,s.push(d))}}d++}}}for(n=0;n<t.length;){const a=t[n];if(s.indexOf(a)<0){const o=this._planes[a];o.canBeVisible=!1,i=!0}n++}i&&(this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[])}updateSprite(e,t,s,i,n){const a=s.offset;e.offsetX=-a.x,e.offsetY=-a.y,e.relativeDepth=n,e.color=s.color,e.texture=s.bitmapData,e.name=i+"_"+this._assetUpdateCounter}getBoundingRectangle(){return this._boundingRectangle||(this._boundingRectangle=super.getBoundingRectangle()),new he(this._boundingRectangle.x,this._boundingRectangle.y,this._boundingRectangle.width,this._boundingRectangle.height)}get planes(){const e=[];for(const t of this._visiblePlanes)e.push(t);return e}get floorRelativeDepth(){return qe.ROOM_DEPTH_OFFSET+.1}get wallRelativeDepth(){return qe.ROOM_DEPTH_OFFSET+.5}}qe.FLOOR_COLOR=16777215,qe.FLOOR_COLOR_LEFT=14540253,qe.FLOOR_COLOR_RIGHT=12303291,qe.WALL_COLOR_TOP=16777215,qe.WALL_COLOR_SIDE=13421772,qe.WALL_COLOR_BOTTOM=10066329,qe.WALL_COLOR_BORDER=10066329,qe.LANDSCAPE_COLOR_TOP=16777215,qe.LANDSCAPE_COLOR_SIDE=13421772,qe.LANDSCAPE_COLOR_BOTTOM=10066329,qe.ROOM_DEPTH_OFFSET=1e3;class rY extends rt{constructor(){super(),this._tileHeight=0}getLayerYOffset(e,t,s){return s===1?(this._tileHeight=this.object.model.getValue(T.TILE_CURSOR_HEIGHT),-this._tileHeight*32):super.getLayerYOffset(e,t,s)}}class nl{constructor(){this._visualizationDatas=new Map}getVisualization(e){const t=this.getVisualizationType(e);return t?new t:null}getVisualizationType(e){if(!e)return null;let t=null;switch(e){case G.ROOM:t=qe;break;case G.TILE_CURSOR:t=rY;break;case G.USER:case G.BOT:case G.RENTABLE_BOT:t=z;break;case G.PET_ANIMATED:t=et;break;case G.FURNITURE_STATIC:t=pr;break;case G.FURNITURE_ANIMATED:t=rt;break;case G.FURNITURE_RESETTING_ANIMATED:t=V3;break;case G.FURNITURE_BADGE_DISPLAY:t=Fa;break;case G.FURNITURE_BG:t=j3;break;case G.FURNITURE_BB:t=$p;break;case G.FURNITURE_ISOMETRIC_BB:t=B3;break;case G.FURNITURE_BOTTLE:t=sn;break;case G.FURNITURE_BUILDER_PLACEHOLDER:t=U3;break;case G.FURNITURE_COUNTER_CLOCK:t=xr;break;case G.FURNITURE_CUBOID:t=F3;break;case G.FURNITURE_EXTERNAL_IMAGE:t=w3;break;case G.FURNITURE_FIREWORKS:t=sI;break;case G.FURNITURE_GIFT_WRAPPED_FIREWORKS:t=nn;break;case G.FURNITURE_GIFT_WRAPPED:t=G3;break;case G.FURNITURE_GUILD_CUSTOMIZED:t=Es;break;case G.FURNITURE_GUILD_ISOMETRIC_BADGE:t=Ir;break;case G.FURNITURE_HABBOWHEEL:t=Tr;break;case G.FURNITURE_MANNEQUIN:t=xa;break;case G.FURNITURE_PARTY_BEAMER:t=Gs;break;case G.FURNITURE_PLANET_SYSTEM:t=H3;break;case G.FURNITURE_POSTER:t=k3;break;case G.FURNITURE_QUEUE_TILE:t=Ii;break;case G.FURNITURE_SCORE_BOARD:t=Gr;break;case G.FURNITURE_SOUNDBLOCK:t=Y3;break;case G.FURNITURE_STICKIE:t=W3;break;case G.FURNITURE_VAL_RANDOMIZER:t=Zt;break;case G.FURNITURE_VOTE_COUNTER:t=Bs;break;case G.FURNITURE_VOTE_MAJORITY:t=ms;break;case G.FURNITURE_WATER_AREA:t=z3;break;case G.FURNITURE_YOUTUBE:t=sl;break}return t||(Y.log("Unknown Visualization",e),null)}getVisualizationData(e,t,s){const i=this._visualizationDatas.get(e);if(i)return i;let n=null;switch(t){case G.FURNITURE_STATIC:case G.FURNITURE_GIFT_WRAPPED:case G.FURNITURE_BB:case G.FURNITURE_ISOMETRIC_BB:case G.FURNITURE_BG:case G.FURNITURE_STICKIE:case G.FURNITURE_BUILDER_PLACEHOLDER:n=new pi;break;case G.FURNITURE_ANIMATED:case G.FURNITURE_RESETTING_ANIMATED:case G.FURNITURE_POSTER:case G.FURNITURE_HABBOWHEEL:case G.FURNITURE_VAL_RANDOMIZER:case G.FURNITURE_BOTTLE:case G.FURNITURE_PLANET_SYSTEM:case G.FURNITURE_QUEUE_TILE:case G.FURNITURE_PARTY_BEAMER:case G.FURNITURE_COUNTER_CLOCK:case G.FURNITURE_WATER_AREA:case G.FURNITURE_SCORE_BOARD:case G.FURNITURE_FIREWORKS:case G.FURNITURE_GIFT_WRAPPED_FIREWORKS:case G.FURNITURE_GUILD_CUSTOMIZED:case G.FURNITURE_GUILD_ISOMETRIC_BADGE:case G.FURNITURE_VOTE_COUNTER:case G.FURNITURE_VOTE_MAJORITY:case G.FURNITURE_SOUNDBLOCK:case G.FURNITURE_BADGE_DISPLAY:case G.FURNITURE_EXTERNAL_IMAGE:case G.FURNITURE_YOUTUBE:case G.TILE_CURSOR:n=new Z_;break;case G.FURNITURE_MANNEQUIN:n=new J_;break;case G.ROOM:n=new cI;break;case G.USER:case G.BOT:case G.RENTABLE_BOT:n=new $u;break;case G.PET_ANIMATED:n=new oI;break}return n?n.initialize(s)?((n instanceof $u||n instanceof J_)&&(n.avatarManager=X.instance.avatar),nl.CACHING_ENABLED&&this._visualizationDatas.set(e,n),n):(n.dispose(),null):null}}nl.CACHING_ENABLED=!0;class ze{}ze.ROOM_MIN_X="room_min_x",ze.ROOM_MAX_X="room_max_x",ze.ROOM_MIN_Y="room_min_y",ze.ROOM_MAX_Y="room_max_y",ze.ROOM_IS_PUBLIC="room_is_public",ze.ROOM_Z_SCALE="room_z_scale",ze.AD_DISPLAY_DELAY="ad_display_delay",ze.IS_PLAYING_GAME="is_playing_game",ze.RESTRICTS_DRAGGING="restricts_dragging",ze.RESTRICTS_SCALING="restricts_scaling",ze.RESTRICTED_SCALE="room_scale";class iY{constructor(e,t){this._width=e,this._height=t,this._heights=[],this._isNotStackable=[],this._isRoomTile=[];let s=e*t;for(;s>0;)this._heights.push(0),this._isNotStackable.push(!1),this._isRoomTile.push(!1),s--}dispose(){this._width=0,this._height=0,this._height=null,this._isNotStackable=null,this._isRoomTile=null}validPosition(e,t){return e>=0&&e<this._width&&t>=0&&t<this._height}getTileHeight(e,t){return this.validPosition(e,t)?this._heights[t*this._width+e]:0}setTileHeight(e,t,s){this.validPosition(e,t)&&(this._heights[t*this._width+e]=s)}setStackingBlocked(e,t,s){this.validPosition(e,t)&&(this._isNotStackable[t*this._width+e]=s)}setIsRoomTile(e,t,s){this.validPosition(e,t)&&(this._isRoomTile[t*this._width+e]=s)}validateLocation(e,t,s,i,n,a,o,u,l,d=-1){let c=0,_=0;if(!this.validPosition(e,t)||!this.validPosition(e+s-1,t+i-1))return!1;(n<0||n>=this._width)&&(n=0),(a<0||a>=this._height)&&(a=0),o=Math.min(o,this._width-n),u=Math.min(u,this._height-a),d===-1&&(d=this.getTileHeight(e,t));let f=t;for(;f<t+i;){for(c=e;c<e+s;){if(c<n||c>=n+o||f<a||f>=a+u){if(_=f*this._width+c,l){if(!this._isRoomTile[_])return!1}else if(this._isNotStackable[_]||!this._isRoomTile[_]||Math.abs(this._heights[_]-d)>.01)return!1}c++}f++}return!0}get width(){return this._width}get height(){return this._height}}class ps{constructor(){this._isDisposed=!1,this._scale=64,this._heightMap=[],this._width=0,this._height=0,this._floorHeight=0}get disposed(){return this._isDisposed}get scale(){return this._scale}set scale(e){this._scale=e}dispose(){this.reset(),this._isDisposed=!0}initialize(e,t,s){if(e<=this._width&&t<=this._height){this._width=e,this._height=t,this._floorHeight=s;return}this.reset();let i=0;for(;i<t;){const n=[];this._heightMap.push(n);let a=0;for(;a<e;)n.push(0),a++;i++}this._width=e,this._height=t,this._floorHeight=s}reset(){this._heightMap=[]}setHeight(e,t,s){if(e<0||e>=this._width||t<0||t>=this._height)return!1;const i=this._heightMap[t];return i?(i[e]=s,!0):!1}getHeight(e,t){if(e<0||e>=this._width||t<0||t>=this._height)return 0;const s=this._heightMap[t];return s?s[e]:0}getLocation(e,t,s,i,n){if(e==0&&t==0){e=this._width,t=this._height;const d=Math.round(this.scale/10);if(n==ps.R){let c=this._width-1;for(;c>=0;){let _=1;for(;_<this._height;){if(this.getHeight(c,_)<=this._floorHeight){_-1<t&&(e=c,t=_-1);break}_++}c--}i=i+(this.scale/4-d/2),s=s+this.scale/2}else{let c=this._height-1;for(;c>=0;){let _=1;for(;_<this._width;){if(this.getHeight(_,c)<=this._floorHeight){_-1<e&&(e=_-1,t=c);break}_++}c--}i=i+(this.scale/4-d/2),s=s-d}}let a=e,o=t,u=this.getHeight(e,t);return n==ps.R?(a=a+(s/(this._scale/2)-.5),o=o+.5,u=u-(i-s/2)/(this._scale/2)):(o=o+((this._scale/2-s)/(this._scale/2)-.5),a=a+.5,u=u-(i-(this._scale/2-s)/2)/(this._scale/2)),new y(a,o,u)}getLocationOldFormat(e,t,s){let i,n,a=0,o=0;n=Math.ceil(e),a=n-e;let u,l,d,c=0;for(i=0;i<this._width;){if(n>=0&&n<this._height){if(this.getHeight(i,n)<=this._floorHeight){u=i-1,l=n,o=i,s=ps.L;break}if(this.getHeight(i,n+1)<=this._floorHeight){u=i,l=n,o=l-e,s=ps.R;break}}n++,i++}const _=this.scale/2*a;let f=-o*this.scale/2;return f=f+-t*18/32*this.scale/2,c=this.getHeight(u,l),d=c*this.scale/2+f,s==ps.R?d=d+a*this.scale/4:d=d+(1-a)*this.scale/4,this.getLocation(u,l,_,d,s)}getOldLocation(e,t){if(e==null)return null;let s=0,i=0,n=0,a=0,o="",u=0;if(t==90)s=Math.floor(e.x-.5),i=Math.floor(e.y+.5),u=this.getHeight(s,i),n=this._scale/2-(e.y-i+.5)*(this._scale/2),a=(u-e.z)*(this._scale/2)+(this._scale/2-n)/2,o=ps.L;else if(t==180)s=Math.floor(e.x+.5),i=Math.floor(e.y-.5),u=this.getHeight(s,i),n=(e.x+.5-s)*(this._scale/2),a=(u-e.z)*(this._scale/2)+n/2,o=ps.R;else return null;return[s,i,n,a,o]}getOldLocationString(e,t){const s=this.getOldLocation(e,t);if(s==null)return null;const i=Math.trunc(s[0]),n=Math.trunc(s[1]),a=Math.trunc(s[2]),o=Math.trunc(s[3]),u=s[4];return":w="+i+","+n+" l="+a+","+o+" "+u}getDirection(e){return e==ps.R?180:90}getFloorAltitude(e,t){const s=this.getHeight(e,t),i=s+1;return s+(Math.trunc(this.getHeight(e-1,t-1))==i||Math.trunc(this.getHeight(e,t-1))==i||Math.trunc(this.getHeight(e+1,t-1))==i||Math.trunc(this.getHeight(e-1,t))==i||Math.trunc(this.getHeight(e+1,t))==i||Math.trunc(this.getHeight(e-1,t+1))==i||Math.trunc(this.getHeight(e,t+1))==i||Math.trunc(this.getHeight(e+1,t+1))==i?.5:0)}isRoomTile(e,t){return e>=0&&e<this._width&&t>=0&&t<this._height&&this._heightMap[t][e]>=0}}ps.DEFAULT_SCALE=32,ps.L="l",ps.R="r";class al{constructor(){this._targetId=-1,this._targetCategory=-2,this._targetLoc=null,this._moveDistance=0,this._previousMoveSpeed=0,this._maintainPreviousMoveSpeed=!1,this._currentLoc=null,this._limitedLocX=!1,this._limitedLocY=!1,this._centeredLocX=!1,this._centeredLocY=!1,this._screenWd=0,this._screenHt=0,this._scale=0,this._roomWd=0,this._roomHt=0,this._geometryUpdateId=-1,this._scaleChanged=!1,this._targetObjectLoc=new y}get location(){return this._currentLoc}get targetId(){return this._targetId}set targetId(e){this._targetId=e}get targetCategory(){return this._targetCategory}set targetCategory(e){this._targetCategory=e}get targetObjectLoc(){return this._targetObjectLoc}set targetObjectLoc(e){this._targetObjectLoc.assign(e)}get limitedLocationX(){return this._limitedLocX}set limitedLocationX(e){this._limitedLocX=e}get limitedLocationY(){return this._limitedLocY}set limitedLocationY(e){this._limitedLocY=e}get centeredLocX(){return this._centeredLocX}set centeredLocX(e){this._centeredLocX=e}get centeredLocY(){return this._centeredLocY}set centeredLocY(e){this._centeredLocY=e}get screenWd(){return this._screenWd}set screenWd(e){this._screenWd=e}get screenHt(){return this._screenHt}set screenHt(e){this._screenHt=e}get scale(){return this._scale}set scale(e){this._scale!=e&&(this._scale=e,this._scaleChanged=!0)}get roomWd(){return this._roomWd}set roomWd(e){this._roomWd=e}get roomHt(){return this._roomHt}set roomHt(e){this._roomHt=e}get geometryUpdateId(){return this._geometryUpdateId}set geometryUpdateId(e){this._geometryUpdateId=e}get isMoving(){return this._targetLoc!=null&&this._currentLoc!=null}set target(e){let t;this._targetLoc==null&&(this._targetLoc=new y),(this._targetLoc.x!=e.x||this._targetLoc.y!=e.y||this._targetLoc.z!=e.z)&&(this._targetLoc.assign(e),t=y.dif(this._targetLoc,this._currentLoc),this._moveDistance=t.length,this._maintainPreviousMoveSpeed=!0)}dispose(){this._targetLoc=null,this._currentLoc=null}initializeLocation(e){this._currentLoc==null&&(this._currentLoc=new y,this._currentLoc.assign(e))}resetLocation(e){this._currentLoc==null&&(this._currentLoc=new y),this._currentLoc.assign(e)}update(e,t){let s,i,n,a,o;if(this._followDuration>0&&this._targetLoc!=null&&this._currentLoc!=null){if(this._scaleChanged){this._scaleChanged=!1,this._currentLoc=this._targetLoc,this._targetLoc=null;return}s=y.dif(this._targetLoc,this._currentLoc),s.length>this._moveDistance&&(this._moveDistance=s.length),s.length<=t?(this._currentLoc=this._targetLoc,this._targetLoc=null,this._previousMoveSpeed=0):(i=Math.sin(Math.PI*s.length/this._moveDistance),n=t*.5,a=this._moveDistance/al.MOVE_SPEED_DENOMINATOR,o=n+(a-n)*i,this._maintainPreviousMoveSpeed&&(o<this._previousMoveSpeed?(o=this._previousMoveSpeed,o>s.length&&(o=s.length)):this._maintainPreviousMoveSpeed=!1),this._previousMoveSpeed=o,s.divide(s.length),s.multiply(o),this._currentLoc=y.sum(this._currentLoc,s))}}reset(){this._geometryUpdateId=-1}activateFollowing(e){this._followDuration=e}}al.MOVE_SPEED_DENOMINATOR=12;class _I{constructor(e,t){this._roomId=e,this._data=t,this._floorType=null,this._wallType=null,this._landscapeType=null}get roomId(){return this._roomId}get data(){return this._data}get floorType(){return this._floorType}set floorType(e){this._floorType=e}get wallType(){return this._wallType}set wallType(e){this._wallType=e}get landscapeType(){return this._landscapeType}set landscapeType(e){this._landscapeType=e}}class nd{constructor(e,t,s,i,n,a,o,u=NaN,l=-1,d=0,c=0,_="",f=!0,g=!0,I=-1){this._id=e,this._typeId=t,this._type=s,this._state=a,this._data=o,this._extra=u,this._expiryTime=l,this._usagePolicy=d,this._ownerId=c,this._ownerName=_,this._synchronized=f,this._realRoomObject=g,this._sizeZ=I,this._location=new y,this._direction=new y,this._location.assign(i),this._direction.assign(n)}get id(){return this._id}get typeId(){return this._typeId}get type(){return this._type}get location(){return this._location}get direction(){return this._direction}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}get expiryTime(){return this._expiryTime}get usagePolicy(){return this._usagePolicy}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get synchronized(){return this._synchronized}get realRoomObject(){return this._realRoomObject}get sizeZ(){return this._sizeZ}}class nY{constructor(e,t){this._tileObjectMap=new Map;let s=0;for(;s<t;)this._tileObjectMap.set(s,new Map),s++;this._width=e,this._height=t}clear(){for(const e of this._tileObjectMap.values())e&&e.clear();this._tileObjectMap.clear()}populate(e){this.clear();for(const t of e)this.addRoomObject(t)}dispose(){this._tileObjectMap=null,this._width=0,this._height=0}getObjectIntTile(e,t){if(e>=0&&e<this._width&&t>=0&&t<this._height){const s=this._tileObjectMap.get(t);if(s)return s.get(e)}return null}setObjectInTile(e,t,s){if(!s.isReady){Y.log("Assigning non initialized object to tile object map!");return}if(e>=0&&e<this._width&&t>=0&&t<this._height){const i=this._tileObjectMap.get(t);i&&i.set(e,s)}}addRoomObject(e){if(!e||!e.model||!e.isReady)return;const t=e.getLocation(),s=e.getDirection();if(!t||!s)return;let i=e.model.getValue(T.FURNITURE_SIZE_X),n=e.model.getValue(T.FURNITURE_SIZE_Y);i<1&&(i=1),n<1&&(n=1);const a=Math.trunc(s.x+45)%360/90;(a===1||a===3)&&([i,n]=[n,i]);let o=t.y;for(;o<t.y+n;){let u=t.x;for(;u<t.x+i;){const l=this.getObjectIntTile(u,o);(!l||l!==e&&l.getLocation().z<=t.z)&&this.setObjectInTile(u,o,e),u++}o++}}}class aY{constructor(e){this._roomId=e,this._modelName=null,this._legacyGeometry=new ps,this._tileObjectMap=null,this._roomCamera=new al,this._selectedObject=null,this._placedObject=null,this._furnitureStackingHeightMap=null,this._floorStack=new Map,this._wallStack=new Map,this._mouseButtonCursorOwners=[]}dispose(){}setModelName(e){this._modelName=e}setSelectedObject(e){this._selectedObject&&this._selectedObject.dispose(),this._selectedObject=e}setPlacedObject(e){this._placedObject&&this._placedObject.dispose(),this._placedObject=e}setFurnitureStackingHeightMap(e){this._furnitureStackingHeightMap&&this._furnitureStackingHeightMap.dispose(),this._furnitureStackingHeightMap=e,this._tileObjectMap&&this._tileObjectMap.dispose(),this._furnitureStackingHeightMap&&(this._tileObjectMap=new nY(this._furnitureStackingHeightMap.width,this._furnitureStackingHeightMap.height))}addPendingFurnitureFloor(e){e&&(this._floorStack.delete(e.id),this._floorStack.set(e.id,e))}removePendingFunitureFloor(e){const t=this._floorStack.get(e);return t?(this._floorStack.delete(e),t):null}getPendingFurnitureFloor(e){const t=this._floorStack.get(e);return t?(this._floorStack.delete(e),t):null}getNextPendingFurnitureFloor(){if(!this._floorStack.size)return null;const e=this._floorStack.keys();return this.getPendingFurnitureFloor(e.next().value)}addPendingFurnitureWall(e){e&&(this._wallStack.delete(e.id),this._wallStack.set(e.id,e))}removePendingFurnitureWall(e){const t=this._wallStack.get(e);return t?(this._wallStack.delete(e),t):null}getPendingFurnitureWall(e){const t=this._wallStack.get(e);return t?(this._wallStack.delete(e),t):null}getNextPendingFurnitureWall(){if(!this._wallStack.size)return null;const e=this._wallStack.keys();return this.getPendingFurnitureWall(e.next().value)}addButtonMouseCursorOwner(e){return this._mouseButtonCursorOwners.indexOf(e)===-1?(this._mouseButtonCursorOwners.push(e),!0):!1}removeButtonMouseCursorOwner(e){const t=this._mouseButtonCursorOwners.indexOf(e);return t>-1?(this._mouseButtonCursorOwners.splice(t,1),!0):!1}hasButtonMouseCursorOwners(){return this._mouseButtonCursorOwners.length>0}get roomId(){return this._roomId}get modelName(){return this._modelName}get legacyGeometry(){return this._legacyGeometry}get tileObjectMap(){return this._tileObjectMap}get roomCamera(){return this._roomCamera}get selectedObject(){return this._selectedObject}get placedObject(){return this._placedObject}get furnitureStackingHeightMap(){return this._furnitureStackingHeightMap}}class oY{constructor(e,t){this._object=e,this._groupBadge=t}get object(){return this._object}get groupBadge(){return this._groupBadge}}class ad{constructor(e,t,s,i,n,a=0,o=null,u=null,l=-1,d=-1,c=null){this._id=0,this._category=0,this._operation="",this._loc=null,this._dir=null,this._typeId=0,this._instanceData=null,this._stuffData=null,this._state=-1,this._animFrame=-1,this._posture=null,this._id=e,this._category=t,this._operation=s,this._loc=new y,this._loc.assign(i),this._dir=new y,this._dir.assign(n),this._typeId=a,this._instanceData=o,this._stuffData=u,this._state=l,this._animFrame=d,this._posture=c}get id(){return this._id}get category(){return this._category}get operation(){return this._operation}get loc(){return this._loc}get dir(){return this._dir}get typeId(){return this._typeId}get instanceData(){return this._instanceData}get stuffData(){return this._stuffData}get state(){return this._state}get animFrame(){return this._animFrame}get posture(){return this._posture}dispose(){this._loc=null,this._dir=null}}class Is{constructor(){this.spriteCount=0,this.externalImageCount=0}static addMannequinSprites(e,t){const s=[];for(const i of e)if(i)if(i.type==="boutique_mannequin1"&&i.name.indexOf("mannequin_")===0){const n=t.getRoomObject(t.activeRoomId,i.objectId,U.FLOOR);if(n){const a=n.visualization.getSpriteList();if(a)for(const o of a)o.x=o.x+(i.x+i.width/2+Is.MANNEQUIN_MAGIC_X_OFFSET),o.y=o.y+(i.y+i.height+Is.MANNEQUIN_MAGIC_Y_OFFSET),o.z=o.z+i.z,s.push(o)}}else s.push(i);return s}static sortSpriteDataObjects(e,t){return e.z<t.z?1:(e.z>t.z,-1)}static isSpriteInViewPort(e,t,s){return!0}static sortQuadPoints(e,t,s,i){const n=[];if(e.x==t.x?n.push(e,s,t,i):e.x==s.x?n.push(e,t,s,i):t.x<e.x&&t.y>e.y||t.x>e.x&&t.y<e.y?n.push(e,s,t,i):n.push(e,t,s,i),n[0].x<n[1].x){let a=n[0];n[0]=n[1],n[1]=a,a=n[2],n[2]=n[3],n[3]=a}if(n[0].y<n[2].y){let a=n[0];n[0]=n[2],n[2]=a,a=n[1],n[1]=n[3],n[3]=a}return n}getFurniData(e,t,s,i){const n=[];let a=t.getSortableSpriteList();const o=s.getRoomObjects(s.activeRoomId,U.UNIT);for(const u of o)if(u.id!==i){const l=u.visualization.getSpriteList();if(l){let d=0,c=0;for(const f of a)if(f.name==="avatar_"+u.id){d=f.z,c=f.y+f.height-t.geometry.scale/4;break}const _=s.getRoomObjectScreenLocation(s.activeRoomId,u.id,U.UNIT,t.id);if(_){c===0&&(c=_.y);for(const f of l)f.x=f.x+(_.x-t.screenOffsetX),f.y=f.y+c,f.z=f.z+d,(f.name.indexOf("h_std_fx29_")===0||f.name.indexOf("h_std_fx185_")===0)&&(f.y=f.y+Is.AVATAR_WATER_EFFECT_MAGIC_Y_OFFSET),a.push(f)}}}a=Is.addMannequinSprites(a,s),a.sort(Is.sortSpriteDataObjects);for(const u of a)u.name!==null&&u.name.length>0&&u.name.indexOf("tile_cursor_")!==0&&Is.isSpriteInViewPort(u,e,t)&&(i<0||u.objectId!=i)&&(n.push(this.getSpriteDataObject(u,e,t,s)),this.maxZ||(this.maxZ=u.z),this.spriteCount++);return JSON.stringify(n)}getRoomRenderingModifiers(e){return JSON.stringify(new Object)}getSpriteDataObject(e,t,s,i){let n=[];const a={};let o=e.name;return e.name.indexOf("@")!==-1&&(n=e.name.split("@"),o=n[0],n[1]),a.name=o,a.x=e.x-t.x,a.y=e.y-t.y,a.x=a.x+s.screenOffsetX,a.y=a.y+s.screenOffsetY,a.z=e.z,e.alpha&&e.alpha.toString()!=="255"&&(a.alpha=e.alpha),e.flipH&&(a.flipH=e.flipH),e.skew&&(a.skew=e.skew),e.frame&&(a.frame=e.frame),e.color&&e.color.length>0&&(a.color=parseInt(e.color)),e.blendMode&&e.blendMode!=="normal"&&(a.blendMode=e.blendMode),o.indexOf("http")===0&&(a.width=e.width,a.height=e.height,this.externalImageCount++,this.externalImageCount>Is.MAX_EXTERNAL_IMAGE_COUNT&&(a.name="box")),e.posture&&(a.posture=e.posture),a}makeBackgroundPlane(e,t,s){const i=new k(0,0),n=new k(e.width,0),a=new k(0,e.height),o=new k(e.width,e.height),u=Is.sortQuadPoints(i,n,a,o);let l=0;s.length>0?(l=s[0].z,this.maxZ&&(l=Math.max(this.maxZ,l))):l=this.maxZ?this.maxZ:0,l=l+(this.spriteCount*1.776104+s.length*2.31743);const d=new zo(null,t);return d.cornerPoints=u,d.z=l,d}sortRoomPlanes(e,t,s){const i=new Map;let n=1;this.maxZ&&(n=n+this.maxZ);for(const u of e){const l={plane:u,z:n};i.set(u.uniqueId,l)}const a=t.getPlaneSortableSprites();a.sort((u,l)=>l.z-u.z),a.reverse();let o=[];for(const u of a){const l=u.sprite;if(l){const d=i.get(l.id);d&&(i.delete(l.id),d.z=u.z,o.push(d))}}return o=o.concat(Array.from(i.values())),o}getRoomPlanes(e,t,s,i){const n=[],o=s.getRoomObject(s.activeRoomId,Oe.ROOM_OBJECT_ID,U.ROOM).visualization;if(o){const u=t.geometry,l=this.sortRoomPlanes(o.planes,t,s),d=_t.instance.stage;for(const c of l){const _=c.plane,f=[],g=y.sum(_.location,_.leftSide),I=u.getScreenPoint(_.location),p=u.getScreenPoint(g),R=u.getScreenPoint(y.sum(_.location,_.rightSide)),S=u.getScreenPoint(y.sum(g,_.rightSide));f.push(I,p,R,S);let O=0,A=0;for(const C of f)C.x+=d.width/2,C.y+=d.height/2,C.x+=t.screenOffsetX,C.y+=t.screenOffsetY,C.x+=-e.x,C.y+=-e.y,C.x<0?O--:C.x>=e.width&&O++,C.y<0?A--:C.y>=e.height&&A++;if(!(Math.abs(O)===4||Math.abs(A)===4)){const C=Is.sortQuadPoints(I,p,R,S);for(const M of _.getDrawingDatas(u))M.cornerPoints=C,M.z=c.z,n.push(M)}}n.unshift(this.makeBackgroundPlane(e,i,n))}return n}}Is.MANNEQUIN_MAGIC_X_OFFSET=1,Is.MANNEQUIN_MAGIC_Y_OFFSET=-16,Is.AVATAR_WATER_EFFECT_MAGIC_Y_OFFSET=-52,Is.MAX_EXTERNAL_IMAGE_COUNT=30;class hY extends Ss{constructor(e){super(),this._connection=null,this._roomCreator=e,this._planeParser=new te,this._latestEntryTileEvent=null,this._currentRoomId=0,this._ownUserId=0,this._initialConnection=!0,this._guideId=-1,this._requesterId=-1}onDispose(){super.onDispose(),this._connection=null,this._roomCreator=null,this._latestEntryTileEvent=null,this._planeParser&&(this._planeParser.dispose(),this._planeParser=null)}setConnection(e){this._connection||!e||(this._connection=e,this._connection.addMessageEvent(new ku(this.onUserInfoEvent.bind(this))),this._connection.addMessageEvent(new Pa(this.onRoomReadyMessageEvent.bind(this))),this._connection.addMessageEvent(new v_(this.onRoomPaintEvent.bind(this))),this._connection.addMessageEvent(new p_(this.onRoomModelEvent.bind(this))),this._connection.addMessageEvent(new T_(this.onRoomHeightMapEvent.bind(this))),this._connection.addMessageEvent(new R_(this.onRoomHeightMapUpdateEvent.bind(this))),this._connection.addMessageEvent(new O_(this.onRoomThicknessEvent.bind(this))),this._connection.addMessageEvent(new I_(this.onRoomDoorEvent.bind(this))),this._connection.addMessageEvent(new i_(this.onRoomRollingEvent.bind(this))),this._connection.addMessageEvent(new r_(this.onObjectsDataUpdateEvent.bind(this))),this._connection.addMessageEvent(new l_(this.onFurnitureAliasesEvent.bind(this))),this._connection.addMessageEvent(new a_(this.onFurnitureFloorAddEvent.bind(this))),this._connection.addMessageEvent(new o_(this.onFurnitureFloorEvent.bind(this))),this._connection.addMessageEvent(new h_(this.onFurnitureFloorRemoveEvent.bind(this))),this._connection.addMessageEvent(new u_(this.onFurnitureFloorUpdateEvent.bind(this))),this._connection.addMessageEvent(new f_(this.onFurnitureWallAddEvent.bind(this))),this._connection.addMessageEvent(new g_(this.onFurnitureWallEvent.bind(this))),this._connection.addMessageEvent(new E_(this.onFurnitureWallRemoveEvent.bind(this))),this._connection.addMessageEvent(new m_(this.onFurnitureWallUpdateEvent.bind(this))),this._connection.addMessageEvent(new c_(this.onFurnitureDataEvent.bind(this))),this._connection.addMessageEvent(new __(this.onItemDataUpdateMessageEvent.bind(this))),this._connection.addMessageEvent(new d_(this.onOneWayDoorStatusMessageEvent.bind(this))),this._connection.addMessageEvent(new xu(this.onRoomUnitDanceEvent.bind(this))),this._connection.addMessageEvent(new y_(this.onRoomUnitEffectEvent.bind(this))),this._connection.addMessageEvent(new Gu(this.onRoomUnitEvent.bind(this))),this._connection.addMessageEvent(new C_(this.onRoomUnitExpressionEvent.bind(this))),this._connection.addMessageEvent(new M_(this.onRoomUnitHandItemEvent.bind(this))),this._connection.addMessageEvent(new P_(this.onRoomUnitIdleEvent.bind(this))),this._connection.addMessageEvent(new Bu(this.onRoomUnitInfoEvent.bind(this))),this._connection.addMessageEvent(new N_(this.onRoomUnitNumberEvent.bind(this))),this._connection.addMessageEvent(new Hu(this.onRoomUnitRemoveEvent.bind(this))),this._connection.addMessageEvent(new b_(this.onRoomUnitStatusEvent.bind(this))),this._connection.addMessageEvent(new S_(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new Fu(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new wu(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new A_(this.onRoomUnitTypingEvent.bind(this))),this._connection.addMessageEvent(new Uu(this.onPetFigureUpdateEvent.bind(this))),this._connection.addMessageEvent(new IE(this.onPetExperienceEvent.bind(this))),this._connection.addMessageEvent(new vE(this.onYouArePlayingGameEvent.bind(this))),this._connection.addMessageEvent(new n_(this.onDiceValueMessageEvent.bind(this))),this._connection.addMessageEvent(new U_(this.onIgnoreResultEvent.bind(this))),this._connection.addMessageEvent(new Zg(this.onGuideSessionStartedMessageEvent.bind(this))),this._connection.addMessageEvent(new qg(this.onGuideSessionEndedMessageEvent.bind(this))),this._connection.addMessageEvent(new Qg(this.onGuideSessionErrorMessageEvent.bind(this))))}setRoomId(e){this._currentRoomId!==0&&this._roomCreator&&this._roomCreator.destroyRoom(this._currentRoomId),this._currentRoomId=e,this._latestEntryTileEvent=null}clearRoomId(){this._currentRoomId=0,this._latestEntryTileEvent=null}onUserInfoEvent(e){if(!(e instanceof ku)||!e.connection)return;const t=e.getParser();t&&(this._ownUserId=t.userInfo.userId)}onRoomReadyMessageEvent(e){const t=e.getParser();if(this._currentRoomId!==t.roomId&&this.setRoomId(t.roomId),this._roomCreator&&this._roomCreator.setRoomInstanceModelName(t.roomId,t.name),this._initialConnection){e.connection.send(new Um),this._initialConnection=!1;return}e.connection.send(new H_)}onRoomPaintEvent(e){if(!(e instanceof v_))return;const t=e.getParser();if(!t)return;const s=t.floorType,i=t.wallType,n=t.landscapeType;this._roomCreator&&this._roomCreator.updateRoomInstancePlaneType(this._currentRoomId,s,i,n)}onRoomModelEvent(e){if(!(e instanceof p_)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(!t)return;const s=this._roomCreator.getLegacyWallGeometry(this._currentRoomId);if(!s)return;this._planeParser.reset();const i=t.width,n=t.height;this._planeParser.initializeTileMap(i,n);let a=null;this._latestEntryTileEvent&&(a=this._latestEntryTileEvent.getParser());let o=-1,u=-1,l=0,d=0,c=0;for(;c<n;){let g=0;for(;g<i;){const I=t.getHeight(g,c);(c>0&&c<n-1||g>0&&g<i-1)&&I!=te.TILE_BLOCKED&&(a==null||g==a.x&&c==a.y)&&(t.getHeight(g,c-1)==te.TILE_BLOCKED&&t.getHeight(g-1,c)==te.TILE_BLOCKED&&t.getHeight(g,c+1)==te.TILE_BLOCKED&&(o=g+.5,u=c,l=I,d=90),t.getHeight(g,c-1)==te.TILE_BLOCKED&&t.getHeight(g-1,c)==te.TILE_BLOCKED&&t.getHeight(g+1,c)==te.TILE_BLOCKED&&(o=g,u=c+.5,l=I,d=180)),this._planeParser.setTileHeight(g,c,I),g++}c++}this._planeParser.setTileHeight(Math.floor(o),Math.floor(u),l),this._planeParser.initializeFromTileData(t.wallHeight),this._planeParser.setTileHeight(Math.floor(o),Math.floor(u),l+this._planeParser.wallHeight),t.scale===64?(this._planeParser.restrictsDragging=!0,this._planeParser.restrictsScaling=!0,this._planeParser.restrictedScale=.5):(this._planeParser.restrictsDragging=!1,this._planeParser.restrictsScaling=!1,this._planeParser.restrictedScale=1),s.scale=ps.DEFAULT_SCALE,s.initialize(i,n,this._planeParser.floorHeight);let _=t.height-1;for(;_>=0;){let g=t.width-1;for(;g>=0;)s.setHeight(g,_,this._planeParser.getTileHeight(g,_)),g--;_--}const f=this._planeParser.getMapData();f.doors.push({x:o,y:u,z:l,dir:d}),this._roomCreator.createRoomInstance(this._currentRoomId,f)}onRoomHeightMapEvent(e){if(!(e instanceof T_)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(!t)return;const s=t.width,i=t.height,n=new iY(s,i);let a=0;for(;a<i;){let o=0;for(;o<s;)n.setTileHeight(o,a,t.getTileHeight(o,a)),n.setStackingBlocked(o,a,t.getStackingBlocked(o,a)),n.setIsRoomTile(o,a,t.isRoomTile(o,a)),o++;a++}this._roomCreator.setFurnitureStackingHeightMap(this._currentRoomId,n)}onRoomHeightMapUpdateEvent(e){if(!(e instanceof R_)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(!t)return;const s=this._roomCreator.getFurnitureStackingHeightMap(this._currentRoomId);if(s){for(;t.next();)s.setTileHeight(t.x,t.y,t.tileHeight()),s.setStackingBlocked(t.x,t.y,t.isStackingBlocked()),s.setIsRoomTile(t.x,t.y,t.isRoomTile());this._roomCreator.refreshTileObjectMap(this._currentRoomId,"RoomMessageHandler.onRoomHeightMapUpdateEvent()")}}onRoomThicknessEvent(e){if(!(e instanceof O_))return;const t=e.getParser();if(!t)return;const s=!t.hideWalls,i=!0,n=t.thicknessWall,a=t.thicknessFloor;this._roomCreator&&(this._roomCreator.updateRoomInstancePlaneVisibility(this._currentRoomId,s,i),this._roomCreator.updateRoomInstancePlaneThickness(this._currentRoomId,n,a))}onRoomDoorEvent(e){e instanceof I_&&(this._latestEntryTileEvent=e)}onRoomRollingEvent(e){if(!(e instanceof i_)||!e.connection||!this._roomCreator)return;const t=e.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,t.rollerId,null,null,1,null),this._roomCreator.updateRoomObjectFloor(this._currentRoomId,t.rollerId,null,null,2,null);const s=t.itemsRolling;if(s&&s.length)for(const n of s)n&&this._roomCreator.rollRoomObjectFloor(this._currentRoomId,n.id,n.location,n.targetLocation);const i=t.unitRolling;if(i){this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,i.id,i.location,i.targetLocation);const n=this._roomCreator.getRoomObjectUser(this._currentRoomId,i.id);if(n&&n.type!==me.MONSTER_PLANT){let a="std";switch(i.movementType){case ti.MOVE:a="mv";break;case ti.SLIDE:a="std";break}this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,i.id,a)}}}onObjectsDataUpdateEvent(e){if(!(e instanceof r_)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(t)for(const s of t.objects)this._roomCreator.updateRoomObjectFloor(this._currentRoomId,s.id,null,null,s.state,s.data)}onFurnitureAliasesEvent(e){!(e instanceof l_)||!e.connection||!this._roomCreator||(e.getParser().aliases,this._connection.send(new H_))}onFurnitureFloorAddEvent(e){if(!(e instanceof a_)||!e.connection||!this._roomCreator)return;const t=e.getParser().item;t&&this.addRoomObjectFurnitureFloor(this._currentRoomId,t)}onFurnitureFloorEvent(e){if(!(e instanceof o_)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(!t)return;const s=t.items.length;let i=0;for(;i<s;){const n=t.items[i];n&&this.addRoomObjectFurnitureFloor(this._currentRoomId,n),i++}}onFurnitureFloorRemoveEvent(e){if(!(e instanceof h_)||!e.connection||!this._roomCreator)return;const t=e.getParser();t&&(t.delay>0?setTimeout(()=>{this._roomCreator.removeRoomObjectFloor(this._currentRoomId,t.itemId,t.isExpired?-1:t.userId,!0)},t.delay):this._roomCreator.removeRoomObjectFloor(this._currentRoomId,t.itemId,t.isExpired?-1:t.userId,!0))}onFurnitureFloorUpdateEvent(e){if(!(e instanceof u_)||!e.connection||!this._roomCreator)return;const t=e.getParser().item;if(!t)return;const s=new y(t.x,t.y,t.z),i=new y(t.direction);this._roomCreator.updateRoomObjectFloor(this._currentRoomId,t.itemId,s,i,t.data.state,t.data,t.extra),this._roomCreator.updateRoomObjectFloorHeight(this._currentRoomId,t.itemId,t.stackHeight),this._roomCreator.updateRoomObjectFloorExpiration(this._currentRoomId,t.itemId,t.expires)}onFurnitureWallAddEvent(e){if(!(e instanceof f_)||!e.connection||!this._roomCreator)return;const t=e.getParser().item;t&&this.addRoomObjectFurnitureWall(this._currentRoomId,t)}onFurnitureWallEvent(e){if(!(e instanceof g_)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(!t)return;const s=t.items.length;let i=0;for(;i<s;){const n=t.items[i];n&&this.addRoomObjectFurnitureWall(this._currentRoomId,n),i++}}onFurnitureWallRemoveEvent(e){if(!(e instanceof E_)||!e.connection||!this._roomCreator)return;const t=e.getParser();t&&this._roomCreator.removeRoomObjectWall(this._currentRoomId,t.itemId,t.userId)}onFurnitureWallUpdateEvent(e){if(!(e instanceof m_)||!e.connection||!this._roomCreator)return;const t=this._roomCreator.getLegacyWallGeometry(this._currentRoomId);if(!t)return;const s=e.getParser().item;if(!s)return;const i=t.getLocation(s.width,s.height,s.localX,s.localY,s.direction),n=new y(t.getDirection(s.direction));this._roomCreator.updateRoomObjectWall(this._currentRoomId,s.itemId,i,n,s.state,s.stuffData),this._roomCreator.updateRoomObjectWallExpiration(this._currentRoomId,s.itemId,s.secondsToExpiration)}onFurnitureDataEvent(e){if(!(e instanceof c_)||!e.connection||!this._roomCreator)return;const t=e.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,t.furnitureId,null,null,t.objectData.state,t.objectData)}onItemDataUpdateMessageEvent(e){if(!(e instanceof __)||!e.connection||!this._roomCreator)return;const t=e.getParser();this._roomCreator.updateRoomObjectWallItemData(this._currentRoomId,t.furnitureId,t.data)}onOneWayDoorStatusMessageEvent(e){if(!(e instanceof d_)||!e.connection||!this._roomCreator)return;const t=e.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,t.itemId,null,null,t.state,new ns)}onDiceValueMessageEvent(e){if(!(e instanceof n_)||!e.connection||!this._roomCreator)return;const t=e.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,t.itemId,null,null,t.value,new ns)}onRoomUnitDanceEvent(e){!(e instanceof xu)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.getParser().unitId,T.FIGURE_DANCE,e.getParser().danceId)}onRoomUnitEffectEvent(e){!(e instanceof y_)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserEffect(this._currentRoomId,e.getParser().unitId,e.getParser().effectId,e.getParser().delay)}onRoomUnitEvent(e){if(!(e instanceof Gu)||!e.connection||!this._roomCreator)return;const t=e.getParser().users;if(!(!t||!t.length)){for(const s of t){if(!s)continue;const i=new y(s.x,s.y,s.z),n=new y(s.dir);this._roomCreator.addRoomObjectUser(this._currentRoomId,s.roomIndex,i,n,s.dir,s.userType,s.figure),s.webID===this._ownUserId&&(this._roomCreator.setRoomSessionOwnUser(this._currentRoomId,s.roomIndex),this._roomCreator.updateRoomObjectUserOwn(this._currentRoomId,s.roomIndex)),this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,s.roomIndex,s.figure,s.sex,s.subType,s.isRiding),me.getTypeString(s.userType)===me.PET&&this._roomCreator.getPetTypeId(s.figure)===be.MONSTERPLANT&&this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,s.roomIndex,s.petPosture),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,s.roomIndex,T.FIGURE_IS_MUTED,this._roomCreator.sessionDataManager.isUserIgnored(s.name)?1:0)}this.updateGuideMarker()}}onRoomUnitExpressionEvent(e){!(e instanceof C_)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.getParser().unitId,T.FIGURE_EXPRESSION,e.getParser().expression)}onRoomUnitHandItemEvent(e){!(e instanceof M_)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.getParser().unitId,T.FIGURE_CARRY_OBJECT,e.getParser().handId)}onRoomUnitIdleEvent(e){!(e instanceof P_)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.getParser().unitId,T.FIGURE_SLEEP,e.getParser().isIdle?1:0)}onRoomUnitInfoEvent(e){!(e instanceof Bu)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,e.getParser().unitId,e.getParser().figure,e.getParser().gender)}onRoomUnitNumberEvent(e){if(!(e instanceof N_)||!e.connection||!this._roomCreator)return;const t=e.getParser();t&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.unitId,T.FIGURE_NUMBER_VALUE,t.value)}onRoomUnitRemoveEvent(e){!(e instanceof Hu)||!e.connection||!this._roomCreator||(this._roomCreator.removeRoomObjectUser(this._currentRoomId,e.getParser().unitId),this.updateGuideMarker())}onRoomUnitStatusEvent(e){if(!(e instanceof b_)||!e.connection||!this._roomCreator)return;const t=e.getParser().statuses;if(!t||!t.length)return;const s=this._roomCreator.getRoomInstance(this._currentRoomId);if(!s)return;const i=s.model.getValue(ze.ROOM_Z_SCALE)||1;for(const n of t){if(!n)continue;let a=n.height;a&&(a=a/i);const o=new y(n.x,n.y,n.z+a),u=new y(n.direction);let l=null;n.didMove&&(l=new y(n.targetX,n.targetY,n.targetZ)),this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,n.id,o,l,n.canStandUp,a,u,n.headDirection),this._roomCreator.updateRoomObjectUserFlatControl(this._currentRoomId,n.id,null);let d=!0,c=!1,_=T.STD,f="";if(n.actions&&n.actions.length){for(const g of n.actions)if(g)switch(g.action){case"flatctrl":this._roomCreator.updateRoomObjectUserFlatControl(this._currentRoomId,n.id,g.value);break;case"sign":n.actions.length===1&&(d=!1),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,n.id,T.FIGURE_SIGN,parseInt(g.value));break;case"gst":n.actions.length===1&&(d=!1),this._roomCreator.updateRoomObjectUserPetGesture(this._currentRoomId,n.id,g.value);break;case"wav":case"mv":c=!0,_=g.action,f=g.value;break;case"trd":break;default:c=!0,_=g.action,f=g.value;break}}c?this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,n.id,_,f):d&&this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,n.id,T.STD,"")}this.updateGuideMarker()}onRoomUnitChatEvent(e){if(!e.connection||!this._roomCreator)return;const t=e.getParser();t&&(this._roomCreator.updateRoomObjectUserGesture(this._currentRoomId,t.roomIndex,t.gesture),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.roomIndex,T.FIGURE_TALK,t.message.length/10))}onRoomUnitTypingEvent(e){!(e instanceof A_)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.getParser().unitId,T.FIGURE_IS_TYPING,e.getParser().isTyping?1:0)}onPetFigureUpdateEvent(e){if(!(e instanceof Uu)||!e.connection||!this._roomCreator)return;const t=e.getParser();t&&this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,t.roomIndex,t.figureData.figuredata,"","",t.isRiding)}onPetExperienceEvent(e){const t=e.getParser();t&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.roomIndex,T.FIGURE_GAINED_EXPERIENCE,t.gainedExperience)}onYouArePlayingGameEvent(e){if(!e)return;const t=e.getParser();t&&this._roomCreator.setRoomEngineGameMode(this._currentRoomId,t.isPlaying)}addRoomObjectFurnitureFloor(e,t){if(!t||!this._roomCreator)return;const s=new y(t.x,t.y,t.z),i=new y(t.direction);t.spriteName?this._roomCreator.addFurnitureFloorByTypeName(e,t.itemId,t.spriteName,s,i,t.state,t.data,t.extra,t.expires,t.usagePolicy,t.userId,t.username,!0,!0,t.stackHeight):this._roomCreator.addFurnitureFloor(e,t.itemId,t.spriteId,s,i,t.state,t.data,t.extra,t.expires,t.usagePolicy,t.userId,t.username,!0,!0,t.stackHeight)}addRoomObjectFurnitureWall(e,t){if(!t||!this._roomCreator)return;const s=this._roomCreator.getLegacyWallGeometry(e);if(!s)return;let i=null;t.isOldFormat||(i=s.getLocation(t.width,t.height,t.localX,t.localY,t.direction));const n=new y(s.getDirection(t.direction));this._roomCreator.addFurnitureWall(e,t.itemId,t.spriteId,i,n,t.state,t.stuffData,t.secondsToExpiration,t.usagePolicy,t.userId,t.username)}onIgnoreResultEvent(e){if(!e)return;const t=e.getParser();if(!t)return;const s=this._roomCreator.roomSessionManager.getSession(this._currentRoomId);if(!s)return;const i=s.userDataManager.getUserDataByName(t.name);if(i)switch(t.result){case 1:case 2:this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,T.FIGURE_IS_MUTED,1);return;case 3:this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,T.FIGURE_IS_MUTED,0);return}}onGuideSessionStartedMessageEvent(e){const t=e.getParser();this._guideId=t.guideUserId,this._requesterId=t.requesterUserId,this.updateGuideMarker()}onGuideSessionEndedMessageEvent(e){this.removeGuideMarker()}onGuideSessionErrorMessageEvent(e){this.removeGuideMarker()}updateGuideMarker(){const e=this._roomCreator.sessionDataManager.userId;this.setUserGuideStatus(this._guideId,this._requesterId===e?ar.GUIDE:ar.NONE),this.setUserGuideStatus(this._requesterId,this._guideId===e?ar.REQUESTER:ar.NONE)}removeGuideMarker(){this.setUserGuideStatus(this._guideId,ar.NONE),this.setUserGuideStatus(this._requesterId,ar.NONE),this._guideId=-1,this._requesterId=-1}setUserGuideStatus(e,t){if(!this._roomCreator||!this._roomCreator.roomSessionManager)return;const s=this._roomCreator.roomSessionManager.getSession(this._currentRoomId);if(!s)return;const i=s.userDataManager.getDataByType(e,hr.USER);i&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,T.FIGURE_GUIDE_STATUS,t)}get currentRoomId(){return this._currentRoomId}}class uY extends Ss{constructor(e){super(),this._roomEngine=e,this._eventIds=new Map,this._selectedAvatarId=-1,this._selectedObjectId=-1,this._selectedObjectCategory=-2,this._whereYouClickIsWhereYouGo=!0,this._objectPlacementSource=null,this.onRoomEngineObjectEvent=this.onRoomEngineObjectEvent.bind(this),this._roomEngine.events.addEventListener(ee.ADDED,this.onRoomEngineObjectEvent)}dispose(){this._eventIds&&(this._eventIds=null),this._roomEngine.events.removeEventListener(ee.ADDED,this.onRoomEngineObjectEvent),this._roomEngine=null}onRoomEngineObjectEvent(e){let t=this.getSelectedRoomObjectData(e.roomId);if(t&&t.operation===_e.OBJECT_PLACE&&t.id===e.objectId){const s=this._roomEngine.getRoomObject(e.roomId,t.id,t.category);if(s&&s.model&&t.category===U.FLOOR){const i=s.model.getValue(T.FURNITURE_ALLOWED_DIRECTIONS);if(i&&i.length){const n=new y(i[0]);if(s.setDirection(n),this.updateSelectedObjectData(e.roomId,t.id,t.category,t.loc,n,t.operation,t.typeId,t.instanceData,t.stuffData,t.state,t.animFrame,t.posture),t=this.getSelectedRoomObjectData(e.roomId),!t)return}}this.setFurnitureAlphaMultiplier(s,.5)}}processRoomCanvasMouseEvent(e,t,s){if(!e||!t||ne.isRunning())return;const i=t.type;let n=this._roomEngine.getRoomObjectCategoryForType(i);if(n!==U.ROOM&&(!this._roomEngine.isPlayingGame()||n!==U.UNIT)&&(n=U.MINIMUM),this.getMouseEventId(n,e.type)===e.eventId){if(e.type===W.MOUSE_CLICK||e.type===W.DOUBLE_CLICK||e.type===W.MOUSE_DOWN||e.type===W.MOUSE_UP||e.type===W.MOUSE_MOVE)return}else e.eventId&&this.setMouseEventId(n,e.type,e.eventId);t.mouseHandler&&t.mouseHandler.mouseEvent(e,s)}processRoomObjectPlacement(e,t,s,i,n,a=null,o=null,u=-1,l=-1,d=null){this._objectPlacementSource=e;const c=new y(-100,-100),_=new y(0);return this.setSelectedRoomObjectData(t,s,i,c,_,_e.OBJECT_PLACE,n,a,o,u,l,d),this._roomEngine&&(this._roomEngine.setObjectMoverIconSprite(n,i,!1,a,o,u,l,d),this._roomEngine.setObjectMoverIconSpriteVisible(!1)),!0}cancelRoomObjectInsert(e){return this.resetSelectedObjectData(e),!0}getMouseEventId(e,t){const s=this._eventIds.get(e);return s&&s.get(t)||null}setMouseEventId(e,t,s){let i=this._eventIds.get(e);i||(i=new Map,this._eventIds.set(e,i)),i.delete(t),i.set(t,s)}handleRoomObjectEvent(e,t){if(e){if(e instanceof re){this.handleRoomObjectMouseEvent(e,t);return}switch(e.type){case Me.STATE_CHANGE:case Me.STATE_RANDOM:this.onRoomObjectStateChangedEvent(e,t);return;case Bi.DIMMER_STATE:this.onRoomObjectDimmerStateUpdateEvent(e,t);return;case hs.POSITION_CHANGED:case hs.OBJECT_REMOVED:this.handleSelectedObjectRemove(e,t);return;case P.OPEN_WIDGET:case P.CLOSE_WIDGET:case P.OPEN_FURNI_CONTEXT_MENU:case P.CLOSE_FURNI_CONTEXT_MENU:case P.PLACEHOLDER:case P.CREDITFURNI:case P.STACK_HEIGHT:case P.EXTERNAL_IMAGE:case P.STICKIE:case P.PRESENT:case P.TROPHY:case P.TEASER:case P.ECOTRONBOX:case P.DIMMER:case P.WIDGET_REMOVE_DIMMER:case P.CLOTHING_CHANGE:case P.JUKEBOX_PLAYLIST_EDITOR:case P.MANNEQUIN:case P.PET_PRODUCT_MENU:case P.GUILD_FURNI_CONTEXT_MENU:case P.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:case P.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:case P.BACKGROUND_COLOR:case P.MYSTERYBOX_OPEN_DIALOG:case P.EFFECTBOX_OPEN_DIALOG:case P.MYSTERYTROPHY_OPEN_DIALOG:case P.ACHIEVEMENT_RESOLUTION_OPEN:case P.ACHIEVEMENT_RESOLUTION_ENGRAVING:case P.ACHIEVEMENT_RESOLUTION_FAILED:case P.FRIEND_FURNITURE_CONFIRM:case P.FRIEND_FURNITURE_ENGRAVING:case P.BADGE_DISPLAY_ENGRAVING:case P.HIGH_SCORE_DISPLAY:case P.HIDE_HIGH_SCORE_DISPLAY:case P.INERNAL_LINK:case P.ROOM_LINK:case P.YOUTUBE:this.onRoomObjectWidgetRequestEvent(e,t);return;case B.DICE_ACTIVATE:case B.DICE_OFF:case B.USE_HABBOWHEEL:case B.STICKIE:case B.ENTER_ONEWAYDOOR:this.onRoomObjectFurnitureActionEvent(e,t);return;case B.SOUND_MACHINE_INIT:case B.SOUND_MACHINE_START:case B.SOUND_MACHINE_STOP:case B.SOUND_MACHINE_DISPOSE:this.handleObjectSoundMachineEvent(e,t);return;case B.JUKEBOX_INIT:case B.JUKEBOX_START:case B.JUKEBOX_MACHINE_STOP:case B.JUKEBOX_DISPOSE:this.handleObjectJukeboxEvent(e,t);return;case os.ADD_HOLE:case os.REMOVE_HOLE:this.onRoomObjectFloorHoleEvent(e,t);return;case We.ROOM_AD_FURNI_CLICK:case We.ROOM_AD_FURNI_DOUBLE_CLICK:case We.ROOM_AD_TOOLTIP_SHOW:case We.ROOM_AD_TOOLTIP_HIDE:case We.ROOM_AD_LOAD_IMAGE:this.onRoomObjectRoomAdEvent(e,t);return;case br.LOAD_BADGE:this.onRoomObjectBadgeAssetEvent(e,t);return;case B.MOUSE_ARROW:case B.MOUSE_BUTTON:this.handleMousePointer(e,t);return;case ri.PLAY_SOUND:case ri.PLAY_SOUND_AT_PITCH:this.handleRoomObjectPlaySoundEvent(e,t);return;case ut.ROOM_OBJECT_INITIALIZED:case ut.ROOM_OBJECT_DISPOSED:case ut.PLAY_SAMPLE:case ut.CHANGE_PITCH:this.handleRoomObjectSamplePlaybackEvent(e,t);return;case Hi.ROOM_BACKGROUND_COLOR:this.onHSLColorEnableEvent(e,t);return;case Qs.RODRE_CURRENT_USER_ID:case Qs.RODRE_URL_PREFIX:this.onRoomObjectDataRequestEvent(e,t);return;default:Y.warn("Unhandled Event",e.constructor.name,"Object ID",e.object.id);return}}}handleRoomObjectMouseEvent(e,t){if(!(!e||!e.type))switch(e.type){case re.CLICK:this.handleRoomObjectMouseClickEvent(e,t);return;case re.DOUBLE_CLICK:this.handleRoomObjectMouseDoubleClickEvent(e,t);return;case re.MOUSE_MOVE:this.handleRoomObjectMouseMoveEvent(e,t);return;case re.MOUSE_DOWN:this.handleRoomObjectMouseDownEvent(e,t);return;case re.MOUSE_DOWN_LONG:this.handleRoomObjectMouseDownLongEvent(e,t);return;case re.MOUSE_ENTER:this.handleRoomObjectMouseEnterEvent(e,t);return;case re.MOUSE_LEAVE:this.handleRoomObjectMouseLeaveEvent(e,t);return}}handleRoomObjectMouseClickEvent(e,t){if(!e)return;let s=_e.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(t);i&&(s=i.operation);let n=!1,a=!1;this._whereYouClickIsWhereYouGo&&(!s||s===_e.OBJECT_UNDEFINED)&&(n=this.handleMoveTargetFurni(t,e));const o=this._roomEngine.getRoomObjectCategoryForType(e.objectType);switch(s){case _e.OBJECT_MOVE:o===U.ROOM?i&&this.modifyRoomObject(t,i.id,i.category,_e.OBJECT_MOVE_TO):o===U.UNIT&&(i&&e.objectType===me.MONSTER_PLANT&&this.modifyRoomObject(t,i.id,i.category,_e.OBJECT_MOVE_TO),e.eventId&&this.setMouseEventId(U.ROOM,W.MOUSE_CLICK,e.eventId),this.placeObjectOnUser(t,e.objectId,o)),a=!0,e.objectId!==-1&&this.setSelectedObject(t,e.objectId,o);break;case _e.OBJECT_PLACE:if(o===U.ROOM)this.placeObject(t,e instanceof ii,e instanceof ma);else if(o===U.UNIT)switch(e.objectType){case me.MONSTER_PLANT:case me.RENTABLE_BOT:this.placeObject(t,e instanceof ii,e instanceof ma);break;default:e.eventId&&this.setMouseEventId(U.ROOM,W.MOUSE_CLICK,e.eventId),this.placeObjectOnUser(t,e.objectId,o);break}break;case _e.OBJECT_UNDEFINED:o===U.ROOM?!n&&e instanceof ii&&this.onRoomObjectTileMouseEvent(t,e):(this.setSelectedObject(t,e.objectId,o),a=!1,o===U.UNIT?(e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.objectType===me.RENTABLE_BOT?this.modifyRoomObject(t,e.objectId,o,_e.OBJECT_PICKUP_BOT):e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.objectType===me.MONSTER_PLANT?this.modifyRoomObject(t,e.objectId,o,_e.OBJECT_PICKUP_PET):!e.ctrlKey&&!e.altKey&&e.shiftKey&&e.objectType===me.MONSTER_PLANT&&this.modifyRoomObject(t,e.objectId,o,_e.OBJECT_ROTATE_POSITIVE),this._roomEngine.isPlayingGame()?a=!0:n=!0):(o===U.FLOOR||o===U.WALL)&&(e.altKey||e.ctrlKey||e.shiftKey)&&(!e.ctrlKey&&!e.altKey&&e.shiftKey?o===U.FLOOR&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ee(ee.REQUEST_ROTATE,t,e.objectId,o)):e.ctrlKey&&!e.altKey&&!e.shiftKey&&this.modifyRoomObject(t,e.objectId,o,_e.OBJECT_PICKUP),this._roomEngine.isPlayingGame()?a=!0:n=!0),e.eventId&&(n&&this.setMouseEventId(U.ROOM,W.MOUSE_CLICK,e.eventId),a&&this.setMouseEventId(U.MINIMUM,W.MOUSE_CLICK,e.eventId)));break}if(o===U.ROOM){const u=this.getMouseEventId(U.MINIMUM,W.MOUSE_CLICK),l=this.getMouseEventId(U.UNIT,W.MOUSE_CLICK);u!==e.eventId&&l!==e.eventId&&!a&&(this.deselectObject(t),this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ee(ee.DESELECTED,t,-1,U.MINIMUM)),this.setSelectedAvatar(t,0,!1))}}handleRoomObjectMouseDoubleClickEvent(e,t){const s=e.objectId,i=e.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i);this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ee(ee.DOUBLE_CLICK,t,s,n))}handleRoomObjectMouseMoveEvent(e,t){if(!e)return;let s=_e.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(t);i&&(s=i.operation);const n=this._roomEngine.getRoomObjectCategoryForType(e.objectType);if(this._roomEngine){const a=this._roomEngine.getRoomObjectCursor(t);if(a&&a.logic){let o=null;e instanceof ii?o=this.handleMouseOverTile(e,t):e.object&&e.object.id!==-1?this._whereYouClickIsWhereYouGo&&(o=this.handleMouseOverObject(n,t,e)):o=new ba(null,0,!1,e.eventId),a.processUpdateMessage(o)}}switch(s){case _e.OBJECT_MOVE:n===U.ROOM&&this.handleObjectMove(e,t);return;case _e.OBJECT_PLACE:n===U.ROOM&&this.handleObjectPlace(e,t);return}}handleRoomObjectMouseDownEvent(e,t){if(!e)return;let s=_e.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(t);i&&(s=i.operation);const n=this._roomEngine.getRoomObjectCategoryForType(e.objectType);switch(s){case _e.OBJECT_UNDEFINED:(n===U.FLOOR||n===U.WALL||e.objectType===me.MONSTER_PLANT)&&(e.altKey&&!e.ctrlKey&&!e.shiftKey||this.decorateModeMove(e))&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ee(ee.REQUEST_MOVE,t,e.objectId,n));return}}handleRoomObjectMouseDownLongEvent(e,t){if(!e)return;let s=_e.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(t);i&&(s=i.operation);const n=this._roomEngine.getRoomObjectCategoryForType(e.objectType);switch(s){case _e.OBJECT_UNDEFINED:(n===U.FLOOR||n===U.WALL||e.objectType===me.MONSTER_PLANT)&&(!e.ctrlKey&&!e.shiftKey||this.decorateModeMove(e))&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ee(ee.REQUEST_MANIPULATION,t,e.objectId,n));return}}handleRoomObjectMouseEnterEvent(e,t){const s=e.objectId,i=e.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i);this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ee(ee.MOUSE_ENTER,t,s,n))}handleRoomObjectMouseLeaveEvent(e,t){const s=e.objectId,i=e.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i);if(n!==U.ROOM&&n===U.UNIT){const a=this._roomEngine.getRoomObjectCursor(t);a&&a.processUpdateMessage(new Ve(0,null))}this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ee(ee.MOUSE_LEAVE,t,s,n))}onRoomObjectStateChangedEvent(e,t){if(e)switch(e.type){case Me.STATE_CHANGE:this.changeObjectState(t,e.object.id,e.object.type,e.state,!1);return;case Me.STATE_RANDOM:this.changeObjectState(t,e.object.id,e.object.type,e.state,!0);return}}onRoomObjectDimmerStateUpdateEvent(e,t){if(e)switch(e.type){case Bi.DIMMER_STATE:this._roomEngine.events.dispatchEvent(new Qh(t,e.state,e.presetId,e.effectId,e.color,e.brightness));return}}handleSelectedObjectRemove(e,t){if(!(!e||!this._roomEngine))switch(e.type){case hs.POSITION_CHANGED:{const s=e.objectId,i=e.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i),a=this._roomEngine.getRoomObject(t,s,n),o=this._roomEngine.getRoomObjectSelectionArrow(t);if(a&&o&&o.logic){const u=a.getLocation();o.logic.processUpdateMessage(new St(u,null))}return}case hs.OBJECT_REMOVED:this.setSelectedAvatar(t,0,!1);return}}onRoomObjectWidgetRequestEvent(e,t){if(!e||!this._roomEngine)return;const s=e.objectId,i=e.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i),a=this._roomEngine.events;if(a&&!Oa.isRoomPreviewerId(t))switch(e.type){case P.OPEN_WIDGET:a.dispatchEvent(new H(H.OPEN_WIDGET,t,s,n,e.object.logic.widget));return;case P.CLOSE_WIDGET:a.dispatchEvent(new H(H.CLOSE_WIDGET,t,s,n,e.object.logic.widget));return;case P.OPEN_FURNI_CONTEXT_MENU:a.dispatchEvent(new H(H.OPEN_FURNI_CONTEXT_MENU,t,s,n,e.object.logic.contextMenu));return;case P.CLOSE_FURNI_CONTEXT_MENU:a.dispatchEvent(new H(H.CLOSE_FURNI_CONTEXT_MENU,t,s,n));return;case P.PLACEHOLDER:a.dispatchEvent(new H(H.REQUEST_PLACEHOLDER,t,s,n));return;case P.CREDITFURNI:a.dispatchEvent(new H(H.REQUEST_CREDITFURNI,t,s,n));return;case P.STACK_HEIGHT:a.dispatchEvent(new H(H.REQUEST_STACK_HEIGHT,t,s,n));return;case P.EXTERNAL_IMAGE:a.dispatchEvent(new H(H.REQUEST_EXTERNAL_IMAGE,t,s,n));return;case P.STICKIE:a.dispatchEvent(new H(H.REQUEST_STICKIE,t,s,n));return;case P.PRESENT:a.dispatchEvent(new H(H.REQUEST_PRESENT,t,s,n));return;case P.TROPHY:a.dispatchEvent(new H(H.REQUEST_TROPHY,t,s,n));return;case P.TEASER:a.dispatchEvent(new H(H.REQUEST_TEASER,t,s,n));return;case P.ECOTRONBOX:a.dispatchEvent(new H(H.REQUEST_ECOTRONBOX,t,s,n));return;case P.DIMMER:a.dispatchEvent(new H(H.REQUEST_DIMMER,t,s,n));return;case P.WIDGET_REMOVE_DIMMER:a.dispatchEvent(new H(H.REMOVE_DIMMER,t,s,n));return;case P.CLOTHING_CHANGE:a.dispatchEvent(new H(H.REQUEST_CLOTHING_CHANGE,t,s,n));return;case P.JUKEBOX_PLAYLIST_EDITOR:a.dispatchEvent(new H(H.REQUEST_PLAYLIST_EDITOR,t,s,n));return;case P.MANNEQUIN:a.dispatchEvent(new H(H.REQUEST_MANNEQUIN,t,s,n));return;case P.PET_PRODUCT_MENU:a.dispatchEvent(new Zh(Zh.USE_PRODUCT_FROM_ROOM,t,s,n));return;case P.GUILD_FURNI_CONTEXT_MENU:this._roomEngine.connection.send(new Fm(e.objectId,e.object.model.getValue(T.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID)));return;case P.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:a.dispatchEvent(new H(H.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,t,s,n));return;case P.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:a.dispatchEvent(new H(H.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,t,s,n));return;case P.BACKGROUND_COLOR:a.dispatchEvent(new H(H.REQUEST_BACKGROUND_COLOR,t,s,n));return;case P.MYSTERYBOX_OPEN_DIALOG:a.dispatchEvent(new H(H.REQUEST_MYSTERYBOX_OPEN_DIALOG,t,s,n));return;case P.EFFECTBOX_OPEN_DIALOG:a.dispatchEvent(new H(H.REQUEST_EFFECTBOX_OPEN_DIALOG,t,s,n));return;case P.MYSTERYTROPHY_OPEN_DIALOG:a.dispatchEvent(new H(H.REQUEST_MYSTERYTROPHY_OPEN_DIALOG,t,s,n));return;case P.ACHIEVEMENT_RESOLUTION_OPEN:this._roomEngine.connection.send(new YE(e.objectId,0));return;case P.ACHIEVEMENT_RESOLUTION_ENGRAVING:a.dispatchEvent(new H(H.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING,t,s,n));return;case P.ACHIEVEMENT_RESOLUTION_FAILED:a.dispatchEvent(new H(H.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED,t,s,n));return;case P.FRIEND_FURNITURE_CONFIRM:a.dispatchEvent(new H(H.REQUEST_FRIEND_FURNITURE_CONFIRM,t,s,n));return;case P.FRIEND_FURNITURE_ENGRAVING:a.dispatchEvent(new H(H.REQUEST_FRIEND_FURNITURE_ENGRAVING,t,s,n));return;case P.BADGE_DISPLAY_ENGRAVING:a.dispatchEvent(new H(H.REQUEST_BADGE_DISPLAY_ENGRAVING,t,s,n));return;case P.HIGH_SCORE_DISPLAY:a.dispatchEvent(new H(H.REQUEST_HIGH_SCORE_DISPLAY,t,s,n));return;case P.HIDE_HIGH_SCORE_DISPLAY:a.dispatchEvent(new H(H.REQUEST_HIDE_HIGH_SCORE_DISPLAY,t,s,n));return;case P.INERNAL_LINK:a.dispatchEvent(new H(H.REQUEST_INTERNAL_LINK,t,s,n));return;case P.ROOM_LINK:a.dispatchEvent(new H(H.REQUEST_ROOM_LINK,t,s,n));return;case P.YOUTUBE:a.dispatchEvent(new H(H.REQUEST_YOUTUBE,t,s,n));return}}onRoomObjectFurnitureActionEvent(e,t){e&&this.useObject(t,e.object.id,e.object.type,e.type)}handleObjectSoundMachineEvent(e,t){if(!e)return;const s=this._roomEngine.getRoomObjectCategoryForType(e.objectType),i=this.getSelectedRoomObjectData(t);if(!(i&&i.category===s&&i.id===e.objectId&&i.operation===_e.OBJECT_PLACE))switch(e.type){case B.SOUND_MACHINE_INIT:this._roomEngine.events.dispatchEvent(new ke(ke.SOUND_MACHINE_INIT,t,e.objectId,s));return;case B.SOUND_MACHINE_START:this._roomEngine.events.dispatchEvent(new ke(ke.SOUND_MACHINE_SWITCHED_ON,t,e.objectId,s));return;case B.SOUND_MACHINE_STOP:this._roomEngine.events.dispatchEvent(new ke(ke.SOUND_MACHINE_SWITCHED_OFF,t,e.objectId,s));return;case B.SOUND_MACHINE_DISPOSE:this._roomEngine.events.dispatchEvent(new ke(ke.SOUND_MACHINE_DISPOSE,t,e.objectId,s));return}}handleObjectJukeboxEvent(e,t){if(!e)return;const s=this._roomEngine.getRoomObjectCategoryForType(e.objectType),i=this.getSelectedRoomObjectData(t);if(!(i&&i.category===s&&i.id===e.objectId&&i.operation===_e.OBJECT_PLACE))switch(e.type){case B.JUKEBOX_INIT:this._roomEngine.events.dispatchEvent(new ke(ke.JUKEBOX_INIT,t,e.objectId,s));return;case B.JUKEBOX_START:this._roomEngine.events.dispatchEvent(new ke(ke.JUKEBOX_SWITCHED_ON,t,e.objectId,s));return;case B.JUKEBOX_MACHINE_STOP:this._roomEngine.events.dispatchEvent(new ke(ke.JUKEBOX_SWITCHED_OFF,t,e.objectId,s));return;case B.JUKEBOX_DISPOSE:this._roomEngine.events.dispatchEvent(new ke(ke.JUKEBOX_DISPOSE,t,e.objectId,s));return}}onRoomObjectFloorHoleEvent(e,t){if(e)switch(e.type){case os.ADD_HOLE:this._roomEngine.addRoomInstanceFloorHole(t,e.objectId);return;case os.REMOVE_HOLE:this._roomEngine.removeRoomInstanceFloorHole(t,e.objectId);return}}onRoomObjectRoomAdEvent(e,t){if(!e)return;let s=null;switch(e.type){case We.ROOM_AD_FURNI_CLICK:this._roomEngine.events.dispatchEvent(e),e.clickUrl&&e.clickUrl.length>0&&X.instance.createLinkEvent(e.clickUrl),s=Gi.FURNI_CLICK;break;case We.ROOM_AD_FURNI_DOUBLE_CLICK:if(e.clickUrl&&e.clickUrl.length>0){const i="CATALOG_PAGE";e.clickUrl.indexOf(i)===0&&X.instance.createLinkEvent(e.clickUrl.substr(i.length))}s=Gi.FURNI_DOUBLE_CLICK;break;case We.ROOM_AD_TOOLTIP_SHOW:s=Gi.TOOLTIP_SHOW;break;case We.ROOM_AD_TOOLTIP_HIDE:s=Gi.TOOLTIP_HIDE;break}s&&this._roomEngine.events.dispatchEvent(new ee(s,t,e.objectId,this._roomEngine.getRoomObjectCategoryForType(e.objectType)))}onRoomObjectBadgeAssetEvent(e,t){if(!(!e||!this._roomEngine))switch(e.type){case br.LOAD_BADGE:{const s=e.objectId,i=e.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i);this._roomEngine.loadRoomObjectBadgeImage(t,s,n,e.badgeId,e.groupBadge);return}}}handleMousePointer(e,t){e&&this._roomEngine.updateMousePointer(e.type,e.objectId,e.objectType)}handleRoomObjectPlaySoundEvent(e,t){const s=this._roomEngine.getRoomObjectCategoryForType(e.objectType);switch(e.type){case ri.PLAY_SOUND:this._roomEngine.events.dispatchEvent(new Ea(Ea.PLAY_SOUND,t,e.objectId,s,e.soundId,e.pitch));return;case ri.PLAY_SOUND_AT_PITCH:this._roomEngine.events.dispatchEvent(new Ea(Ea.PLAY_SOUND_AT_PITCH,t,e.objectId,s,e.soundId,e.pitch));return}}handleRoomObjectSamplePlaybackEvent(e,t){if(!e)return;const s=this._roomEngine.getRoomObjectCategoryForType(e.objectType);switch(e.type){case ut.ROOM_OBJECT_INITIALIZED:this._roomEngine.events.dispatchEvent(new _s(_s.ROOM_OBJECT_INITIALIZED,t,e.objectId,s,e.sampleId,e.pitch));break;case ut.ROOM_OBJECT_DISPOSED:this._roomEngine.events.dispatchEvent(new _s(_s.ROOM_OBJECT_DISPOSED,t,e.objectId,s,e.sampleId,e.pitch));break;case ut.PLAY_SAMPLE:this._roomEngine.events.dispatchEvent(new _s(_s.PLAY_SAMPLE,t,e.objectId,s,e.sampleId,e.pitch));break;case ut.CHANGE_PITCH:this._roomEngine.events.dispatchEvent(new _s(_s.CHANGE_PITCH,t,e.objectId,s,e.sampleId,e.pitch));break}}onHSLColorEnableEvent(e,t){if(!(!e||!this._roomEngine))switch(e.type){case Hi.ROOM_BACKGROUND_COLOR:this._roomEngine.events.dispatchEvent(new mc(mc.ROOM_BACKGROUND_COLOR,t,e.enable,e.hue,e.saturation,e.lightness));return}}onRoomObjectDataRequestEvent(e,t){if(!(!e||!this._roomEngine||!e.object))switch(e.type){case Qs.RODRE_CURRENT_USER_ID:e.object.model.setValue(T.SESSION_CURRENT_USER_ID,this._roomEngine.sessionDataManager.userId);return;case Qs.RODRE_URL_PREFIX:e.object.model.setValue(T.SESSION_URL_PREFIX,ue.getValue("url.prefix"));return}}onRoomObjectTileMouseEvent(e,t){if(!this._roomEngine||this._roomEngine.isDecorating||!this._roomEngine.roomSessionManager)return;const s=this._roomEngine.roomSessionManager.getSession(e);!s||s.isSpectator||this.sendWalkUpdate(t.tileXAsInt,t.tileYAsInt)}handleObjectMove(e,t){if(!e||!this._roomEngine||!this._roomEngine.events)return;const i=this.getSelectedRoomObjectData(t);if(!i)return;const n=this._roomEngine.getRoomObject(t,i.id,i.category);if(!n)return;let a=!0;if(i.category===U.FLOOR||i.category===U.UNIT){const o=this._roomEngine.getFurnitureStackingHeightMap(t);e instanceof ii&&this.handleFurnitureMove(n,i,Math.trunc(e.tileX+.5),Math.trunc(e.tileY+.5),o)||(this.handleFurnitureMove(n,i,i.loc.x,i.loc.y,o),a=!1)}else if(i.category===U.WALL){if(a=!1,e instanceof ma){const o=e.wallLocation,u=e.wallWidth,l=e.wallHeight,d=e.x,c=e.y,_=e.direction;this.handleWallItemMove(n,i,o,u,l,d,c,_)&&(a=!0)}a||(n.setLocation(i.loc),n.setDirection(i.dir)),this._roomEngine.updateRoomObjectMask(t,i.id,a)}a?(this.setFurnitureAlphaMultiplier(n,.5),this._roomEngine.setObjectMoverIconSpriteVisible(!1)):(this.setFurnitureAlphaMultiplier(n,0),this._roomEngine.setObjectMoverIconSpriteVisible(!0))}handleObjectPlace(e,t){if(!e||!this._roomEngine||!this._roomEngine.events)return;let i=this.getSelectedRoomObjectData(t);if(!i)return;let n=this._roomEngine.getRoomObject(t,i.id,i.category);if(!n){if(e instanceof ii){if(i.category===U.FLOOR)this._roomEngine.addFurnitureFloor(t,i.id,i.typeId,i.loc,i.dir,0,i.stuffData,parseFloat(i.instanceData),-1,0,0,"",!1);else if(i.category===U.UNIT){this._roomEngine.addRoomObjectUser(t,i.id,new y,new y(180),180,i.typeId,i.instanceData);const a=this._roomEngine.getRoomObject(t,i.id,i.category);a&&i.posture&&a.model.setValue(T.FIGURE_POSTURE,i.posture)}}else e instanceof ma&&i.category===U.WALL&&this._roomEngine.addFurnitureWall(t,i.id,i.typeId,i.loc,i.dir,0,i.instanceData,0);if(n=this._roomEngine.getRoomObject(t,i.id,i.category),n&&i.category===U.FLOOR){const a=n.model.getValue(T.FURNITURE_ALLOWED_DIRECTIONS);if(a&&a.length){const o=new y(a[0]);if(n.setDirection(o),this.updateSelectedObjectData(t,i.id,i.category,i.loc,o,i.operation,i.typeId,i.instanceData,i.stuffData,i.state,i.animFrame,i.posture),i=this.getSelectedRoomObjectData(t),!i)return}}this.setFurnitureAlphaMultiplier(n,.5),this._roomEngine.setObjectMoverIconSpriteVisible(!0)}if(n){let a=!0;const o=this._roomEngine.getFurnitureStackingHeightMap(t);if(i.category===U.FLOOR)e instanceof ii&&this.handleFurnitureMove(n,i,Math.trunc(e.tileX+.5),Math.trunc(e.tileY+.5),o)||(this._roomEngine.removeRoomObjectFloor(t,i.id),a=!1);else if(i.category===U.WALL){if(a=!1,e instanceof ma){const u=e.wallLocation,l=e.wallWidth,d=e.wallHeight,c=e.x,_=e.y,f=e.direction;this.handleWallItemMove(n,i,u,l,d,c,_,f)&&(a=!0)}a||this._roomEngine.removeRoomObjectWall(t,i.id),this._roomEngine.updateRoomObjectMask(t,i.id,a)}else i.category===U.UNIT&&(e instanceof ii&&this.handleUserPlace(n,Math.trunc(e.tileX+.5),Math.trunc(e.tileY+.5),this._roomEngine.getLegacyWallGeometry(t))||(this._roomEngine.removeRoomObjectUser(t,i.id),a=!1));this._roomEngine.setObjectMoverIconSpriteVisible(!a)}}handleFurnitureMove(e,t,s,i,n){if(!e||!t)return!1;const a=new y;a.assign(e.getDirection()),e.setDirection(t.dir);const o=new y(s,i,0),u=new y;u.assign(e.getDirection());let l=this.validateFurnitureLocation(e,o,t.loc,t.dir,n);return l||(u.x=this.getValidRoomObjectDirection(e,!0),e.setDirection(u),l=this.validateFurnitureLocation(e,o,t.loc,t.dir,n)),l?(e.setLocation(l),u&&e.setDirection(u),!0):(e.setDirection(a),!1)}handleWallItemMove(e,t,s,i,n,a,o,u){if(!e||!t)return!1;const l=new y(u),d=this.validateWallItemLocation(e,s,i,n,a,o,t);return d?(e.setLocation(d),e.setDirection(l),!0):!1}validateFurnitureLocation(e,t,s,i,n){if(!e||!e.model||!t)return null;let a=null;const o=e.getDirection();if(!o||!s||!i)return null;if(t.x===s.x&&t.y===s.y&&o.x===i.x)return a=new y,a.assign(s),a;let u=e.model.getValue(T.FURNITURE_SIZE_X),l=e.model.getValue(T.FURNITURE_SIZE_Y);u<1&&(u=1),l<1&&(l=1);const d=s.x,c=s.y;let _=u,f=l,g=0,I=Math.trunc(Math.trunc(o.x+45)%360/90);if((I===1||I===3)&&(g=u,u=l,l=g),I=Math.trunc(Math.trunc(i.x+45)%360/90),(I===1||I===3)&&(g=_,_=f,f=g),n&&t){const p=e.model.getValue(T.FURNITURE_ALWAYS_STACKABLE)===1;return n.validateLocation(t.x,t.y,u,l,d,c,_,f,p)?new y(t.x,t.y,n.getTileHeight(t.x,t.y)):null}return null}validateWallItemLocation(e,t,s,i,n,a,o){if(e==null||e.model==null||t==null||s==null||i==null||o==null)return null;const u=e.model.getValue(T.FURNITURE_SIZE_X),l=e.model.getValue(T.FURNITURE_SIZE_Z),d=e.model.getValue(T.FURNITURE_CENTER_Z);if((n<u/2||n>s.length-u/2||a<d||a>i.length-(l-d))&&(n<u/2&&n<=s.length-u/2?n=u/2:n>=u/2&&n>s.length-u/2&&(n=s.length-u/2),a<d&&a<=i.length-(l-d)?a=d:a>=d&&a>i.length-(l-d)&&(a=i.length-(l-d))),n<u/2||n>s.length-u/2||a<d||a>i.length-(l-d))return null;let c=y.sum(y.product(s,n/s.length),y.product(i,a/i.length));return c=y.sum(t,c),c}changeObjectState(e,t,s,i,n){const a=this._roomEngine.getRoomObjectCategoryForType(s);this.changeRoomObjectState(e,t,a,i,n)}useObject(e,t,s,i){if(!(!this._roomEngine||!this._roomEngine.connection))switch(i){case B.DICE_ACTIVATE:this._roomEngine.connection.send(new Hm(t));return;case B.DICE_OFF:this._roomEngine.connection.send(new km(t));return;case B.USE_HABBOWHEEL:this._roomEngine.connection.send(new Bm(t));return;case B.STICKIE:this._roomEngine.connection.send(new Om(t));return;case B.ENTER_ONEWAYDOOR:this._roomEngine.connection.send(new Vm(t));return}}changeRoomObjectState(e,t,s,i,n){return!this._roomEngine||!this._roomEngine.connection||(s===U.FLOOR?n?this._roomEngine.connection.send(new jm(t,i)):this._roomEngine.connection.send(new B_(t,i)):s===U.WALL&&this._roomEngine.connection.send(new Ym(t,i))),!0}sendWalkUpdate(e,t){!this._roomEngine||!this._roomEngine.connection||this._roomEngine.connection.send(new np(e,t))}handleMouseOverObject(e,t,s){if(e!==U.FLOOR)return null;const i=this._roomEngine.getRoomObject(t,s.objectId,U.FLOOR);if(!i)return null;const n=this.getActiveSurfaceLocation(i,s);if(!n||!this._roomEngine.getFurnitureStackingHeightMap(t))return null;const o=n.x,u=n.y,l=n.z;return new ba(new y(o,u,i.getLocation().z),l,!0,s.eventId)}handleMoveTargetFurni(e,t){if(t.objectType===me.USER||t.objectType===me.PET||t.objectType===me.BOT||t.objectType===me.RENTABLE_BOT||t.objectType===me.MONSTER_PLANT)return;const s=this._roomEngine.getRoomObject(e,t.objectId,U.FLOOR),i=this.getActiveSurfaceLocation(s,t);return i?(this.sendWalkUpdate(i.x,i.y),!0):!1}getActiveSurfaceLocation(e,t){if(!e||!t)return null;const s=this._roomEngine.sessionDataManager.getFloorItemDataByName(e.type);if(!s||!s.canStandOn&&!s.canSitOn&&!s.canLayOn)return null;const i=e.model;if(!i)return null;const n=e.getLocation(),a=e.getDirection();let o=i.getValue(T.FURNITURE_SIZE_X),u=i.getValue(T.FURNITURE_SIZE_Y);const l=i.getValue(T.FURNITURE_SIZE_Z);(a.x===90||a.x===270)&&([o,u]=[u,o]),o<1&&(o=1),u<1&&(u=1);const d=this._roomEngine.getActiveRoomInstanceRenderingCanvas();if(!d)return null;const c=d.geometry.scale,_=s.canSitOn?.5:0,f=(c/2+t.spriteOffsetX+t.localX)/(c/4),g=(t.spriteOffsetY+t.localY+(l-_)*c/2)/(c/4),I=(f+2*g)/4,p=(f-2*g)/4,R=Math.floor(n.x+I),S=Math.floor(n.y-p+1);let O=!1;(R<n.x||R>=n.x+o||S<n.y||S>=n.y+u)&&(O=!0);const A=s.canSitOn?l-.5:l;return O?null:new y(R,S,A)}handleMouseOverTile(e,t){if(this._whereYouClickIsWhereYouGo)return new ba(new y(e.tileXAsInt,e.tileYAsInt,e.tileZAsInt),0,!0,e.eventId);const s=this._roomEngine.getRoomObjectCursor(t);if(s&&s.visualization){const i=e.tileXAsInt,n=e.tileYAsInt,a=e.tileZAsInt;if(this._roomEngine.getRoomInstance(t)){const u=this._roomEngine.getRoomTileObjectMap(t);if(u){const l=u.getObjectIntTile(i,n),d=this._roomEngine.getFurnitureStackingHeightMap(t);if(d){if(l&&l.model&&l.model.getValue(T.FURNITURE_IS_VARIABLE_HEIGHT)>0){const c=d.getTileHeight(i,n),_=this._roomEngine.getLegacyWallGeometry(t).getHeight(i,n);return new ba(new y(i,n,a),c-_,!0,e.eventId)}return new ba(new y(i,n,a),0,!0,e.eventId)}}}}return null}placeObject(e,t,s){const i=this.getSelectedRoomObjectData(e);if(!i)return;let n=null,a=i.id;const o=i.category;let u=0,l=0,d=0,c=0,_="";if(this._roomEngine&&this._roomEngine.connection&&(n=this._roomEngine.getRoomObject(e,a,o),n)){const f=n.getLocation();if(c=n.getDirection().x,o===U.FLOOR||o===U.UNIT)u=f.x,l=f.y,d=f.z;else if(o===U.WALL){u=f.x,l=f.y,d=f.z;const g=this._roomEngine.getLegacyWallGeometry(e);g&&(_=g.getOldLocationString(f,c))}c=(c/45%8+8)%8,a<0&&o===U.UNIT&&(a=a*-1),this._objectPlacementSource!==_c.CATALOG&&(o===U.UNIT?i.typeId===hr.PET?this._roomEngine.connection.send(new Am(a,Math.trunc(u),Math.trunc(l))):i.typeId===hr.RENTABLE_BOT&&this._roomEngine.connection.send(new Im(a,Math.trunc(u),Math.trunc(l))):n.model.getValue(T.FURNITURE_IS_STICKIE)!==void 0?this._roomEngine.connection.send(new Gm(a,_)):this._roomEngine.connection.send(new xm(a,o,_,Math.trunc(u),Math.trunc(l),c)))}if(this._roomEngine.setPlacedRoomObjectData(e,new ad(i.id,i.category,null,i.dir,null)),this.resetSelectedObjectData(e),this._roomEngine&&this._roomEngine.events){const f=n&&n.id===i.id;this._roomEngine.events.dispatchEvent(new iO(ee.PLACED,e,a,o,_,u,l,d,c,f,t,s,i.instanceData))}}modifyRoomObject(e,t,s,i){if(!this._roomEngine)return!1;const n=this._roomEngine.getRoomObject(e,t,s);if(!n)return!1;let a=!0;switch(i){case _e.OBJECT_ROTATE_POSITIVE:case _e.OBJECT_ROTATE_NEGATIVE:if(this._roomEngine.connection){let o=0;i==_e.OBJECT_ROTATE_NEGATIVE?o=this.getValidRoomObjectDirection(n,!1):o=this.getValidRoomObjectDirection(n,!0);const u=n.getLocation().x,l=n.getLocation().y;if(this.isValidLocation(n,new y(o),this._roomEngine.getFurnitureStackingHeightMap(e)))if(o=Math.trunc(o/45),n.type===me.MONSTER_PLANT){const d=this._roomEngine.roomSessionManager.getSession(e);if(d){const c=d.userDataManager.getUserDataByIndex(t);c&&this._roomEngine.connection.send(new x_(c.webID,Math.trunc(u),Math.trunc(l),o))}}else this._roomEngine.connection.send(new G_(t,u,l,o))}break;case _e.OBJECT_EJECT:case _e.OBJECT_PICKUP:this._roomEngine.connection&&this._roomEngine.connection.send(new wm(s,t));break;case _e.OBJECT_PICKUP_PET:if(this._roomEngine.connection){const o=this._roomEngine.roomSessionManager.getSession(e);if(o){const u=o.userDataManager.getUserDataByIndex(t);o.pickupPet(u.webID)}}break;case _e.OBJECT_PICKUP_BOT:if(this._roomEngine.connection){const o=this._roomEngine.roomSessionManager.getSession(e);if(o){const u=o.userDataManager.getUserDataByIndex(t);o.pickupBot(u.webID)}}break;case _e.OBJECT_MOVE:a=!1,this.setFurnitureAlphaMultiplier(n,.5),this.setSelectedRoomObjectData(e,n.id,s,n.getLocation(),n.getDirection(),i),this._roomEngine.setObjectMoverIconSprite(n.id,s,!0),this._roomEngine.setObjectMoverIconSpriteVisible(!1);break;case _e.OBJECT_MOVE_TO:{const o=this.getSelectedRoomObjectData(e);if(this.updateSelectedObjectData(e,o.id,o.category,o.loc,o.dir,_e.OBJECT_MOVE_TO,o.typeId,o.instanceData,o.stuffData,o.state,o.animFrame,o.posture),this.setFurnitureAlphaMultiplier(n,1),this._roomEngine.removeObjectMoverIconSprite(),this._roomEngine.connection){if(s===U.FLOOR){const u=n.getDirection().x%360,l=n.getLocation(),d=u/45;this._roomEngine.connection.send(new G_(t,l.x,l.y,d))}else if(s===U.WALL){const u=n.getDirection().x%360,l=this._roomEngine.getLegacyWallGeometry(e);if(l){const d=l.getOldLocationString(n.getLocation(),u);d&&this._roomEngine.connection.send(new Xm(t,d))}}else if(s===U.UNIT){const u=n.getDirection().x%360,l=n.getLocation(),d=u/45;parseInt(n.model.getValue(T.RACE));const c=this._roomEngine.roomSessionManager.getSession(e);if(c){const _=c.userDataManager.getUserDataByIndex(t);_&&this._roomEngine.connection.send(new x_(_.webID,l.x,l.y,d))}}}break}}return a&&this.resetSelectedObjectData(e),!0}modifyRoomObjectDataWithMap(e,t,s,i,n){if(!this._roomEngine||!this._roomEngine.getRoomObject(e,t,s))return!1;switch(i){case _e.OBJECT_SAVE_STUFF_DATA:this._roomEngine.connection&&this._roomEngine.connection.send(new Nm(t,n));break}return!0}modifyWallItemData(e,t,s,i){return!this._roomEngine||!this._roomEngine.connection?!1:(this._roomEngine.connection.send(new Pm(t,s,i)),!0)}deleteWallItem(e,t){return!this._roomEngine||!this._roomEngine.connection?!1:(this._roomEngine.connection.send(new Cm(t)),!0)}getValidRoomObjectDirection(e,t){if(!e||!e.model)return 0;let s=0,i=0,n=[];e.type===me.MONSTER_PLANT?n=e.model.getValue(T.PET_ALLOWED_DIRECTIONS):n=e.model.getValue(T.FURNITURE_ALLOWED_DIRECTIONS);let a=e.getDirection().x;if(n&&n.length){if(s=n.indexOf(a),s<0){for(s=0,i=0;i<n.length&&!(a<=n[i]);)s++,i++;s=s%n.length}t?s=(s+1)%n.length:s=(s-1+n.length)%n.length,a=n[s]}return a}isValidLocation(e,t,s){if(!e||!e.model||!t)return!1;const i=e.getDirection(),n=e.getLocation();if(!i||!n)return!1;if(i.x%180===t.x%180)return!0;let a=e.model.getValue(T.FURNITURE_SIZE_X),o=e.model.getValue(T.FURNITURE_SIZE_Y);a<1&&(a=1),o<1&&(o=1);let u=a,l=o,d=Math.trunc(Math.trunc(t.x+45)%360/90);if((d===1||d===3)&&([a,o]=[o,a]),d=Math.trunc(Math.trunc(i.x+45)%360/90),(d===1||d===3)&&([u,l]=[l,u]),s&&n){const c=e.model.getValue(T.FURNITURE_ALWAYS_STACKABLE)===1;if(s.validateLocation(n.x,n.y,a,o,n.x,n.y,u,l,c,n.z))return!0}return!1}placeObjectOnUser(e,t,s){const i=this.getSelectedRoomObjectData(e);!i||!this._roomEngine.getRoomObject(e,t,s)||!this._roomEngine||!this._roomEngine.events||this._roomEngine.events.dispatchEvent(new nO(ee.PLACED_ON_USER,e,t,s,i.id,i.category))}setSelectedObject(e,t,s){if(!this._roomEngine)return;const i=this._roomEngine.events;if(i)switch(s){case U.UNIT:case U.FLOOR:case U.WALL:if(s===U.UNIT)this.deselectObject(e),this.setSelectedAvatar(e,t,!0);else if(this.setSelectedAvatar(e,0,!1),t!==this._selectedObjectId){this.deselectObject(e);const n=this._roomEngine.getRoomObject(e,t,s);n&&n.logic&&(n.logic.processUpdateMessage(new Wo(!0)),this._selectedObjectId=t,this._selectedObjectCategory=s)}i.dispatchEvent(new ee(ee.SELECTED,e,t,s));return}}deselectObject(e){if(this._selectedObjectId===-1)return;const t=this._roomEngine.getRoomObject(e,this._selectedObjectId,this._selectedObjectCategory);t&&t.logic&&(t.logic.processUpdateMessage(new Wo(!1)),this._selectedObjectId=-1,this._selectedObjectCategory=U.MINIMUM)}setSelectedAvatar(e,t,s){if(!this._roomEngine)return;const i=U.UNIT,n=this._roomEngine.getRoomObject(e,this._selectedAvatarId,i);n&&n.logic&&(n.logic.processUpdateMessage(new Ku(!1)),this._selectedAvatarId=-1);let a=!1;if(s){const u=this._roomEngine.getRoomObject(e,t,i);if(u&&u.logic){u.logic.processUpdateMessage(new Ku(!0)),a=!0,this._selectedAvatarId=t;const l=u.getLocation();l&&this._roomEngine.connection.send(new sp(~~l.x,~~l.y))}}const o=this._roomEngine.getRoomObjectSelectionArrow(e);o&&o.logic&&(a&&!this._roomEngine.isPlayingGame()?o.logic.processUpdateMessage(new gi(gi.ENABLED)):o.logic.processUpdateMessage(new gi(gi.DISABLED)))}resetSelectedObjectData(e){if(!this._roomEngine)return;this._roomEngine.removeObjectMoverIconSprite();const t=this.getSelectedRoomObjectData(e);if(t){if(t.operation===_e.OBJECT_MOVE||t.operation===_e.OBJECT_MOVE_TO){const s=this._roomEngine.getRoomObject(e,t.id,t.category);s&&t.operation!==_e.OBJECT_MOVE_TO&&(s.setLocation(t.loc),s.setDirection(t.dir)),this.setFurnitureAlphaMultiplier(s,1),t.category===U.WALL&&this._roomEngine.updateRoomObjectMask(e,t.id,!0),this.updateSelectedObjectData(e,t.id,t.category,t.loc,t.dir,_e.OBJECT_MOVE,t.typeId,t.instanceData,t.stuffData,t.state,t.animFrame,t.posture)}else if(t.operation===_e.OBJECT_PLACE){const s=t.id;switch(t.category){case U.FLOOR:this._roomEngine.removeRoomObjectFloor(e,s);break;case U.WALL:this._roomEngine.removeRoomObjectWall(e,s);break;case U.UNIT:this._roomEngine.removeRoomObjectUser(e,s);break}}this._roomEngine.setSelectedRoomObjectData(e,null)}}getSelectedRoomObjectData(e){return this._roomEngine?this._roomEngine.getSelectedRoomObjectData(e):null}setFurnitureAlphaMultiplier(e,t){!e||!e.model||e.model.setValue(T.FURNITURE_ALPHA_MULTIPLIER,t)}decorateModeMove(e){return this._roomEngine.isDecorating&&!(e.ctrlKey||e.shiftKey)}cancelRoomObjectPlacement(e){return this.resetSelectedObjectData(e),!0}setSelectedRoomObjectData(e,t,s,i,n,a,o=0,u=null,l=null,d=-1,c=-1,_=null){if(this.resetSelectedObjectData(e),!this._roomEngine)return;const f=new ad(t,s,a,i,n,o,u,l,d,c,_);this._roomEngine.setSelectedRoomObjectData(e,f)}updateSelectedObjectData(e,t,s,i,n,a,o=0,u=null,l=null,d=-1,c=-1,_=null){if(!this._roomEngine)return null;const f=new ad(t,s,a,i,n,o,u,l,d,c,_);this._roomEngine.setSelectedRoomObjectData(e,f)}handleUserPlace(e,t,s,i){return i.isRoomTile(t,s)?(e.setLocation(new y(t,s,i.getHeight(t,s))),!0):!1}get engine(){return this._roomEngine}get selectedAvatarId(){return this._selectedAvatarId}}class lY{constructor(){this._events=new ws,this._cachedEvents=new Map,this._registeredEvents=new Map,this._functions=[]}getLogic(e){const t=this.getLogicType(e);if(!t)return null;const s=new t;if(!s)return null;if(s.eventDispatcher=this._events,!this._cachedEvents.get(e)){this._cachedEvents.set(e,!0);const i=s.getEventTypes();for(const n of i)n&&this.registerEventType(n)}return s}registerEventType(e){if(!this._registeredEvents.get(e)){this._registeredEvents.set(e,!0);for(const t of this._functions)t&&this._events.addEventListener(e,t)}}registerEventFunction(e){if(e&&!(this._functions.indexOf(e)>=0)){this._functions.push(e);for(const t of this._registeredEvents.keys())t&&this._events.addEventListener(t,e)}}removeEventFunction(e){if(!e)return;const t=this._functions.indexOf(e);if(t!==-1){this._functions.splice(t,1);for(const s of this._registeredEvents.keys())s&&this._events.removeEventListener(s,e)}}getLogicType(e){if(!e)return null;let t=null;switch(e){case w.ROOM:t=A3;break;case w.TILE_CURSOR:t=Fr;break;case w.SELECTION_ARROW:t=y3;break;case w.USER:case w.BOT:case w.RENTABLE_BOT:t=dt;break;case w.PET:t=R3;break;case w.FURNITURE_BASIC:t=Ee;break;case w.FURNITURE_BADGE_DISPLAY:t=zp;break;case w.FURNITURE_CHANGE_STATE_WHEN_STEP_ON:t=Sj;break;case w.FURNITURE_COUNTER_CLOCK:t=yj;break;case w.FURNITURE_CRACKABLE:t=Cj;break;case w.FURNITURE_CREDIT:t=Pj;break;case w.FURNITURE_CUSTOM_STACK_HEIGHT:t=bj;break;case w.FURNITURE_DICE:t=Dj;break;case w.FURNITURE_EDITABLE_INTERNAL_LINK:t=Uj;break;case w.FURNITURE_EDITABLE_ROOM_LINK:t=Fj;break;case w.FURNITURE_EXTERNAL_IMAGE_WALLITEM:t=xj;break;case w.FURNITURE_FIREWORKS:t=Gj;break;case w.FURNITURE_FLOOR_HOLE:t=Ln;break;case w.FURNITURE_GUILD_CUSTOMIZED:t=mr;break;case w.FURNITURE_HIGH_SCORE:t=Zu;break;case w.FURNITURE_HOCKEY_SCORE:t=kj;break;case w.FURNITURE_ES:t=jj;break;case w.FURNITURE_MANNEQUIN:t=Zi;break;case w.FURNITURE_MULTIHEIGHT:t=Kj;break;case w.FURNITURE_MULTISTATE:t=ft;break;case w.FURNITURE_ONE_WAY_DOOR:t=Zj;break;case w.FURNITURE_PET_CUSTOMIZATION:t=Jj;break;case w.FURNITURE_PRESENT:t=er;break;case w.FURNITURE_PURCHASABLE_CLOTHING:t=t3;break;case w.FURNITURE_PUSHABLE:t=Ei;break;case w.FURNITURE_BACKGROUND_COLOR:t=n3;break;case w.FURNITURE_BG:t=c3;break;case w.FURNITURE_BB:t=_3;break;case w.FURNITURE_ROOMDIMMER:t=d3;break;case w.FURNITURE_SCORE:t=$i;break;case w.FURNITURE_SOUNDBLOCK:t=tr;break;case w.FURNITURE_STICKIE:t=Ju;break;case w.FURNITURE_TROPHY:t=E3;break;case w.FURNITURE_VOTE_COUNTER:t=en;break;case w.FURNITURE_VOTE_MAJORITY:t=m3;break;case w.FURNITURE_WINDOW:t=I3;break;case w.FURNITURE_LOVELOCK:t=zj;break;case w.FURNITURE_YOUTUBE:t=T3;break;case w.FURNITURE_CRAFTING_GIZMO:t=Mj;break;case w.FURNITURE_RENTABLE_SPACE:t=i3;break;case w.FURNITURE_EFFECTBOX:t=wj;break;case w.FURNITURE_MONSTERPLANT_SEED:t=Xj;break;case w.FURNITURE_MYSTERYBOX:t=qj;break;case w.FURNITURE_MYSTERYTROPHY:t=Qj;break;case w.FURNITURE_RANDOM_TELEPORT:t=r3;break;case w.FURNITURE_CLOTHING_CHANGE:t=Aj;break;case w.FURNITURE_CUCKOO_CLOCK:t=Nj;break;case w.FURNITURE_ECOTRON_BOX:t=Lj;break;case w.FURNITURE_GROUP_FORUM_TERMINAL:t=Bj;break;case w.FURNITURE_HWEEN_LOVELOCK:t=Vj;break;case w.FURNITURE_INTERNAL_LINK:t=Yj;break;case w.FURNITURE_JUKEBOX:t=Wj;break;case w.FURNITURE_PLACEHOLDER:t=$j;break;case w.FURNITURE_PLANET_SYSTEM:t=e3;break;case w.FURNITURE_RANDOMSTATE:t=s3;break;case w.FURNITURE_SONG_DISK:t=f3;break;case w.FURNITURE_SOUND_MACHINE:t=g3;break;case w.FURNITURE_WELCOME_GIFT:t=p3;break;case w.FURNITURE_ACHIEVEMENT_RESOLUTION:t=Ps;break;case w.FURNITURE_HABBOWHEEL:t=Hj;break;default:t=Ee;break}return t||(Y.warn("Unknown Logic",e),null)}get events(){return this._events}}class Oe extends Pr{constructor(e){super(),this._communication=e,this._sessionDataManager=null,this._roomSessionManager=null,this._roomManager=null,this._roomObjectEventHandler=new uY(this),this._roomMessageHandler=new hY(this),this._roomContentLoader=new Ne,this._ready=!1,this._roomContentLoaderReady=!1,this._activeRoomId=-1,this._activeRoomActiveCanvas=-1,this._roomInstanceDatas=new Map,this._roomDatas=new Map,this._roomRendererFactory=new ZO,this._visualizationFactory=new nl,this._logicFactory=new lY,this._activeRoomActiveCanvasMouseX=0,this._activeRoomActiveCanvasMouseY=0,this._activeRoomIsDragged=!1,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=0,this._activeRoomDragStartY=0,this._activeRoomDragX=0,this._activeRoomDragY=0,this._skipFurnitureCreationForNextFrame=!1,this._mouseCursorUpdate=!1,this._imageObjectIdBank=null,this._imageCallbacks=new Map,this._thumbnailCallbacks=new Map,this._roomDraggingAlwaysCenters=!1,this._roomAllowsDragging=!0,this._badgeListenerObjects=new Map,this.runVisibilityUpdate=this.runVisibilityUpdate.bind(this),this.processRoomObjectEvent=this.processRoomObjectEvent.bind(this),this.onRoomSessionEvent=this.onRoomSessionEvent.bind(this),this.onRoomContentLoaderReadyEvent=this.onRoomContentLoaderReadyEvent.bind(this),this.onBadgeImageReadyEvent=this.onBadgeImageReadyEvent.bind(this)}onInit(){this._ready||(this._imageObjectIdBank=new vg(1e3),this._thumbnailObjectIdBank=new vg(1e3),this._logicFactory.registerEventFunction(this.processRoomObjectEvent),this._roomManager&&(this._roomManager.setContentLoader(this._roomContentLoader),this._roomManager.addUpdateCategory(U.FLOOR),this._roomManager.addUpdateCategory(U.WALL),this._roomManager.addUpdateCategory(U.UNIT),this._roomManager.addUpdateCategory(U.CURSOR),this._roomManager.addUpdateCategory(U.ROOM)),this._roomMessageHandler.setConnection(this._communication.connection),this._roomContentLoader.initialize(this.events),this._roomContentLoader.setSessionDataManager(this._sessionDataManager),this._roomContentLoader.setIconListener(this),this._roomSessionManager&&(this._roomSessionManager.events.addEventListener(ce.STARTED,this.onRoomSessionEvent),this._roomSessionManager.events.addEventListener(ce.ENDED,this.onRoomSessionEvent)),this.events.addEventListener(Ne.LOADER_READY,this.onRoomContentLoaderReadyEvent),Jr().add(this.update,this),document.addEventListener("visibilitychange",this.runVisibilityUpdate))}onDispose(){if(this._ready){for(const[e,t]of this._roomInstanceDatas)this.removeRoomInstance(e);document.removeEventListener("visibilitychange",this.runVisibilityUpdate),Jr().remove(this.update,this),this._roomObjectEventHandler&&this._roomObjectEventHandler.dispose(),this._roomMessageHandler&&this._roomMessageHandler.dispose(),this._roomContentLoader&&this._roomContentLoader.dispose(),this.events.removeEventListener(Ne.LOADER_READY,this.onRoomContentLoaderReadyEvent),this._roomSessionManager&&(this._roomSessionManager.events.removeEventListener(ce.STARTED,this.onRoomSessionEvent),this._roomSessionManager.events.removeEventListener(ce.ENDED,this.onRoomSessionEvent)),super.onDispose()}}onRoomSessionEvent(e){if(e instanceof ce)switch(e.type){case ce.STARTED:this._roomMessageHandler&&this._roomMessageHandler.setRoomId(e.session.roomId);return;case ce.ENDED:this._roomMessageHandler&&(this._roomMessageHandler.clearRoomId(),this.removeRoomInstance(e.session.roomId));return}}onRoomContentLoaderReadyEvent(e){this._roomContentLoaderReady=!0,this._roomManager.init()}setActiveRoomId(e){this._activeRoomId=e}destroyRoom(e){this.removeRoomInstance(e)}getRoomInstance(e){return this._roomManager&&this._roomManager.getRoomInstance(this.getRoomId(e))||null}removeRoomInstance(e){this.getRoomInstance(e)&&this._roomManager&&this._roomManager.removeRoomInstance(this.getRoomId(e));const s=this._roomInstanceDatas.get(e);s&&(this._roomInstanceDatas.delete(s.roomId),s.dispose()),this.events.dispatchEvent(new Ue(Ue.DISPOSED,e))}createRoomInstance(e,t){let s="111",i="201",n="1";if(!this._ready){let u=this._roomDatas.get(e);u&&(this._roomDatas.delete(e),s=u.floorType,i=u.wallType,n=u.landscapeType),u=new _I(e,t),u.floorType=s,u.wallType=i,u.landscapeType=n,this._roomDatas.set(e,u),Y.warn("Room Engine not initilized yet, can not create room. Room data stored for later initialization.");return}if(!t){Y.warn("Room property messages");return}const a=this._roomDatas.get(e);a&&(this._roomDatas.delete(e),a.floorType&&(s=a.floorType),a.wallType&&(i=a.wallType),a.landscapeType&&(n=a.landscapeType)),this.setupRoomInstance(e,t,s,i,n,this.getRoomInstanceModelName(e))&&(t.restrictsDragging?this._roomAllowsDragging=!1:this._roomAllowsDragging=!0,this.events.dispatchEvent(new Ue(Ue.INITIALIZED,e)))}setupRoomInstance(e,t,s,i,n,a){if(!this._ready||!this._roomManager)return;const o=this._roomManager.createRoomInstance(this.getRoomId(e));if(!o)return null;const u=U.ROOM,l=o.createRoomObjectAndInitalize(Oe.ROOM_OBJECT_ID,Oe.ROOM_OBJECT_TYPE,u);if(o.model.setValue(ze.ROOM_IS_PUBLIC,0),o.model.setValue(ze.ROOM_Z_SCALE,1),t&&(o.model.setValue(ze.RESTRICTS_DRAGGING,t.restrictsDragging),o.model.setValue(ze.RESTRICTS_SCALING,t.restrictsScaling),o.model.setValue(ze.RESTRICTED_SCALE,t.restrictedScale),t.dimensions)){const _=t.dimensions.minX,f=t.dimensions.maxX,g=t.dimensions.minY,I=t.dimensions.maxY;o.model.setValue(ze.ROOM_MIN_X,_),o.model.setValue(ze.ROOM_MAX_X,f),o.model.setValue(ze.ROOM_MIN_Y,g),o.model.setValue(ze.ROOM_MAX_Y,I);const p=Math.trunc(_*423+f*671+g*913+I*7509);l&&l.model&&l.model.setValue(T.ROOM_RANDOM_SEED,p)}const d=l&&l.logic||null;if(d&&(d.initialize(t),s&&(d.processUpdateMessage(new wt(wt.ROOM_FLOOR_UPDATE,s)),o.model.setValue(T.ROOM_FLOOR_TYPE,s)),i&&(d.processUpdateMessage(new wt(wt.ROOM_WALL_UPDATE,i)),o.model.setValue(T.ROOM_WALL_TYPE,i)),n&&(d.processUpdateMessage(new wt(wt.ROOM_LANDSCAPE_UPDATE,n)),o.model.setValue(T.ROOM_LANDSCAPE_TYPE,n))),t&&t.doors.length){let c=0;for(;c<t.doors.length;){const _=t.doors[c];if(_){const f=_.x,g=_.y,I=_.z,p=_.dir,R=Ft.DOOR,S="door_"+c,O=new y(f,g,I);d.processUpdateMessage(new Ft(Ft.ADD_MASK,S,R,O,Ft.HOLE)),(p===90||p===180)&&(p===90&&(o.model.setValue(T.ROOM_DOOR_X,f-.5),o.model.setValue(T.ROOM_DOOR_Y,g)),p===180&&(o.model.setValue(T.ROOM_DOOR_X,f),o.model.setValue(T.ROOM_DOOR_Y,g-.5)),o.model.setValue(T.ROOM_DOOR_Z,I),o.model.setValue(T.ROOM_DOOR_DIR,p))}c++}}return o.createRoomObjectAndInitalize(Oe.CURSOR_OBJECT_ID,Oe.CURSOR_OBJECT_TYPE,U.CURSOR),ue.getValue("enable.avatar.arrow",!1)&&o.createRoomObjectAndInitalize(Oe.ARROW_OBJECT_ID,Oe.ARROW_OBJECT_TYPE,U.CURSOR),o}getRoomInstanceDisplay(e,t,s,i,n){const a=this.getRoomInstance(e);if(!a)return null;let o=a.renderer;if(!o&&(o=this._roomRendererFactory.createRenderer(),!o))return null;o.roomObjectVariableAccurateZ=T.OBJECT_ACCURATE_Z_VALUE,a.setRenderer(o);const u=o.createCanvas(t,s,i,n);if(!u)return null;if(a.model.getValue(ze.RESTRICTS_SCALING)){let d=a.model.getValue(ze.RESTRICTED_SCALE);d||(d=1),u.setScale(d),u.restrictsScaling=!0}else u.restrictsScaling=!1;if(u.setMouseListener(this._roomObjectEventHandler),u.geometry){u.geometry.z_scale=a.model.getValue(ze.ROOM_Z_SCALE);const d=a.model.getValue(T.ROOM_DOOR_X),c=a.model.getValue(T.ROOM_DOOR_Y),_=a.model.getValue(T.ROOM_DOOR_Z),f=a.model.getValue(T.ROOM_DOOR_DIR),g=new y(d,c,_);let I=null;f===90&&(I=new y(-2e3,0,0)),f===180&&(I=new y(0,-2e3,0)),u.geometry.setDisplacement(g,I);const p=u.master;if(p){const R=new ot(Re.EMPTY);R.name=Oe.OVERLAY,R.interactive=!1,p.addChild(R)}}return u.master}setRoomInstanceRenderingCanvasMask(e,t,s){const i=this.getRoomInstanceRenderingCanvas(e,t);i&&i.setMask(s)}setRoomInstanceRenderingCanvasScale(e,t,s,i=null,n=null,a=!1,o=!1){const u=this.getRoomInstanceRenderingCanvas(e,t);if(u){if(u.restrictsScaling&&!a)return;u.setScale(s,i,n,a,o),this.events.dispatchEvent(new Ue(Ue.ROOM_ZOOMED,e))}}getRoomInstanceRenderingCanvas(e,t=-1){const s=this.getRoomInstance(e);if(!s)return null;const i=s.renderer;if(!i)return null;t===-1&&(t=this._activeRoomActiveCanvas);const n=i.getCanvas(t);return n||null}getActiveRoomInstanceRenderingCanvas(){return this.getRoomInstanceRenderingCanvas(this._activeRoomId,this._activeRoomActiveCanvas)}getRoomInstanceRenderingCanvasOffset(e,t=-1){t===-1&&(t=this._activeRoomActiveCanvas);const s=this.getRoomInstanceRenderingCanvas(e,t);return s?new k(s.screenOffsetX,s.screenOffsetY):null}setRoomInstanceRenderingCanvasOffset(e,t,s){const i=this.getRoomInstanceRenderingCanvas(e,t);if(!i||!s)return!1;const n=~~s.x,a=~~s.y;if(!(i.screenOffsetX===n&&i.screenOffsetY===a))return this.events.dispatchEvent(new qh(e,-(i.screenOffsetX-n),-(i.screenOffsetY-a))),i.screenOffsetX=n,i.screenOffsetY=a,!0}getRoomInstanceRenderingCanvasScale(e=-1e3,t=-1){e===-1e3&&(e=this._activeRoomId),t===-1&&(t=this._activeRoomActiveCanvas);const s=this.getRoomInstanceRenderingCanvas(e,t);return s?s.scale:1}initializeRoomInstanceRenderingCanvas(e,t,s,i){const n=this.getRoomInstanceRenderingCanvas(e,t);n&&n.initialize(s,i)}getRoomInstanceGeometry(e,t=-1){const s=this.getRoomInstance(e);if(!s)return null;const i=s.renderer;if(!i)return null;t===-1&&(t=this._activeRoomActiveCanvas);const n=i.getCanvas(t);return n?n.geometry:null}getRoomInstanceVariable(e,t){const s=this.getRoomInstance(e);return s&&s.model&&s.model.getValue(t)||null}updateRoomInstancePlaneVisibility(e,t,s=!0){const i=this.getRoomOwnObject(e);return i?(i.processUpdateMessage(new fi(fi.WALL_VISIBILITY,t)),i.processUpdateMessage(new fi(fi.FLOOR_VISIBILITY,s)),!0):!1}updateRoomInstancePlaneThickness(e,t,s){const i=this.getRoomOwnObject(e);return i?(i.processUpdateMessage(new di(di.WALL_THICKNESS,t)),i.processUpdateMessage(new di(di.FLOOR_THICKNESS,s)),!0):!1}updateRoomInstancePlaneType(e,t=null,s=null,i=null,n=!1){const a=this.getRoomOwnObject(e),o=this.getRoomInstance(e);if(!a){let u=this._roomDatas.get(e);return u||(u=new _I(e,null),this._roomDatas.set(e,u)),t&&(u.floorType=t),s&&(u.wallType=s),i&&(u.landscapeType=i),!0}return t&&(o&&!n&&o.model.setValue(T.ROOM_FLOOR_TYPE,t),a.processUpdateMessage(new wt(wt.ROOM_FLOOR_UPDATE,t))),s&&(o&&!n&&o.model.setValue(T.ROOM_WALL_TYPE,s),a.processUpdateMessage(new wt(wt.ROOM_WALL_UPDATE,s))),i&&(o&&!n&&o.model.setValue(T.ROOM_LANDSCAPE_TYPE,i),a.processUpdateMessage(new wt(wt.ROOM_LANDSCAPE_UPDATE,i))),!0}updateObjectRoomColor(e,t,s,i){const n=this.getRoomOwnObject(e);if(!n||!n.logic)return!1;const a=new Qu(Qu.BACKGROUND_COLOR,t,s,i);return n.logic.processUpdateMessage(a),this.events.dispatchEvent(new Kh(e,t,s,i)),!0}addRoomInstanceFloorHole(e,t){if(t<0)return;const s=this.getRoomOwnObject(e),i=this.getRoomObjectFloor(e,t);if(s&&s.logic&&i&&i.model){const n=i.getLocation(),a=i.model.getValue(T.FURNITURE_SIZE_X),o=i.model.getValue(T.FURNITURE_SIZE_Y);s.processUpdateMessage(new _i(_i.ADD,t,n.x,n.y,a,o))}}removeRoomInstanceFloorHole(e,t){if(t<0)return;const s=this.getRoomOwnObject(e);s&&s.processUpdateMessage(new _i(_i.REMOVE,t))}setRoomEngineGameMode(e,t){const s=this.getRoomInstance(e);if(!s)return;const i=t?1:0;s.model.setValue(ze.IS_PLAYING_GAME,i),i===0?this.events.dispatchEvent(new Ue(Ue.NORMAL_MODE,e)):this.events.dispatchEvent(new Ue(Ue.GAME_MODE,e))}isRoomIdPlayingGame(e){const t=this.getRoomInstance(e);return t?t.model.getValue(ze.IS_PLAYING_GAME)>0:!1}isPlayingGame(){return this.isRoomIdPlayingGame(this._activeRoomId)}disableUpdate(e){e?Jr().remove(this.update,this):(Jr().remove(this.update,this),Jr().add(this.update,this))}runUpdate(){this.update(1)}runVisibilityUpdate(){document.hidden||this.update(1,!0)}update(e,t=!1){this._roomManager&&(e=ve(),ne.turnVisualizationOn(),this.processPendingFurniture(),this._roomManager.update(e,t),this.updateRoomCameras(e),this._mouseCursorUpdate&&this.setPointer(),ne.turnVisualizationOff())}setPointer(){this._mouseCursorUpdate=!1;const e=this.getRoomInstanceData(this._activeRoomId);e&&e.hasButtonMouseCursorOwners()?document.body.style.cursor="pointer":document.body.style.cursor="auto"}processPendingFurniture(){if(this._skipFurnitureCreationForNextFrame){this._skipFurnitureCreationForNextFrame=!1;return}const e=new Date().valueOf(),t=5;for(const s of this._roomInstanceDatas.values()){if(!s)continue;let i=null,n=0,a=!1;for(;i=s.getNextPendingFurnitureFloor();)if(a=this.processPendingFurnitureFloor(s.roomId,i.id,i),!(++n%t)&&new Date().valueOf()-e>=40){this._skipFurnitureCreationForNextFrame=!0;break}for(;!this._skipFurnitureCreationForNextFrame&&(i=s.getNextPendingFurnitureWall());)if(a=this.processPendingFurnitureWall(s.roomId,i.id,i),!(++n%t)&&new Date().valueOf()-e>=40){this._skipFurnitureCreationForNextFrame=!0;break}if(a&&this._roomManager&&(this._roomManager.getRoomInstance(this.getRoomId(s.roomId)).hasUninitializedObjects()||this.objectsInitialized(s.roomId.toString())),this._skipFurnitureCreationForNextFrame)return}}onRoomEngineInitalized(e){if(e){this._ready=!0,this.events.dispatchEvent(new Ue(Ue.ENGINE_INITIALIZED,0));for(const t of this._roomDatas.values())t&&this.createRoomInstance(t.roomId,t.data)}}processPendingFurnitureFloor(e,t,s){if(!s){const u=this.getRoomInstanceData(e);if(u&&(s=u.getPendingFurnitureFloor(t)),!s)return!1}let i=s.type;i||(i=this.getFurnitureFloorName(s.typeId));const n=this.createRoomObjectFloor(e,t,i);if(!n)return!1;const a=n.model;if(a&&(a.setValue(T.FURNITURE_COLOR,this.getFurnitureFloorColorIndex(s.typeId)),a.setValue(T.FURNITURE_TYPE_ID,s.typeId),a.setValue(T.FURNITURE_AD_URL,this.getRoomObjectAdUrl(s.type)),a.setValue(T.FURNITURE_REAL_ROOM_OBJECT,s.realRoomObject?1:0),a.setValue(T.FURNITURE_EXPIRY_TIME,s.expiryTime),a.setValue(T.FURNITURE_EXPIRTY_TIMESTAMP,ve()),a.setValue(T.FURNITURE_USAGE_POLICY,s.usagePolicy),a.setValue(T.FURNITURE_OWNER_ID,s.ownerId),a.setValue(T.FURNITURE_OWNER_NAME,s.ownerName)),!this.updateRoomObjectFloor(e,t,s.location,s.direction,s.state,s.data,s.extra)||s.sizeZ>=0&&!this.updateRoomObjectFloorHeight(e,t,s.sizeZ))return!1;this.events&&this.events.dispatchEvent(new ee(ee.ADDED,e,t,U.FLOOR));const o=this.getPlacedRoomObjectData(e);return o&&o.id===t&&o.category===U.FLOOR&&this.selectRoomObject(e,t,U.FLOOR),n.isReady&&s.synchronized&&this.addObjectToTileMap(e,n),!0}processPendingFurnitureWall(e,t,s){if(!s){const l=this.getRoomInstanceData(e);if(l&&(s=l.getPendingFurnitureWall(t)),!s)return!1}let i="";s.data&&(i=s.data.getLegacyString());let n=this.getFurnitureWallName(s.typeId,i);n||(n="");const a=this.createRoomObjectWall(e,t,n);if(!a)return!1;const o=a.model;if(o&&(o.setValue(T.FURNITURE_COLOR,this.getFurnitureWallColorIndex(s.typeId)),o.setValue(T.FURNITURE_TYPE_ID,s.typeId),o.setValue(T.FURNITURE_AD_URL,this.getRoomObjectAdUrl(s.type)),o.setValue(T.FURNITURE_REAL_ROOM_OBJECT,s.realRoomObject?1:0),o.setValue(T.OBJECT_ACCURATE_Z_VALUE,1),o.setValue(T.FURNITURE_EXPIRY_TIME,s.expiryTime),o.setValue(T.FURNITURE_EXPIRTY_TIMESTAMP,ve()),o.setValue(T.FURNITURE_USAGE_POLICY,s.usagePolicy),o.setValue(T.FURNITURE_OWNER_ID,s.ownerId),o.setValue(T.FURNITURE_OWNER_NAME,s.ownerName)),!this.updateRoomObjectWall(e,t,s.location,s.direction,s.state,i))return!1;this.events&&this.events.dispatchEvent(new ee(ee.ADDED,e,t,U.WALL));const u=this.getPlacedRoomObjectData(e);return u&&Math.abs(u.id)===t&&u.category===U.WALL&&this.selectRoomObject(e,t,U.WALL),!0}setRoomSessionOwnUser(e,t){if(!this._roomSessionManager)return;const s=this._roomSessionManager.getSession(e);s&&s.setOwnRoomIndex(t);const i=this.getRoomCamera(e);i&&(i.targetId=t,i.targetCategory=U.UNIT,i.activateFollowing(this.cameraFollowDuration))}get cameraFollowDuration(){return 1e3}updateRoomCameras(e){for(const t of this._roomInstanceDatas.values()){if(!t)continue;const s=t.roomCamera;if(!s)continue;let i=null;const n=this.getRoomObject(t.roomId,s.targetId,s.targetCategory);n&&(i=n.getLocation()),i&&(t.roomId!==this._activeRoomId||!this._activeRoomIsDragged)&&this.updateRoomCamera(t.roomId,1,i,e)}if(this._activeRoomWasDragged){const t=this.getRoomInstanceRenderingCanvas(this._activeRoomId,1);t&&this.setRoomInstanceRenderingCanvasOffset(this._activeRoomId,1,new k(t.screenOffsetX+this._activeRoomDragX,t.screenOffsetY+this._activeRoomDragY)),this._activeRoomDragX=0,this._activeRoomDragY=0}}updateRoomCamera(e,t,s,i){const n=this.getRoomInstanceRenderingCanvas(e,t),a=this.getRoomInstanceData(e);if(!n||!a||n.scale!==1)return;const o=n.geometry,u=a.roomCamera,l=this.getRoomInstance(e);if(!o||!u||!l)return;const d=this.getRoomCanvasRectangle(e,t);if(!d)return;let c=Math.floor(s.z)+1;const _=Math.round(d.width),f=Math.round(d.height),g=this.getCanvasBoundingRectangle(t);if(g&&(g.right<0||g.bottom<0||g.left>=_||g.top>=f)&&u.reset(),u.screenWd!==_||u.screenHt!==f||u.scale!==o.scale||u.geometryUpdateId!==o.updateId||!y.isEqual(s,u.targetObjectLoc)||u.isMoving){u.targetObjectLoc=s;const I=new y;I.assign(s),I.x=Math.round(I.x),I.y=Math.round(I.y);const p=l.model.getValue(ze.ROOM_MIN_X)-.5,R=l.model.getValue(ze.ROOM_MIN_Y)-.5,S=l.model.getValue(ze.ROOM_MAX_X)+.5,O=l.model.getValue(ze.ROOM_MAX_Y)+.5,A=Math.round((p+S)/2),C=Math.round((R+O)/2),M=2;let N=new k(I.x-A,I.y-C);const L=o.scale/Math.sqrt(2),b=L/2,D=new Ye;D.rotate(-(o.direction.x+90)/180*Math.PI),N=D.apply(N),N.y=N.y*(b/L);const x=d.width/2/L-1,q=d.height/2/b-1;let $=0,Te=0,j=0,Q=0,oe=o.getScreenPoint(new y(A,C,M));if(!oe)return;if(oe.x=oe.x+Math.round(d.width/2),oe.y=oe.y+Math.round(d.height/2),g)if(g.x+=-n.screenOffsetX,g.y+=-n.screenOffsetY,g.width>1&&g.height>1)$=(g.left-oe.x-o.scale*.25)/L,j=(g.right-oe.x+o.scale*.25)/L,Te=(g.top-oe.y-o.scale*.5)/b,Q=(g.bottom-oe.y+o.scale*.5)/b;else{o.adjustLocation(new y(-30,-30),25);return}else{o.adjustLocation(new y(0,0),25);return}let $t=!1,Gt=!1,K=!1,ae=!1;Math.round((j-$)*L)<d.width?(c=2,N.x=(j+$)/2,K=!0):(N.x>j-x&&(N.x=j-x,$t=!0),N.x<$+x&&(N.x=$+x,$t=!0)),Math.round((Q-Te)*b)<d.height?(c=2,N.y=(Q+Te)/2,ae=!0):(N.y>Q-q&&(N.y=Q-q,Gt=!0),N.y<Te+q&&(N.y=Te+q,Gt=!0),Gt&&(N.y=N.y/(b/L))),D.invert(),N=D.apply(N),N.x=N.x+A,N.y=N.y+C;let Le=.35,Be=.2,Xe=.2;const ht=10,gt=10;if(Xe*_>100&&(Xe=100/_),Le*f>150&&(Le=150/f),Be*f>150&&(Be=150/f),u.limitedLocationX&&u.screenWd==_&&u.screenHt==f&&(Xe=0),u.limitedLocationY&&u.screenWd==_&&u.screenHt==f&&(Le=0,Be=0),d.width=d.width*(1-Xe*2),d.height=d.height*(1-(Le+Be)),d.width<ht&&(d.width=ht),d.height<gt&&(d.height=gt),Le+Be>0?(d.x+=-d.width/2,d.y+=-d.height*(Be/(Le+Be))):(d.x+=-d.width/2,d.y+=-d.height/2),oe=o.getScreenPoint(I),!oe)return;if(oe){oe.x=oe.x+n.screenOffsetX,oe.y=oe.y+n.screenOffsetY,I.z=c,I.x=Math.round(N.x*2)/2,I.y=Math.round(N.y*2)/2,u.location||(o.location=I,this.useOffsetScrolling?u.initializeLocation(new y(0,0,0)):u.initializeLocation(I));const es=o.getScreenPoint(I),bt=new y(0,0,0);es&&(bt.x=es.x,bt.y=es.y),(oe.x<d.left||oe.x>d.right)&&!u.centeredLocX||(oe.y<d.top||oe.y>d.bottom)&&!u.centeredLocY||K&&!u.centeredLocX&&u.screenWd!=_||ae&&!u.centeredLocY&&u.screenHt!=f||u.roomWd!=g.width||u.roomHt!=g.height||u.screenWd!=_||u.screenHt!=f?(u.limitedLocationX=$t,u.limitedLocationY=Gt,this.useOffsetScrolling?u.target=bt:u.target=I):($t||(u.limitedLocationX=!1),Gt||(u.limitedLocationY=!1))}u.centeredLocX=K,u.centeredLocY=ae,u.screenWd=_,u.screenHt=f,u.scale=o.scale,u.geometryUpdateId=o.updateId,u.roomWd=g.width,u.roomHt=g.height,this._sessionDataManager.isCameraFollowDisabled||(this.useOffsetScrolling?u.update(i,8):u.update(i,.5)),this.useOffsetScrolling?this.setRoomInstanceRenderingCanvasOffset(this.activeRoomId,1,new k(-u.location.x,-u.location.y)):o.adjustLocation(u.location,25)}else u.limitedLocationX=!1,u.limitedLocationY=!1,u.centeredLocX=!1,u.centeredLocY=!1}getRoomCanvasRectangle(e,t){const s=this.getRoomInstanceRenderingCanvas(e,t);return s?new he(0,0,s.width,s.height):null}getRoomObjectBoundingRectangle(e,t,s,i){const n=this.getRoomInstanceGeometry(e,i);if(!n)return null;const a=this.getRoomObject(e,t,s);if(!a)return null;const o=a.visualization;if(!o)return null;const u=o.getBoundingRectangle(),l=this.getRoomInstanceRenderingCanvas(e,i),d=l?l.scale:1,c=n.getScreenPoint(a.getLocation());return!c||(c.x=Math.round(c.x),c.y=Math.round(c.y),u.x=u.x*d,u.y=u.y*d,u.width=u.width*d,u.height=u.height*d,c.x=c.x*d,c.y=c.y*d,u.x+=c.x,u.y+=c.y,!l)?null:(u.x+=Math.round(l.width/2)+l.screenOffsetX,u.y+=Math.round(l.height/2)+l.screenOffsetY,u)}getCanvasBoundingRectangle(e){return this.getRoomObjectBoundingRectangle(this._activeRoomId,Oe.ROOM_OBJECT_ID,U.ROOM,e)}getFurnitureFloorName(e){return this._roomContentLoader?this._roomContentLoader.getFurnitureFloorNameForTypeId(e):null}getFurnitureWallName(e,t=null){return this._roomContentLoader?this._roomContentLoader.getFurnitureWallNameForTypeId(e,t):null}getFurnitureFloorColorIndex(e){return this._roomContentLoader?this._roomContentLoader.getFurnitureFloorColorIndex(e):null}getFurnitureWallColorIndex(e){return this._roomContentLoader?this._roomContentLoader.getFurnitureWallColorIndex(e):null}getRoomInstanceData(e){const t=this._roomInstanceDatas.get(e);if(t)return t;const s=new aY(e);return this._roomInstanceDatas.set(s.roomId,s),s}getRoomInstanceModelName(e){const t=this.getRoomInstanceData(e);return t?t.modelName:null}setRoomInstanceModelName(e,t){const s=this.getRoomInstanceData(e);s&&s.setModelName(t)}getRoomTileObjectMap(e){const t=this.getRoomInstanceData(e);return t?t.tileObjectMap:null}getCurrentRoomCamera(){return this.getRoomCamera(this._activeRoomId)}getRoomCamera(e){const t=this.getRoomInstanceData(e);return t?t.roomCamera:null}getSelectedRoomObjectData(e){const t=this.getRoomInstanceData(e);return t?t.selectedObject:null}setSelectedRoomObjectData(e,t){const s=this.getRoomInstanceData(e);if(!s)return null;s.setSelectedObject(t),t&&s.setPlacedObject(null)}getPlacedRoomObjectData(e){const t=this.getRoomInstanceData(e);return t?t.placedObject:null}setPlacedRoomObjectData(e,t){const s=this.getRoomInstanceData(e);if(!s)return null;s.setPlacedObject(t)}cancelRoomObjectPlacement(){this._roomObjectEventHandler&&this._roomObjectEventHandler.cancelRoomObjectPlacement(this._activeRoomId)}getFurnitureStackingHeightMap(e){const t=this.getRoomInstanceData(e);return t?t.furnitureStackingHeightMap:null}setFurnitureStackingHeightMap(e,t){const s=this.getRoomInstanceData(e);if(!s)return null;s.setFurnitureStackingHeightMap(t)}getLegacyWallGeometry(e){const t=this.getRoomInstanceData(e);return t?t.legacyGeometry:null}createRoomObjectAndInitialize(e,t,s,i){const n=this.getRoomInstance(e);return n?n.createRoomObjectAndInitalize(t,s,i):null}getTotalObjectsForManager(e,t){const s=this.getRoomInstance(e);return s?s.getTotalObjectsForManager(t):0}getRoomObject(e,t,s){if(!this._ready)return null;let i=this.getRoomId(e);return e===0&&(i=Oe.TEMPORARY_ROOM),this.getObject(i,t,s)}getObject(e,t,s){let i=null;if(this._roomManager&&(i=this._roomManager.getRoomInstance(e)),!i)return null;let n=i.getRoomObject(t,s);if(!n)switch(s){case U.FLOOR:this.processPendingFurnitureFloor(this.getRoomIdFromString(e),t,null),n=i.getRoomObject(t,s);break;case U.WALL:this.processPendingFurnitureWall(this.getRoomIdFromString(e),t,null),n=i.getRoomObject(t,s);break}return n}getRoomObjectByIndex(e,t,s){const i=this.getRoomInstance(e);return i?i.getRoomObjectByIndex(t,s):null}getRoomObjectCategoryForType(e){return!e||!this._roomContentLoader?U.MINIMUM:this._roomContentLoader.getCategoryForType(e)}getRoomObjectCursor(e){return this.getObject(this.getRoomId(e),Oe.CURSOR_OBJECT_ID,U.CURSOR)}getRoomObjectSelectionArrow(e){return this.getObject(this.getRoomId(e),Oe.ARROW_OBJECT_ID,U.CURSOR)}getRoomOwnObject(e){return this.getObject(this.getRoomId(e),Oe.ROOM_OBJECT_ID,U.ROOM)}getRoomObjectUser(e,t){return this.getObject(this.getRoomId(e),t,U.UNIT)}removeRoomObjectUser(e,t){return this.removeRoomObject(e,t,U.UNIT)}createRoomObjectUser(e,t,s){return this.createRoomObjectAndInitialize(e,t,s,U.UNIT)}getRoomObjectFloor(e,t){return this.getObject(this.getRoomId(e),t,U.FLOOR)}createRoomObjectFloor(e,t,s){return this.createRoomObjectAndInitialize(e,t,s,U.FLOOR)}removeRoomObjectFloor(e,t,s=-1,i=!1){const n=this.getRoomInstanceData(e);if(n&&n.removePendingFunitureFloor(t),this._sessionDataManager&&s===this._sessionDataManager.userId&&!Qo.isBuilderClubId(t)){const a=this.getRoomObject(e,t,U.FLOOR);if(a){const o=this.getRoomObjectScreenLocation(e,t,U.FLOOR,this._activeRoomActiveCanvas);if(o&&!(a.model.getValue(T.FURNITURE_DISABLE_PICKING_ANIMATION)===1)){const l=a.model.getValue(T.FURNITURE_TYPE_ID),d=a.model.getValue(T.FURNITURE_EXTRAS),c=a.model.getValue(T.FURNITURE_DATA_FORMAT),_=Fi.getData(c),f=this.getFurnitureFloorIcon(l,null,d,_).data;if(f){const g=Je.generateImage(f);if(this.events){const I=new Ro(g,o.x,o.y);I.iconName=$r.INVENTORY,this.events.dispatchEvent(I)}}}}}this.removeRoomObject(e,t,U.FLOOR),this.setMouseDefault(e,U.FLOOR,t),i&&this.refreshTileObjectMap(e,"RoomEngine.disposeObjectFurniture()")}getRoomObjectWall(e,t){return this.getObject(this.getRoomId(e),t,U.WALL)}removeRoomObjectWall(e,t,s=-1){if(this._sessionDataManager&&s===this._sessionDataManager.userId&&!Qo.isBuilderClubId(t)){const i=this.getRoomObject(e,t,U.WALL);if(i&&i.type.indexOf("post_it")===-1&&i.type.indexOf("external_image_wallitem")===-1){const n=this.getRoomObjectScreenLocation(e,t,U.WALL,this._activeRoomActiveCanvas);if(n){const a=i.model.getValue(T.FURNITURE_TYPE_ID),o=i.model.getValue(T.FURNITURE_DATA),u=this.getFurnitureWallIcon(a,null,o).data;if(u){const l=Je.generateImage(u);if(this.events){const d=new Ro(l,n.x,n.y);d.iconName=$r.INVENTORY,this.events.dispatchEvent(d)}}}}}this.removeRoomObject(e,t,U.WALL),this.updateRoomObjectMask(e,t,!1),this.setMouseDefault(e,U.WALL,t)}createRoomObjectWall(e,t,s){return this.createRoomObjectAndInitialize(e,t,s,U.WALL)}removeRoomObject(e,t,s){const i=this.getRoomInstance(e);if(!i)return null;i.removeRoomObject(t,s),this.events&&this.events.dispatchEvent(new ee(ee.REMOVED,e,t,s))}addFurnitureFloor(e,t,s,i,n,a,o,u=NaN,l=-1,d=0,c=0,_="",f=!0,g=!0,I=-1){const p=this.getRoomInstanceData(e);if(!p)return!1;const R=new nd(t,s,null,i,n,a,o,u,l,d,c,_,f,g,I);return p.addPendingFurnitureFloor(R),!0}addFurnitureFloorByTypeName(e,t,s,i,n,a,o,u=NaN,l=-1,d=0,c=0,_="",f=!0,g=!0,I=-1){const p=this.getRoomInstanceData(e);if(!p)return!1;const R=new nd(t,0,s,i,n,a,o,u,l,d,c,_,f,g,I);return p.addPendingFurnitureFloor(R),!0}addFurnitureWall(e,t,s,i,n,a,o,u=-1,l=0,d=0,c="",_=!0){const f=this.getRoomInstanceData(e);if(!f)return!1;const g=new ns;g.setString(o);const I=new nd(t,s,null,i,n,a,g,NaN,u,l,d,c,!0,_);return f.addPendingFurnitureWall(I),!0}updateRoomObjectFloor(e,t,s,i,n,a,o=null){const u=this.getRoomObjectFloor(e,t);return u?(u.processUpdateMessage(new St(s,i)),u.processUpdateMessage(new Ve(n,a,o)),!0):!1}updateRoomObjectWall(e,t,s,i,n,a=null){const o=this.getRoomObjectWall(e,t);if(!o||!o.logic)return!1;const u=new St(s,i),l=new ns,d=new Ve(n,l);return l.setString(a),o.logic.processUpdateMessage(u),o.logic.processUpdateMessage(d),this.updateRoomObjectMask(e,t),!0}updateRoomObjectWallItemData(e,t,s){const i=this.getRoomObjectWall(e,t);return!i||!i.logic?!1:(i.logic.processUpdateMessage(new X_(s)),!0)}updateRoomObjectFloorHeight(e,t,s){const i=this.getRoomObjectFloor(e,t);return i?(i.processUpdateMessage(new Yp(null,null,s)),!0):!1}updateRoomObjectFloorExpiration(e,t,s){const i=this.getRoomObjectFloor(e,t);return i?(i.model.setValue(T.FURNITURE_EXPIRY_TIME,s),i.model.setValue(T.FURNITURE_EXPIRTY_TIMESTAMP,ve()),!0):!1}updateRoomObjectWallExpiration(e,t,s){const i=this.getRoomObjectWall(e,t);return i?(i.model.setValue(T.FURNITURE_EXPIRY_TIME,s),i.model.setValue(T.FURNITURE_EXPIRTY_TIMESTAMP,ve()),!0):!1}updateRoomObjectMask(e,t,s=!0){const i=U.WALL+"_"+t,n=this.getRoomObjectWall(e,t);let a=null;if(n&&n.model){if(n.model.getValue(T.FURNITURE_USES_PLANE_MASK)>0){const u=n.model.getValue(T.FURNITURE_PLANE_MASK_TYPE),l=n.getLocation();s?a=new Ft(Ft.ADD_MASK,i,u,l):a=new Ft(Ft.REMOVE_MASK,i)}}else a=new Ft(Ft.REMOVE_MASK,i);const o=this.getRoomOwnObject(e);o&&o.logic&&a&&o.logic.processUpdateMessage(a)}rollRoomObjectFloor(e,t,s,i){const n=this.getRoomObjectFloor(e,t);n&&n.processUpdateMessage(new qi(s,i,null,!!i))}updateRoomObjectWallLocation(e,t,s){const i=this.getRoomObjectWall(e,t);return i?(i.logic&&i.logic.processUpdateMessage(new qi(s,null,null)),this.updateRoomObjectMask(e,t),!0):!1}addRoomObjectUser(e,t,s,i,n,a,o){if(this.getRoomObjectUser(e,t))return!1;let l=me.getTypeString(a);l===me.PET&&(l=this.getPetType(o));const d=this.createRoomObjectUser(e,t,l);return d?(d.processUpdateMessage(new qu(this.fixedUserLocation(e,s),null,i,n,!1,0)),o&&d.processUpdateMessage(new Xu(o)),this.events&&this.events.dispatchEvent(new ee(ee.ADDED,e,t,U.UNIT)),!0):!1}updateRoomObjectUserLocation(e,t,s,i,n=!1,a=0,o=null,u=NaN){const l=this.getRoomObjectUser(e,t);if(!l)return!1;s||(s=l.getLocation()),o||(o=l.getDirection()),isNaN(u)&&(u=l.model.getValue(T.HEAD_DIRECTION)),l.processUpdateMessage(new qu(this.fixedUserLocation(e,s),this.fixedUserLocation(e,i),o,u,n,a));const d=this._roomSessionManager&&this._roomSessionManager.getSession(e)||null;return d&&d.ownRoomIndex===t&&this._logicFactory.events.dispatchEvent(new vo(vo.ROAME_MOVE_TO,i)),!0}fixedUserLocation(e,t){if(!t)return null;const s=this.getFurnitureStackingHeightMap(e),i=this.getLegacyWallGeometry(e);if(!s||!i)return t;let n=t.z;const a=s.getTileHeight(t.x,t.y),o=i.getHeight(t.x,t.y);return Math.abs(n-a)<.1&&Math.abs(a-o)<.1&&(n=i.getFloorAltitude(t.x,t.y)),new y(t.x,t.y,n)}updateRoomObjectUserAction(e,t,s,i,n=null){const a=this.getRoomObjectUser(e,t);if(!a)return!1;let o=null;switch(s){case T.FIGURE_TALK:o=new Y_(i);break;case T.FIGURE_SLEEP:o=new z_(i===1);break;case T.FIGURE_IS_TYPING:o=new Vp(i===1);break;case T.FIGURE_IS_MUTED:o=new wp(i===1);break;case T.FIGURE_CARRY_OBJECT:o=new Pp(i,n);break;case T.FIGURE_USE_OBJECT:o=new jp(i);break;case T.FIGURE_DANCE:o=new Np(i);break;case T.FIGURE_GAINED_EXPERIENCE:o=new Dp(i);break;case T.FIGURE_NUMBER_VALUE:o=new Bp(i);break;case T.FIGURE_SIGN:o=new kp(i);break;case T.FIGURE_EXPRESSION:o=new Lp(i);break;case T.FIGURE_IS_PLAYING_GAME:o=new Hp(i===1);break;case T.FIGURE_GUIDE_STATUS:o=new Oj(i);break}return o?(a.processUpdateMessage(o),!0):!1}updateRoomObjectUserFigure(e,t,s,i=null,n=null,a=!1){const o=this.getRoomObjectUser(e,t);return o?(o.processUpdateMessage(new Xu(s,i,n,a)),!0):!1}updateRoomObjectUserFlatControl(e,t,s){const i=this.getRoomObjectUser(e,t);return i?(i.processUpdateMessage(new Up(parseInt(s))),!0):!1}updateRoomObjectUserEffect(e,t,s,i=0){const n=this.getRoomObjectUser(e,t);return n?(n.processUpdateMessage(new bp(s,i)),!0):!1}updateRoomObjectUserGesture(e,t,s){const i=this.getRoomObjectUser(e,t);return i?(i.processUpdateMessage(new Fp(s)),!0):!1}updateRoomObjectUserPetGesture(e,t,s){const i=this.getRoomObjectUser(e,t);return i?(i.processUpdateMessage(new Gp(s)),!0):!1}updateRoomObjectUserPosture(e,t,s,i=null){const n=this.getRoomObjectUser(e,t);return n?(n.processUpdateMessage(new W_(s,i)),!0):!1}updateRoomObjectUserOwn(e,t){const s=this.getRoomObjectUser(e,t);s&&s.processUpdateMessage(new xp)}useRoomObject(e,t){const s=this.getRoomObject(this._activeRoomId,e,t);if(s){const i=s.logic;if(i)return i.useObject(),!0}return!1}objectInitialized(e,t,s){const i=this.getRoomIdFromString(e);s===U.WALL&&this.updateRoomObjectMask(i,t);const n=this.getRoomObject(i,t,s);if(n&&n.model&&n.logic){const a=n.model.getValue(T.FURNITURE_DATA_FORMAT);if(!isNaN(a)){const o=Fi.getData(a);o.initializeFromRoomObjectModel(n.model),n.processUpdateMessage(new Ve(n.getState(0),o))}this.events.dispatchEvent(new ee(ee.CONTENT_UPDATED,i,t,s))}e!==Oe.TEMPORARY_ROOM&&this.addObjectToTileMap(i,n)}changeObjectModelData(e,t,s,i,n){const a=this.getObject(this.getRoomId(e),t,s);if(!a||!a.logic)return!1;const o=new Wp(i,n);return a.processUpdateMessage(o),!0}changeObjectState(e,t,s){const i=this.getObject(this.getRoomId(e),t,s);if(!i||!i.model)return;let n=i.model.getValue(T.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(n)?n=1:n=n+1,i.model.setValue(T.FURNITURE_AUTOMATIC_STATE_INDEX,n);const a=i.model.getValue(T.FURNITURE_DATA_FORMAT),o=Fi.getData(a);o.initializeFromRoomObjectModel(i.model),i.logic&&i.logic.processUpdateMessage(new Ve(n,o))}loadRoomObjectBadgeImage(e,t,s,i,n=!0){if(!this._sessionDataManager)return;let a=null;if(e===0){const u=this._roomManager.getRoomInstance(Oe.TEMPORARY_ROOM);u&&(a=u.getRoomObject(t,s))}else a=this.getRoomObjectFloor(e,t);if(!a||!a.logic)return;let o=n?this._sessionDataManager.loadGroupBadgeImage(i):this._sessionDataManager.loadBadgeImage(i);if(o)this.putBadgeInObjectAssets(a,i,n);else{o="loading_icon",this._badgeListenerObjects||(this._badgeListenerObjects=new Map),this._badgeListenerObjects.size||this._sessionDataManager.events.addEventListener(yn.IMAGE_READY,this.onBadgeImageReadyEvent);let u=this._badgeListenerObjects.get(i);u||(u=[]),u.push(new oY(a,n)),this._badgeListenerObjects.set(i,u)}a.logic.processUpdateMessage(new Na(i,o))}onBadgeImageReadyEvent(e){if(!this._sessionDataManager)return;const t=this._badgeListenerObjects&&this._badgeListenerObjects.get(e.badgeId);if(t){for(const s of t){if(!s)continue;this.putBadgeInObjectAssets(s.object,e.badgeId,s.groupBadge);const i=s.groupBadge?this._sessionDataManager.loadGroupBadgeImage(e.badgeId):this._sessionDataManager.loadBadgeImage(e.badgeId);s.object&&s.object.logic&&s.object.logic.processUpdateMessage(new Na(e.badgeId,i))}this._badgeListenerObjects.delete(e.badgeId),this._badgeListenerObjects.size||this._sessionDataManager.events.removeEventListener(yn.IMAGE_READY,this.onBadgeImageReadyEvent)}}putBadgeInObjectAssets(e,t,s=!1){if(!this._roomContentLoader||!this._sessionDataManager)return;const i=s?this._sessionDataManager.loadGroupBadgeImage(t):this._sessionDataManager.loadBadgeImage(t),n=s?this._sessionDataManager.getGroupBadgeImage(t):this._sessionDataManager.getBadgeImage(t);n&&this._roomContentLoader.addAssetToCollection(e.type,i,n,!1)}dispatchMouseEvent(e,t,s,i,n,a,o,u){const l=this.getRoomInstanceRenderingCanvas(this._activeRoomId,e);if(!l)return;const d=this.getRenderingCanvasOverlay(l),c=this.getOverlayIconSprite(d,Oe.OBJECT_ICON_SPRITE);if(c){const _=c.getLocalBounds();c.x=t-_.width/2,c.y=s-_.height/2}if(!this.handleRoomDragging(l,t,s,i,n,a,o)&&!l.handleMouseEvent(t,s,i,n,a,o,u)){let _=null;i===W.MOUSE_CLICK?(this.events&&this.events.dispatchEvent(new ee(ee.DESELECTED,this._activeRoomId,-1,U.MINIMUM)),_=re.CLICK):i===W.MOUSE_MOVE?_=re.MOUSE_MOVE:i===W.MOUSE_DOWN?_=re.MOUSE_DOWN:i===W.MOUSE_DOWN_LONG?_=re.MOUSE_DOWN_LONG:i===W.MOUSE_UP&&(_=re.MOUSE_UP),this._roomObjectEventHandler.handleRoomObjectEvent(new re(_,this.getRoomObject(this._activeRoomId,Oe.ROOM_OBJECT_ID,U.ROOM),null,n),this._activeRoomId)}this._activeRoomActiveCanvas=e,this._activeRoomActiveCanvasMouseX=t,this._activeRoomActiveCanvasMouseY=s}handleRoomDragging(e,t,s,i,n,a,o){let u=t-this._activeRoomActiveCanvasMouseX,l=s-this._activeRoomActiveCanvasMouseY;if(i===W.MOUSE_DOWN)!n&&!a&&!o&&!this.isDecorating&&this._roomAllowsDragging&&(this._activeRoomIsDragged=!0,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=this._activeRoomActiveCanvasMouseX,this._activeRoomDragStartY=this._activeRoomActiveCanvasMouseY);else if(i===W.MOUSE_UP){if(this._activeRoomIsDragged&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged)){const d=this.getRoomInstanceData(this._activeRoomId);if(d){const c=d.roomCamera;c&&(this.useOffsetScrolling&&(c.isMoving||(c.centeredLocX=!1,c.centeredLocY=!1),c.resetLocation(new y(-e.screenOffsetX,-e.screenOffsetY))),this._roomDraggingAlwaysCenters&&c.reset())}}}else if(i===W.MOUSE_MOVE)this._activeRoomIsDragged&&(this._activeRoomWasDragged||(u=t-this._activeRoomDragStartX,l=s-this._activeRoomDragStartY,(u<=-Oe.DRAG_THRESHOLD||u>=Oe.DRAG_THRESHOLD||l<=-Oe.DRAG_THRESHOLD||l>=Oe.DRAG_THRESHOLD)&&(this._activeRoomWasDragged=!0),u=0,l=0),(u!=0||l!=0)&&(this._activeRoomDragX+=u,this._activeRoomDragY+=l,this._activeRoomWasDragged=!0));else if((i===W.MOUSE_CLICK||i===W.DOUBLE_CLICK)&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged))return this._activeRoomWasDragged=!1,!0;return!1}updateMousePointer(e,t,s){const i=this.getRoomObjectCategoryForType(s);switch(e){case B.MOUSE_BUTTON:this.setMouseButton(this._activeRoomId,i,t);return;default:this.setMouseDefault(this._activeRoomId,i,t);return}}setMouseButton(e,t,s){if(!this._roomSessionManager)return;const i=this._roomSessionManager.getSession(e);if(i&&(t!==U.FLOOR&&t!==U.WALL||i.controllerLevel>=Fs.GUEST)){const n=this.getRoomInstanceData(e);n&&n.addButtonMouseCursorOwner(t+"_"+s)&&(this._mouseCursorUpdate=!0)}}setMouseDefault(e,t,s){if(!this._roomSessionManager)return;const i=this.getRoomInstanceData(e);i&&i.removeButtonMouseCursorOwner(t+"_"+s)&&(this._mouseCursorUpdate=!0)}processRoomObjectOperation(e,t,s){if(!this._roomObjectEventHandler)return!1;this._roomObjectEventHandler.modifyRoomObject(this._activeRoomId,e,t,s)}modifyRoomObjectDataWithMap(e,t,s,i){if(!this._roomObjectEventHandler)return!1;t===U.FLOOR&&this._roomObjectEventHandler.modifyRoomObjectDataWithMap(this._activeRoomId,e,t,s,i)}modifyRoomObjectData(e,t,s,i){if(!this._roomObjectEventHandler)return!1;t===U.WALL&&this._roomObjectEventHandler.modifyWallItemData(this._activeRoomId,e,s,i)}processRoomObjectEvent(e){if(!this._roomObjectEventHandler)return;const t=this.getRoomObjectRoomId(e.object);if(!t)return;const s=this.getRoomIdFromString(t);this._roomObjectEventHandler.handleRoomObjectEvent(e,s)}processRoomObjectPlacement(e,t,s,i,n=null,a=null,o=-1,u=-1,l=null){const d=this.getRoomInstance(this._activeRoomId);return!d||d.model.getValue(ze.ROOM_IS_PUBLIC)!==0||!this._roomObjectEventHandler?!1:this._roomObjectEventHandler.processRoomObjectPlacement(e,this._activeRoomId,t,s,i,n,a,o,u,l)}getRoomObjectScreenLocation(e,t,s,i=-1){i==-1&&(i=this._activeRoomActiveCanvas);const n=this.getRoomInstanceGeometry(e,i);if(!n)return null;const a=this.getRoomObject(e,t,s);if(!a)return null;const o=n.getScreenPoint(a.getLocation());if(!o)return null;const u=this.getRoomInstanceRenderingCanvas(e,i);return u?(o.x=o.x*u.scale,o.y=o.y*u.scale,o.x+=u.width/2+u.screenOffsetX,o.y+=u.height/2+u.screenOffsetY,o.x=Math.round(o.x),o.y=Math.round(o.y),o):null}selectRoomObject(e,t,s){this._roomObjectEventHandler&&this._roomObjectEventHandler.setSelectedObject(e,t,s)}setSelectedAvatar(e,t){this._roomObjectEventHandler||this._roomObjectEventHandler.setSelectedAvatar(e,t,!0)}cancelRoomObjectInsert(){this._roomObjectEventHandler&&this._roomObjectEventHandler.cancelRoomObjectInsert(this._activeRoomId)}addOverlayIconSprite(e,t,s,i=1){if(!e||!s)return;let n=this.getOverlayIconSprite(e,t);return n?null:(n=new ot(s),n.name=t,n.scale.set(i),e.addChild(n),n)}onRoomContentLoaded(e,t,s){if(!this._roomContentLoader||e===-1)return;this._thumbnailObjectIdBank.freeNumber(e-1);const i=this._thumbnailCallbacks.get(t);if(i){this._thumbnailCallbacks.delete(t);const n=this._roomContentLoader.getImage(t);if(n)for(const a of i)a&&a.imageReady(e,null,n)}}setObjectMoverIconSprite(e,t,s,i=null,n=null,a=-1,o=-1,u=null){let l=null,d=0,c=null;const _=1;if(s)c=this.getRoomObjectImage(this._activeRoomId,e,t,new y,1,null);else if(this._roomContentLoader)if(t===U.FLOOR?(l=this._roomContentLoader.getFurnitureFloorNameForTypeId(e),d=this._roomContentLoader.getFurnitureFloorColorIndex(e)):t===U.WALL&&(l=this._roomContentLoader.getFurnitureWallNameForTypeId(e,i),d=this._roomContentLoader.getFurnitureWallColorIndex(e)),t===U.UNIT)if(l=me.getTypeString(e),l==="pet"){l=this.getPetType(i);const p=new ul(i);c=this.getRoomObjectPetImage(p.typeId,p.paletteId,p.color,new y(180),64,null,!0,0,p.customParts,u)}else c=this.getGenericRoomObjectImage(l,i,new y(180),64,null,0,null,n,a,o,u);else c=this.getGenericRoomObjectImage(l,d.toString(),new y,1,null,0,i,n,a,o,u);if(!c||!c.data)return;const f=this.getActiveRoomInstanceRenderingCanvas();if(!f)return;const g=this.getRenderingCanvasOverlay(f);this.removeOverlayIconSprite(g,Oe.OBJECT_ICON_SPRITE);const I=this.addOverlayIconSprite(g,Oe.OBJECT_ICON_SPRITE,c.data,_);I&&(I.x=this._activeRoomActiveCanvasMouseX-c.data.width/2,I.y=this._activeRoomActiveCanvasMouseY-c.data.height/2)}getRoomObjectImage(e,t,s,i,n,a,o=0){if(!this._roomManager)return null;let u=-1,l=null,d=null,c="",_=null;const f=this.getRoomId(e),g=this._roomManager.getRoomInstance(f);if(g){const I=g.getRoomObject(t,s);if(I&&I.model)switch(u=I.id,l=I.type,s){case U.FLOOR:case U.WALL:{c=I.model.getValue(T.FURNITURE_COLOR).toString(),_=I.model.getValue(T.FURNITURE_EXTRAS);const p=I.model.getValue(T.FURNITURE_DATA_FORMAT);p!==ns.FORMAT_KEY&&(d=Fi.getData(p),d.initializeFromRoomObjectModel(I.model));break}case U.UNIT:c=I.model.getValue(T.FIGURE);break}}return this.getGenericRoomObjectImage(l,c,i,n,a,o,_,d,-1,-1,null,u)}getFurnitureFloorIconUrl(e){let t=null,s="";return this._roomContentLoader?(t=this._roomContentLoader.getFurnitureFloorNameForTypeId(e),s=this._roomContentLoader.getFurnitureFloorColorIndex(e).toString(),this._roomContentLoader.getAssetIconUrl(t,s)):null}getFurnitureFloorIcon(e,t,s=null,i=null){return this.getFurnitureFloorImage(e,new y,1,t,0,s,-1,-1,i)}getFurnitureWallIconUrl(e,t=null){let s=null,i="";return this._roomContentLoader?(s=this._roomContentLoader.getFurnitureWallNameForTypeId(e,t),i=this._roomContentLoader.getFurnitureWallColorIndex(e).toString(),this._roomContentLoader.getAssetIconUrl(s,i)):null}getFurnitureWallIcon(e,t,s=null){return this.getFurnitureWallImage(e,new y,1,t,0,s)}getFurnitureFloorImage(e,t,s,i,n=0,a=null,o=-1,u=-1,l=null){let d=null,c="";return this._roomContentLoader&&(d=this._roomContentLoader.getFurnitureFloorNameForTypeId(e),c=this._roomContentLoader.getFurnitureFloorColorIndex(e).toString()),s===1&&i?this.getGenericRoomObjectThumbnail(d,c,i,a,l):this.getGenericRoomObjectImage(d,c,t,s,i,n,a,l,o,u)}getFurnitureWallImage(e,t,s,i,n=0,a=null,o=-1,u=-1){let l=null,d="";return this._roomContentLoader&&(l=this._roomContentLoader.getFurnitureWallNameForTypeId(e),d=this._roomContentLoader.getFurnitureWallColorIndex(e).toString()),s===1&&i?this.getGenericRoomObjectThumbnail(l,d,i,a,null):this.getGenericRoomObjectImage(l,d,t,s,i,n,a,null,o,u)}getRoomObjectPetImage(e,t,s,i,n,a,o=!1,u=0,l=null,d=null){let c=null,_=e+" "+t+" "+s.toString(16);if(o&&(_=_+" head"),l){_=_+(" "+l.length);for(const f of l)_=_+(" "+f.layerId+" "+f.partId+" "+f.paletteId)}return this._roomContentLoader&&(c=this._roomContentLoader.getPetNameForType(e)),this.getGenericRoomObjectImage(c,_,i,n,a,u,null,null,-1,-1,d)}getGenericRoomObjectImage(e,t,s,i,n,a=0,o=null,u=null,l=-1,d=-1,c=null,_=-1){if(!this._roomManager)return null;const f=new Mp;if(f.id=-1,!this._ready||!e)return f;let g=this._roomManager.getRoomInstance(Oe.TEMPORARY_ROOM);if(!g&&(g=this._roomManager.createRoomInstance(Oe.TEMPORARY_ROOM),!g))return f;let I=this._imageObjectIdBank.reserveNumber();const p=this.getRoomObjectCategoryForType(e);if(I<0)return f;I++;const R=g.createRoomObjectAndInitalize(I,e,p);if(!R||!R.model||!R.logic)return f;const S=R.model;switch(p){case U.FLOOR:case U.WALL:S.setValue(T.FURNITURE_COLOR,parseInt(t)),S.setValue(T.FURNITURE_EXTRAS,o);break;case U.UNIT:if(e===me.USER||e===me.BOT||e===me.RENTABLE_BOT||e===me.PET)S.setValue(T.FIGURE,t);else{const M=new ul(t);S.setValue(T.PET_PALETTE_INDEX,M.paletteId),S.setValue(T.PET_COLOR,M.color),M.headOnly&&S.setValue(T.PET_HEAD_ONLY,1),M.hasCustomParts&&(S.setValue(T.PET_CUSTOM_LAYER_IDS,M.customLayerIds),S.setValue(T.PET_CUSTOM_PARTS_IDS,M.customPartIds),S.setValue(T.PET_CUSTOM_PALETTE_IDS,M.customPaletteIds)),c&&S.setValue(T.FIGURE_POSTURE,c)}break;case U.ROOM:break}R.setDirection(s);const O=R.visualization;if(!O)return g.removeRoomObject(I,p),f;(l>-1||u)&&(u&&u.getLegacyString()!==""?R.logic.processUpdateMessage(new Ve(parseInt(u.getLegacyString()),u)):R.logic.processUpdateMessage(new Ve(l,u)));const A=new ys(i,new y(-135,30,0),new y(11,11,5));if(O.update(A,0,!0,!1),d>0){let M=0;for(;M<d;)O.update(A,0,!0,!1),M++}const C=O.getImage(a,_);if(f.data=C,f.id=I,!this.isRoomContentTypeLoaded(e)&&n){let M=this._imageCallbacks.get(I.toString());M||(M=[],this._imageCallbacks.set(I.toString(),M)),M.push(n),S.setValue(T.IMAGE_QUERY_SCALE,i)}else g.removeRoomObject(I,p),this._imageObjectIdBank.freeNumber(I-1),f.id=0;return A.dispose(),f}getGenericRoomObjectThumbnail(e,t,s,i=null,n=null){if(!this._roomManager)return null;const a=new Mp;if(a.id=-1,!this._ready||!e)return a;let o=this._roomManager.getRoomInstance(Oe.TEMPORARY_ROOM);if(!o&&(o=this._roomManager.createRoomInstance(Oe.TEMPORARY_ROOM),!o))return a;let u=this._thumbnailObjectIdBank.reserveNumber();if(this.getRoomObjectCategoryForType(e),u<0)return a;u++,a.id=u,a.data=null,a.image=null;const l=[e,t].join("_"),d=this._roomContentLoader.getImage(l);if(!d&&s){let c=this._thumbnailCallbacks.get(l);c||(c=[],this._thumbnailCallbacks.set(l,c),this._roomContentLoader.downloadImage(u,e,t,null)),c.push(s)}else d&&(a.image=d),this._thumbnailObjectIdBank.freeNumber(u-1),a.id=0;return a}initalizeTemporaryObjectsByType(e,t){const s=this._roomManager.getRoomInstance(Oe.TEMPORARY_ROOM);if(!s||!this._roomContentLoader)return;const i=this._roomContentLoader.getCategoryForType(e),n=s.getManager(i);let a=null,o=0;if(n&&n.objects.length){for(const u of n.objects.getValues())if(u&&u.model&&u.type===e){const l=u.id,d=u.visualization;let c=null;if(d){const f=u.model.getValue(T.IMAGE_QUERY_SCALE);a&&o!==f&&(a.dispose(),a=null),a||(o=f,a=new ys(f,new y(-135,30,0),new y(11,11,5))),d.update(a,0,!0,!1),c=d.image}s.removeRoomObject(l,i),this._imageObjectIdBank.freeNumber(l-1);const _=this._imageCallbacks.get(l.toString());if(_){this._imageCallbacks.delete(l.toString());for(const f of _)f&&(c?f.imageReady(l,c):f.imageFailed(l))}}}a&&a.dispose()}setObjectMoverIconSpriteVisible(e){const t=this.getActiveRoomInstanceRenderingCanvas();if(!t)return;const s=this.getRenderingCanvasOverlay(t),i=this.getOverlayIconSprite(s,Oe.OBJECT_ICON_SPRITE);i&&(i.visible=e)}removeObjectMoverIconSprite(){const e=this.getActiveRoomInstanceRenderingCanvas();if(!e)return;const t=this.getRenderingCanvasOverlay(e);this.removeOverlayIconSprite(t,Oe.OBJECT_ICON_SPRITE)}getRenderingCanvasOverlay(e){if(!e)return null;const t=e.master;return t&&t.getChildByName(Oe.OVERLAY)||null}removeOverlayIconSprite(e,t){if(!e)return!1;let s=e.children.length-1;for(;s>=0;){const i=e.getChildAt(s);if(i&&i.name===t){if(e.removeChildAt(s),i.children.length){const n=i.getChildAt(0);n.parent.removeChild(n),n.destroy()}return!0}s--}return!1}getOverlayIconSprite(e,t){if(!e)return null;let s=e.children.length-1;for(;s>=0;){const i=e.getChildAt(s);if(i&&i.name===t)return i;s--}return null}getRoomObjects(e,t){if(this._ready){const s=this.getRoomId(e),i=this._roomManager.getRoomInstance(s);if(i)return i.getRoomObjectsForCategory(t)}return[]}addObjectToTileMap(e,t){const s=this.getRoomInstanceData(e).tileObjectMap;s&&s.addRoomObject(t)}refreshTileObjectMap(e,t){const s=this.getRoomInstanceData(e).tileObjectMap;s&&s.populate(this.getRoomObjects(e,U.FLOOR))}getRenderRoomMessage(e,t,s=!1,i=!0,n=!1,a=-1){let o=null;if(a>-1?o=this.getRoomInstanceRenderingCanvas(this._activeRoomId,a):o=this.getActiveRoomInstanceRenderingCanvas(),!o)return null;n&&o.skipSpriteVisibilityChecking();let u=-1;!i&&this._roomSessionManager.getSession(this._activeRoomId)!=null&&(u=this._roomSessionManager.getSession(this._activeRoomId).ownRoomIndex);const l=new Is,d=l.getFurniData(e,o,this,u),c=l.getRoomRenderingModifiers(this),_=l.getRoomPlanes(e,o,this,t);return n&&o.resumeSpriteVisibilityChecking(),Y.log(d,c,_),null}createTextureFromRoom(e,t=-1,s=null){let i=null;t>-1?i=this.getRoomInstanceRenderingCanvas(this._activeRoomId,t):i=this.getActiveRoomInstanceRenderingCanvas();let n=null;return s?n=Je.generateTexture(i.master,s):n=i.getDisplayAsTexture(),n}saveTextureAsScreenshot(e,t=!1){let s=null;t?s=new F_:s=new Vu,s.assignBitmap(e),this._communication.connection.send(s)}saveBase64AsScreenshot(e,t=!1){let s=null;t?s=new F_:s=new Vu,s.assignBase64(e),this._communication.connection.send(s)}objectsInitialized(e){const t=this.getRoomIdFromString(e);this.events.dispatchEvent(new Ue(Ue.OBJECTS_INITIALIZED,t))}getRoomId(e){return e.toString()}getRoomIdFromString(e){if(!e)return-1;const t=e.split("_");return t.length<=0?-1:parseInt(t[0])||0}getRoomObjectRoomId(e){return!e||!e.model?null:e.model.getValue(T.OBJECT_ROOM_ID)}getRoomObjectAdUrl(e){return this._roomContentLoader.getRoomObjectAdUrl(e)}getPetTypeId(e){let t=-1;if(e){const s=e.split(" ");s.length>1&&(t=parseInt(s[0]))}return t}getPetType(e){if(!e)return null;const t=e.split(" ");if(t.length>1){const s=parseInt(t[0]);return this._roomContentLoader?this._roomContentLoader.getPetNameForType(s):"pet"}return null}isRoomContentTypeLoaded(e){return this._roomContentLoader?this._roomContentLoader.getCollection(e)!==null:!1}getPetColorResult(e,t){return this._roomContentLoader?this._roomContentLoader.getPetColorResult(e,t):null}getPetColorResultsForTag(e,t){return this._roomContentLoader?this._roomContentLoader.getPetColorResultsForTag(e,t):null}deleteRoomObject(e,t){return!this._roomObjectEventHandler||t!==U.WALL?!1:this._roomObjectEventHandler.deleteWallItem(this._activeRoomId,e)}get connection(){return this._communication.connection}get sessionDataManager(){return this._sessionDataManager}set sessionDataManager(e){this._sessionDataManager=e}get roomSessionManager(){return this._roomSessionManager}set roomSessionManager(e){this._roomSessionManager=e}get roomManager(){return this._roomManager}set roomManager(e){this._roomManager=e}get objectEventHandler(){return this._roomObjectEventHandler}get roomRendererFactory(){return this._roomRendererFactory}get visualizationFactory(){return this._visualizationFactory}get logicFactory(){return this._logicFactory}get activeRoomId(){return this._activeRoomId}get ready(){return this._ready}get roomContentLoader(){return this._roomContentLoader}get isDecorating(){if(!this._roomSessionManager)return!1;const e=this._roomSessionManager.getSession(this._activeRoomId);return e&&e.isDecorating||!1}get useOffsetScrolling(){return!0}get selectedAvatarId(){return this._roomObjectEventHandler?this._roomObjectEventHandler.selectedAvatarId:-1}getRoomObjectCount(e,t){return this._roomManager==null?0:this._roomManager.getRoomInstance(e.toString()).getRoomObjectsForCategory(t).length}}Oe.ROOM_OBJECT_ID=-1,Oe.ROOM_OBJECT_TYPE="room",Oe.CURSOR_OBJECT_ID=-2,Oe.CURSOR_OBJECT_TYPE="tile_cursor",Oe.ARROW_OBJECT_ID=-3,Oe.ARROW_OBJECT_TYPE="selection_arrow",Oe.OVERLAY="overlay",Oe.OBJECT_ICON_SPRITE="object_icon_sprite",Oe.DRAG_THRESHOLD=15,Oe.TEMPORARY_ROOM="temporary_room";class V{constructor(e,t=1){this._previewRoomId=1,this._currentPreviewObjectType=0,this._currentPreviewObjectCategory=0,this._currentPreviewObjectData="",this._currentPreviewRectangle=null,this._currentPreviewCanvasWidth=0,this._currentPreviewCanvasHeight=0,this._currentPreviewScale=64,this._backgroundColor=305148561,this._backgroundSprite=null,this._disableUpdate=!1,this._roomEngine=e,this._planeParser=new te,this._previewRoomId=Oa.makeRoomPreviewerId(t),this._addViewOffset=new k(0,0),this.onRoomObjectAdded=this.onRoomObjectAdded.bind(this),this.onRoomInitializedonRoomInitialized=this.onRoomInitializedonRoomInitialized.bind(this),this.isRoomEngineReady&&this._roomEngine.events&&(this._roomEngine.events.addEventListener(ee.ADDED,this.onRoomObjectAdded),this._roomEngine.events.addEventListener(ee.CONTENT_UPDATED,this.onRoomObjectAdded),this._roomEngine.events.addEventListener(Ue.INITIALIZED,this.onRoomInitializedonRoomInitialized)),this.createRoomForPreview()}dispose(){this.reset(!0),this.isRoomEngineReady&&this._roomEngine.events&&(this._roomEngine.events.removeEventListener(ee.ADDED,this.onRoomObjectAdded),this._roomEngine.events.removeEventListener(ee.CONTENT_UPDATED,this.onRoomObjectAdded),this._roomEngine.events.removeEventListener(Ue.INITIALIZED,this.onRoomInitializedonRoomInitialized)),this._backgroundSprite&&(this._backgroundSprite.destroy(),this._backgroundSprite=null),this._planeParser&&(this._planeParser.dispose(),this._planeParser=null)}createRoomForPreview(){if(this.isRoomEngineReady){const t=new te;t.initializeTileMap(7+2,7+2);let s=1;for(;s<1+7;){let i=1;for(;i<1+7;)t.setTileHeight(i,s,0),i++;s++}t.initializeFromTileData(),this._roomEngine.createRoomInstance(this._previewRoomId,t.getMapData()),t.dispose()}}reset(e){this.isRoomEngineReady&&(this._roomEngine.removeRoomObjectFloor(this._previewRoomId,V.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectWall(this._previewRoomId,V.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectUser(this._previewRoomId,V.PREVIEW_OBJECT_ID),e||this.updatePreviewRoomView()),this._currentPreviewObjectCategory=U.MINIMUM}updatePreviewModel(e,t,s=!0){const i=new Aa;i.flush(),i.parseModel(e,t,s);const n=this._roomEngine.getLegacyWallGeometry(this._previewRoomId);if(!n)return;this._planeParser.reset();const a=i.width,o=i.height;this._planeParser.initializeTileMap(a,o);const u=null;let l=-1,d=-1,c=0,_=0,f=0;for(;f<o;){let R=0;for(;R<a;){const S=i.getHeight(R,f);(f>0&&f<o-1||R>0&&R<a-1)&&S!=te.TILE_BLOCKED&&u==null&&(i.getHeight(R,f-1)==te.TILE_BLOCKED&&i.getHeight(R-1,f)==te.TILE_BLOCKED&&i.getHeight(R,f+1)==te.TILE_BLOCKED&&(l=R+.5,d=f,c=S,_=90),i.getHeight(R,f-1)==te.TILE_BLOCKED&&i.getHeight(R-1,f)==te.TILE_BLOCKED&&i.getHeight(R+1,f)==te.TILE_BLOCKED&&(l=R,d=f+.5,c=S,_=180)),this._planeParser.setTileHeight(R,f,S),R++}f++}this._planeParser.setTileHeight(Math.floor(l),Math.floor(d),c),this._planeParser.initializeFromTileData(i.wallHeight),this._planeParser.setTileHeight(Math.floor(l),Math.floor(d),c+this._planeParser.wallHeight),n.scale=ps.DEFAULT_SCALE,n.initialize(a,o,this._planeParser.floorHeight);let g=i.height-1;for(;g>=0;){let R=i.width-1;for(;R>=0;)n.setHeight(R,g,this._planeParser.getTileHeight(R,g)),R--;g--}const I=this._planeParser.getMapData();I.doors.push({x:l,y:d,z:c,dir:_});const p=this.getRoomPreviewOwnRoomObject();p&&p.processUpdateMessage(new Yo(I))}addFurnitureIntoRoom(e,t,s=null,i=null){if(s||(s=new ns),this.isRoomEngineReady&&(this.reset(!1),this._currentPreviewObjectType=e,this._currentPreviewObjectCategory=U.FLOOR,this._currentPreviewObjectData="",this._roomEngine.addFurnitureFloor(this._previewRoomId,V.PREVIEW_OBJECT_ID,e,new y(V.PREVIEW_OBJECT_LOCATION_X,V.PREVIEW_OBJECT_LOCATION_Y,0),t,0,s,NaN,-1,0,-1,"",!0,!1))){this._previousAutomaticStateChangeTime=ve(),this._automaticStateChange=!0;const n=this._roomEngine.getRoomObject(this._previewRoomId,V.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);return n&&i&&n.model.setValue(T.FURNITURE_EXTRAS,i),this.updatePreviewRoomView(),V.PREVIEW_OBJECT_ID}return-1}addWallItemIntoRoom(e,t,s){if(this.isRoomEngineReady){if(this._currentPreviewObjectCategory===U.WALL&&this._currentPreviewObjectType===e&&this._currentPreviewObjectData===s)return V.PREVIEW_OBJECT_ID;if(this.reset(!1),this._currentPreviewObjectType=e,this._currentPreviewObjectCategory=U.WALL,this._currentPreviewObjectData=s,this._roomEngine.addFurnitureWall(this._previewRoomId,V.PREVIEW_OBJECT_ID,e,new y(.5,2.3,1.8),t,0,s,0,0,-1,"",!1))return this._previousAutomaticStateChangeTime=ve(),this._automaticStateChange=!0,this.updatePreviewRoomView(),V.PREVIEW_OBJECT_ID}return-1}addAvatarIntoRoom(e,t){return this.isRoomEngineReady?(this.reset(!1),this._currentPreviewObjectType=1,this._currentPreviewObjectCategory=U.UNIT,this._currentPreviewObjectData=e,this._roomEngine.addRoomObjectUser(this._previewRoomId,V.PREVIEW_OBJECT_ID,new y(V.PREVIEW_OBJECT_LOCATION_X,V.PREVIEW_OBJECT_LOCATION_Y,0),new y(90,0,0),135,me.getTypeNumber(me.USER),e)&&(this._previousAutomaticStateChangeTime=ve(),this._automaticStateChange=!0,this.updateUserGesture(1),this.updateUserEffect(t),this.updateUserPosture("std")),this.updatePreviewRoomView(),V.PREVIEW_OBJECT_ID):-1}addPetIntoRoom(e){return this.isRoomEngineReady?(this.reset(!1),this._currentPreviewObjectType=1,this._currentPreviewObjectCategory=U.UNIT,this._currentPreviewObjectData=e,this._roomEngine.addRoomObjectUser(this._previewRoomId,V.PREVIEW_OBJECT_ID,new y(V.PREVIEW_OBJECT_LOCATION_X,V.PREVIEW_OBJECT_LOCATION_Y,0),new y(90,0,0),90,me.getTypeNumber(me.PET),e)&&(this._previousAutomaticStateChangeTime=ve(),this._automaticStateChange=!1,this.updateUserGesture(1),this.updateUserPosture("std")),this.updatePreviewRoomView(),V.PREVIEW_OBJECT_ID):-1}updateUserPosture(e,t=""){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserPosture(this._previewRoomId,V.PREVIEW_OBJECT_ID,e,t)}updateUserGesture(e){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserGesture(this._previewRoomId,V.PREVIEW_OBJECT_ID,e)}updateUserEffect(e){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserEffect(this._previewRoomId,V.PREVIEW_OBJECT_ID,e)}updateObjectUserFigure(e,t=null,s=null,i=!1){return this.isRoomEngineReady?this._roomEngine.updateRoomObjectUserFigure(this._previewRoomId,V.PREVIEW_OBJECT_ID,e,t,s,i):!1}updateObjectUserAction(e,t,s=null){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserAction(this._previewRoomId,V.PREVIEW_OBJECT_ID,e,t,s)}updateObjectStuffData(e){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectFloor(this._previewRoomId,V.PREVIEW_OBJECT_ID,null,null,e.state,e)}changeRoomObjectState(){this.isRoomEngineReady&&(this._automaticStateChange=!1,this._currentPreviewObjectCategory!==U.UNIT&&this._roomEngine.changeObjectState(this._previewRoomId,V.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}changeRoomObjectDirection(){if(this.isRoomEngineReady){const e=this._roomEngine.getRoomObject(this._previewRoomId,V.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(!e)return;const t=this._roomEngine.objectEventHandler.getValidRoomObjectDirection(e,!0);switch(this._currentPreviewObjectCategory){case U.FLOOR:{const s=new y(V.PREVIEW_OBJECT_LOCATION_X,V.PREVIEW_OBJECT_LOCATION_Y),i=new y(t,t,t);this._roomEngine.updateRoomObjectFloor(this._previewRoomId,V.PREVIEW_OBJECT_ID,s,i,null,null);return}case U.WALL:return}}}checkAutomaticRoomObjectStateChange(){if(this._automaticStateChange){const e=ve();e>this._previousAutomaticStateChangeTime+V.AUTOMATIC_STATE_CHANGE_INTERVAL&&(this._previousAutomaticStateChangeTime=e,this.isRoomEngineReady&&this._roomEngine.changeObjectState(this._previewRoomId,V.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}}getRoomCanvas(e,t){if(this.isRoomEngineReady){const s=this._roomEngine.getRoomInstanceDisplay(this._previewRoomId,V.PREVIEW_CANVAS_ID,e,t,this._currentPreviewScale);if(s&&this._backgroundColor!==null){let n=this._backgroundSprite;n||(n=new ot(Re.WHITE),s.addChildAt(n,0)),n.width=e,n.height=t,n.tint=this._backgroundColor}this._roomEngine.setRoomInstanceRenderingCanvasMask(this._previewRoomId,V.PREVIEW_CANVAS_ID,!0);const i=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,V.PREVIEW_CANVAS_ID);return i&&i.adjustLocation(new y(V.PREVIEW_OBJECT_LOCATION_X,V.PREVIEW_OBJECT_LOCATION_Y,0),30),this._currentPreviewCanvasWidth=e,this._currentPreviewCanvasHeight=t,s}return null}modifyRoomCanvas(e,t){this.isRoomEngineReady&&(this._currentPreviewCanvasWidth=e,this._currentPreviewCanvasHeight=t,this._backgroundSprite&&(this._backgroundSprite.width=e,this._backgroundSprite.height=t),this._roomEngine.initializeRoomInstanceRenderingCanvas(this._previewRoomId,V.PREVIEW_CANVAS_ID,e,t))}set addViewOffset(e){this._addViewOffset=e}get addViewOffset(){return this._addViewOffset}updatePreviewObjectBoundingRectangle(e){const t=this._roomEngine.getRoomObjectBoundingRectangle(this._previewRoomId,V.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,V.PREVIEW_CANVAS_ID);if(t&&e)if(t.x+=-(this._currentPreviewCanvasWidth>>1),t.y+=-(this._currentPreviewCanvasHeight>>1),t.x+=-e.x,t.y+=-e.y,!this._currentPreviewRectangle)this._currentPreviewRectangle=t;else{const s=this._currentPreviewRectangle.clone().enlarge(t);(s.width-this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth-this._currentPreviewRectangle.width>>1||s.height-this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1||this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)&&(this._currentPreviewRectangle=s)}}validatePreviewSize(e){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return e;if(this.isRoomEngineReady){const t=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,V.PREVIEW_CANVAS_ID);this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth*(1+V.ALLOWED_IMAGE_CUT)||this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight*(1+V.ALLOWED_IMAGE_CUT)?V.ZOOM_ENABLED?this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,V.PREVIEW_CANVAS_ID)!==.5&&(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,V.PREVIEW_CANVAS_ID,.5,null,null),this._currentPreviewScale=V.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0,e.x=e.x>>1,e.y=e.y>>1,this._currentPreviewRectangle.x=this._currentPreviewRectangle.x>>2,this._currentPreviewRectangle.y=this._currentPreviewRectangle.y>>2,this._currentPreviewRectangle.width=this._currentPreviewRectangle.width>>2,this._currentPreviewRectangle.height=this._currentPreviewRectangle.height>>2):t.isZoomedIn()&&(t.performZoomOut(),this._currentPreviewScale=V.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0):this._currentPreviewNeedsZoomOut||(V.ZOOM_ENABLED?this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,V.PREVIEW_CANVAS_ID)!==1&&(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,V.PREVIEW_CANVAS_ID,1,null,null),this._currentPreviewScale=V.SCALE_NORMAL):t.isZoomedIn()||(t.performZoomIn(),this._currentPreviewScale=V.SCALE_NORMAL))}return e}zoomIn(){this.isRoomEngineReady&&(V.ZOOM_ENABLED?this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,V.PREVIEW_CANVAS_ID,1):this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,V.PREVIEW_CANVAS_ID).performZoomIn()),this._currentPreviewScale=V.SCALE_NORMAL}zoomOut(){this.isRoomEngineReady&&(V.ZOOM_ENABLED?this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,V.PREVIEW_CANVAS_ID,.5):this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,V.PREVIEW_CANVAS_ID).performZoomOut()),this._currentPreviewScale=V.SCALE_SMALL}updateAvatarDirection(e,t){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserLocation(this._previewRoomId,V.PREVIEW_OBJECT_ID,new y(V.PREVIEW_OBJECT_LOCATION_X,V.PREVIEW_OBJECT_LOCATION_Y,0),new y(V.PREVIEW_OBJECT_LOCATION_X,V.PREVIEW_OBJECT_LOCATION_Y,0),!1,0,new y(e*45,0,0),t*45)}updateObjectRoom(e=null,t=null,s=null,i=!1){return this.isRoomEngineReady?this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,e,t,s,i):!1}updateRoomWallsAndFloorVisibility(e,t=!0){this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneVisibility(this._previewRoomId,e,t)}getCanvasOffset(e){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return e;let t=-(this._currentPreviewRectangle.left+this._currentPreviewRectangle.right)>>1,s=-(this._currentPreviewRectangle.top+this._currentPreviewRectangle.bottom)>>1;const i=this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1;i>10?s=s+Math.min(15,i-10):this._currentPreviewObjectCategory!==U.UNIT?s=s+(5-Math.max(0,i/2)):s=s-(5-Math.min(0,i/2)),s=s+this._addViewOffset.y,t=t+this._addViewOffset.x;const n=t-e.x,a=s-e.y;if(n!==0||a!==0){const o=Math.sqrt(n*n+a*a);return o>10&&(t=e.x+n*10/o,s=e.y+a*10/o),new k(t,s)}return null}updatePreviewRoomView(e=!1){if(!(this._disableUpdate&&!e)&&(this.checkAutomaticRoomObjectStateChange(),this.isRoomEngineReady)){let t=this._roomEngine.getRoomInstanceRenderingCanvasOffset(this._previewRoomId,V.PREVIEW_CANVAS_ID);if(t&&(this.updatePreviewObjectBoundingRectangle(t),this._currentPreviewRectangle)){const s=this._currentPreviewScale;t=this.validatePreviewSize(t);const i=this.getCanvasOffset(t);i&&this._roomEngine.setRoomInstanceRenderingCanvasOffset(this._previewRoomId,V.PREVIEW_CANVAS_ID,i),this._currentPreviewScale!==s&&(this._currentPreviewRectangle=null)}}}set disableUpdate(e){this._disableUpdate=e}set disableRoomEngineUpdate(e){this.isRoomEngineReady&&this._roomEngine.disableUpdate(e)}onRoomInitializedonRoomInitialized(e){if(e)switch(e.type){case Ue.INITIALIZED:e.roomId===this._previewRoomId&&this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,"110","99999");return}}onRoomObjectAdded(e){if(e.roomId===this._previewRoomId&&e.objectId===V.PREVIEW_OBJECT_ID&&e.category===this._currentPreviewObjectCategory){this._currentPreviewRectangle=null,this._currentPreviewNeedsZoomOut=!1;const t=this._roomEngine.getRoomObject(e.roomId,e.objectId,e.category);if(t&&t.model&&e.category===U.WALL){const s=t.model.getValue(T.FURNITURE_SIZE_Z),i=t.model.getValue(T.FURNITURE_CENTER_Z);(s!==null||i!==null)&&this._roomEngine.updateRoomObjectWallLocation(e.roomId,e.objectId,new y(.5,2.3,(3.6-s)/2+i))}}}updateRoomEngine(){this.isRoomEngineReady&&this._roomEngine.runUpdate()}getRenderingCanvas(){const e=this._roomEngine.getRoomInstanceRenderingCanvas(this._previewRoomId,V.PREVIEW_CANVAS_ID);return e||null}getGenericRoomObjectImage(e,t,s,i,n,a=0,o=null,u=null,l=-1,d=-1,c=null){return this.isRoomEngineReady?this._roomEngine.getGenericRoomObjectImage(e,t,s,i,n,a,o,u,l,d,c):null}getRoomObjectImage(e,t,s,i=0){return this.isRoomEngineReady?this._roomEngine.getRoomObjectImage(this._previewRoomId,V.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,e,t,s,i):null}getRoomObjectCurrentImage(){if(this.isRoomEngineReady){const e=this._roomEngine.getRoomObject(this._previewRoomId,V.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(e&&e.visualization)return e.visualization.getImage(16777215,-1)}return null}getRoomPreviewObject(){if(this.isRoomEngineReady){const e=this._roomEngine.getRoomObject(this._previewRoomId,V.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(e)return e}return null}getRoomPreviewOwnRoomObject(){if(this.isRoomEngineReady){const e=this._roomEngine.getRoomObject(this._previewRoomId,Oe.ROOM_OBJECT_ID,U.ROOM);if(e)return e}return null}get isRoomEngineReady(){return this._roomEngine&&this._roomEngine.ready}get roomId(){return this._previewRoomId}get backgroundColor(){return this._backgroundColor}set backgroundColor(e){this._backgroundColor=e}get width(){return this._currentPreviewCanvasWidth}get height(){return this._currentPreviewCanvasHeight}}V.SCALE_NORMAL=64,V.SCALE_SMALL=32,V.PREVIEW_COUNTER=0,V.PREVIEW_CANVAS_ID=1,V.PREVIEW_OBJECT_ID=1,V.PREVIEW_OBJECT_LOCATION_X=2,V.PREVIEW_OBJECT_LOCATION_Y=2,V.ALLOWED_IMAGE_CUT=.25,V.AUTOMATIC_STATE_CHANGE_INTERVAL=2500,V.ZOOM_ENABLED=!0;class dI{constructor(e,t){this._image=e,this._placeHolder=t}get image(){return this._image}get placeHolder(){return this._placeHolder}}class cY{constructor(e){this._code=e,this._parts=[]}get code(){return this._code}get parts(){return this._parts}}class nt{constructor(e,t=0,s=0,i=0){this.type=e,this.key=t,this.color=s,this.position=i}get code(){return this.key===0?null:nt.getCode(this.type,this.key,this.color,this.position)}static getCode(e,t,s,i){return(e===nt.BASE?e:t>=100?nt.SYMBOL_ALT:nt.SYMBOL)+(t<10?"0":"")+(e===nt.BASE?t:t>=100?t-100:t)+(s<10?"0":"")+s+i}calculatePosition(e){const t=this.calculateGridPos(this.position);let s=nt.CELL_WIDTH*t.x+nt.CELL_WIDTH/2-e.width/2,i=nt.CELL_HEIGHT*t.y+nt.CELL_HEIGHT/2-e.height/2;return s<0&&(s=0),s+e.width>nt.IMAGE_WIDTH&&(s=nt.IMAGE_WIDTH-e.width),i<0&&(i=0),i+e.height>nt.IMAGE_HEIGHT&&(i=nt.IMAGE_HEIGHT-e.height),new Hh(Math.floor(s),Math.floor(i))}calculateGridPos(e){const t=new Hh;return t.x=Math.floor(e%3),t.y=Math.floor(e/3),t}}nt.BASE="b",nt.SYMBOL="s",nt.SYMBOL_ALT="t",nt.BASE_PART=0,nt.LAYER_PART=1,nt.IMAGE_WIDTH=39,nt.IMAGE_HEIGHT=39,nt.CELL_WIDTH=13,nt.CELL_HEIGHT=13;class Ts{constructor(e,t){this._assets=e,this._sessionDataManager=t,this._groupBases=new Map,this._groupSymbols=new Map,this._groupPartColors=new Map,this._requestedBadges=new Map,this._groupBadgesQueue=new Map,this._readyToGenerateGroupBadges=!1}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new Xg(this.onGroupBadgePartsEvent.bind(this))];for(const e of this._messages)this._sessionDataManager.communication.registerMessageEvent(e)}}dispose(){if(this._messages&&this._messages.length){for(const e of this._messages)this._sessionDataManager.communication.removeMessageEvent(e);this._messages=null}this._sessionDataManager=null}getBadgeImage(e,t=Ts.NORMAL_BADGE,s=!0){let i=this.getBadgeTexture(e,t);return!i&&s&&(i=this.getBadgePlaceholder()),i}getBadgeInfo(e){const t=this.getBadgeTexture(e);return t?new dI(t,!1):new dI(this.getBadgePlaceholder(),!0)}loadBadgeImage(e,t=Ts.NORMAL_BADGE){return this._assets.getTexture(this.getBadgeUrl(e,t))?e:(this.getBadgeTexture(e,t),null)}getBadgeTexture(e,t=Ts.NORMAL_BADGE){const s=this.getBadgeUrl(e,t);if(!s||!s.length)return null;const i=this._assets.getTexture(s);if(i)return i.clone();if(t===Ts.NORMAL_BADGE){if(this._requestedBadges.get(e))return null;this._requestedBadges.set(e,!0),this._assets.downloadAsset(s).then(n=>{if(!n)return;this._requestedBadges.delete(e);const a=this._assets.getTexture(s);a&&this._sessionDataManager&&this._sessionDataManager.events.dispatchEvent(new yn(e,a.clone()))}).catch(n=>{})}else if(t===Ts.GROUP_BADGE){if(this._groupBadgesQueue.get(e))return;this._groupBadgesQueue.set(e,!0),this._readyToGenerateGroupBadges&&this.loadGroupBadge(e)}return null}getBadgePlaceholder(){const e=ue.getValue("images.url")+"/loading_icon.png",t=this._assets.getTexture(e);return t?t.clone():null}getBadgeUrl(e,t=Ts.NORMAL_BADGE){let s=null;switch(t){case Ts.NORMAL_BADGE:s=ue.getValue("badge.asset.url").replace("%badgename%",e);break;case Ts.GROUP_BADGE:s=e;break}return s}loadGroupBadge(e){const t=new cY(e),s=[...e.matchAll(/[b|s][0-9]{4,6}/g)];for(const i of s){const n=i[0],a=n.length===6,o=n[0],u=parseInt(n.slice(1,a?3:4)),l=parseInt(n.slice(a?3:4,a?5:6)),d=n.length<6?0:parseInt(n.slice(a?5:6,a?6:7)),c=new nt(o,u,l,d);t.parts.push(c)}this.renderGroupBadge(t)}renderGroupBadge(e){const t=new nr,s=new ot(ig.EMPTY);s.width=nt.IMAGE_WIDTH,s.height=nt.IMAGE_HEIGHT,t.addChild(s);for(const n of e.parts){let a=!0;const o=n.type==="b"?this._groupBases.get(n.key):this._groupSymbols.get(n.key);if(o)for(const u of o){if(!u||!u.length)continue;const l=this._assets.getTexture(`badgepart_${u}`);if(!l)continue;const{x:d,y:c}=n.calculatePosition(l),_=new ot(l);_.position.set(d,c),a&&(_.tint=parseInt(this._groupPartColors.get(n.color),16)),a=!1,t.addChild(_)}}this._requestedBadges.delete(e.code),this._groupBadgesQueue.delete(e.code);const i=Je.generateTexture(t);this._assets.setTexture(e.code,i),this._sessionDataManager&&this._sessionDataManager.events.dispatchEvent(new yn(e.code,i))}onGroupBadgePartsEvent(e){if(!e)return;const t=e.getParser();if(t){t.bases.forEach((s,i)=>this._groupBases.set(i,s.map(n=>n.replace(".png","").replace(".gif","")))),t.symbols.forEach((s,i)=>this._groupSymbols.set(i,s.map(n=>n.replace(".png","").replace(".gif","")))),this._groupPartColors=t.partColors,this._readyToGenerateGroupBadges=!0;for(const s of this._groupBadgesQueue.keys())this.loadGroupBadge(s)}}get disposed(){return!!this._sessionDataManager}}Ts.GROUP_BADGE="group_badge",Ts.NORMAL_BADGE="normal_badge";class fI{constructor(e,t,s,i,n,a,o,u,l,d,c,_,f,g,I,p,R,S,O,A,C,M,N,L,b,D,x,q,$){this._type=e,this._id=t,this._fullName=s,this._className=i,this._category=n,this._revision=u,this._tileSizeX=l,this._tileSizeY=d,this._tileSizeZ=c,this._colors=_,this._hasIndexedColor=f,this._colourIndex=g,this._localizedName=a,this._description=o,this._adUrl=I,this._purchaseOfferId=p,this._purchaseCouldBeUsedForBuyout=R,this._rentOfferId=S,this._rentCouldBeUsedForBuyout=O,this._customParams=C,this._specialType=M,this._availableForBuildersClub=A,this._canStandOn=N,this._canSitOn=L,this._canLayOn=b,this._excludedFromDynamic=D,this._furniLine=x,this._environment=q,this._rare=$}get type(){return this._type}get id(){return this._id}get className(){return this._className}set className(e){this._className=e}get fullName(){return this._fullName}get category(){return this._category}get hasIndexedColor(){return this._hasIndexedColor}get colorIndex(){return this._colourIndex}get revision(){return this._revision}get tileSizeX(){return this._tileSizeX}get tileSizeY(){return this._tileSizeY}get tileSizeZ(){return this._tileSizeZ}get colors(){return this._colors}get name(){return this._localizedName}get description(){return this._description}get adUrl(){return this._adUrl}get purchaseOfferId(){return this._purchaseOfferId}get customParams(){return this._customParams}get specialType(){return this._specialType}get rentOfferId(){return this._rentOfferId}get purchaseCouldBeUsedForBuyout(){return this._purchaseCouldBeUsedForBuyout}get rentCouldBeUsedForBuyout(){return this._rentCouldBeUsedForBuyout}get availableForBuildersClub(){return this._availableForBuildersClub}get canStandOn(){return this._canStandOn}get canSitOn(){return this._canSitOn}get canLayOn(){return this._canLayOn}get isExternalImage(){return this._className.indexOf("external_image")!==-1}get excludeDynamic(){return this._excludedFromDynamic}get furniLine(){return this._furniLine}get environment(){return this._environment}get rare(){return this._rare}}class on extends ws{constructor(e,t,s){super(),this._floorItems=e,this._wallItems=t,this._localization=s}loadFurnitureData(e){e&&fetch(e).then(t=>t.json()).then(t=>this.onFurnitureDataLoaded(t)).catch(t=>this.onFurnitureDataError(t))}onFurnitureDataLoaded(e){e&&((typeof e.roomitemtypes>"u"||typeof e.wallitemtypes>"u")&&Y.warn("Could not find `roomitemtypes` or `wallitemtypes` in furnidata."),e.roomitemtypes&&this.parseFloorItems(e.roomitemtypes),e.wallitemtypes&&this.parseWallItems(e.wallitemtypes),this.dispatchEvent(new Ce(on.FURNITURE_DATA_READY)))}onFurnitureDataError(e){e&&(Y.error(e),this.dispatchEvent(new Ce(on.FURNITURE_DATA_ERROR)))}parseFloorItems(e){if(!(!e||!e.furnitype))for(const t of e.furnitype){if(!t)continue;const s=[];if(t.partcolors)for(const l of t.partcolors.color){let d=l;d.charAt(0)==="#"&&(d=d.replace("#","")),s.push(parseInt(d,16))}const i=t.classname.split("*"),n=i[0],a=i.length>1?parseInt(i[1]):0,o=i.length>1,u=new fI(h.FurnitureType.FLOOR,t.id,t.classname,n,t.category,t.name,t.description,t.revision,t.xdim,t.ydim,0,s,o,a,t.adurl,t.offerid,t.buyout,t.rentofferid,t.rentbuyout,t.bc,t.customparams,t.specialtype,t.canstandon,t.cansiton,t.canlayon,t.excludeddynamic,t.furniline,t.environment,t.rare);this._floorItems.set(u.id,u),this.updateLocalizations(u)}}parseWallItems(e){if(!(!e||!e.furnitype))for(const t of e.furnitype){if(!t)continue;const s=new fI(h.FurnitureType.WALL,t.id,t.classname,t.classname,t.category,t.name,t.description,t.revision,0,0,0,null,!1,0,t.adurl,t.offerid,t.buyout,t.rentofferid,t.rentbuyout,t.bc,null,t.specialtype,!1,!1,!1,t.excludeddynamic,t.furniline,t.environment,t.rare);this._wallItems.set(s.id,s),this.updateLocalizations(s)}}updateLocalizations(e){if(this._localization)switch(e.type){case h.FurnitureType.FLOOR:this._localization.setValue("roomItem.name."+e.id,e.name),this._localization.setValue("roomItem.desc."+e.id,e.description);return;case h.FurnitureType.WALL:this._localization.setValue("wallItem.name."+e.id,e.name),this._localization.setValue("wallItem.desc."+e.id,e.description);return}}}on.FURNITURE_DATA_READY="FDP_FURNITURE_DATA_READY",on.FURNITURE_DATA_ERROR="FDP_FURNITURE_DATA_ERROR";class _Y{constructor(e){this._sessionDataManager=e,this._groupBadges=new Map}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new Pa(this.onRoomReadyMessageEvent.bind(this)),new GE(this.onGroupBadgesEvent.bind(this))];for(const e of this._messages)this._sessionDataManager.communication.registerMessageEvent(e)}}dispose(){if(!this.disposed){if(this._messages&&this._messages.length){for(const e of this._messages)this._sessionDataManager.communication.removeMessageEvent(e);this._messages=null}this._groupBadges=null,this._sessionDataManager=null}}onRoomReadyMessageEvent(e){this._sessionDataManager.send(new mp)}onGroupBadgesEvent(e){const t=e.getParser();for(const[s,i]of t.badges.entries())this._groupBadges.set(s,i)}getGroupBadge(e){return this._groupBadges.get(e)}get disposed(){return!!this._sessionDataManager}}class od{}od.NO_CLUB=0,od.CLUB=1,od.VIP=2;class vr extends Ss{constructor(e,t){super(),this._connection=e,this._listener=t,this._roomId=0}onDispose(){this._connection=null,this._listener=null}setRoomId(e){this._roomId=e}get connection(){return this._connection}get listener(){return this._listener}get roomId(){return this._roomId}}class dY extends vr{constructor(e,t){super(e,t),e.addMessageEvent(new Kc(this.onRoomGenericError.bind(this)))}onRoomGenericError(e){if(!(e instanceof Kc))return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);if(!s)return;let i=null;switch(t.errorCode){case dc.KICKED_OUT_OF_ROOM:i=tt.RSEME_KICKED;break;default:return}!i||i.length==0||this.listener.events.dispatchEvent(new tt(i,s))}}class fY extends vr{constructor(e,t){super(e,t),e.addMessageEvent(new iE(this.onOpenPetPackageRequested.bind(this))),e.addMessageEvent(new nE(this.onOpenPetPackageResult.bind(this)))}onOpenPetPackageRequested(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new pa(pa.RSOPPE_OPEN_PET_PACKAGE_REQUESTED,s,t.objectId,t.figureData,0,null))}onOpenPetPackageResult(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new pa(pa.RSOPPE_OPEN_PET_PACKAGE_RESULT,s,t.objectId,null,t.nameValidationStatus,t.nameValidationInfo))}}class gY extends vr{constructor(e,t){super(e,t),e.addMessageEvent(new hE(this.onPollContentsEvent.bind(this))),e.addMessageEvent(new lE(this.onPollOfferEvent.bind(this))),e.addMessageEvent(new uE(this.onPollErrorEvent.bind(this))),e.addMessageEvent(new gE(this.onStartRoomPollEvent.bind(this))),e.addMessageEvent(new fE(this.onRoomPollResultEvent.bind(this)))}onPollContentsEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const s=e.getParser();if(!s)return;const i=new ai(ai.CONTENT,t,s.id);i.startMessage=s.startMessage,i.endMessage=s.endMessage,i.numQuestions=s.numQuestions,i.questionArray=s.questionArray,i.npsPoll=s.npsPoll,this.listener.events.dispatchEvent(i)}onPollOfferEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const s=e.getParser();if(!s)return;const i=new ai(ai.OFFER,t,s.id);i.summary=s.headline,i.summary=s.summary,this.listener.events.dispatchEvent(i)}onPollErrorEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t||!e.getParser())return;const i=new ai(ai.ERROR,t,-1);i.headline="???",i.summary="???",this.listener.events.dispatchEvent(i)}onStartRoomPollEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const s=e.getParser();if(!s)return;const i=new Ia(Ia.VOTE_QUESTION,t,s.question,s.choices);this.listener.events.dispatchEvent(i)}onRoomPollResultEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const s=e.getParser();if(!s)return;const i=new Ia(Ia.VOTE_RESULT,t,s.question,s.choices,s.SafeStr_7651,s.SafeStr_7654);this.listener.events.dispatchEvent(i)}}class EY extends vr{constructor(e,t){super(e,t),e.addMessageEvent(new S_(this.onRoomUnitChatEvent.bind(this))),e.addMessageEvent(new Fu(this.onRoomUnitChatEvent.bind(this))),e.addMessageEvent(new wu(this.onRoomUnitChatEvent.bind(this))),e.addMessageEvent(new yE(this.onRoomUnitHandItemReceivedEvent.bind(this))),e.addMessageEvent(new jE(this.onRespectReceivedEvent.bind(this))),e.addMessageEvent(new kE(this.onPetRespectNoficationEvent.bind(this))),e.addMessageEvent(new VE(this.onPetSupplementedNotificationEvent.bind(this))),e.addMessageEvent(new SE(this.onFloodControlEvent.bind(this))),e.addMessageEvent(new AE(this.onRemainingMuteEvent.bind(this)))}onRoomUnitChatEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const s=e.getParser();if(!s)return;let i=Pe.CHAT_TYPE_SPEAK;e instanceof Fu?i=Pe.CHAT_TYPE_SHOUT:e instanceof wu&&(i=Pe.CHAT_TYPE_WHISPER);const n=new Pe(Pe.CHAT_EVENT,t,s.roomIndex,s.message,i,s.bubble);this.listener.events.dispatchEvent(n)}onRoomUnitHandItemReceivedEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const s=e.getParser();s&&this.listener.events.dispatchEvent(new Pe(Pe.CHAT_EVENT,t,s.giverUserId,"",Pe.CHAT_TYPE_HAND_ITEM_RECEIVED,xi.GENERIC,null,s.handItemType))}onRespectReceivedEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const s=e.getParser();if(!s)return;const i=t.userDataManager.getUserData(s.userId);i&&this.listener.events.dispatchEvent(new Pe(Pe.CHAT_EVENT,t,i.roomIndex,"",Pe.CHAT_TYPE_RESPECT,xi.GENERIC))}onPetRespectNoficationEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const s=e.getParser();if(!s)return;const i=t.userDataManager.getPetData(s.petData.id);if(!i)return;let n=Pe.CHAT_TYPE_PETRESPECT;s.isTreat&&(n=Pe.CHAT_TYPE_PETTREAT),this.listener.events.dispatchEvent(new Pe(Pe.CHAT_EVENT,t,i.roomIndex,"",n,xi.GENERIC))}onPetSupplementedNotificationEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const s=e.getParser();if(!s)return;const i=t.userDataManager.getPetData(s.petId);if(!i)return;let n=-1;const a=t.userDataManager.getUserData(s.userId);a&&(n=a.roomIndex);let o=Pe.CHAT_TYPE_PETREVIVE;switch(s.supplementType){case Xi.REVIVE:o=Pe.CHAT_TYPE_PETREVIVE;break;case Xi.REBREED_FERTILIZER:o=Pe.CHAT_TYPE_PET_REBREED_FERTILIZE;break;case Xi.SPEED_FERTILIZER:o=Pe.CHAT_TYPE_PET_SPEED_FERTILIZE;break}this.listener.events.dispatchEvent(new Pe(Pe.CHAT_EVENT,t,i.roomIndex,"",o,xi.GENERIC,null,n))}onFloodControlEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const s=e.getParser();if(!s)return;const i=s.seconds;this.listener.events.dispatchEvent(new Pe(Pe.FLOOD_EVENT,t,-1,i.toString(),0,0))}onRemainingMuteEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const s=e.getParser();s&&this.listener.events.dispatchEvent(new Pe(Pe.CHAT_EVENT,t,t.ownRoomIndex,"",Pe.CHAT_TYPE_MUTE_REMAINING,xi.GENERIC,null,s.seconds))}}class mY extends vr{constructor(e,t){super(e,t),e.addMessageEvent(new Qc(this.onGetGuestRoomResultEvent.bind(this)))}onGetGuestRoomResultEvent(e){if(!(e instanceof Qc))return;const t=e.getParser();if(!t||t.roomForward)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=t.data;s.tradeMode=i.tradeMode,s.isGuildRoom=i.habboGroupId!==0,s.doorMode=i.doorMode,s.allowPets=i.allowPets,s.moderationSettings=t.moderation,this.listener.events.dispatchEvent(new Oc(Oc.RSDUE_ALLOW_PETS,s)),this.listener.events.dispatchEvent(new ce(ce.ROOM_DATA,s))}}class pY extends vr{constructor(e,t){super(e,t),e.addMessageEvent(new mE(this.onRoomDimmerPresets.bind(this)))}onRoomDimmerPresets(e){if(!e)return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=new Tc(Tc.ROOM_DIMMER_PRESETS,s);i.selectedPresetId=t.selectedPresetId;let n=0;for(;n<t.presetCount;){const a=t.getPreset(n);a&&i.storePreset(a.id,a.type,a.color,a.brightness),n++}this.listener&&this.listener.events.dispatchEvent(i)}}class IY extends vr{constructor(e,t){super(e,t),e.addMessageEvent(new e_(this.onRoomRightsEvent.bind(this))),e.addMessageEvent(new $c(this.onRoomRightsClearEvent.bind(this))),e.addMessageEvent(new t_(this.onRoomRightsOwnerEvent.bind(this)))}onRoomRightsEvent(e){if(!(e instanceof e_))return;const t=this.listener.getSession(this.roomId);t&&t.setControllerLevel(e.getParser().controllerLevel)}onRoomRightsClearEvent(e){if(!(e instanceof $c))return;const t=this.listener.getSession(this.roomId);t&&t.setControllerLevel(Fs.NONE)}onRoomRightsOwnerEvent(e){if(!(e instanceof t_))return;const t=this.listener.getSession(this.roomId);t&&t.setRoomOwner()}}class TY extends vr{constructor(e,t){super(e,t),e&&e.addMessageEvent(new $g(this.onFurnitureGiftOpenedEvent.bind(this)))}onFurnitureGiftOpenedEvent(e){if(!e)return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);s&&this.listener&&this.listener.events&&this.listener.events.dispatchEvent(new vc(vc.RSPE_PRESENT_OPENED,s,t.classId,t.itemType,t.productCode,t.placedItemId,t.placedItemType,t.placedInRoom,t.petFigureString))}}class sr extends vr{constructor(e,t){super(e,t),e.addMessageEvent(new s_(this.onRoomEnterEvent.bind(this))),e.addMessageEvent(new Pa(this.onRoomReadyMessageEvent.bind(this))),e.addMessageEvent(new Xc(this.onDesktopViewEvent.bind(this))),e.addMessageEvent(new Jc(this.onRoomDoorbellAcceptedEvent.bind(this))),e.addMessageEvent(new qc(this.onRoomDoorbellRejectedEvent.bind(this))),e.addMessageEvent(new OE(this.onYouAreSpectatorMessageEvent.bind(this)))}onRoomEnterEvent(e){e instanceof s_&&this.listener&&this.listener.sessionUpdate(this.roomId,sr.RS_CONNECTED)}onRoomReadyMessageEvent(e){if(!(e instanceof Pa))return;const t=this.roomId,s=e.getParser().roomId;this.listener&&(this.listener.sessionReinitialize(t,s),this.listener.sessionUpdate(this.roomId,sr.RS_READY))}onDesktopViewEvent(e){e instanceof Xc&&this.listener&&this.listener.sessionUpdate(this.roomId,sr.RS_DISCONNECTED)}onRoomDoorbellAcceptedEvent(e){if(!(e instanceof Jc)||!this.listener)return;const t=e.getParser();if(!t)return;const s=t.userName;if(!s||!s.length)this.connection.send(new qm(this.roomId));else if(this.listener.events){const i=this.listener.getSession(this.roomId);if(!i)return;this.listener.events.dispatchEvent(new ni(ni.RSDE_ACCEPTED,i,s))}}onRoomDoorbellRejectedEvent(e){if(!(e instanceof qc)||!this.listener)return;const t=e.getParser();if(!t)return;const s=t.userName;if(!s||!s.length)this.listener.sessionUpdate(this.roomId,sr.RS_DISCONNECTED);else if(this.listener.events){const i=this.listener.getSession(this.roomId);if(!i)return;this.listener.events.dispatchEvent(new ni(ni.RSDE_REJECTED,i,s))}}onYouAreSpectatorMessageEvent(e){if(this.listener){const t=this.listener.getSession(this.roomId);if(!t)return;t.isSpectator=!0,this.listener.events.dispatchEvent(new Sc(Sc.SPECTATOR_MODE,t))}}}sr.RS_CONNECTED="RS_CONNECTED",sr.RS_READY="RS_READY",sr.RS_DISCONNECTED="RS_DISCONNECTED";class RY{constructor(){this._adultLevel=7}get id(){return this._id}set id(e){this._id=e}get level(){return this._level}set level(e){this._level=e}get maximumLevel(){return this._maximumLevel}set maximumLevel(e){this._maximumLevel=e}get experience(){return this._experience}set experience(e){this._experience=e}get levelExperienceGoal(){return this._levelExperienceGoal}set levelExperienceGoal(e){this._levelExperienceGoal=e}get energy(){return this._energy}set energy(e){this._energy=e}get maximumEnergy(){return this._maximumEnergy}set maximumEnergy(e){this._maximumEnergy=e}get happyness(){return this._happyness}set happyness(e){this._happyness=e}get maximumHappyness(){return this._maximumHappyness}set maximumHappyness(e){this._maximumHappyness=e}get ownerId(){return this._ownerId}set ownerId(e){this._ownerId=e}get ownerName(){return this._ownerName}set ownerName(e){this._ownerName=e}get respect(){return this._respect}set respect(e){this._respect=e}get age(){return this._age}set age(e){this._age=e}get unknownRarity(){return this._unknownRarity}set unknownRarity(e){this._unknownRarity=e}get saddle(){return this._saddle}set saddle(e){this._saddle=e}get rider(){return this._rider}set rider(e){this._rider=e}get skillTresholds(){return this._skillThresholds}set skillTresholds(e){this._skillThresholds=e}get publiclyRideable(){return this._publiclyRideable}set publiclyRideable(e){this._publiclyRideable=e}get breedable(){return this._breedable}set breedable(e){this._breedable=e}get fullyGrown(){return this._fullyGrown}set fullyGrown(e){this._fullyGrown=e}get dead(){return this._dead}set dead(e){this._dead=e}get rarityLevel(){return this._rarityLevel}set rarityLevel(e){this._rarityLevel=e}get maximumTimeToLive(){return this._maximumTimeToLive}set maximumTimeToLive(e){this._maximumTimeToLive=e}get remainingTimeToLive(){return this._remainingTimeToLive}set remainingTimeToLive(e){this._remainingTimeToLive=e}get remainingGrowTime(){return this._remainingGrowTime}set remainingGrowTime(e){this._remainingGrowTime=e}get publiclyBreedable(){return this._publiclyBreedable}set publiclyBreedable(e){this._publiclyBreedable=e}get adultLevel(){return this._adultLevel}}class vY{constructor(e){this._roomIndex=-1,this._name="",this._type=0,this._sex="",this._figure="",this._custom="",this._webID=0,this._groupID=0,this._groupStatus=0,this._groupName="",this._ownerId=0,this._ownerName="",this._petLevel=0,this._rarityLevel=0,this._roomIndex=e}get roomIndex(){return this._roomIndex}get activityPoints(){return this._activityPoints}set activityPoints(e){this._activityPoints=e}get name(){return this._name}set name(e){this._name=e}get type(){return this._type}set type(e){this._type=e}get sex(){return this._sex}set sex(e){this._sex=e}get figure(){return this._figure}set figure(e){this._figure=e}get custom(){return this._custom}set custom(e){this._custom=e}get webID(){return this._webID}set webID(e){this._webID=e}get groupId(){return this._groupID}set groupId(e){this._groupID=e}get groupName(){return this._groupName}set groupName(e){this._groupName=e}get groupStatus(){return this._groupStatus}set groupStatus(e){this._groupStatus=e}get ownerId(){return this._ownerId}set ownerId(e){this._ownerId=e}get ownerName(){return this._ownerName}set ownerName(e){this._ownerName=e}get rarityLevel(){return this._rarityLevel}set rarityLevel(e){this._rarityLevel=e}get hasSaddle(){return this._hasSaddle}set hasSaddle(e){this._hasSaddle=e}get isRiding(){return this._isRiding}set isRiding(e){this._isRiding=e}get canBreed(){return this._canBreed}set canBreed(e){this._canBreed=e}get canHarvest(){return this._canHarvest}set canHarvest(e){this._canHarvest=e}get canRevive(){return this._canRevive}set canRevive(e){this._canRevive=e}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(e){this._hasBreedingPermission=e}get petLevel(){return this._petLevel}set petLevel(e){this._petLevel=e}get botSkills(){return this._botSkills}set botSkills(e){this._botSkills=e}get isModerator(){return this._isModerator}set isModerator(e){this._isModerator=e}}class OY extends vr{constructor(e,t){super(e,t),e.addMessageEvent(new Gu(this.onRoomUnitEvent.bind(this))),e.addMessageEvent(new Bu(this.onRoomUnitInfoEvent.bind(this))),e.addMessageEvent(new Hu(this.onRoomUnitRemoveEvent.bind(this))),e.addMessageEvent(new xu(this.onRoomUnitDanceEvent.bind(this))),e.addMessageEvent(new FE(this.onUserCurrentBadgesEvent.bind(this))),e.addMessageEvent(new tE(this.onRoomDoorbellEvent.bind(this))),e.addMessageEvent(new L_(this.onUserNameChangeMessageEvent.bind(this))),e.addMessageEvent(new Wg(this.onNewFriendRequestEvent.bind(this))),e.addMessageEvent(new TE(this.onPetInfoEvent.bind(this))),e.addMessageEvent(new RE(this.onPetStatusUpdateEvent.bind(this))),e.addMessageEvent(new $F(this.onPetBreedingMessageEvent.bind(this))),e.addMessageEvent(new aE(this.onPetLevelUpdateMessageEvent.bind(this))),e.addMessageEvent(new m1(this.onConfirmBreedingResultEvent.bind(this))),e.addMessageEvent(new p1(this.onNestBreedingSuccessEvent.bind(this))),e.addMessageEvent(new E1(this.onConfirmBreedingRequestEvent.bind(this))),e.addMessageEvent(new Uu(this.onPetFigureUpdateEvent.bind(this))),e.addMessageEvent(new pE(this.onPetBreedingResultEvent.bind(this))),e.addMessageEvent(new rE(this.onPetPlacingError.bind(this))),e.addMessageEvent(new sE(this.onBotError.bind(this))),e.addMessageEvent(new EE(this.onFavoriteMembershipUpdateMessageEvent.bind(this)))}onRoomUnitEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const s=e.getParser().users,i=[];if(s&&s.length)for(const n of s){if(!n)continue;const a=new vY(n.roomIndex);a.name=n.name,a.custom=n.custom,a.activityPoints=n.activityPoints,a.figure=n.figure,a.type=n.userType,a.webID=n.webID,a.groupId=n.groupID,a.groupName=n.groupName,a.groupStatus=n.groupStatus,a.sex=n.sex,a.ownerId=n.ownerId,a.ownerName=n.ownerName,a.rarityLevel=n.rarityLevel,a.hasSaddle=n.hasSaddle,a.isRiding=n.isRiding,a.canBreed=n.canBreed,a.canHarvest=n.canHarvest,a.canRevive=n.canRevive,a.hasBreedingPermission=n.hasBreedingPermission,a.petLevel=n.petLevel,a.botSkills=n.botSkills,a.isModerator=n.isModerator,t.userDataManager.getUserData(n.roomIndex)||i.push(a),t.userDataManager.updateUserData(a)}this.listener.events.dispatchEvent(new _u(t,i))}onRoomUnitInfoEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const s=e.getParser();s&&(t.userDataManager.updateFigure(s.unitId,s.figure,s.gender,!1,!1),t.userDataManager.updateMotto(s.unitId,s.motto),t.userDataManager.updateAchievementScore(s.unitId,s.achievementScore),this.listener.events.dispatchEvent(new du(t,s.unitId,s.figure,s.gender,s.motto,s.achievementScore)))}onRoomUnitRemoveEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);t&&t.userDataManager.removeUserData(e.getParser().unitId)}onRoomUnitDanceEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new tu(s,t.unitId,t.danceId))}onUserCurrentBadgesEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);s&&(s.userDataManager.setUserBadges(t.userId,t.badges),this.listener.events.dispatchEvent(new cu(s,t.userId,t.badges)))}onRoomDoorbellEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const s=t.userName;if(!s||!s.length)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new ni(ni.DOORBELL,i,s))}onUserNameChangeMessageEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);s&&s.userDataManager.updateName(t.id,t.newName)}onNewFriendRequestEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=t.request;this.listener.events.dispatchEvent(new ru(s,i.requestId,i.requesterUserId,i.requesterName))}onPetInfoEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=new RY;i.id=t.id,i.level=t.level,i.maximumLevel=t.maximumLevel,i.experience=t.experience,i.levelExperienceGoal=t.levelExperienceGoal,i.energy=t.energy,i.maximumEnergy=t.maximumEnergy,i.happyness=t.happyness,i.maximumHappyness=t.maximumHappyness,i.ownerId=t.ownerId,i.ownerName=t.ownerName,i.respect=t.respect,i.age=t.age,i.unknownRarity=t.unknownRarity,i.saddle=t.saddle,i.rider=t.rider,i.breedable=t.breedable,i.fullyGrown=t.fullyGrown,i.rarityLevel=t.rarityLevel,i.dead=t.dead,i.skillTresholds=t.skillTresholds,i.publiclyRideable=t.publiclyRideable,i.maximumTimeToLive=t.maximumTimeToLive,i.remainingTimeToLive=t.remainingTimeToLive,i.remainingGrowTime=t.remainingGrowTime,i.publiclyBreedable=t.publiclyBreedable,this.listener.events.dispatchEvent(new hu(s,i))}onPetStatusUpdateEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);s&&(s.userDataManager.updatePetBreedingStatus(t.roomIndex,t.canBreed,t.canHarvest,t.canRevive,t.hasBreedingPermission),this.listener.events.dispatchEvent(new lu(s,t.petId,t.canBreed,t.canHarvest,t.canRevive,t.hasBreedingPermission)))}onPetBreedingMessageEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new nu(s,t.state,t.ownPetId,t.otherPetId))}onPetLevelUpdateMessageEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);s&&(s.userDataManager.updatePetLevel(t.roomIndex,t.level),this.listener.events.dispatchEvent(new uu(s,t.petId,t.level)))}onConfirmBreedingResultEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new eu(s,t.breedingNestStuffId,t.result))}onNestBreedingSuccessEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new iu(s,t.petId,t.rarityCategory))}onConfirmBreedingRequestEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new $h(s,t.nestId,t.pet1,t.pet2,t.rarityCategories,t.resultPetType))}onPetFigureUpdateEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=t.figureData.figuredata;s.userDataManager.updateFigure(t.roomIndex,i,"",t.hasSaddle,t.isRiding),this.listener.events.dispatchEvent(new ou(s,t.petId,i))}onPetBreedingResultEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new au(s,t.resultData,t.otherResultData))}onPetPlacingError(e){if(!e||!this.listener)return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);if(!s)return;let i=null;switch(t.errorCode){case 0:i=tt.RSEME_PETS_FORBIDDEN_IN_HOTEL;break;case 1:i=tt.RSEME_PETS_FORBIDDEN_IN_FLAT;break;case 2:i=tt.RSEME_MAX_PETS;break;case 3:i=tt.RSEME_NO_FREE_TILES_FOR_PET;break;case 4:i=tt.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET;break;case 5:i=tt.RSEME_MAX_NUMBER_OF_OWN_PETS;break}!i||i.length==0||this.listener.events.dispatchEvent(new tt(i,s))}onBotError(e){if(!e||!this.listener)return;const t=e.getParser();if(!t)return;const s=this.listener.getSession(this.roomId);if(!s)return;let i=null;switch(t.errorCode){case 0:i=tt.RSEME_BOTS_FORBIDDEN_IN_HOTEL;break;case 1:i=tt.RSEME_BOTS_FORBIDDEN_IN_FLAT;break;case 2:i=tt.RSEME_BOT_LIMIT_REACHED;break;case 3:i=tt.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT;break;case 4:i=tt.RSEME_BOT_NAME_NOT_ACCEPTED;break}!i||i.length==0||this.listener.events.dispatchEvent(new tt(i,s))}onFavoriteMembershipUpdateMessageEvent(e){if(!this.listener)return;const t=e.getParser(),s=this.listener.getSession(this.roomId);if(!s)return;const i=s.userDataManager.getUserDataByIndex(t.roomIndex);i&&(i.groupId=t.groupId,i.groupName=t.groupName,this.listener.events.dispatchEvent(new su(s,t.roomIndex,t.groupId,t.status,t.groupName)))}}class SY extends vr{constructor(e,t){super(e,t),e.addMessageEvent(new _E(this.onQuestionEvent.bind(this))),e.addMessageEvent(new cE(this.onQuestionAnsweredEvent.bind(this))),e.addMessageEvent(new dE(this.onQuestionFinishedEvent.bind(this)))}onQuestionEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const s=e.getParser();if(!s)return;const i=new oi(oi.QUESTION,t,s.pollId);i.question=s.question,i.duration=s.duration,i.pollType=s.pollType,i.questionId=s.questionId,i.pollId=s.pollId,this.listener.events.dispatchEvent(i)}onQuestionAnsweredEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const s=e.getParser();if(!s)return;const i=new oi(oi.ANSWERED,t,s.userId);i.value=s.value,i.userId=s.userId,i.answerCounts=s.answerCounts,this.listener.events.dispatchEvent(i)}onQuestionFinishedEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const s=e.getParser();if(!s)return;const i=new oi(oi.FINISHED,t);i.questionId=s.questionId,i.answerCounts=s.answerCounts,this.listener.events.dispatchEvent(i)}}class AY{constructor(e){this._sessionDataManager=e,this._ignoredUsers=[]}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new BE(this.onIgnoredUsersEvent.bind(this)),new U_(this.onIgnoreResultEvent.bind(this))];for(const e of this._messages)this._sessionDataManager.communication.registerMessageEvent(e)}}dispose(){if(!this.disposed){if(this._messages&&this._messages.length){for(const e of this._messages)this._sessionDataManager.communication.removeMessageEvent(e);this._messages=null}this._sessionDataManager=null}}requestIgnoredUsers(){this._sessionDataManager.send(new lp(this._sessionDataManager.userName))}onIgnoredUsersEvent(e){if(!e)return;const t=e.getParser();t&&(this._ignoredUsers=t.ignoredUsers)}onIgnoreResultEvent(e){if(!e)return;const t=e.getParser();if(!t)return;const s=t.name;switch(t.result){case 0:return;case 1:this.addUserToIgnoreList(s);return;case 2:this.addUserToIgnoreList(s),this._ignoredUsers.shift();return;case 3:this.removeUserFromIgnoreList(s);return}}addUserToIgnoreList(e){this._ignoredUsers.indexOf(e)<0&&this._ignoredUsers.push(e)}removeUserFromIgnoreList(e){const t=this._ignoredUsers.indexOf(e);t>=0&&this._ignoredUsers.splice(t,1)}ignoreUserId(e){this._sessionDataManager.send(new dp(e))}ignoreUser(e){this._sessionDataManager.send(new _p(e))}unignoreUser(e){this._sessionDataManager.send(new fp(e))}isIgnored(e){return this._ignoredUsers.indexOf(e)>=0}get disposed(){return!!this._sessionDataManager}}class yY{constructor(e,t,s){this._type=e,this._name=t,this._description=s}get type(){return this._type}get name(){return this._name}get description(){return this._description}}class hn extends ws{constructor(e){super(),this._products=e}dispose(){this._products=null}loadProductData(e){e&&fetch(e).then(t=>t.json()).then(t=>this.onProductDataLoadedEvent(t)).catch(t=>this.onProductDataError(t))}onProductDataLoadedEvent(e){e&&(this.parseProducts(e.productdata),this.dispatchEvent(new Ce(hn.PDP_PRODUCT_DATA_READY)))}onProductDataError(e){e&&this.dispatchEvent(new Ce(hn.PDP_PRODUCT_DATA_FAILED))}parseProducts(e){if(e)for(const t of e.product)t&&this._products.set(t.code,new yY(t.code,t.name,t.description))}}hn.PDP_PRODUCT_DATA_READY="PDP_PRODUCT_DATA_READY",hn.PDP_PRODUCT_DATA_FAILED="PDP_PRODUCT_DATA_FAILED";class Br extends Ss{constructor(){super(),this._connection=null,this._userDataByType=new Map,this._userDataByRoomIndex=new Map,this._userBadges=new Map}onDispose(){this._connection=null}setConnection(e){this._connection=e}getUserData(e){return this.getDataByType(e,Br.TYPE_USER)}getPetData(e){return this.getDataByType(e,Br.TYPE_PET)}getBotData(e){return this.getDataByType(e,Br.TYPE_BOT)}getRentableBotData(e){return this.getDataByType(e,Br.TYPE_RENTABLE_BOT)}getDataByType(e,t){const s=this._userDataByType.get(t);if(!s)return null;const i=s.get(e);return i||null}getUserDataByIndex(e){const t=this._userDataByRoomIndex.get(e);return t||null}getUserDataByName(e){for(const t of this._userDataByRoomIndex.values())if(!(!t||t.name!==e))return t;return null}updateUserData(e){if(!e)return;this.removeUserData(e.roomIndex);let t=this._userDataByType.get(e.type);t||(t=new Map,this._userDataByType.set(e.type,t)),t.set(e.webID,e),this._userDataByRoomIndex.set(e.roomIndex,e)}removeUserData(e){const t=this.getUserDataByIndex(e);if(!t)return;this._userDataByRoomIndex.delete(e);const s=this._userDataByType.get(t.type);s&&s.delete(t.webID)}getUserBadges(e){this._connection&&this._connection.send(new gp(e));const t=this._userBadges.get(e);return t||[]}setUserBadges(e,t){this._userBadges.set(e,t)}updateFigure(e,t,s,i,n){const a=this.getUserDataByIndex(e);a&&(a.figure=t,a.sex=s,a.hasSaddle=i,a.isRiding=n)}updateName(e,t){const s=this.getUserDataByIndex(e);s&&(s.name=t)}updateMotto(e,t){const s=this.getUserDataByIndex(e);s&&(s.custom=t)}updateAchievementScore(e,t){const s=this.getUserDataByIndex(e);s&&(s.activityPoints=t)}updatePetLevel(e,t){const s=this.getUserDataByIndex(e);s&&(s.petLevel=t)}updatePetBreedingStatus(e,t,s,i,n){const a=this.getUserDataByIndex(e);a&&(a.canBreed=t,a.canHarvest=s,a.canRevive=i,a.hasBreedingPermission=n)}requestPetInfo(e){!this._connection||!this.getPetData(e)||this._connection.send(new rm(e))}get connection(){return this._connection}}Br.TYPE_USER=1,Br.TYPE_PET=2,Br.TYPE_BOT=3,Br.TYPE_RENTABLE_BOT=4;class CY extends Ss{constructor(){super(),this._connection=null,this._userData=new Br,this._roomId=0,this._password=null,this._state=ce.CREATED,this._tradeMode=wi.NO_TRADING,this._doorMode=0,this._controllerLevel=Fs.NONE,this._ownRoomIndex=-1,this._isGuildRoom=!1,this._isRoomOwner=!1,this._isDecorating=!1,this._isSpectator=!1,this._moderationSettings=null}onDispose(){this._userData&&(this._userData.dispose(),this._userData=null),this._connection=null}setConnection(e){this._connection||!e||(this._connection=e,this._userData&&this._userData.setConnection(e))}setControllerLevel(e){if(e>=Fs.NONE&&e<=Fs.MODERATOR){this._controllerLevel=e;return}this._controllerLevel=Fs.NONE}setOwnRoomIndex(e){this._ownRoomIndex=e}setRoomOwner(){this._isRoomOwner=!0}start(){return this._state!==ce.CREATED||!this._connection?!1:(this._state=ce.STARTED,this.enterRoom())}enterRoom(){return this._connection?(this._connection.send(new _m(this._roomId,this._password)),!0):!1}reset(e){e!==this._roomId&&(this._roomId=e)}sendChatMessage(e,t){this._connection.send(new k_(e,t))}sendShoutMessage(e,t){this._connection.send(new Qm(e,t))}sendWhisperMessage(e,t,s){this._connection.send(new Zm(e,t,s))}sendChatTypingMessage(e){e?this._connection.send(new Jm):this._connection.send(new $m)}sendMottoMessage(e){this._connection.send(new Ep(e))}sendDanceMessage(e){this._connection.send(new tp(e))}sendExpressionMessage(e){this._connection.send(new ep(e))}sendSignMessage(e){e<0||e>17||this._connection.send(new ip(e))}sendPostureMessage(e){this._connection.send(new rp(e))}sendDoorbellApprovalMessage(e,t){this._connection.send(new cm(e,t))}sendAmbassadorAlertMessage(e){this._connection.send(new dm(e))}sendKickMessage(e){this._connection.send(new Em(e))}sendMuteMessage(e,t){this._connection.send(new mm(e,t,this._roomId))}sendBanMessage(e,t){this._connection.send(new fm(e,this._roomId,t))}sendGiveRightsMessage(e){this._connection.send(new gm(e))}sendTakeRightsMessage(e){this._connection.send(new pm(e))}sendPollStartMessage(e){this._connection.send(new um(e))}sendPollRejectMessage(e){this._connection.send(new hm(e))}sendPollAnswerMessage(e,t,s){this._connection.send(new om(e,t,s))}sendPeerUsersClassificationMessage(e){this._connection.send(new Ip(e))}sendOpenPetPackageMessage(e,t){this._connection.send(new Wm(e,t))}sendRoomUsersClassificationMessage(e){this._connection.send(new Tp(e))}updateMoodlightData(e,t,s,i,n){let a="000000"+s.toString(16).toUpperCase();a="#"+a.substring(a.length-6),this.connection.send(new Dm(e,t,a,i,n))}toggleMoodlightState(){this.connection.send(new Lm)}pickupPet(e){this._connection&&this._connection.send(new ym(e))}pickupBot(e){this._connection&&this._connection.send(new Tm(e))}requestMoodlightSettings(){this._connection&&this._connection.send(new bm)}openGift(e){this._connection.send(new zm(e))}mountPet(e){this._connection.send(new w_(e,!0))}dismountPet(e){this._connection.send(new w_(e,!1))}usePetProduct(e,t){this._connection.send(new am(e,t))}removePetSaddle(e){this._connection.send(new sm(e))}togglePetBreeding(e){this._connection.send(new im(e))}togglePetRiding(e){this._connection.send(new nm(e))}useMultistateItem(e){this._connection.send(new B_(e))}harvestPet(e){this._connection.send(new Sm(e))}compostPlant(e){this._connection.send(new vm(e))}requestPetCommands(e){this._connection.send(new em(e))}sendScriptProceed(){this._connection.send(new $E)}sendUpdateClothingChangeFurniture(e,t,s){this._connection.send(new Mm(e,t,s))}changeQueue(e){this._connection.send(new Km(e))}votePoll(e){this._connection.send(new lm(e))}get connection(){return this._connection}get userDataManager(){return this._userData}get roomId(){return this._roomId}set roomId(e){this._roomId=e}get password(){return this._password}set password(e){this._password=e}get state(){return this._state}get isPrivateRoom(){return!0}get tradeMode(){return this._tradeMode}set tradeMode(e){this._tradeMode=e}get doorMode(){return this._doorMode}set doorMode(e){this._doorMode=e}get allowPets(){return this._allowPets}set allowPets(e){this._allowPets=e}get controllerLevel(){return this._controllerLevel}get ownRoomIndex(){return this._ownRoomIndex}get isGuildRoom(){return this._isGuildRoom}set isGuildRoom(e){this._isGuildRoom=e}get isRoomOwner(){return this._isRoomOwner}get isDecorating(){return this._isDecorating}set isDecorating(e){this._isDecorating=e}get isSpectator(){return this._isSpectator}set isSpectator(e){this._isSpectator=e}get moderationSettings(){return this._moderationSettings}set moderationSettings(e){this._moderationSettings=e}}class MY extends Pr{constructor(e,t){super(),this._communication=e,this._roomEngine=t,this._handlers=[],this._sessions=new Map,this._pendingSession=null,this._sessionStarting=!1,this._viewerSession=null,this.onRoomEngineEvent=this.onRoomEngineEvent.bind(this)}onInit(){this.createHandlers(),this.processPendingSession(),this._roomEngine.events.addEventListener(Ue.ENGINE_INITIALIZED,this.onRoomEngineEvent)}onDispose(){this._roomEngine.events.removeEventListener(Ue.ENGINE_INITIALIZED,this.onRoomEngineEvent),super.onDispose()}createHandlers(){const e=this._communication&&this._communication.connection;e&&this._handlers.push(new EY(e,this),new mY(e,this),new pY(e,this),new IY(e,this),new sr(e,this),new OY(e,this),new TY(e,this),new dY(e,this),new SY(e,this),new gY(e,this),new fY(e,this))}setHandlers(e){if(!(!this._handlers||!this._handlers.length))for(const t of this._handlers)t&&t.setRoomId(e.roomId)}onRoomEngineEvent(e){this.processPendingSession()}processPendingSession(){!this._pendingSession||!this._roomEngine.ready||(this.addSession(this._pendingSession),this._pendingSession=null)}getSession(e){const t=this._sessions.get(this.getRoomId(e));return t||null}createSession(e,t=null){const s=new CY;return s.roomId=e,s.password=t,this.addSession(s)}addSession(e){return this._roomEngine.ready?(this._sessionStarting=!0,this._sessions.get(this.getRoomId(e.roomId))&&this.removeSession(e.roomId,!1),e.setConnection(this._communication.connection),this._sessions.set(this.getRoomId(e.roomId),e),this.events.dispatchEvent(new ce(ce.CREATED,e)),this._viewerSession=e,this.startSession(this._viewerSession),!0):(this._pendingSession=e,!1)}startSession(e){return e.state===ce.STARTED?!1:(this._sessionStarting=!1,e.start()?(this.events.dispatchEvent(new ce(ce.STARTED,e)),this.setHandlers(e),!0):(this.removeSession(e.roomId),!1))}removeSession(e,t=!0){const s=this.getSession(e);s&&(this._sessions.delete(this.getRoomId(e)),this.events.dispatchEvent(new ce(ce.ENDED,s,t)),s.dispose())}sessionUpdate(e,t){if(this.getSession(e))switch(t){case sr.RS_CONNECTED:return;case sr.RS_READY:return;case sr.RS_DISCONNECTED:this.removeSession(e);return}}sessionReinitialize(e,t){const s=this.getSession(e);s&&(this._sessions.delete(this.getRoomId(e)),s.reset(t),this._sessions.set(this.getRoomId(t),s),this.setHandlers(s))}getRoomId(e){return"hard_coded_room_id"}get communication(){return this._communication}get roomEngine(){return this._roomEngine}get viewerSession(){return this._viewerSession}}class Ti{static logEventLog(e){try{Ae.available&&Ae.call("logEventLog",e)}catch{Y.log("External interface not working, failed to log event log.")}}static openPage(e){try{Ae.available?Ae.call("openPage",e):Y.log("External interface not available, openPage failed.")}catch{Y.log("Failed to open web page",e)}}static openWebPage(e){window.open(e)}static sendHeartBeat(){try{Ae.available&&Ae.call("heartBeat")}catch{Y.log("Failed to send heartbeat")}}static openWebPageAndMinimizeClient(e){try{Ae.available&&Ti.openPage(e)}catch{Y.log("Failed to open web page",e)}}static closeWebPageAndRestoreClient(){try{Ae.available&&Ae.call("closeWebPageAndRestoreClient")}catch{Y.log("Failed to close web page and restore client!")}}static openHabblet(e,t=null){try{Ae.available&&Ae.call("openHabblet",e,t)}catch{Y.log("Failed to open Habblet",e)}}static closeHabblet(e,t=null){try{Ae.available&&Ae.call("closeHabblet",e,t)}catch{Y.log("Failed to close Habblet",e)}}static send(e,t){try{Ae.available&&Ae.call("disconnect",e,t)}catch{Y.log("Failed to close send ")}}static showGame(e){try{Ae.available&&Ae.callGame("showGame",e)}catch(t){Y.log("Failed to open game",t)}}static hideGame(){try{Ae.available&&Ae.callGame("hideGame")}catch{Y.log("Failed to hide game")}}static open(e){try{Ae.available?Ae.call("openExternalLink",escape(e)):Y.log("External interface not available. Could not request to open: "+e)}catch{Y.log("External interface not working. Could not request to open: "+e)}}static roomVisited(e){try{Ae.available?Ae.call("roomVisited",e):Y.log("External interface not available. Could not store last room visit.")}catch{Y.log("External interface not working. Could not store last room visit.")}}static openMinimail(e){try{Ae.available?Ae.call("openMinimail",e):Y.log("External interface not available. Could not open minimail.")}catch{Y.log("External interface not working. Could not open minimail.")}}static openNews(){try{Ae.available?Ae.call("openNews"):Y.log("External interface not available. Could not open news.")}catch{Y.log("External interface not working. Could not open news.")}}static closeNews(){try{Ae.available?Ae.call("closeNews"):Y.log("External interface not available. Could not close news.")}catch{Y.log("External interface not working. Could not close news.")}}static openAvatars(){try{Ae.available?Ae.call("openAvatars"):Y.log("External interface not available. Could not open avatars.")}catch{Y.log("External interface not working. Could not open avatars.")}}static openRoomEnterAd(){try{Ae.available?Ae.call("openRoomEnterAd"):Y.log("External interface not available. Could not open roomenterad.")}catch{Y.log("External interface not working. Could not open roomenterad.")}}static updateFigure(e){try{Ae.available?Ae.call("updateFigure",e):Y.log("External interface not available. Could not update figure.")}catch{Y.log("External interface not working. Could not update figure.")}}}Ti.ADVERTISEMENT="advertisement",Ti.OPENLINK="openlink",Ti.OPENROOM="openroom";class PY extends Pr{constructor(e){super(),this._communication=e,this.resetUserInfo(),this._ignoredUsersManager=new AY(this),this._groupInformationManager=new _Y(this),this._clubLevel=0,this._securityLevel=0,this._isAmbassador=!1,this._noobnessLevel=-1,this._isEmailVerified=!1,this._systemOpen=!1,this._systemShutdown=!1,this._isAuthenticHabbo=!1,this._isRoomCameraFollowDisabled=!1,this._uiFlags=0,this._floorItems=new Map,this._wallItems=new Map,this._products=new Map,this._furnitureData=null,this._furnitureReady=!1,this._productsReady=!1,this._furnitureListenersNotified=!1,this._pendingFurnitureListeners=[],this._pendingProductListeners=[],this._tags=[],this._badgeImageManager=null,this.onFurnitureDataReadyEvent=this.onFurnitureDataReadyEvent.bind(this),this.onProductDataReadyEvent=this.onProductDataReadyEvent.bind(this),this.onNitroSettingsEvent=this.onNitroSettingsEvent.bind(this)}onInit(){this.loadFurnitureData(),this.loadProductData(),this.loadBadgeImageManager(),this._ignoredUsersManager&&this._ignoredUsersManager.init(),this._groupInformationManager&&this._groupInformationManager.init(),this._communication.registerMessageEvent(new jg(this.onUserFigureEvent.bind(this))),this._communication.registerMessageEvent(new ku(this.onUserInfoEvent.bind(this))),this._communication.registerMessageEvent(new LE(this.onUserPermissionsEvent.bind(this))),this._communication.registerMessageEvent(new Vg(this.onAvailabilityStatusMessageEvent.bind(this))),this._communication.registerMessageEvent(new oE(this.onPetRespectFailed.bind(this))),this._communication.registerMessageEvent(new gr(this.onChangeNameUpdateEvent.bind(this))),this._communication.registerMessageEvent(new L_(this.onUserNameChangeMessageEvent.bind(this))),this._communication.registerMessageEvent(new wE(this.onUserTags.bind(this))),this._communication.registerMessageEvent(new Pa(this.onRoomModelNameEvent.bind(this))),this._communication.registerMessageEvent(new HE(this.onInClientLinkEvent.bind(this))),this._communication.registerMessageEvent(new eE(this.onMysteryBoxKeysEvent.bind(this))),this._communication.registerMessageEvent(new Kg(this.onNoobnessLevelMessageEvent.bind(this))),this._communication.registerMessageEvent(new UE(this.onAccountSafetyLockStatusChangeMessageEvent.bind(this))),this._communication.registerMessageEvent(new xE(this.onEmailStatus.bind(this))),X.instance.events.addEventListener(si.SETTINGS_UPDATED,this.onNitroSettingsEvent)}onDispose(){this.destroyFurnitureData(),this._ignoredUsersManager&&(this._ignoredUsersManager.dispose(),this._ignoredUsersManager=null),this._groupInformationManager&&(this._groupInformationManager.dispose(),this._groupInformationManager=null),X.instance.events.removeEventListener(si.SETTINGS_UPDATED,this.onNitroSettingsEvent),super.onDispose()}resetUserInfo(){this._userId=0,this._name=null,this._figure=null,this._gender=null,this._realName=null,this._canChangeName=!1,this._safetyLocked=!1}loadFurnitureData(){this.destroyFurnitureData(),this._furnitureData=new on(this._floorItems,this._wallItems,X.instance.localization),this._furnitureData.addEventListener(on.FURNITURE_DATA_READY,this.onFurnitureDataReadyEvent),this._furnitureData.loadFurnitureData(ue.getValue("furnidata.url"))}loadProductData(){this.destroyProductData(),this._productData=new hn(this._products),this._productData.addEventListener(hn.PDP_PRODUCT_DATA_READY,this.onProductDataReadyEvent),this._productData.loadProductData(ue.getValue("productdata.url"))}loadBadgeImageManager(){this._badgeImageManager||(this._badgeImageManager=new Ts(Ws(),this),this._badgeImageManager.init())}hasProductData(e){return this._productsReady?!0:(e&&this._pendingProductListeners.indexOf(e)===-1&&this._pendingProductListeners.push(e),!1)}getAllFurnitureData(e){if(!this._furnitureReady)return this._pendingFurnitureListeners.indexOf(e)===-1&&this._pendingFurnitureListeners.push(e),null;const t=[];for(const s of this._floorItems.values())s&&t.push(s);for(const s of this._wallItems.values())s&&t.push(s);return t}removePendingFurniDataListener(e){if(!this._pendingFurnitureListeners)return;const t=this._pendingFurnitureListeners.indexOf(e);t!==-1&&this._pendingFurnitureListeners.splice(t,1)}onUserFigureEvent(e){!e||!e.connection||(this._figure=e.getParser().figure,this._gender=e.getParser().gender,Ti.updateFigure(this._figure))}onUserInfoEvent(e){if(!e||!e.connection)return;this.resetUserInfo();const t=e.getParser().userInfo;t&&(this._userId=t.userId,this._name=t.username,this._figure=t.figure,this._gender=t.gender,this._realName=t.realName,this._respectsReceived=t.respectsReceived,this._respectsLeft=t.respectsRemaining,this._respectsPetLeft=t.respectsPetRemaining,this._canChangeName=t.canChangeName,this._safetyLocked=t.safetyLocked,this._ignoredUsersManager&&this._ignoredUsersManager.requestIgnoredUsers())}onUserPermissionsEvent(e){!e||!e.connection||(this._clubLevel=e.getParser().clubLevel,this._securityLevel=e.getParser().securityLevel,this._isAmbassador=e.getParser().isAmbassador)}onAvailabilityStatusMessageEvent(e){if(!e||!e.connection)return;const t=e.getParser();t&&(this._systemOpen=t.isOpen,this._systemShutdown=t.onShutdown,this._isAuthenticHabbo=t.isAuthenticUser)}onPetRespectFailed(e){!e||!e.connection||this._respectsPetLeft++}onChangeNameUpdateEvent(e){if(!e||!e.connection)return;const t=e.getParser();t&&t.resultCode===gr.NAME_OK&&(this._canChangeName=!1,this.events.dispatchEvent(new Oo(t.name)))}onUserNameChangeMessageEvent(e){if(!e||!e.connection)return;const t=e.getParser();t&&t.webId===this.userId&&(this._name=t.newName,this._canChangeName=!1,this.events.dispatchEvent(new Oo(this._name)))}onUserTags(e){if(!e||!e.connection)return;const t=e.getParser();t&&(this._tags=t.tags)}onRoomModelNameEvent(e){if(!e)return;const t=e.getParser();t&&Ti.roomVisited(t.roomId)}onFurnitureDataReadyEvent(e){if(this._furnitureData.removeEventListener(on.FURNITURE_DATA_READY,this.onFurnitureDataReadyEvent),this._furnitureReady=!0,!this._furnitureListenersNotified&&(this._furnitureListenersNotified=!0,this._pendingFurnitureListeners&&this._pendingFurnitureListeners.length))for(const t of this._pendingFurnitureListeners)t&&t.loadFurnitureData();this._pendingProductListeners=[]}onProductDataReadyEvent(e){this._productData.removeEventListener(hn.PDP_PRODUCT_DATA_READY,this.onProductDataReadyEvent),this._productsReady=!0;for(const t of this._pendingProductListeners)t&&t.loadProductData();this._pendingProductListeners=[]}onInClientLinkEvent(e){if(!e)return;const t=e.getParser();t&&X.instance.createLinkEvent(t.link)}onMysteryBoxKeysEvent(e){if(!e)return;const t=e.getParser();t&&this.events.dispatchEvent(new Jh(t.boxColor,t.keyColor))}onNoobnessLevelMessageEvent(e){this._noobnessLevel=e.getParser().noobnessLevel,this._noobnessLevel!==_a.OLD_IDENTITY&&ue.setValue("new.identity",1)}onAccountSafetyLockStatusChangeMessageEvent(e){if(!e)return;const t=e.getParser();t&&(this._safetyLocked=t.status==Ou.SAFETY_LOCK_STATUS_LOCKED)}onEmailStatus(e){if(!e)return;const t=e.getParser();t&&(this._isEmailVerified=t.isVerified)}onNitroSettingsEvent(e){this._isRoomCameraFollowDisabled=e.cameraFollow,this._uiFlags=e.flags,this.events.dispatchEvent(new fu(this._uiFlags))}destroyFurnitureData(){this._furnitureData&&(this._furnitureData.dispose(),this._furnitureData=null)}destroyProductData(){this._productData&&(this._productData.dispose(),this._productData=null)}getFloorItemData(e){const t=this._floorItems.get(e);return t||null}getFloorItemDataByName(e){if(!e||!this._floorItems||!this._floorItems.size)return null;for(const t of this._floorItems.values())if(!(!t||t.className!==e))return t}getWallItemData(e){const t=this._wallItems.get(e);return t||null}getWallItemDataByName(e){if(!e||!this._wallItems||!this._wallItems.size)return null;for(const t of this._wallItems.values())if(!(!t||t.className!==e))return t}getProductData(e){return this._productsReady||this.loadProductData(),this._products.get(e)}getBadgeUrl(e){return this._badgeImageManager.getBadgeUrl(e)}getGroupBadgeUrl(e){return this._badgeImageManager.getBadgeUrl(e,Ts.GROUP_BADGE)}getBadgeImage(e){return this._badgeImageManager.getBadgeImage(e)}getGroupBadgeImage(e){return this._badgeImageManager.getBadgeImage(e,Ts.GROUP_BADGE)}getUserTags(e){e<0||this.send(new cp(e))}loadBadgeImage(e){return this._badgeImageManager.loadBadgeImage(e)}loadGroupBadgeImage(e){return this._badgeImageManager.loadBadgeImage(e,Ts.GROUP_BADGE)}hasSecurity(e){return this._securityLevel>=e}giveRespect(e){e<0||this._respectsLeft<=0||(this.send(new pp(e)),this._respectsLeft--)}givePetRespect(e){e<0||this._respectsPetLeft<=0||(this.send(new tm(e)),this._respectsPetLeft--)}sendSpecialCommandMessage(e,t=0){this.send(new k_(e))}ignoreUser(e){this._ignoredUsersManager&&this._ignoredUsersManager.ignoreUser(e)}unignoreUser(e){this._ignoredUsersManager&&this._ignoredUsersManager.unignoreUser(e)}isUserIgnored(e){return this._ignoredUsersManager&&this._ignoredUsersManager.isIgnored(e)}getGroupBadge(e){return this._groupInformationManager&&this._groupInformationManager.getGroupBadge(e)}send(e){this._communication.connection.send(e)}get communication(){return this._communication}get userId(){return this._userId}get userName(){return this._name}get figure(){return this._figure}get gender(){return this._gender}get realName(){return this._realName}get ignoredUsersManager(){return this._ignoredUsersManager}get groupInformationManager(){return this._groupInformationManager}get respectsReceived(){return this._respectsReceived}get respectsLeft(){return this._respectsLeft}get respectsPetLeft(){return this._respectsPetLeft}get canChangeName(){return this._canChangeName}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}get isEmailVerified(){return this._isEmailVerified}get isNoob(){return this._noobnessLevel!==_a.OLD_IDENTITY}get isRealNoob(){return this._noobnessLevel===_a.REAL_NOOB}get isSystemOpen(){return this._systemOpen}get isSystemShutdown(){return this._systemShutdown}get isAuthenticHabbo(){return this._isAuthenticHabbo}get isModerator(){return this._securityLevel>=ur.MODERATOR}get isCameraFollowDisabled(){return this._isRoomCameraFollowDisabled}get uiFlags(){return this._uiFlags}get tags(){return this._tags}}class gI extends Du{constructor(e,t,s,i,n=""){super(e,t,s,i),this._jukeboxDiskId=-1,this._songData=n}get id(){return this._id}get length(){return this._length}get name(){return this._name}get creator(){return this._creator}get songData(){return this._songData}set songData(e){this._songData=e}get diskId(){return this._jukeboxDiskId}set diskId(e){this._jukeboxDiskId=e}}class NY{constructor(e,t,s,i,n){this._songId=e,this._startPos=t,this._playLength=s,this._fadeInSeconds=i,this._fadeOutSeconds=n,this._playRequestTime=Date.now()}get songId(){return this._songId}get startPos(){return this._startPos<0?0:this._startPos+(Date.now()-this._playRequestTime)/1e3}get playLength(){return this._playLength}get playRequestTime(){return this._playRequestTime}get fadeInSeconds(){return this._fadeInSeconds}get fadeOutSeconds(){return this._fadeOutSeconds}}class ol extends Ce{constructor(e,t){super(ol.NOTIFY_PLAYED_SONG),this._name=e,this._creator=t}get name(){return this._name}get creator(){return this._creator}}ol.NOTIFY_PLAYED_SONG="UIEW_NOTIFY_PLAYED_SONG";class Ri extends Ce{constructor(e,t,s,i){super(e),this._id=s,this._position=i,this._priority=t}get id(){return this._id}get position(){return this._position}get priority(){return this._priority}}Ri.NPE_USER_PLAY_SONG="NPE_USER_PLAY_SONG",Ri.NPW_USER_STOP_SONG="NPW_USER_STOP_SONG",Ri.NPE_SONG_CHANGED="NPE_SONG_CHANGED";class un extends Ce{constructor(e){super(e)}}un.PLUE_PLAY_LIST_UPDATED="PLUE_PLAY_LIST_UPDATED",un.PLUE_PLAY_LIST_FULL="PLUE_PLAY_LIST_FULL";class Xo extends Ce{constructor(e){super(e)}}Xo.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT="SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT";class Ko extends Ce{constructor(e,t){super(e),this._id=t}get id(){return this._id}}Ko.SIR_TRAX_SONG_INFO_RECEIVED="SIR_TRAX_SONG_INFO_RECEIVED";class qo extends Ce{constructor(e,t){super(e),this._id=t}get id(){return this._id}}qo.TRAX_SONG_COMPLETE="SME_TRAX_SONG_COMPLETE";class us{}us.PRIORITY_ROOM_PLAYLIST=0,us.PRIORITY_USER_PLAYLIST=1,us.PRIORITY_SONG_PLAY=2,us.PRIORITY_PURCHASE_PREVIEW=3,us.PRIORITY_COUNT=4;class bY{constructor(){this._isPlaying=!1,this._disposed=!1,this._entries=[],this._missingSongInfo=[],this._messageEvents=[new NE(this.onNowPlayingMessageEvent.bind(this)),new PE(this.onJukeboxSongDisksMessageEvent.bind(this)),new ME(this.onJukeboxPlayListFullMessageEvent.bind(this))],this.onSongInfoReceivedEvent=this.onSongInfoReceivedEvent.bind(this)}init(){this._messageEvents.forEach(e=>X.instance.communication.connection.addMessageEvent(e)),X.instance.soundManager.events.addEventListener(Ko.SIR_TRAX_SONG_INFO_RECEIVED,this.onSongInfoReceivedEvent)}get priority(){return us.PRIORITY_ROOM_PLAYLIST}onNowPlayingMessageEvent(e){const t=e.getParser();this._isPlaying=t.currentSongId!==-1,t.currentSongId>=0?(X.instance.soundManager.musicController.playSong(t.currentSongId,us.PRIORITY_ROOM_PLAYLIST,t.syncCount/1e3,0,1,1),this._currentEntryId=t.currentSongId):this.stopPlaying(),t.nextSongId>=0&&X.instance.soundManager.musicController.addSongInfoRequest(t.nextSongId),this._playPosition=t.currentPosition,X.instance.soundManager.events.dispatchEvent(new Ri(Ri.NPE_SONG_CHANGED,us.PRIORITY_ROOM_PLAYLIST,t.currentSongId,t.currentPosition))}onJukeboxSongDisksMessageEvent(e){const t=e.getParser();this._entries=[];for(let s=0;s<t.songDisks.length;s++){const i=t.songDisks.getWithIndex(s),n=t.songDisks.getKey(s);let a=X.instance.soundManager.musicController.getSongInfo(i);a==null&&(a=new gI(i,-1,null,null,null),this._missingSongInfo.indexOf(i)<0&&(this._missingSongInfo.push(i),X.instance.soundManager.musicController.requestSongInfoWithoutSamples(i))),a.diskId=n,this._entries.push(a)}this._missingSongInfo.length==0&&X.instance.soundManager.events.dispatchEvent(new un(un.PLUE_PLAY_LIST_UPDATED))}onJukeboxPlayListFullMessageEvent(e){X.instance.soundManager.events.dispatchEvent(new un(un.PLUE_PLAY_LIST_FULL))}onSongInfoReceivedEvent(e){for(let s=0;s<this.length;s++){const i=this._entries[s];if(i.id===e.id){const n=i.diskId,a=X.instance.soundManager.musicController.getSongInfo(e.id);a!=null&&(a.diskId=n,this._entries[s]=a);break}}const t=this._missingSongInfo.indexOf(e.id);t>=0&&this._missingSongInfo.splice(t,1),this._missingSongInfo.length==0&&X.instance.soundManager.events.dispatchEvent(new un(un.PLUE_PLAY_LIST_UPDATED))}stopPlaying(){X.instance.soundManager.musicController.stop(this.priority),this._currentEntryId=-1,this._playPosition=-1,this._isPlaying=!1}get length(){return this._entries?this._entries.length:0}get playPosition(){return this._playPosition}get nowPlayingSongId(){return this._currentEntryId}get isPlaying(){return this._isPlaying}get entries(){return this._entries}getEntry(e){return e<0||e>=this._entries.length?null:this._entries[e]}requestPlayList(){X.instance.communication.connection.send(new ap)}dispose(){this._disposed||(this._disposed=!0,this.stopPlaying(),X.instance.soundManager.events&&X.instance.soundManager.events.removeEventListener(Ko.SIR_TRAX_SONG_INFO_RECEIVED,this.onSongInfoReceivedEvent),this._messageEvents.forEach(e=>X.instance.communication.connection.removeMessageEvent(e)),this._messageEvents=null)}}class DY{constructor(e){this._id=e,this._items=[]}addChannelItem(e){this._items.push(e)}get items(){return this._items}}class LY{constructor(e,t){this._id=e,this._length=t}get id(){return this._id}get length(){return this._length}}class hd{constructor(e){this._channels=[],this._metaData=new Map;let t=[];const s=e.split(":"),i=s[s.length-1];if(i.indexOf("meta")>-1){const n=i.split(";");for(const a of n){const o=a.split(",");this._metaData.set(o[0],o[1])}t=s.slice(0,s.length-1)}else t=s;for(let n=0;n<t.length/2;n++)if(t[n*2].length>0){const a=parseInt(t[n*2]),o=t[n*2+1].split(";"),u=new DY(a);for(const l of o){const d=l.split(",");if(d.length!==2)return;u.addChannelItem(new LY(parseInt(d[0]),parseInt(d[1])))}this._channels.push(u)}}get channels(){return this._channels}getSampleIds(){const e=[];for(const t of this._channels)for(const s of t.items)e.indexOf(s.id)===-1&&e.push(s.id);return e}get hasMetaData(){return this._metaData.has("meta")}get metaCutMode(){return this._metaData.has("c")}get metaTempo(){const e=this._metaData.get("t");return e?parseInt(e):null}}var Ga={};/*!
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(r){(function(){var e=function(){this.init()};e.prototype={init:function(){var c=this||t;return c._counter=1e3,c._html5AudioPool=[],c.html5PoolSize=10,c._codecs={},c._howls=[],c._muted=!1,c._volume=1,c._canPlayEvent="canplaythrough",c._navigator=typeof window<"u"&&window.navigator?window.navigator:null,c.masterGain=null,c.noAudio=!1,c.usingWebAudio=!0,c.autoSuspend=!0,c.ctx=null,c.autoUnlock=!0,c._setup(),c},volume:function(c){var _=this||t;if(c=parseFloat(c),_.ctx||d(),typeof c<"u"&&c>=0&&c<=1){if(_._volume=c,_._muted)return _;_.usingWebAudio&&_.masterGain.gain.setValueAtTime(c,t.ctx.currentTime);for(var f=0;f<_._howls.length;f++)if(!_._howls[f]._webAudio)for(var g=_._howls[f]._getSoundIds(),I=0;I<g.length;I++){var p=_._howls[f]._soundById(g[I]);p&&p._node&&(p._node.volume=p._volume*c)}return _}return _._volume},mute:function(c){var _=this||t;_.ctx||d(),_._muted=c,_.usingWebAudio&&_.masterGain.gain.setValueAtTime(c?0:_._volume,t.ctx.currentTime);for(var f=0;f<_._howls.length;f++)if(!_._howls[f]._webAudio)for(var g=_._howls[f]._getSoundIds(),I=0;I<g.length;I++){var p=_._howls[f]._soundById(g[I]);p&&p._node&&(p._node.muted=c?!0:p._muted)}return _},stop:function(){for(var c=this||t,_=0;_<c._howls.length;_++)c._howls[_].stop();return c},unload:function(){for(var c=this||t,_=c._howls.length-1;_>=0;_--)c._howls[_].unload();return c.usingWebAudio&&c.ctx&&typeof c.ctx.close<"u"&&(c.ctx.close(),c.ctx=null,d()),c},codecs:function(c){return(this||t)._codecs[c.replace(/^x-/,"")]},_setup:function(){var c=this||t;if(c.state=c.ctx&&c.ctx.state||"suspended",c._autoSuspend(),!c.usingWebAudio)if(typeof Audio<"u")try{var _=new Audio;typeof _.oncanplaythrough>"u"&&(c._canPlayEvent="canplay")}catch{c.noAudio=!0}else c.noAudio=!0;try{var _=new Audio;_.muted&&(c.noAudio=!0)}catch{}return c.noAudio||c._setupCodecs(),c},_setupCodecs:function(){var c=this||t,_=null;try{_=typeof Audio<"u"?new Audio:null}catch{return c}if(!_||typeof _.canPlayType!="function")return c;var f=_.canPlayType("audio/mpeg;").replace(/^no$/,""),g=c._navigator?c._navigator.userAgent:"",I=g.match(/OPR\/(\d+)/g),p=I&&parseInt(I[0].split("/")[1],10)<33,R=g.indexOf("Safari")!==-1&&g.indexOf("Chrome")===-1,S=g.match(/Version\/(.*?) /),O=R&&S&&parseInt(S[1],10)<15;return c._codecs={mp3:!!(!p&&(f||_.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!f,opus:!!_.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!_.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!_.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(_.canPlayType('audio/wav; codecs="1"')||_.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!_.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!_.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(_.canPlayType("audio/x-m4a;")||_.canPlayType("audio/m4a;")||_.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(_.canPlayType("audio/x-m4b;")||_.canPlayType("audio/m4b;")||_.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(_.canPlayType("audio/x-mp4;")||_.canPlayType("audio/mp4;")||_.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!O&&_.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!O&&_.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!_.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(_.canPlayType("audio/x-flac;")||_.canPlayType("audio/flac;")).replace(/^no$/,"")},c},_unlockAudio:function(){var c=this||t;if(!(c._audioUnlocked||!c.ctx)){c._audioUnlocked=!1,c.autoUnlock=!1,!c._mobileUnloaded&&c.ctx.sampleRate!==44100&&(c._mobileUnloaded=!0,c.unload()),c._scratchBuffer=c.ctx.createBuffer(1,1,22050);var _=function(f){for(;c._html5AudioPool.length<c.html5PoolSize;)try{var g=new Audio;g._unlocked=!0,c._releaseHtml5Audio(g)}catch{c.noAudio=!0;break}for(var I=0;I<c._howls.length;I++)if(!c._howls[I]._webAudio)for(var p=c._howls[I]._getSoundIds(),R=0;R<p.length;R++){var S=c._howls[I]._soundById(p[R]);S&&S._node&&!S._node._unlocked&&(S._node._unlocked=!0,S._node.load())}c._autoResume();var O=c.ctx.createBufferSource();O.buffer=c._scratchBuffer,O.connect(c.ctx.destination),typeof O.start>"u"?O.noteOn(0):O.start(0),typeof c.ctx.resume=="function"&&c.ctx.resume(),O.onended=function(){O.disconnect(0),c._audioUnlocked=!0,document.removeEventListener("touchstart",_,!0),document.removeEventListener("touchend",_,!0),document.removeEventListener("click",_,!0),document.removeEventListener("keydown",_,!0);for(var A=0;A<c._howls.length;A++)c._howls[A]._emit("unlock")}};return document.addEventListener("touchstart",_,!0),document.addEventListener("touchend",_,!0),document.addEventListener("click",_,!0),document.addEventListener("keydown",_,!0),c}},_obtainHtml5Audio:function(){var c=this||t;if(c._html5AudioPool.length)return c._html5AudioPool.pop();var _=new Audio().play();return _&&typeof Promise<"u"&&(_ instanceof Promise||typeof _.then=="function")&&_.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(c){var _=this||t;return c._unlocked&&_._html5AudioPool.push(c),_},_autoSuspend:function(){var c=this;if(!(!c.autoSuspend||!c.ctx||typeof c.ctx.suspend>"u"||!t.usingWebAudio)){for(var _=0;_<c._howls.length;_++)if(c._howls[_]._webAudio){for(var f=0;f<c._howls[_]._sounds.length;f++)if(!c._howls[_]._sounds[f]._paused)return c}return c._suspendTimer&&clearTimeout(c._suspendTimer),c._suspendTimer=setTimeout(function(){if(c.autoSuspend){c._suspendTimer=null,c.state="suspending";var g=function(){c.state="suspended",c._resumeAfterSuspend&&(delete c._resumeAfterSuspend,c._autoResume())};c.ctx.suspend().then(g,g)}},3e4),c}},_autoResume:function(){var c=this;if(!(!c.ctx||typeof c.ctx.resume>"u"||!t.usingWebAudio))return c.state==="running"&&c.ctx.state!=="interrupted"&&c._suspendTimer?(clearTimeout(c._suspendTimer),c._suspendTimer=null):c.state==="suspended"||c.state==="running"&&c.ctx.state==="interrupted"?(c.ctx.resume().then(function(){c.state="running";for(var _=0;_<c._howls.length;_++)c._howls[_]._emit("resume")}),c._suspendTimer&&(clearTimeout(c._suspendTimer),c._suspendTimer=null)):c.state==="suspending"&&(c._resumeAfterSuspend=!0),c}};var t=new e,s=function(c){var _=this;if(!c.src||c.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}_.init(c)};s.prototype={init:function(c){var _=this;return t.ctx||d(),_._autoplay=c.autoplay||!1,_._format=typeof c.format!="string"?c.format:[c.format],_._html5=c.html5||!1,_._muted=c.mute||!1,_._loop=c.loop||!1,_._pool=c.pool||5,_._preload=typeof c.preload=="boolean"||c.preload==="metadata"?c.preload:!0,_._rate=c.rate||1,_._sprite=c.sprite||{},_._src=typeof c.src!="string"?c.src:[c.src],_._volume=c.volume!==void 0?c.volume:1,_._xhr={method:c.xhr&&c.xhr.method?c.xhr.method:"GET",headers:c.xhr&&c.xhr.headers?c.xhr.headers:null,withCredentials:c.xhr&&c.xhr.withCredentials?c.xhr.withCredentials:!1},_._duration=0,_._state="unloaded",_._sounds=[],_._endTimers={},_._queue=[],_._playLock=!1,_._onend=c.onend?[{fn:c.onend}]:[],_._onfade=c.onfade?[{fn:c.onfade}]:[],_._onload=c.onload?[{fn:c.onload}]:[],_._onloaderror=c.onloaderror?[{fn:c.onloaderror}]:[],_._onplayerror=c.onplayerror?[{fn:c.onplayerror}]:[],_._onpause=c.onpause?[{fn:c.onpause}]:[],_._onplay=c.onplay?[{fn:c.onplay}]:[],_._onstop=c.onstop?[{fn:c.onstop}]:[],_._onmute=c.onmute?[{fn:c.onmute}]:[],_._onvolume=c.onvolume?[{fn:c.onvolume}]:[],_._onrate=c.onrate?[{fn:c.onrate}]:[],_._onseek=c.onseek?[{fn:c.onseek}]:[],_._onunlock=c.onunlock?[{fn:c.onunlock}]:[],_._onresume=[],_._webAudio=t.usingWebAudio&&!_._html5,typeof t.ctx<"u"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(_),_._autoplay&&_._queue.push({event:"play",action:function(){_.play()}}),_._preload&&_._preload!=="none"&&_.load(),_},load:function(){var c=this,_=null;if(t.noAudio){c._emit("loaderror",null,"No audio support.");return}typeof c._src=="string"&&(c._src=[c._src]);for(var f=0;f<c._src.length;f++){var g,I;if(c._format&&c._format[f])g=c._format[f];else{if(I=c._src[f],typeof I!="string"){c._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}g=/^data:audio\/([^;,]+);/i.exec(I),g||(g=/\.([^.]+)$/.exec(I.split("?",1)[0])),g&&(g=g[1].toLowerCase())}if(g||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),g&&t.codecs(g)){_=c._src[f];break}}if(!_){c._emit("loaderror",null,"No codec support for selected audio sources.");return}return c._src=_,c._state="loading",window.location.protocol==="https:"&&_.slice(0,5)==="http:"&&(c._html5=!0,c._webAudio=!1),new i(c),c._webAudio&&a(c),c},play:function(c,_){var f=this,g=null;if(typeof c=="number")g=c,c=null;else{if(typeof c=="string"&&f._state==="loaded"&&!f._sprite[c])return null;if(typeof c>"u"&&(c="__default",!f._playLock)){for(var I=0,p=0;p<f._sounds.length;p++)f._sounds[p]._paused&&!f._sounds[p]._ended&&(I++,g=f._sounds[p]._id);I===1?c=null:g=null}}var R=g?f._soundById(g):f._inactiveSound();if(!R)return null;if(g&&!c&&(c=R._sprite||"__default"),f._state!=="loaded"){R._sprite=c,R._ended=!1;var S=R._id;return f._queue.push({event:"play",action:function(){f.play(S)}}),S}if(g&&!R._paused)return _||f._loadQueue("play"),R._id;f._webAudio&&t._autoResume();var O=Math.max(0,R._seek>0?R._seek:f._sprite[c][0]/1e3),A=Math.max(0,(f._sprite[c][0]+f._sprite[c][1])/1e3-O),C=A*1e3/Math.abs(R._rate),M=f._sprite[c][0]/1e3,N=(f._sprite[c][0]+f._sprite[c][1])/1e3;R._sprite=c,R._ended=!1;var L=function(){R._paused=!1,R._seek=O,R._start=M,R._stop=N,R._loop=!!(R._loop||f._sprite[c][2])};if(O>=N){f._ended(R);return}var b=R._node;if(f._webAudio){var D=function(){f._playLock=!1,L(),f._refreshBuffer(R);var Te=R._muted||f._muted?0:R._volume;b.gain.setValueAtTime(Te,t.ctx.currentTime),R._playStart=t.ctx.currentTime,typeof b.bufferSource.start>"u"?R._loop?b.bufferSource.noteGrainOn(0,O,86400):b.bufferSource.noteGrainOn(0,O,A):R._loop?b.bufferSource.start(0,O,86400):b.bufferSource.start(0,O,A),C!==1/0&&(f._endTimers[R._id]=setTimeout(f._ended.bind(f,R),C)),_||setTimeout(function(){f._emit("play",R._id),f._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?D():(f._playLock=!0,f.once("resume",D),f._clearTimer(R._id))}else{var x=function(){b.currentTime=O,b.muted=R._muted||f._muted||t._muted||b.muted,b.volume=R._volume*t.volume(),b.playbackRate=R._rate;try{var Te=b.play();if(Te&&typeof Promise<"u"&&(Te instanceof Promise||typeof Te.then=="function")?(f._playLock=!0,L(),Te.then(function(){f._playLock=!1,b._unlocked=!0,_?f._loadQueue():f._emit("play",R._id)}).catch(function(){f._playLock=!1,f._emit("playerror",R._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),R._ended=!0,R._paused=!0})):_||(f._playLock=!1,L(),f._emit("play",R._id)),b.playbackRate=R._rate,b.paused){f._emit("playerror",R._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}c!=="__default"||R._loop?f._endTimers[R._id]=setTimeout(f._ended.bind(f,R),C):(f._endTimers[R._id]=function(){f._ended(R),b.removeEventListener("ended",f._endTimers[R._id],!1)},b.addEventListener("ended",f._endTimers[R._id],!1))}catch(j){f._emit("playerror",R._id,j)}};b.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(b.src=f._src,b.load());var q=window&&window.ejecta||!b.readyState&&t._navigator.isCocoonJS;if(b.readyState>=3||q)x();else{f._playLock=!0,f._state="loading";var $=function(){f._state="loaded",x(),b.removeEventListener(t._canPlayEvent,$,!1)};b.addEventListener(t._canPlayEvent,$,!1),f._clearTimer(R._id)}}return R._id},pause:function(c){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"pause",action:function(){_.pause(c)}}),_;for(var f=_._getSoundIds(c),g=0;g<f.length;g++){_._clearTimer(f[g]);var I=_._soundById(f[g]);if(I&&!I._paused&&(I._seek=_.seek(f[g]),I._rateSeek=0,I._paused=!0,_._stopFade(f[g]),I._node))if(_._webAudio){if(!I._node.bufferSource)continue;typeof I._node.bufferSource.stop>"u"?I._node.bufferSource.noteOff(0):I._node.bufferSource.stop(0),_._cleanBuffer(I._node)}else(!isNaN(I._node.duration)||I._node.duration===1/0)&&I._node.pause();arguments[1]||_._emit("pause",I?I._id:null)}return _},stop:function(c,_){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"stop",action:function(){f.stop(c)}}),f;for(var g=f._getSoundIds(c),I=0;I<g.length;I++){f._clearTimer(g[I]);var p=f._soundById(g[I]);p&&(p._seek=p._start||0,p._rateSeek=0,p._paused=!0,p._ended=!0,f._stopFade(g[I]),p._node&&(f._webAudio?p._node.bufferSource&&(typeof p._node.bufferSource.stop>"u"?p._node.bufferSource.noteOff(0):p._node.bufferSource.stop(0),f._cleanBuffer(p._node)):(!isNaN(p._node.duration)||p._node.duration===1/0)&&(p._node.currentTime=p._start||0,p._node.pause(),p._node.duration===1/0&&f._clearSound(p._node))),_||f._emit("stop",p._id))}return f},mute:function(c,_){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"mute",action:function(){f.mute(c,_)}}),f;if(typeof _>"u")if(typeof c=="boolean")f._muted=c;else return f._muted;for(var g=f._getSoundIds(_),I=0;I<g.length;I++){var p=f._soundById(g[I]);p&&(p._muted=c,p._interval&&f._stopFade(p._id),f._webAudio&&p._node?p._node.gain.setValueAtTime(c?0:p._volume,t.ctx.currentTime):p._node&&(p._node.muted=t._muted?!0:c),f._emit("mute",p._id))}return f},volume:function(){var c=this,_=arguments,f,g;if(_.length===0)return c._volume;if(_.length===1||_.length===2&&typeof _[1]>"u"){var I=c._getSoundIds(),p=I.indexOf(_[0]);p>=0?g=parseInt(_[0],10):f=parseFloat(_[0])}else _.length>=2&&(f=parseFloat(_[0]),g=parseInt(_[1],10));var R;if(typeof f<"u"&&f>=0&&f<=1){if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"volume",action:function(){c.volume.apply(c,_)}}),c;typeof g>"u"&&(c._volume=f),g=c._getSoundIds(g);for(var S=0;S<g.length;S++)R=c._soundById(g[S]),R&&(R._volume=f,_[2]||c._stopFade(g[S]),c._webAudio&&R._node&&!R._muted?R._node.gain.setValueAtTime(f,t.ctx.currentTime):R._node&&!R._muted&&(R._node.volume=f*t.volume()),c._emit("volume",R._id))}else return R=g?c._soundById(g):c._sounds[0],R?R._volume:0;return c},fade:function(c,_,f,g){var I=this;if(I._state!=="loaded"||I._playLock)return I._queue.push({event:"fade",action:function(){I.fade(c,_,f,g)}}),I;c=Math.min(Math.max(0,parseFloat(c)),1),_=Math.min(Math.max(0,parseFloat(_)),1),f=parseFloat(f),I.volume(c,g);for(var p=I._getSoundIds(g),R=0;R<p.length;R++){var S=I._soundById(p[R]);if(S){if(g||I._stopFade(p[R]),I._webAudio&&!S._muted){var O=t.ctx.currentTime,A=O+f/1e3;S._volume=c,S._node.gain.setValueAtTime(c,O),S._node.gain.linearRampToValueAtTime(_,A)}I._startFadeInterval(S,c,_,f,p[R],typeof g>"u")}}return I},_startFadeInterval:function(c,_,f,g,I,p){var R=this,S=_,O=f-_,A=Math.abs(O/.01),C=Math.max(4,A>0?g/A:g),M=Date.now();c._fadeTo=f,c._interval=setInterval(function(){var N=(Date.now()-M)/g;M=Date.now(),S+=O*N,S=Math.round(S*100)/100,O<0?S=Math.max(f,S):S=Math.min(f,S),R._webAudio?c._volume=S:R.volume(S,c._id,!0),p&&(R._volume=S),(f<_&&S<=f||f>_&&S>=f)&&(clearInterval(c._interval),c._interval=null,c._fadeTo=null,R.volume(f,c._id),R._emit("fade",c._id))},C)},_stopFade:function(c){var _=this,f=_._soundById(c);return f&&f._interval&&(_._webAudio&&f._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(f._interval),f._interval=null,_.volume(f._fadeTo,c),f._fadeTo=null,_._emit("fade",c)),_},loop:function(){var c=this,_=arguments,f,g,I;if(_.length===0)return c._loop;if(_.length===1)if(typeof _[0]=="boolean")f=_[0],c._loop=f;else return I=c._soundById(parseInt(_[0],10)),I?I._loop:!1;else _.length===2&&(f=_[0],g=parseInt(_[1],10));for(var p=c._getSoundIds(g),R=0;R<p.length;R++)I=c._soundById(p[R]),I&&(I._loop=f,c._webAudio&&I._node&&I._node.bufferSource&&(I._node.bufferSource.loop=f,f&&(I._node.bufferSource.loopStart=I._start||0,I._node.bufferSource.loopEnd=I._stop,c.playing(p[R])&&(c.pause(p[R],!0),c.play(p[R],!0)))));return c},rate:function(){var c=this,_=arguments,f,g;if(_.length===0)g=c._sounds[0]._id;else if(_.length===1){var I=c._getSoundIds(),p=I.indexOf(_[0]);p>=0?g=parseInt(_[0],10):f=parseFloat(_[0])}else _.length===2&&(f=parseFloat(_[0]),g=parseInt(_[1],10));var R;if(typeof f=="number"){if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"rate",action:function(){c.rate.apply(c,_)}}),c;typeof g>"u"&&(c._rate=f),g=c._getSoundIds(g);for(var S=0;S<g.length;S++)if(R=c._soundById(g[S]),R){c.playing(g[S])&&(R._rateSeek=c.seek(g[S]),R._playStart=c._webAudio?t.ctx.currentTime:R._playStart),R._rate=f,c._webAudio&&R._node&&R._node.bufferSource?R._node.bufferSource.playbackRate.setValueAtTime(f,t.ctx.currentTime):R._node&&(R._node.playbackRate=f);var O=c.seek(g[S]),A=(c._sprite[R._sprite][0]+c._sprite[R._sprite][1])/1e3-O,C=A*1e3/Math.abs(R._rate);(c._endTimers[g[S]]||!R._paused)&&(c._clearTimer(g[S]),c._endTimers[g[S]]=setTimeout(c._ended.bind(c,R),C)),c._emit("rate",R._id)}}else return R=c._soundById(g),R?R._rate:c._rate;return c},seek:function(){var c=this,_=arguments,f,g;if(_.length===0)c._sounds.length&&(g=c._sounds[0]._id);else if(_.length===1){var I=c._getSoundIds(),p=I.indexOf(_[0]);p>=0?g=parseInt(_[0],10):c._sounds.length&&(g=c._sounds[0]._id,f=parseFloat(_[0]))}else _.length===2&&(f=parseFloat(_[0]),g=parseInt(_[1],10));if(typeof g>"u")return 0;if(typeof f=="number"&&(c._state!=="loaded"||c._playLock))return c._queue.push({event:"seek",action:function(){c.seek.apply(c,_)}}),c;var R=c._soundById(g);if(R)if(typeof f=="number"&&f>=0){var S=c.playing(g);S&&c.pause(g,!0),R._seek=f,R._ended=!1,c._clearTimer(g),!c._webAudio&&R._node&&!isNaN(R._node.duration)&&(R._node.currentTime=f);var O=function(){S&&c.play(g,!0),c._emit("seek",g)};if(S&&!c._webAudio){var A=function(){c._playLock?setTimeout(A,0):O()};setTimeout(A,0)}else O()}else if(c._webAudio){var C=c.playing(g)?t.ctx.currentTime-R._playStart:0,M=R._rateSeek?R._rateSeek-R._seek:0;return R._seek+(M+C*Math.abs(R._rate))}else return R._node.currentTime;return c},playing:function(c){var _=this;if(typeof c=="number"){var f=_._soundById(c);return f?!f._paused:!1}for(var g=0;g<_._sounds.length;g++)if(!_._sounds[g]._paused)return!0;return!1},duration:function(c){var _=this,f=_._duration,g=_._soundById(c);return g&&(f=_._sprite[g._sprite][1]/1e3),f},state:function(){return this._state},unload:function(){for(var c=this,_=c._sounds,f=0;f<_.length;f++)_[f]._paused||c.stop(_[f]._id),c._webAudio||(c._clearSound(_[f]._node),_[f]._node.removeEventListener("error",_[f]._errorFn,!1),_[f]._node.removeEventListener(t._canPlayEvent,_[f]._loadFn,!1),_[f]._node.removeEventListener("ended",_[f]._endFn,!1),t._releaseHtml5Audio(_[f]._node)),delete _[f]._node,c._clearTimer(_[f]._id);var g=t._howls.indexOf(c);g>=0&&t._howls.splice(g,1);var I=!0;for(f=0;f<t._howls.length;f++)if(t._howls[f]._src===c._src||c._src.indexOf(t._howls[f]._src)>=0){I=!1;break}return n&&I&&delete n[c._src],t.noAudio=!1,c._state="unloaded",c._sounds=[],c=null,null},on:function(c,_,f,g){var I=this,p=I["_on"+c];return typeof _=="function"&&p.push(g?{id:f,fn:_,once:g}:{id:f,fn:_}),I},off:function(c,_,f){var g=this,I=g["_on"+c],p=0;if(typeof _=="number"&&(f=_,_=null),_||f)for(p=0;p<I.length;p++){var R=f===I[p].id;if(_===I[p].fn&&R||!_&&R){I.splice(p,1);break}}else if(c)g["_on"+c]=[];else{var S=Object.keys(g);for(p=0;p<S.length;p++)S[p].indexOf("_on")===0&&Array.isArray(g[S[p]])&&(g[S[p]]=[])}return g},once:function(c,_,f){var g=this;return g.on(c,_,f,1),g},_emit:function(c,_,f){for(var g=this,I=g["_on"+c],p=I.length-1;p>=0;p--)(!I[p].id||I[p].id===_||c==="load")&&(setTimeout((function(R){R.call(this,_,f)}).bind(g,I[p].fn),0),I[p].once&&g.off(c,I[p].fn,I[p].id));return g._loadQueue(c),g},_loadQueue:function(c){var _=this;if(_._queue.length>0){var f=_._queue[0];f.event===c&&(_._queue.shift(),_._loadQueue()),c||f.action()}return _},_ended:function(c){var _=this,f=c._sprite;if(!_._webAudio&&c._node&&!c._node.paused&&!c._node.ended&&c._node.currentTime<c._stop)return setTimeout(_._ended.bind(_,c),100),_;var g=!!(c._loop||_._sprite[f][2]);if(_._emit("end",c._id),!_._webAudio&&g&&_.stop(c._id,!0).play(c._id),_._webAudio&&g){_._emit("play",c._id),c._seek=c._start||0,c._rateSeek=0,c._playStart=t.ctx.currentTime;var I=(c._stop-c._start)*1e3/Math.abs(c._rate);_._endTimers[c._id]=setTimeout(_._ended.bind(_,c),I)}return _._webAudio&&!g&&(c._paused=!0,c._ended=!0,c._seek=c._start||0,c._rateSeek=0,_._clearTimer(c._id),_._cleanBuffer(c._node),t._autoSuspend()),!_._webAudio&&!g&&_.stop(c._id,!0),_},_clearTimer:function(c){var _=this;if(_._endTimers[c]){if(typeof _._endTimers[c]!="function")clearTimeout(_._endTimers[c]);else{var f=_._soundById(c);f&&f._node&&f._node.removeEventListener("ended",_._endTimers[c],!1)}delete _._endTimers[c]}return _},_soundById:function(c){for(var _=this,f=0;f<_._sounds.length;f++)if(c===_._sounds[f]._id)return _._sounds[f];return null},_inactiveSound:function(){var c=this;c._drain();for(var _=0;_<c._sounds.length;_++)if(c._sounds[_]._ended)return c._sounds[_].reset();return new i(c)},_drain:function(){var c=this,_=c._pool,f=0,g=0;if(!(c._sounds.length<_)){for(g=0;g<c._sounds.length;g++)c._sounds[g]._ended&&f++;for(g=c._sounds.length-1;g>=0;g--){if(f<=_)return;c._sounds[g]._ended&&(c._webAudio&&c._sounds[g]._node&&c._sounds[g]._node.disconnect(0),c._sounds.splice(g,1),f--)}}},_getSoundIds:function(c){var _=this;if(typeof c>"u"){for(var f=[],g=0;g<_._sounds.length;g++)f.push(_._sounds[g]._id);return f}else return[c]},_refreshBuffer:function(c){var _=this;return c._node.bufferSource=t.ctx.createBufferSource(),c._node.bufferSource.buffer=n[_._src],c._panner?c._node.bufferSource.connect(c._panner):c._node.bufferSource.connect(c._node),c._node.bufferSource.loop=c._loop,c._loop&&(c._node.bufferSource.loopStart=c._start||0,c._node.bufferSource.loopEnd=c._stop||0),c._node.bufferSource.playbackRate.setValueAtTime(c._rate,t.ctx.currentTime),_},_cleanBuffer:function(c){var _=this,f=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(!c.bufferSource)return _;if(t._scratchBuffer&&c.bufferSource&&(c.bufferSource.onended=null,c.bufferSource.disconnect(0),f))try{c.bufferSource.buffer=t._scratchBuffer}catch{}return c.bufferSource=null,_},_clearSound:function(c){var _=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);_||(c.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function(c){this._parent=c,this.init()};i.prototype={init:function(){var c=this,_=c._parent;return c._muted=_._muted,c._loop=_._loop,c._volume=_._volume,c._rate=_._rate,c._seek=0,c._paused=!0,c._ended=!0,c._sprite="__default",c._id=++t._counter,_._sounds.push(c),c.create(),c},create:function(){var c=this,_=c._parent,f=t._muted||c._muted||c._parent._muted?0:c._volume;return _._webAudio?(c._node=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),c._node.gain.setValueAtTime(f,t.ctx.currentTime),c._node.paused=!0,c._node.connect(t.masterGain)):t.noAudio||(c._node=t._obtainHtml5Audio(),c._errorFn=c._errorListener.bind(c),c._node.addEventListener("error",c._errorFn,!1),c._loadFn=c._loadListener.bind(c),c._node.addEventListener(t._canPlayEvent,c._loadFn,!1),c._endFn=c._endListener.bind(c),c._node.addEventListener("ended",c._endFn,!1),c._node.src=_._src,c._node.preload=_._preload===!0?"auto":_._preload,c._node.volume=f*t.volume(),c._node.load()),c},reset:function(){var c=this,_=c._parent;return c._muted=_._muted,c._loop=_._loop,c._volume=_._volume,c._rate=_._rate,c._seek=0,c._rateSeek=0,c._paused=!0,c._ended=!0,c._sprite="__default",c._id=++t._counter,c},_errorListener:function(){var c=this;c._parent._emit("loaderror",c._id,c._node.error?c._node.error.code:0),c._node.removeEventListener("error",c._errorFn,!1)},_loadListener:function(){var c=this,_=c._parent;_._duration=Math.ceil(c._node.duration*10)/10,Object.keys(_._sprite).length===0&&(_._sprite={__default:[0,_._duration*1e3]}),_._state!=="loaded"&&(_._state="loaded",_._emit("load"),_._loadQueue()),c._node.removeEventListener(t._canPlayEvent,c._loadFn,!1)},_endListener:function(){var c=this,_=c._parent;_._duration===1/0&&(_._duration=Math.ceil(c._node.duration*10)/10,_._sprite.__default[1]===1/0&&(_._sprite.__default[1]=_._duration*1e3),_._ended(c)),c._node.removeEventListener("ended",c._endFn,!1)}};var n={},a=function(c){var _=c._src;if(n[_]){c._duration=n[_].duration,l(c);return}if(/^data:[^;]+;base64,/.test(_)){for(var f=atob(_.split(",")[1]),g=new Uint8Array(f.length),I=0;I<f.length;++I)g[I]=f.charCodeAt(I);u(g.buffer,c)}else{var p=new XMLHttpRequest;p.open(c._xhr.method,_,!0),p.withCredentials=c._xhr.withCredentials,p.responseType="arraybuffer",c._xhr.headers&&Object.keys(c._xhr.headers).forEach(function(R){p.setRequestHeader(R,c._xhr.headers[R])}),p.onload=function(){var R=(p.status+"")[0];if(R!=="0"&&R!=="2"&&R!=="3"){c._emit("loaderror",null,"Failed loading audio file with status: "+p.status+".");return}u(p.response,c)},p.onerror=function(){c._webAudio&&(c._html5=!0,c._webAudio=!1,c._sounds=[],delete n[_],c.load())},o(p)}},o=function(c){try{c.send()}catch{c.onerror()}},u=function(c,_){var f=function(){_._emit("loaderror",null,"Decoding audio data failed.")},g=function(I){I&&_._sounds.length>0?(n[_._src]=I,l(_,I)):f()};typeof Promise<"u"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(c).then(g).catch(f):t.ctx.decodeAudioData(c,g,f)},l=function(c,_){_&&!c._duration&&(c._duration=_.duration),Object.keys(c._sprite).length===0&&(c._sprite={__default:[0,c._duration*1e3]}),c._state!=="loaded"&&(c._state="loaded",c._emit("load"),c._loadQueue())},d=function(){if(t.usingWebAudio){try{typeof AudioContext<"u"?t.ctx=new AudioContext:typeof webkitAudioContext<"u"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var c=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),_=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),f=_?parseInt(_[1],10):null;if(c&&f&&f<9){var g=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!g&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};r.Howler=t,r.Howl=s,typeof Ci<"u"?(Ci.HowlerGlobal=e,Ci.Howler=t,Ci.Howl=s,Ci.Sound=i):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=t,window.Howl=s,window.Sound=i)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var s=this;if(!s.ctx||!s.ctx.listener)return s;for(var i=s._howls.length-1;i>=0;i--)s._howls[i].stereo(t);return s},HowlerGlobal.prototype.pos=function(t,s,i){var n=this;if(!n.ctx||!n.ctx.listener)return n;if(s=typeof s!="number"?n._pos[1]:s,i=typeof i!="number"?n._pos[2]:i,typeof t=="number")n._pos=[t,s,i],typeof n.ctx.listener.positionX<"u"?(n.ctx.listener.positionX.setTargetAtTime(n._pos[0],Howler.ctx.currentTime,.1),n.ctx.listener.positionY.setTargetAtTime(n._pos[1],Howler.ctx.currentTime,.1),n.ctx.listener.positionZ.setTargetAtTime(n._pos[2],Howler.ctx.currentTime,.1)):n.ctx.listener.setPosition(n._pos[0],n._pos[1],n._pos[2]);else return n._pos;return n},HowlerGlobal.prototype.orientation=function(t,s,i,n,a,o){var u=this;if(!u.ctx||!u.ctx.listener)return u;var l=u._orientation;if(s=typeof s!="number"?l[1]:s,i=typeof i!="number"?l[2]:i,n=typeof n!="number"?l[3]:n,a=typeof a!="number"?l[4]:a,o=typeof o!="number"?l[5]:o,typeof t=="number")u._orientation=[t,s,i,n,a,o],typeof u.ctx.listener.forwardX<"u"?(u.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),u.ctx.listener.forwardY.setTargetAtTime(s,Howler.ctx.currentTime,.1),u.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),u.ctx.listener.upX.setTargetAtTime(n,Howler.ctx.currentTime,.1),u.ctx.listener.upY.setTargetAtTime(a,Howler.ctx.currentTime,.1),u.ctx.listener.upZ.setTargetAtTime(o,Howler.ctx.currentTime,.1)):u.ctx.listener.setOrientation(t,s,i,n,a,o);else return l;return u},Howl.prototype.init=function(t){return function(s){var i=this;return i._orientation=s.orientation||[1,0,0],i._stereo=s.stereo||null,i._pos=s.pos||null,i._pannerAttr={coneInnerAngle:typeof s.coneInnerAngle<"u"?s.coneInnerAngle:360,coneOuterAngle:typeof s.coneOuterAngle<"u"?s.coneOuterAngle:360,coneOuterGain:typeof s.coneOuterGain<"u"?s.coneOuterGain:0,distanceModel:typeof s.distanceModel<"u"?s.distanceModel:"inverse",maxDistance:typeof s.maxDistance<"u"?s.maxDistance:1e4,panningModel:typeof s.panningModel<"u"?s.panningModel:"HRTF",refDistance:typeof s.refDistance<"u"?s.refDistance:1,rolloffFactor:typeof s.rolloffFactor<"u"?s.rolloffFactor:1},i._onstereo=s.onstereo?[{fn:s.onstereo}]:[],i._onpos=s.onpos?[{fn:s.onpos}]:[],i._onorientation=s.onorientation?[{fn:s.onorientation}]:[],t.call(this,s)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,s){var i=this;if(!i._webAudio)return i;if(i._state!=="loaded")return i._queue.push({event:"stereo",action:function(){i.stereo(t,s)}}),i;var n=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof s>"u")if(typeof t=="number")i._stereo=t,i._pos=[t,0,0];else return i._stereo;for(var a=i._getSoundIds(s),o=0;o<a.length;o++){var u=i._soundById(a[o]);if(u)if(typeof t=="number")u._stereo=t,u._pos=[t,0,0],u._node&&(u._pannerAttr.panningModel="equalpower",(!u._panner||!u._panner.pan)&&e(u,n),n==="spatial"?typeof u._panner.positionX<"u"?(u._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):u._panner.setPosition(t,0,0):u._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),i._emit("stereo",u._id);else return u._stereo}return i},Howl.prototype.pos=function(t,s,i,n){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"pos",action:function(){a.pos(t,s,i,n)}}),a;if(s=typeof s!="number"?0:s,i=typeof i!="number"?-.5:i,typeof n>"u")if(typeof t=="number")a._pos=[t,s,i];else return a._pos;for(var o=a._getSoundIds(n),u=0;u<o.length;u++){var l=a._soundById(o[u]);if(l)if(typeof t=="number")l._pos=[t,s,i],l._node&&((!l._panner||l._panner.pan)&&e(l,"spatial"),typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(s,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):l._panner.setPosition(t,s,i)),a._emit("pos",l._id);else return l._pos}return a},Howl.prototype.orientation=function(t,s,i,n){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"orientation",action:function(){a.orientation(t,s,i,n)}}),a;if(s=typeof s!="number"?a._orientation[1]:s,i=typeof i!="number"?a._orientation[2]:i,typeof n>"u")if(typeof t=="number")a._orientation=[t,s,i];else return a._orientation;for(var o=a._getSoundIds(n),u=0;u<o.length;u++){var l=a._soundById(o[u]);if(l)if(typeof t=="number")l._orientation=[t,s,i],l._node&&(l._panner||(l._pos||(l._pos=a._pos||[0,0,-.5]),e(l,"spatial")),typeof l._panner.orientationX<"u"?(l._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(s,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):l._panner.setOrientation(t,s,i)),a._emit("orientation",l._id);else return l._orientation}return a},Howl.prototype.pannerAttr=function(){var t=this,s=arguments,i,n,a;if(!t._webAudio)return t;if(s.length===0)return t._pannerAttr;if(s.length===1)if(typeof s[0]=="object")i=s[0],typeof n>"u"&&(i.pannerAttr||(i.pannerAttr={coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,panningModel:i.panningModel}),t._pannerAttr={coneInnerAngle:typeof i.pannerAttr.coneInnerAngle<"u"?i.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof i.pannerAttr.coneOuterAngle<"u"?i.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof i.pannerAttr.coneOuterGain<"u"?i.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof i.pannerAttr.distanceModel<"u"?i.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof i.pannerAttr.maxDistance<"u"?i.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof i.pannerAttr.refDistance<"u"?i.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof i.pannerAttr.rolloffFactor<"u"?i.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof i.pannerAttr.panningModel<"u"?i.pannerAttr.panningModel:t._panningModel});else return a=t._soundById(parseInt(s[0],10)),a?a._pannerAttr:t._pannerAttr;else s.length===2&&(i=s[0],n=parseInt(s[1],10));for(var o=t._getSoundIds(n),u=0;u<o.length;u++)if(a=t._soundById(o[u]),a){var l=a._pannerAttr;l={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:l.coneOuterAngle,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:l.coneOuterGain,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:l.distanceModel,maxDistance:typeof i.maxDistance<"u"?i.maxDistance:l.maxDistance,refDistance:typeof i.refDistance<"u"?i.refDistance:l.refDistance,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:l.rolloffFactor,panningModel:typeof i.panningModel<"u"?i.panningModel:l.panningModel};var d=a._panner;d||(a._pos||(a._pos=t._pos||[0,0,-.5]),e(a,"spatial"),d=a._panner),d.coneInnerAngle=l.coneInnerAngle,d.coneOuterAngle=l.coneOuterAngle,d.coneOuterGain=l.coneOuterGain,d.distanceModel=l.distanceModel,d.maxDistance=l.maxDistance,d.refDistance=l.refDistance,d.rolloffFactor=l.rolloffFactor,d.panningModel=l.panningModel}return t},Sound.prototype.init=function(t){return function(){var s=this,i=s._parent;s._orientation=i._orientation,s._stereo=i._stereo,s._pos=i._pos,s._pannerAttr=i._pannerAttr,t.call(this),s._stereo?i.stereo(s._stereo):s._pos&&i.pos(s._pos[0],s._pos[1],s._pos[2],s._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var s=this,i=s._parent;return s._orientation=i._orientation,s._stereo=i._stereo,s._pos=i._pos,s._pannerAttr=i._pannerAttr,s._stereo?i.stereo(s._stereo):s._pos?i.pos(s._pos[0],s._pos[1],s._pos[2],s._id):s._panner&&(s._panner.disconnect(0),s._panner=void 0,i._refreshBuffer(s)),t.call(this)}}(Sound.prototype.reset);var e=function(t,s){s=s||"spatial",s==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX<"u"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX<"u"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()})(Ga);class dZ{constructor(e){this._sampleUrl=e,this._isPlaying=!1,this._startPos=0,this._currentPos=0,this._playLength=0,this._sequence=[],this._cache=new Map}play(e,t,s=0,i=-1){return mt(this,void 0,void 0,function*(){this.reset(),this._currentSong=new hd(e),this._startPos=Math.trunc(s),this._playLength=i,this._currentPos=this._startPos,this._currentSongId=t,yield this.preload(),this._isPlaying=!0,this.tick(),this._tickerInterval=window.setInterval(()=>this.tick(),1e3)})}reset(){this._isPlaying=!1,window.clearInterval(this._tickerInterval),Ga.Howler.stop(),this._currentSongId=-1,this._currentSong=void 0,this._tickerInterval=void 0,this._startPos=0,this._playLength=0,this._sequence=[],this._currentPos=0}pause(){this._isPlaying=!1,Ga.Howler.stop()}resume(){this._isPlaying=!0}stop(){const e=this._currentSongId;this.reset(),X.instance.soundManager.events.dispatchEvent(new qo(qo.TRAX_SONG_COMPLETE,e))}setVolume(e){Ga.Howler.volume(e)}getVolume(){return Ga.Howler.volume()}getSample(e){return mt(this,void 0,void 0,function*(){let t=this._cache.get(e);return t||(t=yield this.loadSong(e)),Promise.resolve(t)})}preload(){return mt(this,void 0,void 0,function*(){if(this._sequence=[],!!this._currentSong){for(const e of this._currentSong.channels){const t=[];for(const s of e.items){const i=yield this.getSample(s.id),n=Math.ceil(s.length*2/Math.ceil(i.duration()));for(let a=0;a<n;a++)for(let o=0;o<Math.ceil(i.duration());o++)t.push({sampleId:s.id,offset:o})}this._sequence.push(t)}this._playLength<=0&&(this._playLength=Math.max(...this._sequence.map(e=>e.length)))}})}preloadSamplesForSong(e){return mt(this,void 0,void 0,function*(){const t=new hd(e);yield Promise.all(t.getSampleIds().map(s=>this.getSample(s)))})}loadSong(e){return mt(this,void 0,void 0,function*(){return new Promise((t,s)=>{const i=new Ga.Howl({src:[this._sampleUrl.replace("%sample%",e.toString())],preload:!0});i.once("load",()=>{this._cache.set(e,i),t(i)}),i.once("loaderror",()=>{Y.error("failed to load sample "+e),s("failed to load sample "+e)})})})}tick(){this._currentPos>this._playLength-1&&this.stop(),this._isPlaying&&(this._currentSong&&this.playPosition(this._currentPos),this._currentPos++)}playPosition(e){if(!(!this._currentSong||!this._sequence)&&Ga.Howler._audioUnlocked)for(const t of this._sequence){const s=t[e];if(!s||s.sampleId===-1||s.sampleId===0)continue;const i=this._cache.get(s.sampleId);i&&(s.offset===0?i.play():i.playing()||(i.seek(s.offset),i.play()))}}}class kn{constructor(){this._priorityPlaying=-1,this._requestNumberPlaying=-1,this._previousNotificationTime=-1,this._timerInstance=-1,this._songRequestList=[],this._requestedSongs=new Map,this._availableSongs=new Map,this._songDiskInventory=new Ot,this._songRequestsPerPriority=[],this._songRequestCountsPerPriority=[],this._diskInventoryMissingData=[],this._songIdPlaying=-1,this._previousNotifiedSongId=-1,this._messageEvents=[new bE(this.onTraxSongInfoMessageEvent.bind(this)),new DE(this.onSongDiskInventoryMessage.bind(this))],this.onJukeboxInit=this.onJukeboxInit.bind(this),this.onJukeboxDispose=this.onJukeboxDispose.bind(this),this.onSoundMachineInit=this.onSoundMachineInit.bind(this),this.onSoundMachineDispose=this.onSoundMachineDispose.bind(this),this.onTraxSongComplete=this.onTraxSongComplete.bind(this)}init(){this._timerInstance=window.setInterval(this.onTick.bind(this),1e3),this._musicPlayer=new dZ(X.instance.getConfiguration("external.samples.url")),this._messageEvents.forEach(e=>X.instance.communication.connection.addMessageEvent(e)),X.instance.roomEngine.events.addEventListener(ke.JUKEBOX_INIT,this.onJukeboxInit),X.instance.roomEngine.events.addEventListener(ke.JUKEBOX_DISPOSE,this.onJukeboxDispose),X.instance.roomEngine.events.addEventListener(ke.SOUND_MACHINE_INIT,this.onSoundMachineInit),X.instance.roomEngine.events.addEventListener(ke.SOUND_MACHINE_DISPOSE,this.onSoundMachineDispose),X.instance.soundManager.events.addEventListener(qo.TRAX_SONG_COMPLETE,this.onTraxSongComplete)}getRoomItemPlaylist(e){return this._roomItemPlaylist}get songDiskInventory(){return this._songDiskInventory}getSongDiskInventorySize(){return this._songDiskInventory.length}getSongDiskInventoryDiskId(e){return e>=0&&e<this._songDiskInventory.length?this._songDiskInventory.getKey(e):-1}getSongDiskInventorySongId(e){return e>=0&&e<this._songDiskInventory.length?this._songDiskInventory.getWithIndex(e):-1}getSongInfo(e){const t=this.getSongDataEntry(e);return t||this.requestSongInfoWithoutSamples(e),t}getSongIdPlayingAtPriority(e){return e!==this._priorityPlaying?-1:this._songIdPlaying}stop(e){const t=e===this._priorityPlaying,s=this.getTopRequestPriority()===e;t?(this.resetSongStartRequest(e),this.stopSongAtPriority(e)):(this.resetSongStartRequest(e),s&&this.reRequestSongAtPriority(this._priorityPlaying))}addSongInfoRequest(e){this.requestSong(e,!0)}requestSongInfoWithoutSamples(e){this.requestSong(e,!1)}requestUserSongDisks(){X.instance.communication.connection.send(new up)}updateVolume(e){this._musicPlayer.setVolume(e)}dispose(){this._timerInstance&&(clearInterval(this._timerInstance),this._timerInstance=void 0),this._messageEvents.forEach(e=>X.instance.communication.connection.removeMessageEvent(e)),X.instance.roomEngine.events.removeEventListener(ke.JUKEBOX_INIT,this.onJukeboxInit),X.instance.roomEngine.events.removeEventListener(ke.JUKEBOX_DISPOSE,this.onJukeboxDispose),X.instance.roomEngine.events.removeEventListener(ke.SOUND_MACHINE_INIT,this.onSoundMachineInit),X.instance.roomEngine.events.removeEventListener(ke.SOUND_MACHINE_DISPOSE,this.onSoundMachineDispose),X.instance.soundManager.events.removeEventListener(qo.TRAX_SONG_COMPLETE,this.onTraxSongComplete)}get samplesIdsInUse(){let e,t,s=[];for(let i=0;i<this._songRequestsPerPriority.length;i++)if(this._songRequestsPerPriority[i]&&(e=this._songRequestsPerPriority[i],t=this._availableSongs.get(e.songId),t)){const n=t.songData;if(n.length>0){const a=new hd(n);s=s.concat(a.getSampleIds())}}return s}onSongLoaded(e){const t=this.getTopRequestPriority();if(t>=0){const s=this.getSongIdRequestedAtPriority(t);e===s&&this.playSongObject(t,e)}}samplesUnloaded(e){throw new Error("Method not implemented.")}onTraxSongComplete(e){if(this.getSongIdPlayingAtPriority(this._priorityPlaying)===e.id){this.getTopRequestPriority()===this._priorityPlaying&&this.getSongRequestCountAtPriority(this._priorityPlaying)==this._requestNumberPlaying&&this.resetSongStartRequest(this._priorityPlaying);const t=this._priorityPlaying;this.playSongWithHighestPriority(),t>=us.PRIORITY_SONG_PLAY&&X.instance.soundManager.events.dispatchEvent(new Ri(Ri.NPW_USER_STOP_SONG,t,e.id,-1))}}onTraxSongInfoMessageEvent(e){const t=e.getParser();for(const s of t.songs){const i=!!this.getSongDataEntry(s.id);if(this.areSamplesRequested(s.id),!i){const n=new gI(s.id,s.length,s.name,s.creator,s.data);this._availableSongs.set(s.id,n);const a=this.getTopRequestPriority(),o=this.getSongIdRequestedAtPriority(a);for(s.id===o&&this.playSongObject(a,o),X.instance.soundManager.events.dispatchEvent(new Ko(Ko.SIR_TRAX_SONG_INFO_RECEIVED,s.id));this._diskInventoryMissingData.indexOf(s.id)!=-1;)this._diskInventoryMissingData.splice(this._diskInventoryMissingData.indexOf(s.id),1),this._diskInventoryMissingData.length===0&&X.instance.soundManager.events.dispatchEvent(new Xo(Xo.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT))}}}onSongDiskInventoryMessage(e){const t=e.getParser();this._songDiskInventory.reset();for(let s=0;s<t.songDiskCount;s++){const i=t.getDiskId(s),n=t.getSongId(s);this._songDiskInventory.add(i,n),this._availableSongs.get(n)||(this._diskInventoryMissingData.push(n),this.requestSongInfoWithoutSamples(n))}this._diskInventoryMissingData.length===0&&X.instance.soundManager.events.dispatchEvent(new Xo(Xo.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT))}onTick(){this._songRequestList.length!==0&&(X.instance.communication.connection.send(new hp(...this._songRequestList)),this._songRequestList=[])}requestSong(e,t){this._requestedSongs.get(e)===void 0&&(this._requestedSongs.set(e,t),this._songRequestList.push(e))}areSamplesRequested(e){return this._requestedSongs.get(e)?this._requestedSongs.get(e):!1}processSongEntryForPlaying(e,t=!0){return this.getSongDataEntry(e)?!0:(this.addSongInfoRequest(e),!1)}playSong(e,t,s=0,i=0,n=.5,a=.5){return!this.addSongStartRequest(t,e,s,i,n,a)||!this.processSongEntryForPlaying(e)?!1:(t>=this._priorityPlaying&&this.playSongObject(t,e),!0)}playSongObject(e,t){if(t===-1||e<0||e>=us.PRIORITY_COUNT)return!1;let s=!1;this.stopSongAtPriority(this._priorityPlaying)&&(s=!0);const i=this.getSongDataEntry(t);if(!i)return!1;if(s)return!0;this._musicPlayer.setVolume(X.instance.soundManager.traxVolume);let n=kn.SKIP_POSITION_SET,a=0;const o=this.getSongStartRequest(e);return o&&(n=o.startPos,a=o.playLength,o.fadeInSeconds,o.fadeOutSeconds),n>=i.length/1e3?!1:(n<=kn.SKIP_POSITION_SET&&(n=0),n=Math.trunc(n),this._priorityPlaying=e,this._requestNumberPlaying=this.getSongRequestCountAtPriority(e),this._songIdPlaying=t,this._priorityPlaying<=kn.MAXIMUM_NOTIFY_PRIORITY&&this.notifySongPlaying(i),this._musicPlayer.preloadSamplesForSong(i.songData).then(()=>this._musicPlayer.play(i.songData,i.id,n,a)),e>us.PRIORITY_ROOM_PLAYLIST&&X.instance.soundManager.events.dispatchEvent(new Ri(Ri.NPE_USER_PLAY_SONG,e,i.id,-1)),!0)}notifySongPlaying(e){const s=Date.now();e.length>=8e3&&(this._previousNotifiedSongId!=e.id||s>this._previousNotificationTime+8e3)&&(X.instance.soundManager.events.dispatchEvent(new ol(e.name,e.creator)),this._previousNotifiedSongId=e.id,this._previousNotificationTime=s)}addSongStartRequest(e,t,s,i,n,a){if(e<0||e>=us.PRIORITY_COUNT)return!1;const o=new NY(t,s,i,n,a);return this._songRequestsPerPriority[e]=o,this._songRequestCountsPerPriority[e]=this._songRequestCountsPerPriority[e]+1,!0}getSongDataEntry(e){let t;return this._availableSongs&&(t=this._availableSongs.get(e)),t}getSongStartRequest(e){return this._songRequestsPerPriority[e]}getTopRequestPriority(){return this._songRequestsPerPriority.length-1}getSongIdRequestedAtPriority(e){return e<0||e>=us.PRIORITY_COUNT||!this._songRequestsPerPriority[e]?-1:this._songRequestsPerPriority[e].songId}getSongRequestCountAtPriority(e){return e<0||e>=us.PRIORITY_COUNT?-1:this._songRequestCountsPerPriority[e]}playSongWithHighestPriority(){let e;this._priorityPlaying=-1,this._songIdPlaying=-1,this._requestNumberPlaying=-1;let s=this.getTopRequestPriority();for(;s>=0;){if(e=this.getSongIdRequestedAtPriority(s),e>=0&&this.playSongObject(s,e))return;s--}}resetSongStartRequest(e){e>=0&&e<us.PRIORITY_COUNT&&(this._songRequestsPerPriority[e]=void 0)}reRequestSongAtPriority(e){this._songRequestCountsPerPriority[e]=this._songRequestCountsPerPriority[e]+1}stopSongAtPriority(e){if(e===this._priorityPlaying&&this._priorityPlaying>=0){const t=this.getSongIdPlayingAtPriority(e);if(t>=0)return this.getSongDataEntry(t),this._musicPlayer.stop(),!0}return!1}onSoundMachineInit(e){this.disposeRoomPlaylist()}onSoundMachineDispose(e){this.disposeRoomPlaylist()}onJukeboxInit(e){this.disposeRoomPlaylist(),this._roomItemPlaylist=new bY,this._roomItemPlaylist.init(),X.instance.communication.connection.send(new op)}onJukeboxDispose(e){this.disposeRoomPlaylist()}disposeRoomPlaylist(){this._roomItemPlaylist&&(this._roomItemPlaylist.dispose(),this._roomItemPlaylist=void 0)}}kn.SKIP_POSITION_SET=-1,kn.MAXIMUM_NOTIFY_PRIORITY=us.PRIORITY_ROOM_PLAYLIST;class UY extends Pr{constructor(){super(),this._volumeSystem=.5,this._volumeFurni=.5,this._volumeTrax=.5,this._internalSamples=new Ot,this._furniSamples=new Ot,this._furnitureBeingPlayed=new Ot,this._musicController=new kn,this.onEvent=this.onEvent.bind(this)}onInit(){this._musicController.init(),X.instance.roomEngine.events.addEventListener(_s.PLAY_SAMPLE,this.onEvent),X.instance.roomEngine.events.addEventListener(ee.REMOVED,this.onEvent),X.instance.roomEngine.events.addEventListener(Ue.DISPOSED,this.onEvent),X.instance.events.addEventListener(si.SETTINGS_UPDATED,this.onEvent),X.instance.events.addEventListener(Xh.PLAY_SOUND,this.onEvent)}onDispose(){this._musicController&&(this._musicController.dispose(),this._musicController=null),X.instance.roomEngine.events.removeEventListener(_s.PLAY_SAMPLE,this.onEvent),X.instance.roomEngine.events.removeEventListener(ee.REMOVED,this.onEvent),X.instance.roomEngine.events.removeEventListener(Ue.DISPOSED,this.onEvent),X.instance.events.removeEventListener(si.SETTINGS_UPDATED,this.onEvent),X.instance.events.removeEventListener(Xh.PLAY_SOUND,this.onEvent)}onEvent(e){var t;switch(e.type){case _s.PLAY_SAMPLE:{const s=e;this.playFurniSample(s.objectId,s.sampleId,s.pitch);return}case ee.REMOVED:{const s=e;this.stopFurniSample(s.objectId);return}case Ue.DISPOSED:{this._furnitureBeingPlayed.getKeys().forEach(s=>{this.stopFurniSample(s)});return}case si.SETTINGS_UPDATED:{const s=e,i=s.volumeFurni!==this._volumeFurni,n=s.volumeTrax!==this._volumeTrax;this._volumeSystem=s.volumeSystem/100,this._volumeFurni=s.volumeFurni/100,this._volumeTrax=s.volumeTrax/100,i&&this.updateFurniSamplesVolume(this._volumeFurni),n&&((t=this._musicController)===null||t===void 0||t.updateVolume(this._volumeTrax));return}case Xh.PLAY_SOUND:{const s=e;this.playInternalSample(s.sampleCode);return}}}playSample(e,t,s=1){e.volume=t,e.currentTime=0;try{e.play()}catch(i){Y.error(i)}}playInternalSample(e){let t=this._internalSamples.getValue(e);if(!t){const s=ue.getValue("sounds.url");t=new Audio(s.replace("%sample%",e)),this._internalSamples.add(e,t)}this.playSample(t,this._volumeSystem)}playFurniSample(e,t,s){let i=this._furniSamples.getValue(t);if(!i){const n=ue.getValue("external.samples.url");i=new Audio(n.replace("%sample%",t.toString())),this._furniSamples.add(t,i)}this._furnitureBeingPlayed.hasKey(e)||this._furnitureBeingPlayed.add(e,t),i.onended=n=>{this.stopFurniSample(e)},i.onpause=n=>{this.stopFurniSample(e)},i.onerror=n=>{this.stopFurniSample(e)},this.playSample(i,this._volumeFurni,s)}stopInternalSample(e){const t=this._internalSamples.getValue(e);if(t)try{t.pause()}catch(s){Y.error(s)}}stopFurniSample(e){const t=this._furnitureBeingPlayed.getValue(e);if(!t)return;const s=this._furniSamples.getValue(t);if(this._furnitureBeingPlayed.remove(e),!!s)try{s.pause()}catch(i){Y.error(i)}}updateInternalSamplesVolume(e){this._internalSamples.getValues().forEach(t=>{t.volume=e})}updateFurniSamplesVolume(e){this._furniSamples.getValues().forEach(t=>{t.volume=e})}get traxVolume(){return this._volumeTrax}get musicController(){return this._musicController}}Ae.available,J.SCALE_MODE=window.devicePixelRatio%1?Ds.LINEAR:Ds.NEAREST,J.ROUND_PIXELS=!0,J.GC_MAX_IDLE=120;class X{constructor(e,t){X.INSTANCE||(X.INSTANCE=this),this._application=new _t(t),this._core=e,this._events=new ws,this._communication=new lj(e.communication),this._localization=new _j(this._communication),this._avatar=new hl,this._roomEngine=new Oe(this._communication),this._sessionDataManager=new PY(this._communication),this._roomSessionManager=new MY(this._communication,this._roomEngine),this._roomManager=new ds(this._roomEngine,this._roomEngine.visualizationFactory,this._roomEngine.logicFactory),this._cameraManager=new tS,this._soundManager=new UY,this._linkTrackers=[],this._isReady=!1,this._isDisposed=!1,this._core.configuration.events.addEventListener(ki.LOADED,this.onConfigurationLoadedEvent.bind(this)),this._roomEngine.events.addEventListener(Ue.ENGINE_INITIALIZED,this.onRoomEngineReady.bind(this))}static bootstrap(){X.INSTANCE&&(X.INSTANCE.dispose(),X.INSTANCE=null);const e=document.createElement("canvas"),t=new this(new dO,{autoDensity:!1,width:window.innerWidth,height:window.innerHeight,resolution:window.devicePixelRatio,view:e});e.addEventListener("webglcontextlost",()=>t.events.dispatchEvent(new Ce(X.WEBGL_CONTEXT_LOST)))}init(){if(!(this._isReady||this._isDisposed)){if(this._avatar&&this._avatar.init(),this._soundManager&&this._soundManager.init(),this._roomEngine&&(this._roomEngine.sessionDataManager=this._sessionDataManager,this._roomEngine.roomSessionManager=this._roomSessionManager,this._roomEngine.roomManager=this._roomManager,this._sessionDataManager&&this._sessionDataManager.init(),this._roomSessionManager&&this._roomSessionManager.init(),this._roomEngine.init()),!this._communication.connection)throw new Error("No connection found");new cj(this._communication.connection),this._isReady=!0}}dispose(){this._isDisposed||(this._roomManager&&(this._roomManager.dispose(),this._roomManager=null),this._roomSessionManager&&(this._roomSessionManager.dispose(),this._roomSessionManager=null),this._sessionDataManager&&(this._sessionDataManager.dispose(),this._sessionDataManager=null),this._roomEngine&&(this._roomEngine.dispose(),this._roomEngine=null),this._avatar&&(this._avatar.dispose(),this._avatar=null),this._soundManager&&(this._soundManager.dispose(),this._soundManager=null),this._communication&&(this._communication.dispose(),this._communication=null),this._application&&(this._application.destroy(),this._application=null),this._isDisposed=!0,this._isReady=!1)}onConfigurationLoadedEvent(e){Jr().maxFPS=ue.getValue("system.fps.max",24),Y.LOG_DEBUG=ue.getValue("system.log.debug",!0),Y.LOG_WARN=ue.getValue("system.log.warn",!1),Y.LOG_ERROR=ue.getValue("system.log.error",!1),Y.LOG_EVENTS=ue.getValue("system.log.events",!1),Y.LOG_PACKETS=ue.getValue("system.log.packets",!1),Rr.LANDSCAPES_ENABLED=ue.getValue("room.landscapes.enabled",!0)}onRoomEngineReady(e){this.startSendingHeartBeat()}getConfiguration(e,t=null){return ue.getValue(e,t)}getLocalization(e){return this._localization.getValue(e)}getLocalizationWithParameter(e,t,s){return this._localization.getValueWithParameter(e,t,s)}getLocalizationWithParameters(e,t,s){return this._localization.getValueWithParameters(e,t,s)}addLinkEventTracker(e){this._linkTrackers.indexOf(e)>=0||this._linkTrackers.push(e)}removeLinkEventTracker(e){const t=this._linkTrackers.indexOf(e);t!==-1&&this._linkTrackers.splice(t,1)}createLinkEvent(e){if(!(!e||e===""))for(const t of this._linkTrackers){if(!t)continue;const s=t.eventUrlPrefix;s.length>0?e.substr(0,s.length)===s&&t.linkReceived(e):t.linkReceived(e)}}startSendingHeartBeat(){this.sendHeartBeat(),setInterval(this.sendHeartBeat,1e4)}sendHeartBeat(){Ti.sendHeartBeat()}get application(){return this._application}get core(){return this._core}get events(){return this._events}get localization(){return this._localization}get communication(){return this._communication}get avatar(){return this._avatar}get roomEngine(){return this._roomEngine}get sessionDataManager(){return this._sessionDataManager}get roomSessionManager(){return this._roomSessionManager}get roomManager(){return this._roomManager}get cameraManager(){return this._cameraManager}get soundManager(){return this._soundManager}get width(){return this._application.renderer.width}get height(){return this._application.renderer.height}get isReady(){return this._isReady}get isDisposed(){return this._isDisposed}static get instance(){return this.INSTANCE||null}}X.WEBGL_CONTEXT_LOST="NE_WEBGL_CONTEXT_LOST",X.WEBGL_UNAVAILABLE="NE_WEBGL_UNAVAILABLE",X.READY="NE_READY!",X.INSTANCE=null;class Se{static format(e,t="",s=3){return e>s*Se.YEAR?Se.getLocalization("friendlytime.years"+t,Math.round(e/Se.YEAR)):e>s*Se.MONTH?Se.getLocalization("friendlytime.months"+t,Math.round(e/Se.MONTH)):e>s*Se.DAY?Se.getLocalization("friendlytime.days"+t,Math.round(e/Se.DAY)):e>s*Se.HOUR?Se.getLocalization("friendlytime.hours"+t,Math.round(e/Se.HOUR)):e>s*Se.MINUTE?Se.getLocalization("friendlytime.minutes"+t,Math.round(e/Se.MINUTE)):Se.getLocalization("friendlytime.seconds"+t,Math.round(e))}static shortFormat(e,t="",s=3){return e>s*Se.YEAR?Se.getLocalization("friendlytime.years.short"+t,Math.round(e/Se.YEAR)):e>s*Se.MONTH?Se.getLocalization("friendlytime.months.short"+t,Math.round(e/Se.MONTH)):e>s*Se.DAY?Se.getLocalization("friendlytime.days.short"+t,Math.round(e/Se.DAY)):e>s*Se.HOUR?Se.getLocalization("friendlytime.hours.short"+t,Math.round(e/Se.HOUR)):e>s*Se.MINUTE?Se.getLocalization("friendlytime.minutes.short"+t,Math.round(e/Se.MINUTE)):Se.getLocalization("friendlytime.seconds.short"+t,Math.round(e))}static getLocalization(e,t){return X.instance.getLocalizationWithParameter(e,"amount",t.toString())}}Se.MINUTE=60,Se.HOUR=60*Se.MINUTE,Se.DAY=24*Se.HOUR,Se.WEEK=7*Se.DAY,Se.MONTH=30*Se.DAY,Se.YEAR=365*Se.DAY;class Qo{static isBuilderClubId(e){return e>=Qo.BUILDER_CLUB_FURNI_ID_BASE}}Qo.BUILDER_CLUB_FURNI_ID_BASE=2147418112;const fZ=r=>r>>>0,EI=r=>{const e=fZ(r);return e>=Math.pow(2,31)?e-Math.pow(2,32):e};class ud{constructor(e){if(this._id=e.id,this._isMain=e.main||!1,this._avatarSets=new Map,this._bodyParts=[],this._allBodyParts=[],e.avatarSets&&e.avatarSets.length>0)for(const s of e.avatarSets){if(!s)continue;const i=new ud(s);this._avatarSets.set(i.id,i)}if(e.bodyParts&&e.bodyParts.length>0)for(const s of e.bodyParts)s&&this._bodyParts.push(s.id);let t=this._bodyParts.concat();for(const s of this._avatarSets.values())s&&(t=t.concat(s.getBodyParts()));this._allBodyParts=t}findAvatarSet(e){if(e===this._id)return this;for(const t of this._avatarSets.values())if(t&&t.findAvatarSet(e))return t;return null}getBodyParts(){return this._allBodyParts.concat()}get id(){return this._id}get isMain(){if(this._isMain)return!0;for(const e of this._avatarSets.values())if(e&&e.isMain)return!0;return!1}}class Hs{constructor(e=0,t=0,s=0){this._x=e,this._y=t,this._z=s}static dot(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}static cross(e,t){const s=new Hs;return s.x=e.y*t.z-e.z*t.y,s.y=e.z*t.x-e.x*t.z,s.z=e.x*t.y-e.y*t.x,s}static subtract(e,t){return new Hs(e.x-t.x,e.y-t.y,e.z-t.z)}dot(e){return this._x*e.x+this._y*e.y+this._z*e.z}cross(e){const t=new Hs;return t.x=this._y*e.z-this._z*e.y,t.y=this._z*e.x-this._x*e.z,t.z=this._x*e.y-this._y*e.x,t}subtract(e){this._x=this._x-e.x,this._y=this._y-e.y,this._z=this._z-e.z}add(e){this._x=this._x+e.x,this._y=this._y+e.y,this._z=this._z+e.z}normalize(){const e=1/this.length();this._x=this._x*e,this._y=this._y*e,this._z=this._z*e}scaleBy(e){this._x*=e,this._y*=e,this._z*=e}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)}toString(){return"Vector3D: ("+this._x+","+this._y+","+this._z+")"}get x(){return this._x}set x(e){this._x=e}get y(){return this._y}set y(e){this._y=e}get z(){return this._z}set z(e){this._z=e}}class mI{constructor(e,t,s){this._location=new Hs(e,t,s),this._transformedLocation=new Hs,this._needsTransformation=!1,(e!=0||t!=0||s!=0)&&(this._needsTransformation=!0)}get location(){return this._location}get transformedLocation(){return this._transformedLocation}applyTransform(e){this._needsTransformation&&(this._transformedLocation=e.vectorMultiplication(this._location))}}class pI extends mI{constructor(e,t=!1){super(parseFloat(e.x),parseFloat(e.y),parseFloat(e.z)),this._id=e.id,this._radius=parseFloat(e.radius),this._normal=new Hs(parseFloat(e.nx),parseFloat(e.ny),parseFloat(e.nz)),this._isDoubleSided=e.double||!1,this._isDynamic=t}getDistance(e){const t=Math.abs(e.z-this.transformedLocation.z-this._radius),s=Math.abs(e.z-this.transformedLocation.z+this._radius);return Math.min(t,s)}get id(){return this._id}get normal(){return this._normal}get isDoubleSided(){return this._isDoubleSided}toString(){return this._id+": "+this.location+" - "+this.transformedLocation}get isDynamic(){return this._isDynamic}}class FY extends mI{constructor(e){if(super(parseFloat(e.x),parseFloat(e.y),parseFloat(e.z)),this._id=e.id,this._radius=parseFloat(e.radius),this._parts=new Map,this._dynamicParts=new Map,e.items&&e.items.length>0)for(const t of e.items){if(!t)continue;const s=new pI(t);this._parts.set(s.id,s)}}getDynamicParts(e){const t=this._dynamicParts.get(e),s=[];if(t)for(const i in t){const n=t[i];n&&s.push(n)}return s}getPartIds(e){const t=[];for(const s of this._parts.values())s&&t.push(s.id);if(e){const s=this._dynamicParts.get(e);if(s)for(const i in s){const n=s[i];n&&t.push(n.id)}}return t}removeDynamicParts(e){return this._dynamicParts.delete(e),!0}addPart(e,t){if(this.hasPart(e.id,t))return!1;let s=this._dynamicParts.get(t);return s||(s={},this._dynamicParts.set(t,s)),s[e.id]=new pI(e,!0),!0}hasPart(e,t){let s=this._parts.get(e)||null;return!s&&this._dynamicParts.get(t)!==void 0&&(s=this._dynamicParts.get(t)[e]||null),s!==null}getParts(e,t,s,i){const n=[];for(const u of this._parts.values())u&&(u.applyTransform(e),n.push([u.getDistance(t),u]));const a=this._dynamicParts.get(i);if(a)for(const u in a){const l=a[u];l&&(l.applyTransform(e),n.push([l.getDistance(t),l]))}n.sort((u,l)=>{const d=u[0],c=l[0];return d<c?-1:d>c?1:0});const o=[];for(const u of n)u&&o.push(u[1].id);return o}getDistance(e){const t=Math.abs(e.z-this.transformedLocation.z-this._radius),s=Math.abs(e.z-this.transformedLocation.z+this._radius);return Math.min(t,s)}get id(){return this._id}get radius(){return this._radius}}class Rs{constructor(e=0,t=0,s=0,i=0,n=0,a=0,o=0,u=0,l=0){this._data=[e,t,s,i,n,a,o,u,l]}static getXRotationMatrix(e){const t=e*Math.PI/180,s=Math.cos(t),i=Math.sin(t);return new Rs(1,0,0,0,s,-i,0,i,s)}static getYRotationMatrix(e){const t=e*Math.PI/180,s=Math.cos(t),i=Math.sin(t);return new Rs(s,0,i,0,1,0,-i,0,s)}static getZRotationMatrix(e){const t=e*Math.PI/180,s=Math.cos(t),i=Math.sin(t);return new Rs(s,-i,0,i,s,0,0,0,1)}identity(){return this._data=[1,0,0,0,1,0,0,0,1],this}vectorMultiplication(e){const t=e.x*this._data[0]+e.y*this._data[3]+e.z*this._data[6],s=e.x*this._data[1]+e.y*this._data[4]+e.z*this._data[7],i=e.x*this._data[2]+e.y*this._data[5]+e.z*this._data[8];return new Hs(t,s,i)}multiply(e){const t=this._data[0]*e.data[0]+this._data[1]*e.data[3]+this._data[2]*e.data[6],s=this._data[0]*e.data[1]+this._data[1]*e.data[4]+this._data[2]*e.data[7],i=this._data[0]*e.data[2]+this._data[1]*e.data[5]+this._data[2]*e.data[8],n=this._data[3]*e.data[0]+this._data[4]*e.data[3]+this._data[5]*e.data[6],a=this._data[3]*e.data[1]+this._data[4]*e.data[4]+this._data[5]*e.data[7],o=this._data[3]*e.data[2]+this._data[4]*e.data[5]+this._data[5]*e.data[8],u=this._data[6]*e.data[0]+this._data[7]*e.data[3]+this._data[8]*e.data[6],l=this._data[6]*e.data[1]+this._data[7]*e.data[4]+this._data[8]*e.data[7],d=this._data[6]*e.data[2]+this._data[7]*e.data[5]+this._data[8]*e.data[8];return new Rs(t,s,i,n,a,o,u,l,d)}scalarMultiply(e){let t=0;for(;t<this._data.length;)this._data[t]=this._data[t]*e,t++}rotateX(e){const t=e*Math.PI/180,s=Math.cos(t),i=Math.sin(t);return new Rs(1,0,0,0,s,-i,0,i,s).multiply(this)}rotateY(e){const t=e*Math.PI/180,s=Math.cos(t),i=Math.sin(t);return new Rs(s,0,i,0,1,0,-i,0,s).multiply(this)}rotateZ(e){const t=e*Math.PI/180,s=Math.cos(t),i=Math.sin(t);return new Rs(s,-i,0,i,s,0,0,0,1).multiply(this)}skew(){}transpose(){return new Rs(this._data[0],this._data[3],this._data[6],this._data[1],this._data[4],this._data[7],this._data[2],this._data[5],this._data[8])}equals(e){return!1}get data(){return this._data}}Rs.IDENTITY=new Rs(1,0,0,0,1,0,0,0,1),Rs.TOLERANS=1e-18;class wY{constructor(e){this._camera=new Hs(0,0,10),this._avatarSet=new ud(e.avatarSets[0]),this._geometryTypes=new Map,this._itemIdToBodyPartMap=new Map,this._transformation=new Rs,this._canvases=new Map;const t=e.camera;if(t&&(this._camera.x=parseFloat(t.x),this._camera.y=parseFloat(t.y),this._camera.z=parseFloat(t.z)),e.canvases&&e.canvases.length>0)for(const s of e.canvases){if(!s)continue;const i=s.scale,n=new Map;if(s.geometries&&s.geometries.length>0)for(const a of s.geometries){if(!a)continue;const o=new PO(a,i);n.set(o.id,o)}this._canvases.set(i,n)}if(e.types&&e.types.length>0)for(const s of e.types){if(!s)continue;const i=new Map,n=new Map;if(s.bodyParts&&s.bodyParts.length>0)for(const a of s.bodyParts){if(!a)continue;const o=new FY(a);i.set(o.id,o);for(const u of o.getPartIds(null))n.set(u,o)}this._geometryTypes.set(s.id,i),this._itemIdToBodyPartMap.set(s.id,n)}}removeDynamicItems(e){for(const t of this._geometryTypes.values())if(t)for(const s of t.values())s&&s.removeDynamicParts(e)}getBodyPartIdsInAvatarSet(e){const t=this._avatarSet.findAvatarSet(e);return t?t.getBodyParts():[]}isMainAvatarSet(e){const t=this._avatarSet.findAvatarSet(e);return t?t.isMain:!1}getCanvas(e,t){const s=this._canvases.get(e);return s&&s.get(t)||null}typeExists(e){return!!this._geometryTypes.get(e)}hasBodyPart(e,t){if(this.typeExists(e)){const s=this._geometryTypes.get(e);if(s&&s.get(t))return!0}return!1}getBodyPartIDs(e){const t=this.getBodyPartsOfType(e),s=[];if(t)for(const i of t.values())i&&s.push(i.id);return s}getBodyPartsOfType(e){return this.typeExists(e)?this._geometryTypes.get(e):new Map}getBodyPart(e,t){return this.getBodyPartsOfType(e).get(t)||null}getBodyPartOfItem(e,t,s){const i=this._itemIdToBodyPartMap.get(e);if(i){const n=i.get(t);if(n)return n;const a=this.getBodyPartsOfType(e);if(a){for(const o of a.values())if(o&&o.hasPart(t,s))return o}}return null}getBodyPartsInAvatarSet(e,t){const s=this.getBodyPartIdsInAvatarSet(t),i=[];for(const n of s){if(!n)continue;const a=e.get(n);a&&i.push(a)}return i}getBodyPartsAtAngle(e,t,s){if(!s)return[];const i=this.getBodyPartsOfType(s),n=this.getBodyPartsInAvatarSet(i,e),a=[],o=[];this._transformation=Rs.getYRotationMatrix(t);for(const u of n.values())u&&(u.applyTransform(this._transformation),a.push([u.getDistance(this._camera),u]));a.sort((u,l)=>{const d=u[0],c=l[0];return d<c?-1:d>c?1:0});for(const u of a)u&&o.push(u[1].id);return o}getParts(e,t,s,i,n){if(this.hasBodyPart(e,t)){const a=this.getBodyPartsOfType(e).get(t);return this._transformation=Rs.getYRotationMatrix(s),a.getParts(this._transformation,this._camera,i,n)}return[]}}class xY extends ws{constructor(e){super(),this._renderManager=e,this._geometry=null,this._figureData=new LO,this._partSetsData=new UO,this._animationData=new MO,this._animationManager=new OO,this._mandatorySetTypeIds={},this._actionManager=null,this._defaultAction=null}init(){}dispose(){this.disposed||(super.dispose(),this._renderManager=null,this._figureData=null,this._partSetsData=null,this._animationData=null,this._mandatorySetTypeIds=null)}initGeometry(e){e&&(this._geometry=new wY(e))}initActions(e,t){t&&(this._actionManager=new EO(e,t),this._defaultAction=this._actionManager.getDefaultAction())}updateActions(e){this._actionManager.updateActions(e),this._defaultAction=this._actionManager.getDefaultAction()}initPartSets(e){return e&&this._partSetsData.parse(e)?(this._partSetsData.getPartDefinition("ri").appendToFigure=!0,this._partSetsData.getPartDefinition("li").appendToFigure=!0,!0):!1}initAnimation(e){return e?this._animationData.parse(e):!1}initFigureData(e){return e?this._figureData.parse(e):!1}injectFigureData(e){this._figureData.injectJSON(e)}registerAnimations(e,t="fx",s=200){let i=0;for(;i<s;){const n=e.getCollection(t+i);if(n){const a=n.data;this._animationManager.registerAnimation(this,a.animations)}i++}}registerAnimation(e){this._animationManager.registerAnimation(this,e)}getPartColor(e,t,s=0){const i=e.getPartColorIds(t);if(!i||i.length<s)return null;const n=this._figureData.getSetType(t);if(n==null)return null;const a=this._figureData.getPalette(n.paletteID);return a?a.getColor(i[s]):null}getBodyPartData(e,t,s){return this._animationManager.getLayerData(e,t,s)}getAnimation(e){return this._animationManager.getAnimation(e)}getActionDefinition(e){return this._actionManager.getActionDefinition(e)}getActionDefinitionWithState(e){return this._actionManager.getActionDefinitionWithState(e)}isMainAvatarSet(e){return this._geometry.isMainAvatarSet(e)}sortActions(e){return this._actionManager.sortActions(e)}maxFrames(e){let t=0;for(const s of e)t=Math.max(t,this._animationData.getFrameCount(s.definition));return t}getMandatorySetTypeIds(e,t){return this._mandatorySetTypeIds[e]||(this._mandatorySetTypeIds[e]=[]),this._mandatorySetTypeIds[e][t]?this._mandatorySetTypeIds[e][t]:(this._mandatorySetTypeIds[e][t]=this._figureData.getMandatorySetTypeIds(e,t),this._mandatorySetTypeIds[e][t])}getDefaultPartSet(e,t){return this._figureData.getDefaultPartSet(e,t)}getCanvasOffsets(e,t,s){return this._actionManager.getCanvasOffsets(e,t,s)}getCanvas(e,t){return this._geometry.getCanvas(e,t)}removeDynamicItems(e){this._geometry.removeDynamicItems(e)}getActiveBodyPartIds(e,t){let s=[];const i=[],n=e.definition.geometryType;if(e.definition.isAnimation){const a=e.definition.state+"."+e.actionParameter,o=this._animationManager.getAnimation(a);if(o&&(s=o.getAnimatedBodyPartIds(0,e.overridingAction),o.hasAddData())){const u={id:"",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:1},l={setType:""};for(const d of o.addData){const c=this._geometry.getBodyPart(n,d.align);if(c){u.id=d.id,c.addPart(u,t),l.setType=d.id;const _=this._partSetsData.addPartDefinition(l);_.appendToFigure=!0,d.base===""&&(_.staticId=1),i.indexOf(c.id)===-1&&i.push(c.id)}}}for(const u of s){const l=this._geometry.getBodyPart(n,u);l&&i.indexOf(l.id)===-1&&i.push(l.id)}}else{s=this._partSetsData.getActiveParts(e.definition);for(const a of s){const o=this._geometry.getBodyPartOfItem(n,a,t);o&&i.indexOf(o.id)===-1&&i.push(o.id)}}return i}getBodyPartsUnordered(e){return this._geometry.getBodyPartIdsInAvatarSet(e)}getBodyParts(e,t,s){const i=yr.DIRECTION_TO_ANGLE[s];return this._geometry.getBodyPartsAtAngle(e,i,t)}getFrameBodyPartOffset(e,t,s,i){const n=this._animationData.getAction(e.definition);return n?n.getFrameBodyPartOffset(t,s,i):Vi.DEFAULT_OFFSET}getParts(e,t,s,i,n,a,o,u=null){let l=null,d=[],c=null;if(!s==null)return[];const _=this._partSetsData.getActiveParts(s.definition),f=[];let g=[0];const I=this._animationData.getAction(s.definition);if(s.definition.isAnimation){const O=s.definition.state+"."+s.actionParameter,A=this._animationManager.getAnimation(O);if(A){g=this.getPopulatedArray(A.frameCount(s.overridingAction));for(const C of A.getAnimatedBodyPartIds(0,s.overridingAction))if(C===e){const M=this._geometry.getBodyPart(i,C);if(M)for(const N of M.getDynamicParts(o))_.push(N.id)}}}const p=this._geometry.getParts(i,e,n,_,o),R=t.getPartTypeIds();for(const O of R){if(u&&u.get(O))continue;const A=t.getPartSetId(O),C=t.getPartColorIds(O),M=this._figureData.getSetType(O);if(M){const N=this._figureData.getPalette(M.paletteID);if(N){const L=M.getPartSet(A);if(L){a=a.concat(L.hiddenLayers);for(const b of L.parts)if(p.indexOf(b.type)>-1){if(I){const Te=I.getPart(b.type);Te?d=Te.frames:d=g}else d=g;l=s.definition,_.indexOf(b.type)===-1&&(l=this._defaultAction);const D=this._partSetsData.getPartDefinition(b.type);let x=D?D.flippedSetType:b.type;(!x||x==="")&&(x=b.type),C&&C.length>b.colorLayerIndex-1&&(c=N.getColor(C[b.colorLayerIndex-1]));const q=b.colorLayerIndex>0,$=new Nc(e,b.type,b.id.toString(),c,d,l,q,b.paletteMap,x);f.push($)}}}}}const S=[];for(const O of p){let A=null,C=!1;const M=u&&u.get(O);for(const N of f)N.partType===O&&(M?A=N.color:(C=!0,a.indexOf(O)===-1&&S.push(N)));if(!C){if(M){const N=u.get(O);let L=0,b=0;for(;b<N.length;)L=L+N.charCodeAt(b),b++;if(I){const x=I.getPart(O);x?d=x.frames:d=g}else d=g;const D=new Nc(e,O,N,A,d,s.definition,A!=null,-1,O,!1,1);S.push(D)}else if(_.indexOf(O)>-1){const N=this._geometry.getBodyPartOfItem(i,O,o);if(e===N.id){const L=this._partSetsData.getPartDefinition(O);let b=!1,D=1;if(L.appendToFigure){let x="1";if(s.actionParameter!==""&&(x=s.actionParameter),L.hasStaticId()&&(x=L.staticId.toString()),I){const $=I.getPart(O);$?d=$.frames:d=g}else d=g;const q=new Nc(e,O,x,null,d,s.definition,!1,-1,O,b,D);S.push(q)}}}}}return S}getPopulatedArray(e){const t=[];let s=0;for(;s<e;)t.push(s),s++;return t}getItemIds(){if(this._actionManager){const e=this._actionManager.getActionDefinition("CarryItem").params,t=[];for(const s of e.values())t.push(s);return t}return[]}get renderManager(){return this._renderManager}get figureData(){return this._figureData}get partData(){return this._partSetsData}get animationManager(){return this._animationManager}}const GY={animations:[{id:"Move",parts:[{setType:"bd",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"bds",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ss",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lg",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"sh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lhs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rhs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ch",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]}]},{id:"Wave",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"lhs",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"ch",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"},{number:2,assetPartDefinition:"wav"},{number:3,assetPartDefinition:"wav"}]}]},{id:"Talk",parts:[{setType:"hd",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]},{setType:"fa",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]}]},{id:"Sign",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"sig"}]},{setType:"li",frames:[{number:0,assetPartDefinition:"sig"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav"}]}]},{id:"Respect",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"respect",repeats:15},{number:1,assetPartDefinition:"respect",repeats:15}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav",repeats:15},{number:1,assetPartDefinition:"wav",repeats:15}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav",repeats:15},{number:1,assetPartDefinition:"wav",repeats:15}]}]},{id:"Blow",parts:[{setType:"rh",frames:[{number:0,assetPartDefinition:"blw",repeats:10},{number:1,assetPartDefinition:"blw",repeats:10}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"ri",frames:[{number:0,assetPartDefinition:""}]},{setType:"ey",frames:[{number:0,assetPartDefinition:"std",repeats:10},{number:0,assetPartDefinition:"eyb",repeats:10}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"std",repeats:10},{number:0,assetPartDefinition:"blw",repeats:10}]}]},{id:"Laugh",parts:[{setType:"rh",frames:[{number:0,assetPartDefinition:"blw"}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"ri",frames:[{number:0,assetPartDefinition:""}]},{setType:"ey",frames:[{number:0,assetPartDefinition:"std",repeats:2}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"sml"}]}],offsets:{frames:[{id:0,directions:[{id:0,bodyParts:[{id:"head",dx:0,dy:1}]},{id:1,bodyParts:[{id:"head",dx:0,dy:1}]},{id:2,bodyParts:[{id:"head",dx:0,dy:1}]},{id:3,bodyParts:[{id:"head",dx:0,dy:1}]},{id:4,bodyParts:[{id:"head",dx:0,dy:1}]},{id:5,bodyParts:[{id:"head",dx:0,dy:1}]},{id:6,bodyParts:[{id:"head",dx:0,dy:1}]},{id:7,bodyParts:[{id:"head",dx:0,dy:1}]}]},{id:1,directions:[{id:0,bodyParts:[{id:"head",dx:0,dy:0}]},{id:1,bodyParts:[{id:"head",dx:0,dy:0}]},{id:2,bodyParts:[{id:"head",dx:0,dy:0}]},{id:3,bodyParts:[{id:"head",dx:0,dy:0}]},{id:4,bodyParts:[{id:"head",dx:0,dy:0}]},{id:5,bodyParts:[{id:"head",dx:0,dy:0}]},{id:6,bodyParts:[{id:"head",dx:0,dy:0}]},{id:7,bodyParts:[{id:"head",dx:0,dy:0}]}]}]}}]},BY={geometry:{direction:0,camera:{x:0,y:0,z:10},canvases:[{scale:"h",geometries:[{id:"vertical",width:90,height:130,dx:0,dy:0},{id:"sitting",width:90,height:130,dx:0,dy:0},{id:"horizontal",width:128,height:80,dx:30,dy:0},{id:"swhorizontal",width:192,height:120,dx:0,dy:-40}]},{scale:"sh",geometries:[{id:"vertical",width:45,height:72,dx:0,dy:0},{id:"sitting",width:45,height:72,dx:0,dy:0},{id:"horizontal",width:64,height:50,dx:15,dy:-10},{id:"swhorizontal",width:96,height:70,dx:0,dy:-20},{id:"swim",width:64,height:70,dx:25,dy:10}]}],avatarSets:[{id:"full",avatarSets:[{id:"body",main:!0,bodyParts:[{id:"top"},{id:"bottom"},{id:"behind"},{id:"torso"},{id:"leftitem"},{id:"rightitem"},{id:"leftarm"},{id:"rightarm"}]},{id:"head",bodyParts:[{id:"head"}]}]}],types:[{id:"vertical",bodyParts:[{id:"top",x:0,y:0,z:0,radius:2},{id:"bottom",x:0,y:0,z:0,radius:.001},{id:"behind",x:0,y:0,z:.2,radius:.3},{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.045,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.5,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.5,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"sitting",bodyParts:[{id:"top",x:0,y:0,z:0,radius:2},{id:"bottom",x:0,y:0,z:0,radius:.001},{id:"behind",x:0,y:0,z:.2,radius:.3},{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.045,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.5,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.5,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"horizontal",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.6,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.6,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"swhorizontal",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.6,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.6,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"swim",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]}]}},HY={partSets:{partSet:[{setType:"ri",flippedSetType:"ri"},{setType:"ri",flippedSetType:"ri"},{setType:"rh",flippedSetType:"lh"},{setType:"rhs",flippedSetType:"lhs"},{setType:"rs",swim:"0",flippedSetType:"ls"},{setType:"rc",flippedSetType:"lc"},{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"sh"},{setType:"lg"},{setType:"ch"},{setType:"cp"},{setType:"cc"},{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb",removeSetType:"hr"},{setType:"li",flippedSetType:"li"},{setType:"lh",flippedSetType:"rh"},{setType:"lhs",flippedSetType:"rhs"},{setType:"ls",flippedSetType:"rs"},{setType:"lc",flippedSetType:"rc"},{setType:"wa"},{setType:"ea"},{setType:"ca"},{setType:"fa"},{setType:"ha"},{setType:"he"}],activePartSets:[{id:"figure",activeParts:[{setType:"rh"},{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"sh"},{setType:"lg"},{setType:"ch"},{setType:"cp"},{setType:"cc"},{setType:"wa"},{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb"},{setType:"lh"},{setType:"lhs"},{setType:"ls"},{setType:"lc"},{setType:"ea"},{setType:"ca"},{setType:"fa"},{setType:"ha"},{setType:"he"}]},{id:"head",activeParts:[{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb"},{setType:"ea"},{setType:"fa"},{setType:"ha"},{setType:"he"}]},{id:"speak",activeParts:[{setType:"hd"},{setType:"hr"},{setType:"hrb"},{setType:"fc"},{setType:"fa"},{setType:"ha"}]},{id:"gesture",activeParts:[{setType:"ey"},{setType:"fc"}]},{id:"eye",activeParts:[{setType:"ey"}]},{id:"handRight",activeParts:[{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"ri"}]},{id:"handRightAndHead",activeParts:[{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"ri"},{setType:"ey"},{setType:"fc"},{setType:"hd"}]},{id:"handLeft",activeParts:[{setType:"lh"},{setType:"lhs"},{setType:"ls"},{setType:"lc"},{setType:"li"}]},{id:"walk",activeParts:[{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"lg"},{setType:"lh"},{setType:"lhs"},{setType:"rh"},{setType:"rhs"},{setType:"ls"},{setType:"lc"},{setType:"rs"},{setType:"rc"},{setType:"sh"}]},{id:"sit",activeParts:[{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"lg"},{setType:"sh"},{setType:"cc"}]},{id:"itemRight",activeParts:[{setType:"ri"}]}]}};class bs extends ws{constructor(e,t,s,i){super(),this._state=bs.NOT_LOADED,this._libraryName=e,this._revision=t,this._downloadUrl=i,this._assets=s,this._animation=null,this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName),this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision),this._assets.getCollection(this._libraryName)&&(this._state=bs.LOADED)}downloadAsset(){return mt(this,void 0,void 0,function*(){if(!this._assets||this._state===bs.LOADING||this._state===bs.LOADED)return;if(this._assets.getCollection(this._libraryName)){this._state=bs.LOADED,this.dispatchEvent(new da(da.DOWNLOAD_COMPLETE,this));return}if(this._state=bs.LOADING,!(yield this._assets.downloadAsset(this._downloadUrl)))return;this._state=bs.LOADED;const s=this._assets.getCollection(this._libraryName);s&&(this._animation=s.data.animations),this.dispatchEvent(new da(da.DOWNLOAD_COMPLETE,this))})}get libraryName(){return this._libraryName}get animation(){return this._animation}get isLoaded(){return this._state===bs.LOADED}}bs.DOWNLOAD_COMPLETE="EADL_DOWNLOAD_COMPLETE",bs.NOT_LOADED=0,bs.LOADING=1,bs.LOADED=2;class Or extends ws{constructor(e,t){super(),this._assets=e,this._structure=t,this._missingMandatoryLibs=ue.getValue("avatar.mandatory.effect.libraries"),this._effectMap=new Map,this._effectListeners=new Map,this._incompleteEffects=new Map,this._initDownloadBuffer=[],this._pendingDownloadQueue=[],this._currentDownloads=[],this._libraryNames=[],this._isReady=!1,this.onLibraryLoaded=this.onLibraryLoaded.bind(this),this.onAvatarRenderReady=this.onAvatarRenderReady.bind(this),this.loadEffectMap(),this._structure.renderManager.events.addEventListener(zh.AVATAR_RENDER_READY,this.onAvatarRenderReady)}loadEffectMap(){const e=new XMLHttpRequest;try{e.open("GET",ue.getValue("avatar.effectmap.url")),e.send(),e.onloadend=t=>{if(e.responseText){const s=JSON.parse(e.responseText);this.processEffectMap(s.effects),this.processMissingLibraries(),this._isReady=!0,this.dispatchEvent(new Ce(Or.DOWNLOADER_READY))}},e.onerror=t=>{throw new Error("invalid_avatar_effect_map")}}catch(t){Y.error(t)}}processEffectMap(e){if(e)for(const t of e){if(!t)continue;const s=t.id,i=t.lib,n=t.revision||"";if(this._libraryNames.indexOf(i)>=0)continue;this._libraryNames.push(i);const a=new bs(i,n,this._assets,ue.getValue("avatar.asset.effect.url"));a.addEventListener(da.DOWNLOAD_COMPLETE,this.onLibraryLoaded);let o=this._effectMap.get(s);o||(o=[]),o.push(a),this._effectMap.set(s,o)}}downloadAvatarEffect(e,t){if(!this._isReady||!this._structure.renderManager.isReady){this._initDownloadBuffer.push([e,t]);return}const s=this.getAvatarEffectPendingLibraries(e);if(s&&s.length){if(t&&!t.disposed){let i=this._effectListeners.get(e.toString());i||(i=[]),i.push(t),this._effectListeners.set(e.toString(),i)}this._incompleteEffects.set(e.toString(),s);for(const i of s)i&&this.downloadLibrary(i)}else t&&!t.disposed&&t.resetEffect(e)}onAvatarRenderReady(e){if(e){for(const[t,s]of this._initDownloadBuffer)this.downloadAvatarEffect(t,s);this._initDownloadBuffer=[]}}onLibraryLoaded(e){if(!e||!e.library)return;const t=[];this._structure.registerAnimation(e.library.animation);for(const[i,n]of this._incompleteEffects.entries()){let a=!0;for(const o of n)if(!(!o||o.isLoaded)){a=!1;break}if(a){t.push(i);const o=this._effectListeners.get(i);for(const u of o)!u||u.disposed||u.resetEffect(parseInt(i));this._effectListeners.delete(i),this.dispatchEvent(new Ce(Or.LIBRARY_LOADED))}}for(const i of t)this._incompleteEffects.delete(i);let s=0;for(;s<this._currentDownloads.length;){const i=this._currentDownloads[s];i&&i.libraryName===e.library.libraryName&&this._currentDownloads.splice(s,1),s++}}processMissingLibraries(){const e=this._missingMandatoryLibs.slice();for(const t of e){if(!t)continue;const s=this._effectMap.get(t);if(s)for(const i of s)i&&this.downloadLibrary(i)}}isAvatarEffectReady(e){return!this._isReady||!this._structure.renderManager.isReady?!1:!this.getAvatarEffectPendingLibraries(e).length}getAvatarEffectPendingLibraries(e){const t=[];if(!this._structure)return t;const s=this._effectMap.get(e.toString());if(s)for(const i of s)!i||i.isLoaded||t.indexOf(i)===-1&&t.push(i);return t}downloadLibrary(e){!e||e.isLoaded||this._pendingDownloadQueue.indexOf(e)>=0||this._currentDownloads.indexOf(e)>=0||(this._pendingDownloadQueue.push(e),this.processDownloadQueue())}processDownloadQueue(){for(;this._pendingDownloadQueue.length;)this._pendingDownloadQueue[0].downloadAsset(),this._currentDownloads.push(this._pendingDownloadQueue.shift())}}Or.DOWNLOADER_READY="EADM_DOWNLOADER_READY",Or.LIBRARY_LOADED="EADM_LIBRARY_LOADED",Or.MAX_DOWNLOADS=2;class kY extends Mt{constructor(e,t,s,i,n){super(e,t,s,i,n,null)}isPlaceholder(){return!0}}class hl extends Pr{constructor(){super(),this._structure=null,this._avatarAssetDownloadManager=null,this._placeHolderFigure=null,this._figureMapReady=!1,this._effectMapReady=!1,this._actionsReady=!1,this._geometryReady=!1,this._partSetsReady=!1,this._animationsReady=!1,this._isReady=!1,this.onAvatarAssetDownloaderReady=this.onAvatarAssetDownloaderReady.bind(this),this.onAvatarAssetDownloaded=this.onAvatarAssetDownloaded.bind(this),this.onEffectAssetDownloaderReady=this.onEffectAssetDownloaderReady.bind(this),this.onEffectAssetDownloaded=this.onEffectAssetDownloaded.bind(this),this.onAvatarStructureDownloadDone=this.onAvatarStructureDownloadDone.bind(this)}onInit(){this._structure=new xY(this),this.loadGeometry(),this.loadPartSets(),this.loadActions(),this.loadAnimations(),this.loadFigureData(),this._aliasCollection=new pO(this,Ws()),this._aliasCollection.init(),this._avatarAssetDownloadManager||(this._avatarAssetDownloadManager=new cr(Ws(),this._structure),this._avatarAssetDownloadManager.addEventListener(cr.DOWNLOADER_READY,this.onAvatarAssetDownloaderReady),this._avatarAssetDownloadManager.addEventListener(cr.LIBRARY_LOADED,this.onAvatarAssetDownloaded)),this._effectAssetDownloadManager||(this._effectAssetDownloadManager=new Or(Ws(),this._structure),this._effectAssetDownloadManager.addEventListener(Or.DOWNLOADER_READY,this.onEffectAssetDownloaderReady),this._effectAssetDownloadManager.addEventListener(Or.LIBRARY_LOADED,this.onEffectAssetDownloaded)),this.checkReady()}onDispose(){this._avatarAssetDownloadManager&&(this._avatarAssetDownloadManager.removeEventListener(cr.DOWNLOADER_READY,this.onAvatarAssetDownloaderReady),this._avatarAssetDownloadManager.removeEventListener(cr.LIBRARY_LOADED,this.onAvatarAssetDownloaded)),this._effectAssetDownloadManager&&(this._effectAssetDownloadManager.removeEventListener(Or.DOWNLOADER_READY,this.onEffectAssetDownloaderReady),this._effectAssetDownloadManager.removeEventListener(Or.LIBRARY_LOADED,this.onEffectAssetDownloaded))}loadGeometry(){this._structure&&(this._structure.initGeometry(BY.geometry),this._geometryReady=!0,this.checkReady())}loadPartSets(){this._structure&&(this._structure.initPartSets(HY.partSets),this._partSetsReady=!0,this.checkReady())}loadActions(){const e=ue.getValue("avatar.default.actions");e&&this._structure.initActions(Ws(),e);const t=new XMLHttpRequest;try{t.open("GET",ue.getValue("avatar.actions.url")),t.send(),t.onloadend=s=>{this._structure&&(this._structure.updateActions(JSON.parse(t.responseText)),this._actionsReady=!0,this.checkReady())},t.onerror=s=>{throw new Error("invalid_avatar_actions")}}catch(s){Y.error(s)}}loadAnimations(){this._structure&&(this._structure.initAnimation(GY.animations),this._animationsReady=!0,this.checkReady())}loadFigureData(){const e=ue.getValue("avatar.default.figuredata");if(!e||typeof e=="string"){Y.error("XML figuredata is no longer supported");return}this._structure&&this._structure.initFigureData(e),new So(ue.getValue("avatar.figuredata.url"),this._structure.figureData).addEventListener(So.AVATAR_STRUCTURE_DONE,this.onAvatarStructureDownloadDone)}onAvatarStructureDownloadDone(e){this._structureReady=!0,this._structure.init(),this.checkReady()}onAvatarAssetDownloaderReady(e){e&&(this._figureMapReady=!0,this.checkReady())}onAvatarAssetDownloaded(e){e&&this._aliasCollection.reset()}onEffectAssetDownloaderReady(e){e&&(this._effectMapReady=!0,this.checkReady())}onEffectAssetDownloaded(e){e&&this._aliasCollection.reset()}checkReady(){this._isReady||!this._geometryReady||!this._partSetsReady||!this._actionsReady||!this._animationsReady||!this._figureMapReady||!this._effectMapReady||!this._structureReady||(this._isReady=!0,this.events&&this.events.dispatchEvent(new Ce(zh.AVATAR_RENDER_READY)))}createFigureContainer(e){return new gu(e)}isFigureContainerReady(e){return this._avatarAssetDownloadManager?this._avatarAssetDownloadManager.isAvatarFigureContainerReady(e):!1}createAvatarImage(e,t,s,i=null,n=null){if(!this._structure||!this._avatarAssetDownloadManager)return null;const a=new gu(e);return s&&this.validateAvatarFigure(a,s),this._avatarAssetDownloadManager.isAvatarFigureContainerReady(a)?new Mt(this._structure,this._aliasCollection,a,t,this._effectAssetDownloadManager,n):(this._placeHolderFigure||(this._placeHolderFigure=new gu(hl.DEFAULT_FIGURE)),this._avatarAssetDownloadManager.downloadAvatarFigure(a,i),new kY(this._structure,this._aliasCollection,this._placeHolderFigure,t,this._effectAssetDownloadManager))}downloadAvatarFigure(e,t){this._avatarAssetDownloadManager&&this._avatarAssetDownloadManager.downloadAvatarFigure(e,t)}validateAvatarFigure(e,t){let s=!1;const i=this._structure.getMandatorySetTypeIds(t,2);if(i){const n=this._structure.figureData;for(const a of i)if(e.hasPartType(a)){const o=n.getSetType(a);if(o&&!o.getPartSet(e.getPartSetId(a))){const l=this._structure.getDefaultPartSet(a,t);l&&(e.updatePart(a,l.id,[0]),s=!0)}}else{const o=this._structure.getDefaultPartSet(a,t);o&&(e.updatePart(a,o.id,[0]),s=!0)}}return!s}getFigureClubLevel(e,t,s=null){if(!this._structure)return 0;const i=this._structure.figureData,n=Array.from(e.getPartTypeIds());let a=0;for(const o of n){const u=i.getSetType(o);if(!u)continue;const l=e.getPartSetId(o),d=u.getPartSet(l);if(d){a=Math.max(d.clubLevel,a);const c=i.getPalette(u.paletteID),_=e.getPartColorIds(o);for(const f of _){const g=c.getColor(f);g&&(a=Math.max(g.clubLevel,a))}}}s||(s=this._structure.getBodyPartsUnordered(rs.FULL));for(const o of s){const u=i.getSetType(o);u&&n.indexOf(o)===-1&&(a=Math.max(u.optionalFromClubLevel(t),a))}return a}isValidFigureSetForGender(e,t){const i=this.structureData.getFigurePartSet(e);return!!(i&&(i.gender.toUpperCase()==="U"||i.gender.toUpperCase()===t.toUpperCase()))}getFigureStringWithFigureIds(e,t,s){const i=new de;i.loadAvatarData(e,t);const n=this.resolveFigureSets(s);for(const a of n)i.savePartData(a.type,a.id,i.getColourIds(a.type));return i.getFigureString()}resolveFigureSets(e){const t=this.structureData,s=[];for(const i of e){const n=t.getFigurePartSet(i);n&&s.push(n)}return s}getMandatoryAvatarPartSetIds(e,t){return this._structure?this._structure.getMandatorySetTypeIds(e,t):null}getAssetByName(e){return this._aliasCollection.getAsset(e)}get assets(){return Ws()}get isReady(){return this._isReady}get structure(){return this._structure}get structureData(){return this._structure?this._structure.figureData:null}get downloadManager(){return this._avatarAssetDownloadManager}}hl.DEFAULT_FIGURE="hd-99999-99999";class VY{constructor(e,t,s){this._layerId=e,this._partId=t,this._paletteId=s}get layerId(){return this._layerId}set layerId(e){this._layerId=e}get partId(){return this._partId}set partId(e){this._partId=e}get paletteId(){return this._paletteId}set paletteId(e){this._paletteId=e}}class ul{constructor(e){this._typeId=this.getTypeId(e),this._paletteId=this.getPaletteId(e),this._color=this.getColor(e),this._headOnly=this.getHeadOnly(e);const t=this.getCustomData(e);this._customLayerIds=this.getCustomLayerIds(t),this._customPartIds=this.getCustomPartIds(t),this._customPaletteIds=this.getCustomPaletteIds(t),this._customParts=[];let s=0;for(;s<this._customLayerIds.length;)this._customParts.push(new VY(this._customLayerIds[s],this._customPartIds[s],this._customPaletteIds[s])),s++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get customLayerIds(){return this._customLayerIds}get customPartIds(){return this._customPartIds}get customPaletteIds(){return this._customPaletteIds}get customParts(){return this._customParts}getCustomPart(e){if(this._customParts){for(const t of this._customParts)if(t.layerId===e)return t}return null}get hasCustomParts(){return this._customLayerIds!=null&&this._customLayerIds.length>0}get headOnly(){return this._headOnly}get figureString(){let e=this.typeId+" "+this.paletteId+" "+this.color.toString(16);e=e+(" "+this.customParts.length);for(const t of this.customParts)e=e+(" "+t.layerId+" "+t.partId+" "+t.paletteId);return e}getCustomData(e){let t=[];if(e){const s=e.split(" "),i=this._headOnly?1:0,n=4+i;if(s.length>n){const a=3+i,o=parseInt(s[a]);t=s.slice(n,n+o*3)}}return t}getCustomLayerIds(e){const t=[];let s=0;for(;s<e.length;)t.push(parseInt(e[s+0])),s=s+3;return t}getCustomPartIds(e){const t=[];let s=0;for(;s<e.length;)t.push(parseInt(e[s+1])),s=s+3;return t}getCustomPaletteIds(e){const t=[];let s=0;for(;s<e.length;)t.push(parseInt(e[s+2])),s=s+3;return t}getTypeId(e){if(e){const t=e.split(" ");if(t.length>=1)return parseInt(t[0])}return 0}getPaletteId(e){if(e){const t=e.split(" ");if(t.length>=2)return parseInt(t[1])}return 0}getColor(e){if(e){const t=e.split(" ");if(t.length>=3)return parseInt(t[2],16)}return 16777215}getHeadOnly(e){if(e){const t=e.split(" ");if(t.length>=4)return t[3]==="head"}return!1}}class Ba{constructor(e){this._complete=!0,this._target=e}get running(){return this._running&&!!this._target}get complete(){return this._complete}set target(e){this._target=e}get target(){return this._target}set tag(e){this._tag=e}get tag(){return this._tag}start(){this._running=!0}update(e){}stop(){this._target=null,this._running=!1}tick(e){}}class gZ extends Ba{constructor(e){super(null),this._callback=e}get running(){return this._running&&!!this._callback}tick(e){super.tick(e),this._callback&&(this._callback(),this._callback=null)}}class EZ extends Ba{constructor(...e){super(e&&e.length?e[0].target:null),this._runningMotions=[],this._removedMotions=[];for(const t of e)this._runningMotions.push(t)}start(){super.start();for(const e of this._runningMotions)e.start()}tick(e){super.tick(e);let t=null;for(;(t=this._removedMotions.pop())!==null;)this._runningMotions.splice(this._removedMotions.indexOf(t),1),t.running&&t.stop();for(const s of this._runningMotions)s.running&&s.tick(e),s.complete&&this._removedMotions.push(s);if(this._runningMotions.length>0){for(const s of this._runningMotions)if(this._target=s.target,this._target)break;this._complete=!1}else this._complete=!0}}class mZ extends Ba{constructor(e){super(e)}tick(e){super.tick(e),this.target&&(this.target.remove(),this.target=null)}}class Zo extends Ba{constructor(e,t){super(e),this._complete=!1,this._duration=t}get duration(){return this._duration}start(){super.start(),this._complete=!1,this._startTimeMs=ve()}tick(e){super.tick(e);const t=(e-this._startTimeMs)/this._duration;t<1?this.update(t):(this.update(1),this._complete=!0)}}class pZ extends Zo{constructor(e,t,s){super(e,t),this._height=s}start(){super.start(),this._offset=0,this.target.style.top=this._offset-this._height+"px"}update(e){super.update(e),this.target.style.top=this._offset-this._height+this.getBounceOffset(e)*this._height+"px"}getBounceOffset(e){return e<.364?7.5625*e*e:e<.727?(e=e-.545,7.5625*e*e+.75):e<.909?(e=e-.9091,7.5625*e*e+.9375):(e=e-.955,7.5625*e*e+.984375)}stop(){this.target.style.top=this._offset+"px",super.stop()}}class jY extends Zo{constructor(e){super(e.target,e.duration),this._interval=e}start(){super.start(),this._interval.start()}update(e){super.update(e),this._interval.update(e)}stop(){super.stop(),this._interval.stop()}}class YY extends jY{constructor(e,t){super(e),this._rate=t}}class IZ extends YY{constructor(e,t){super(e,t)}update(e){this._interval.update(Math.pow(e,1/this._rate))}}class TZ extends Zo{constructor(e,t,s,i,n,a){super(e,t),this._deltaX=s,this._deltaY=i,this._height=-n,this._numJumps=a}start(){super.start(),this._startX=this.target.offsetLeft,this._startY=this.target.offsetTop}update(e){super.update(e),this.target.style.left=this._startX+this._deltaX*e+"px",this.target.style.top=this._startY+this._height*Math.abs(Math.sin(e*Math.PI*this._numJumps))+this._deltaY*e+"px"}}class ge{static get TIMER_TIME(){return 1e3/Xv()}static runMotion(e){return ge._RUNNING_MOTIONS.indexOf(e)===-1&&ge._QUEUED_MOTIONS.indexOf(e)===-1&&(ge._IS_UPDATING?ge._QUEUED_MOTIONS.push(e):(ge._RUNNING_MOTIONS.push(e),e.start()),ge.startTimer()),e}static removeMotion(e){let t=ge._RUNNING_MOTIONS.indexOf(e);t>-1?ge._IS_UPDATING?(t=ge._REMOVED_MOTIONS.indexOf(e),t==-1&&ge._REMOVED_MOTIONS.push(e)):(ge._RUNNING_MOTIONS.splice(t,1),e.running&&e.stop(),ge._RUNNING_MOTIONS.length||ge.stopTimer()):(t=ge._QUEUED_MOTIONS.indexOf(e),t>-1&&ge._QUEUED_MOTIONS.splice(t,1))}static getMotionByTag(e){for(const t of ge._RUNNING_MOTIONS)if(t.tag==e)return t;for(const t of ge._QUEUED_MOTIONS)if(t.tag==e)return t;return null}static getMotionByTarget(e){for(const t of ge._RUNNING_MOTIONS)if(t.target==e)return t;for(const t of ge._QUEUED_MOTIONS)if(t.target==e)return t;return null}static getMotionByTagAndTarget(e,t){for(const s of ge._RUNNING_MOTIONS)if(s.tag==e&&s.target==t)return s;for(const s of ge._QUEUED_MOTIONS)if(s.tag==e&&s.target==t)return s;return null}static get isRunning(){return!!ge._TIMER}static get isUpdating(){return ge._IS_UPDATING}static onTick(){ge._IS_UPDATING=!0;const e=ve();let t=null;for(;t=ge._QUEUED_MOTIONS.pop();)ge._RUNNING_MOTIONS.push(t);for(;t=ge._REMOVED_MOTIONS.pop();)ge._RUNNING_MOTIONS.splice(ge._RUNNING_MOTIONS.indexOf(t),1),t.running&&t.stop();for(t of ge._RUNNING_MOTIONS)t.running?(t.tick(e),t.complete&&ge.removeMotion(t)):ge.removeMotion(t);ge._RUNNING_MOTIONS.length||ge.stopTimer(),ge._IS_UPDATING=!1}static startTimer(){ge._TIMER||(ge._TIMER=setInterval(ge.onTick,ge.TIMER_TIME))}static stopTimer(){ge._TIMER&&(clearInterval(ge._TIMER),ge._TIMER=null)}getNumRunningMotions(e){let t=0;for(const s of ge._RUNNING_MOTIONS)s.target===e&&t++;return t}}ge._QUEUED_MOTIONS=[],ge._RUNNING_MOTIONS=[],ge._REMOVED_MOTIONS=[],ge._TIMER=null,ge._IS_UPDATING=!1;class WY extends Zo{constructor(e,t,s,i){super(e,t),this._endX=s,this._endY=i}start(){super.start(),this._startX=this.target.offsetLeft,this._startY=this.target.offsetTop,this._deltaX=this._endX-this._startX,this._deltaY=this._endY-this._startY}update(e){this.target.style.left=this._startX+this._deltaX*e+"px",this.target.style.top=this._startY+this._deltaY*e+"px"}}class RZ extends WY{constructor(e,t,s,i){super(e,t,s,i)}start(){this._endX=this.target.offsetLeft+this._endX,this._endY=this.target.offsetTop+this._endY,super.start()}}class vZ extends Ba{constructor(...e){super(e?e[0].target:null),this._queue=[];for(const t of e)this._queue.push(t);this._motion=e[0],this._complete=!this._motion}get running(){return this._running&&this._motion?this._motion.running:!1}start(){super.start(),this._motion.start()}update(e){super.update(e),this._motion.running&&this._motion.update(e)}stop(){super.stop(),this._motion.stop()}tick(e){if(super.tick(e),this._motion.tick(e),this._motion.complete){this._motion.stop();const t=this._queue.indexOf(this._motion);t<this._queue.length-1?(this._motion=this._queue[t+1],this._target=this._motion.target,this._motion.start()):this._complete=!0}}}class OZ extends Zo{constructor(e,t,s,i){super(e,t),this._endW=s,this._endH=i}start(){super.start(),this._startW=this.target.offsetWidth,this._startH=this.target.offsetHeight,this._deltaW=this._endW-this._startW,this._deltaH=this._endH-this._startH}update(e){this.target.style.width=this._startW+this._deltaW*e+"px",this.target.style.height=this._startH+this._deltaH*e+"px"}}class SZ extends Ba{constructor(e){super(null),this._waitTimeMs=e}get running(){return this._running}start(){super.start(),this._complete=!1,this._startTimeMs=ve()}tick(e){super.tick(e),this._complete=e-this._startTimeMs>=this._waitTimeMs,this._complete&&this.stop()}}h.AcceptFriendFailerData=bM,h.AcceptFriendMessageComposer=FG,h.AcceptFriendResultEvent=pL,h.AcceptFriendResultParser=DM,h.AcceptGameInviteMessageComposer=sB,h.AcceptQuestMessageComposer=Mk,h.AccountSafetyLockStatusChangeMessageEvent=UE,h.AccountSafetyLockStatusChangeParser=Ou,h.AchievementData=Sa,h.AchievementEvent=$U,h.AchievementLevelUpData=UN,h.AchievementNotificationMessageEvent=LF,h.AchievementNotificationMessageParser=FN,h.AchievementParser=UA,h.AchievementResolutionCompletedMessageEvent=kL,h.AchievementResolutionCompletedMessageParser=$M,h.AchievementResolutionData=Su,h.AchievementResolutionProgressMessageEvent=VL,h.AchievementResolutionProgressMessageParser=e0,h.AchievementResolutionsMessageEvent=jL,h.AchievementResolutionsMessageParser=t0,h.AchievementsEvent=e1,h.AchievementsParser=FA,h.AchievementsScoreEvent=t1,h.AchievementsScoreParser=wA,h.ActionDefinition=gO,h.ActionType=fO,h.ActivateQuestMessageComposer=Pk,h.ActiveActionData=yc,h.ActivePartSet=Eg,h.ActivityPointNotificationMessageEvent=UF,h.ActivityPointNotificationParser=wN,h.AddDataContainer=IO,h.AddFavouriteRoomMessageComposer=DH,h.AddJukeboxDiskComposer=wV,h.AddSpamWallPostItMessageComposer=tV,h.AdjustmentFilter=Wv,h.AdvancedMap=Ot,h.AlphaTolerance=Ks,h.Animation=Ta,h.AnimationAction=Vi,h.AnimationActionPart=CO,h.AnimationData=st,h.AnimationFrame=xt,h.AnimationFrameData=Qp,h.AnimationFrameDirectionalData=b3,h.AnimationFrameSequenceData=D3,h.AnimationItem=J3,h.AnimationLayerData=L3,h.AnimationManager=OO,h.AnimationSizeData=el,h.AnimationStateData=Jp,h.ApplySnapshotMessageComposer=PV,h.ApplyTonerComposer=gV,h.ApproveAllMembershipRequestsMessageComposer=pB,h.ApproveNameMessageComposer=WV,h.ApproveNameMessageEvent=ox,h.ApproveNameResultParser=_A,h.ArrayBufferToBase64=If,h.AssetAlias=mO,h.AssetAliasCollection=pO,h.AssetManager=lc,h.AuthenticatedEvent=CE,h.AuthenticatedParser=Vb,h.AuthenticationMessageComposer=ZB,h.AvailabilityStatusMessageEvent=Vg,h.AvailabilityStatusMessageParser=iS,h.AvailabilityTimeMessageEvent=oD,h.AvailabilityTimeMessageParser=nS,h.AvatarAction=F,h.AvatarActionManager=EO,h.AvatarAnimationData=MO,h.AvatarAnimationFrame=Eu,h.AvatarAnimationLayerData=lr,h.AvatarAssetDownloadLibrary=As,h.AvatarAssetDownloadManager=cr,h.AvatarCanvas=PO,h.AvatarDataContainer=TO,h.AvatarDirectionAngle=yr,h.AvatarEditorFigureCategory=On,h.AvatarEditorInstanceId=Yh,h.AvatarEditorSideCategory=og,h.AvatarEffect=xA,h.AvatarEffectActivatedComposer=L2,h.AvatarEffectActivatedEvent=s1,h.AvatarEffectActivatedParser=GA,h.AvatarEffectAddedEvent=r1,h.AvatarEffectAddedParser=BA,h.AvatarEffectExpiredEvent=i1,h.AvatarEffectExpiredParser=HA,h.AvatarEffectSelectedComposer=U2,h.AvatarEffectSelectedEvent=n1,h.AvatarEffectSelectedParser=kA,h.AvatarEffectsEvent=a1,h.AvatarEffectsParser=VA,h.AvatarExpressionEnum=as,h.AvatarFigureContainer=gu,h.AvatarFigurePartType=le,h.AvatarGuideStatus=ar,h.AvatarImage=Mt,h.AvatarImageActionCache=SO,h.AvatarImageBodyPartCache=_g,h.AvatarImageBodyPartContainer=AO,h.AvatarImageCache=fg,h.AvatarImageDirectionCache=yO,h.AvatarImagePartContainer=Nc,h.AvatarLogic=dt,h.AvatarModelGeometry=wY,h.AvatarRenderEffectLibraryEvent=da,h.AvatarRenderEvent=zh,h.AvatarRenderLibraryEvent=fa,h.AvatarRenderManager=hl,h.AvatarScaleType=Cr,h.AvatarSet=ud,h.AvatarSetType=rs,h.AvatarStructure=xY,h.AvatarStructureDownload=So,h.AvatarVisualization=z,h.AvatarVisualizationData=$u,h.BadgeAndPointLimit=jA,h.BadgeBaseAndLevel=V_,h.BadgeImageManager=Ts,h.BadgeImageReadyEvent=yn,h.BadgeInfo=dI,h.BadgePointLimitsEvent=Jg,h.BadgePointLimitsParser=YA,h.BadgeReceivedEvent=o1,h.BadgeReceivedParser=WA,h.BadgesEvent=h1,h.BadgesParser=zA,h.BannedUserData=oy,h.BannedUsersFromRoomEvent=jw,h.BannedUsersFromRoomParser=hy,h.BaseHandler=vr,h.BinaryReader=ph,h.BinaryWriter=Tf,h.BonusRareInfoMessageEvent=ND,h.BonusRareInfoMessageParser=US,h.BotAddedToInventoryEvent=fD,h.BotAddedToInventoryParser=gS,h.BotCommandConfigurationEvent=fw,h.BotCommandConfigurationParser=ry,h.BotData=Uc,h.BotErrorEvent=sE,h.BotErrorEventParser=xN,h.BotForceOpenContextMenuEvent=gw,h.BotForceOpenContextMenuParser=iy,h.BotInventoryMessageEvent=gD,h.BotInventoryMessageParser=ES,h.BotPlaceComposer=Im,h.BotReceivedMessageEvent=ED,h.BotReceivedMessageParser=mS,h.BotRemoveComposer=Tm,h.BotRemovedFromInventoryEvent=mD,h.BotRemovedFromInventoryParser=pS,h.BotSkillData=ny,h.BotSkillListUpdateEvent=Ew,h.BotSkillListUpdateParser=ay,h.BotSkillSaveComposer=eV,h.BreedPetsMessageComposer=Yu,h.BreedingPetInfo=Mg,h.BuildersClubFurniCountMessageEvent=bD,h.BuildersClubFurniCountMessageParser=FS,h.BuildersClubPlaceRoomItemMessageComposer=Bx,h.BuildersClubPlaceWallItemMessageComposer=Hx,h.BuildersClubQueryFurniCountMessageComposer=kx,h.BuildersClubSubscriptionStatusMessageEvent=DD,h.BuildersClubSubscriptionStatusMessageParser=wS,h.BundleDiscountRuleset=xS,h.BundleDiscountRulesetMessageEvent=LD,h.BundleDiscountRulesetMessageParser=GS,h.BuyMarketplaceOfferMessageComposer=rH,h.BuyMarketplaceTokensMessageComposer=iH,h.Byte=eO,h.CallForHelpCategoryData=TS,h.CallForHelpDisabledNotifyMessageEvent=PU,h.CallForHelpDisabledNotifyMessageParser=Y0,h.CallForHelpFromForumMessageMessageComposer=r2,h.CallForHelpFromForumThreadMessageComposer=i2,h.CallForHelpFromIMMessageComposer=n2,h.CallForHelpFromPhotoMessageComposer=a2,h.CallForHelpFromSelfieMessageComposer=o2,h.CallForHelpMessageComposer=h2,h.CallForHelpPendingCallsDeletedMessageEvent=NU,h.CallForHelpPendingCallsDeletedMessageParser=W0,h.CallForHelpPendingCallsMessageEvent=bU,h.CallForHelpPendingCallsMessageParser=z0,h.CallForHelpReplyMessageEvent=DU,h.CallForHelpReplyMessageParser=X0,h.CallForHelpResultMessageEvent=LU,h.CallForHelpResultMessageParser=K0,h.CallForHelpTopicData=IS,h.Callback=gZ,h.CameraPublishStatusMessageEvent=RD,h.CameraPublishStatusMessageParser=AS,h.CameraPurchaseOKMessageEvent=vD,h.CameraPurchaseOKMessageParser=yS,h.CameraSnapshotMessageEvent=OD,h.CameraSnapshotMessageParser=CS,h.CameraStorageUrlMessageEvent=SD,h.CameraStorageUrlMessageParser=MS,h.CampaignCalendarData=Fc,h.CampaignCalendarDataMessageEvent=MD,h.CampaignCalendarDataMessageParser=DS,h.CampaignCalendarDoorOpenedMessageEvent=PD,h.CampaignCalendarDoorOpenedMessageParser=LS,h.CanCreateRoomEvent=hF,h.CanCreateRoomEventEvent=uF,h.CanCreateRoomEventParser=qP,h.CanCreateRoomMessageComposer=UH,h.CanCreateRoomMessageParser=Wc,h.CancelEventMessageComposer=LH,h.CancelMarketplaceOfferMessageComposer=nH,h.CancelMysteryBoxWaitMessageEvent=nF,h.CancelMysteryBoxWaitMessageParser=WP,h.CancelPetBreedingComposer=V2,h.CancelQuestMessageComposer=Nk,h.CantConnectMessageParser=Do,h.CatalogGroupsComposer=zV,h.CatalogIndexMessageParser=BS,h.CatalogLocalizationData=HS,h.CatalogPageExpirationEvent=UD,h.CatalogPageExpirationParser=kS,h.CatalogPageMessageEvent=FD,h.CatalogPageMessageOfferData=vu,h.CatalogPageMessageParser=VS,h.CatalogPageMessageProductData=Dr,h.CatalogPageWithEarliestExpiryMessageEvent=xD,h.CatalogPageWithEarliestExpiryMessageParser=jS,h.CatalogPagesListEvent=wD,h.CatalogPublishedMessageEvent=GD,h.CatalogPublishedMessageParser=YS,h.CategoriesWithVisitorCountData=QP,h.CategoriesWithVisitorCountEvent=lF,h.CategoriesWithVisitorCountParser=rN,h.CfhChatlogData=vP,h.CfhChatlogEvent=Y1,h.CfhChatlogMessageParser=OP,h.CfhSanctionMessageEvent=pD,h.CfhSanctionMessageParser=vS,h.CfhSanctionTypeData=RS,h.CfhTopicsInitEvent=ID,h.CfhTopicsInitMessageParser=OS,h.ChangeEmailComposer=XV,h.ChangeEmailResultEvent=hx,h.ChangeEmailResultParser=Sg,h.ChangeQueueMessageComposer=Km,h.ChangeUserNameMessageComposer=Px,h.ChangeUserNameResultMessageEvent=gr,h.ChangeUserNameResultMessageParser=lS,h.ChatRecordData=Lr,h.ChatReviewGuideDecidesOnOfferMessageComposer=u2,h.ChatReviewGuideDetachedMessageComposer=l2,h.ChatReviewGuideVoteMessageComposer=c2,h.ChatReviewSessionCreateMessageComposer=_2,h.ChatReviewSessionDetachedMessageEvent=UU,h.ChatReviewSessionDetachedMessageParser=q0,h.ChatReviewSessionOfferedToGuideMessageEvent=FU,h.ChatReviewSessionOfferedToGuideMessageParser=Q0,h.ChatReviewSessionResultsMessageEvent=wU,h.ChatReviewSessionResultsMessageParser=Z0,h.ChatReviewSessionStartedMessageEvent=xU,h.ChatReviewSessionStartedMessageParser=J0,h.ChatReviewSessionVotingStatusMessageEvent=GU,h.ChatReviewSessionVotingStatusMessageParser=bn,h.ChatlineData=RP,h.CheckUserNameMessageComposer=Nx,h.CheckUserNameResultMessageEvent=_D,h.CheckUserNameResultMessageParser=cS,h.ClientDeviceCategoryEnum=cc,h.ClientHelloMessageComposer=XE,h.ClientPingEvent=Yg,h.ClientPingParser=IM,h.ClientPlatformEnum=jh,h.CloseIssueDefaultActionMessageComposer=dH,h.CloseIssuesMessageComposer=ju,h.ClubGiftData=WS,h.ClubGiftInfoEvent=BD,h.ClubGiftInfoParser=zS,h.ClubGiftNotificationEvent=FF,h.ClubGiftNotificationParser=GN,h.ClubGiftSelectedEvent=HD,h.ClubGiftSelectedParser=XS,h.ClubOfferData=Og,h.ClubOfferExtendData=KS,h.ColorConverter=Zs,h.ColorData=mi,h.Combo=EZ,h.CommunicationManager=cO,h.CommunityGoalData=gb,h.CommunityGoalEarnedPrizesMessageEvent=tw,h.CommunityGoalEarnedPrizesMessageParser=mb,h.CommunityGoalHallOfFameData=Ib,h.CommunityGoalHallOfFameMessageEvent=sw,h.CommunityGoalHallOfFameMessageParser=Tb,h.CommunityGoalProgressMessageEvent=rw,h.CommunityGoalProgressMessageParser=Rb,h.CommunityGoalVoteMessageComposer=sH,h.CommunityGoalVoteMessageEvent=F1,h.CommunityVoteReceivedParser=fP,h.CompetitionEntrySubmitResultEvent=hL,h.CompetitionEntrySubmitResultMessageParser=Ki,h.CompetitionRoomsData=ZP,h.CompetitionRoomsDataMessageEvent=cF,h.CompetitionRoomsDataMessageParser=iN,h.CompetitionRoomsSearchMessageComposer=FH,h.CompetitionStatusMessageEvent=AD,h.CompetitionStatusMessageParser=PS,h.CompetitionVotingInfoMessageEvent=uL,h.CompetitionVotingInfoMessageParser=TM,h.CompetitionVotingInfoResult=Cu,h.CompleteDiffieHandshakeEvent=AU,h.CompleteDiffieHandshakeMessageComposer=JB,h.CompleteDiffieHandshakeParser=B0,h.CompostPlantMessageComposer=vm,h.ConcurrentUsersGoalProgressMessageEvent=iw,h.ConcurrentUsersGoalProgressMessageParser=vb,h.ConditionDefinition=Db,h.ConfigurationEvent=ki,h.ConfigurationManager=_O,h.ConfirmBreedingRequestEvent=E1,h.ConfirmBreedingRequestParser=BC,h.ConfirmBreedingResultEvent=m1,h.ConfirmBreedingResultParser=HC,h.ConfirmPetBreedingComposer=j2,h.ConnectionErrorEvent=wF,h.ConnectionErrorMessageParser=BN,h.ContextMenuEnum=Kt,h.ControlYoutubeDisplayPlaybackMessageComposer=EV,h.ConvertGlobalRoomIdMessageComposer=wH,h.ConvertedRoomIdEvent=_F,h.ConvertedRoomIdMessageParser=nN,h.CopyChannelFilter=Bh,h.CrackableDataType=Eo,h.CraftComposer=MG,h.CraftSecretComposer=PG,h.CraftableProductsEvent=fL,h.CraftableProductsMessageParser=AM,h.CraftingRecipeEvent=gL,h.CraftingRecipeIngredientParser=yM,h.CraftingRecipeMessageParser=CM,h.CraftingRecipesAvailableEvent=EL,h.CraftingRecipesAvailableMessageParser=MM,h.CraftingResultEvent=mL,h.CraftingResultMessageParser=PM,h.CraftingResultObjectParser=Dg,h.CreateFlatMessageComposer=xH,h.CurrentTimingCodeMessageEvent=lL,h.CurrentTimingCodeMessageParser=RM,h.CustomUserNotificationMessageEvent=Tw,h.CustomUserNotificationMessageParser=Ay,h.DeclineFriendMessageComposer=wG,h.DefaultSanctionMessageComposer=fH,h.DeleteFavouriteRoomMessageComposer=GH,h.DeletePendingCallsForHelpMessageComposer=d2,h.DesktopViewComposer=LG,h.DesktopViewEvent=Xc,h.DesktopViewParser=NM,h.DiceValueMessageEvent=n_,h.DiceValueMessageParser=yy,h.DirectSMSClubBuyAvailableMessageEvent=kD,h.DirectSMSClubBuyAvailableMessageParser=qS,h.DirectionData=Fn,h.DirectionDataContainer=RO,h.DirectionalOffsetData=Zp,h.DisconnectMessageComposer=$B,h.DisconnectReasonEnum=pe,h.DisconnectReasonEvent=yU,h.DisconnectReasonParser=H0,h.Disposable=Ss,h.Dispose=mZ,h.DoorbellMessageEvent=tE,h.DoorbellMessageParser=aN,h.DropBounce=pZ,h.Ease=jY,h.EaseOut=IZ,h.EaseRate=YY,h.EditEventMessageComposer=BH,h.EffectAssetDownloadLibrary=bs,h.EffectAssetDownloadManager=Or,h.ElementPointerMessageEvent=xF,h.ElementPointerMessageParser=HN,h.EmailStatusParser=vA,h.EmailStatusResultEvent=xE,h.EmptyDataType=mo,h.EpicPopupMessageEvent=nw,h.EpicPopupMessageParser=Ob,h.EvaWireDataWrapper=tO,h.EvaWireFormat=rO,h.EventDispatcher=ws,h.ExperienceData=q3,h.ExpressionAddition=qp,h.ExpressionAdditionFactory=La,h.ExtendRentOrBuyoutFurniMessageComposer=sV,h.ExtendRentOrBuyoutStripItemMessageComposer=rV,h.ExtendedForumData=Yc,h.ExtendedProfileChangedMessageEvent=_x,h.ExtendedProfileChangedMessageParser=OA,h.ExtendedSprite=Tu,h.FavoriteMembershipUpdateMessageEvent=EE,h.FavoriteMembershipUpdateMessageParser=Oy,h.FavouriteChangedEvent=dF,h.FavouriteChangedMessageParser=oN,h.FavouritesEvent=fF,h.FavouritesMessageParser=hN,h.FigureDataContainer=de,h.FigurePart=NO,h.FigurePartSet=bO,h.FigureSetData=LO,h.FigureSetIdsMessageEvent=l1,h.FigureSetIdsMessageParser=KA,h.FigureUpdateEvent=jg,h.FigureUpdateParser=_S,h.FindFriendsProcessResultEvent=IL,h.FindFriendsProcessResultParser=LM,h.FindNewFriendsMessageComposer=xG,h.FireworkChargeData=QS,h.FireworkChargeDataEvent=VD,h.FireworkChargeDataParser=ZS,h.FixedSizeStack=Fq,h.FlatAccessDeniedMessageEvent=qc,h.FlatAccessDeniedMessageParser=uN,h.FlatControllerAddedEvent=Yw,h.FlatControllerAddedParser=ly,h.FlatControllerData=uy,h.FlatControllerRemovedEvent=Ww,h.FlatControllerRemovedParser=cy,h.FlatControllersEvent=zw,h.FlatControllersParser=_y,h.FlatCreatedEvent=gF,h.FlatCreatedMessageParser=lN,h.FloatingHeartAddition=Ns,h.FloatingIdleZAddition=Qt,h.FloodControlEvent=SE,h.FloodControlParser=mC,h.FloorHeightMapEvent=p_,h.FloorHeightMapMessageParser=Aa,h.FloorPlane=Gn,h.FloorRasterizer=tY,h.FollowFriendFailedEvent=TL,h.FollowFriendFailedParser=UM,h.FollowFriendMessageComposer=GG,h.ForumData=wo,h.ForumDataMessageEvent=EU,h.ForumDataMessageParser=N0,h.ForumsListMessageEvent=mU,h.ForwardToACompetitionRoomMessageComposer=TG,h.ForwardToARandomPromotedRoomMessageComposer=HH,h.ForwardToASubmittableRoomMessageComposer=RG,h.ForwardToRandomCompetitionRoomMessageComposer=vG,h.ForwardToSomeRoomMessageComposer=kH,h.FriendCategoryData=Lg,h.FriendFurniConfirmLockMessageComposer=UG,h.FriendFurniEngravingWidgetType=An,h.FriendListFragmentEvent=RL,h.FriendListFragmentParser=FM,h.FriendListUpdateComposer=BG,h.FriendListUpdateEvent=vL,h.FriendListUpdateParser=wM,h.FriendNotificationEvent=OL,h.FriendNotificationParser=xM,h.FriendParser=Vc,h.FriendRequestData=Ug,h.FriendRequestQuestCompleteMessageComposer=bk,h.FriendRequestsEvent=SL,h.FriendRequestsParser=GM,h.FriendWidgetEngravingWidgetTypeEnum=To,h.FriendlyTime=Se,h.FrontPageItem=Yi,h.FurniId=Qo,h.FurniRentOrBuyoutOfferMessageEvent=Rw,h.FurniRentOrBuyoutOfferMessageParser=by,h.FurnitureAchievementResolutionLogic=Ps,h.FurnitureAliasesComposer=Um,h.FurnitureAliasesEvent=l_,h.FurnitureAliasesParser=Dy,h.FurnitureAnimatedVisualization=rt,h.FurnitureAnimatedVisualizationData=Z_,h.FurnitureBBVisualization=$p,h.FurnitureBadgeDisplayLogic=zp,h.FurnitureBadgeDisplayVisualization=Fa,h.FurnitureBottleVisualization=sn,h.FurnitureBrandedImageVisualization=gs,h.FurnitureBuilderPlaceholderVisualization=U3,h.FurnitureChangeStateWhenStepOnLogic=Sj,h.FurnitureClothingChangeLogic=Aj,h.FurnitureColorWheelComposer=Bm,h.FurnitureCounterClockLogic=yj,h.FurnitureCounterClockVisualization=xr,h.FurnitureCrackableLogic=Cj,h.FurnitureCraftingGizmoLogic=Mj,h.FurnitureCreditLogic=Pj,h.FurnitureCuboidVisualization=F3,h.FurnitureCuckooClockLogic=Nj,h.FurnitureCustomStackHeightLogic=bj,h.FurnitureData=fI,h.FurnitureDataEvent=c_,h.FurnitureDataLoader=on,h.FurnitureDataParser=Wi,h.FurnitureDiceActivateComposer=Hm,h.FurnitureDiceDeactivateComposer=km,h.FurnitureDiceLogic=Dj,h.FurnitureDynamicThumbnailVisualization=eI,h.FurnitureEcotronBoxLogic=Lj,h.FurnitureEditableInternalLinkLogic=Uj,h.FurnitureEditableRoomLinkLogic=Fj,h.FurnitureEffectBoxLogic=wj,h.FurnitureExchangeComposer=aV,h.FurnitureExternalImageLogic=xj,h.FurnitureExternalImageVisualization=w3,h.FurnitureFireworksLogic=Gj,h.FurnitureFireworksVisualization=sI,h.FurnitureFloorAddEvent=a_,h.FurnitureFloorAddParser=Cy,h.FurnitureFloorDataParser=xc,h.FurnitureFloorEvent=o_,h.FurnitureFloorHoleLogic=Ln,h.FurnitureFloorParser=My,h.FurnitureFloorRemoveEvent=h_,h.FurnitureFloorRemoveParser=Py,h.FurnitureFloorUpdateComposer=G_,h.FurnitureFloorUpdateEvent=u_,h.FurnitureFloorUpdateParser=Ny,h.FurnitureFriendFurniLogic=Qi,h.FurnitureGiftWrappedFireworksVisualization=nn,h.FurnitureGiftWrappedVisualization=G3,h.FurnitureGroupForumTerminalLogic=Bj,h.FurnitureGroupInfoComposer=Fm,h.FurnitureGuildCustomizedLogic=mr,h.FurnitureGuildCustomizedVisualization=Es,h.FurnitureGuildIsometricBadgeVisualization=Ir,h.FurnitureHabboWheelLogic=Hj,h.FurnitureHabboWheelVisualization=Tr,h.FurnitureHighScoreLogic=Zu,h.FurnitureHockeyScoreLogic=kj,h.FurnitureHweenLovelockLogic=Vj,h.FurnitureIceStormLogic=jj,h.FurnitureInternalLinkLogic=Yj,h.FurnitureIsometricBBVisualization=B3,h.FurnitureJukeboxLogic=Wj,h.FurnitureListAddOrUpdateEvent=c1,h.FurnitureListAddOrUpdateParser=LC,h.FurnitureListComposer=H2,h.FurnitureListEvent=_1,h.FurnitureListInvalidateEvent=d1,h.FurnitureListInvalidateParser=UC,h.FurnitureListItemParser=Nn,h.FurnitureListParser=FC,h.FurnitureListRemovedEvent=f1,h.FurnitureListRemovedParser=wC,h.FurnitureLogic=Ee,h.FurnitureLoveLockLogic=zj,h.FurnitureMannequinLogic=Zi,h.FurnitureMannequinSaveLookComposer=hV,h.FurnitureMannequinSaveNameComposer=uV,h.FurnitureMannequinVisualization=xa,h.FurnitureMannequinVisualizationData=J_,h.FurnitureMonsterplantSeedLogic=Xj,h.FurnitureMultiHeightLogic=Kj,h.FurnitureMultiStateComposer=B_,h.FurnitureMultiStateLogic=ft,h.FurnitureMysteryBoxLogic=qj,h.FurnitureMysteryTrophyLogic=Qj,h.FurnitureOneWayDoorComposer=Vm,h.FurnitureOneWayDoorLogic=Zj,h.FurnitureParticleSystem=x3,h.FurnitureParticleSystemEmitter=rn,h.FurnitureParticleSystemParticle=tI,h.FurniturePartyBeamerVisualization=Gs,h.FurniturePetCustomizationLogic=Jj,h.FurniturePickupComposer=wm,h.FurniturePlaceComposer=xm,h.FurniturePlacePaintComposer=iV,h.FurniturePlaceholderLogic=$j,h.FurniturePlanetSystemLogic=e3,h.FurniturePlanetSystemVisualization=H3,h.FurniturePlanetSystemVisualizationPlanetObject=tl,h.FurniturePostItPlaceComposer=Gm,h.FurniturePostItPlacedEvent=g1,h.FurniturePostItPlacedParser=xC,h.FurniturePosterVisualization=k3,h.FurniturePresentLogic=er,h.FurniturePurchaseableClothingLogic=t3,h.FurniturePushableLogic=Ei,h.FurnitureQueueTileVisualization=Ii,h.FurnitureRandomStateComposer=jm,h.FurnitureRandomStateLogic=s3,h.FurnitureRandomTeleportLogic=r3,h.FurnitureRentableSpaceLogic=i3,h.FurnitureResettingAnimatedVisualization=V3,h.FurnitureRoomBackgroundColorLogic=n3,h.FurnitureRoomBackgroundLogic=c3,h.FurnitureRoomBackgroundVisualization=j3,h.FurnitureRoomBillboardLogic=_3,h.FurnitureRoomBrandingLogic=Nt,h.FurnitureRoomDimmerLogic=d3,h.FurnitureScoreBoardVisualization=Gr,h.FurnitureScoreLogic=$i,h.FurnitureSongDiskLogic=f3,h.FurnitureSoundBlockLogic=tr,h.FurnitureSoundBlockVisualization=Y3,h.FurnitureSoundMachineLogic=g3,h.FurnitureStackHeightComposer=oV,h.FurnitureStackHeightEvent=vw,h.FurnitureStackHeightParser=Ly,h.FurnitureStackingHeightMap=iY,h.FurnitureStickieLogic=Ju,h.FurnitureStickieVisualization=W3,h.FurnitureTrophyLogic=E3,h.FurnitureValRandomizerVisualization=Zt,h.FurnitureVisualization=pr,h.FurnitureVisualizationData=pi,h.FurnitureVoteCounterLogic=en,h.FurnitureVoteCounterVisualization=Bs,h.FurnitureVoteMajorityLogic=m3,h.FurnitureVoteMajorityVisualization=ms,h.FurnitureWallAddEvent=f_,h.FurnitureWallAddParser=zy,h.FurnitureWallDataParser=Gc,h.FurnitureWallEvent=g_,h.FurnitureWallMultiStateComposer=Ym,h.FurnitureWallParser=Xy,h.FurnitureWallRemoveEvent=E_,h.FurnitureWallRemoveParser=Ky,h.FurnitureWallUpdateComposer=Xm,h.FurnitureWallUpdateEvent=m_,h.FurnitureWallUpdateParser=qy,h.FurnitureWaterAreaVisualization=z3,h.FurnitureWelcomeGiftLogic=p3,h.FurnitureWindowLogic=I3,h.FurnitureYoutubeLogic=T3,h.FurnitureYoutubeVisualization=sl,h.Game2AccountGameStatusMessageEvent=UL,h.Game2AccountGameStatusMessageParser=qM,h.Game2CheckGameDirectoryStatusMessageComposer=$G,h.Game2ExitGameMessageComposer=qG,h.Game2GameChatMessageComposer=QG,h.Game2GameDirectoryStatusMessageEvent=FL,h.Game2GameDirectoryStatusMessageParser=Uo,h.Game2GetAccountGameStatusMessageComposer=eB,h.Game2GetWeeklyFriendsLeaderboardComposer=cB,h.Game2GetWeeklyLeaderboardComposer=_B,h.Game2InArenaQueueMessageEvent=wL,h.Game2InArenaQueueMessageParser=QM,h.Game2JoiningGameFailedMessageEvent=xL,h.Game2JoiningGameFailedMessageParser=ui,h.Game2LoadStageReadyMessageComposer=ZG,h.Game2PlayAgainMessageComposer=JG,h.Game2RequestFullStatusUpdateMessageComposer=tB,h.Game2StartingGameFailedMessageEvent=GL,h.Game2StartingGameFailedMessageParser=jc,h.Game2StopCounterMessageEvent=BL,h.Game2StopCounterMessageParser=ZM,h.Game2UserLeftGameMessageEvent=HL,h.Game2UserLeftGameMessageParser=JM,h.Game2WeeklyFriendsLeaderboardEvent=eU,h.Game2WeeklyLeaderboardEvent=tU,h.Game2WeeklyLeaderboardParser=Mu,h.GameAchievementData=s0,h.GameAchievementsMessageEvent=YL,h.GameAchievementsMessageParser=r0,h.GameClickTargetAddition=wr,h.GameConfigurationData=i0,h.GameInviteMessageEvent=WL,h.GameInviteMessageParser=n0,h.GameListMessageEvent=zL,h.GameListMessageParser=a0,h.GameMessageHandler=cj,h.GameRewardWinnerEntry=d0,h.GameStatusMessageEvent=XL,h.GameStatusMessageParser=Ca,h.GameUnloadedMessageComposer=rB,h.GenericErrorEnum=dc,h.GenericErrorEvent=Kc,h.GenericErrorHandler=dY,h.GenericErrorParser=E0,h.GeometryBodyPart=FY,h.GeometryItem=pI,h.GeometryType=or,h.GetAssetManager=Ws,h.GetBadgePointLimitsComposer=F2,h.GetBonusRareInfoMessageComposer=Vx,h.GetBotInventoryComposer=ZE,h.GetBundleDiscountRulesetComposer=jx,h.GetCatalogIndexComposer=Yx,h.GetCatalogPageComposer=Wx,h.GetCatalogPageExpirationComposer=zx,h.GetCatalogPageWithEarliestExpiryComposer=Xx,h.GetCategoriesWithUserCountMessageComposer=VH,h.GetCfhChatlogMessageComposer=gH,h.GetCfhStatusMessageComposer=f2,h.GetClubGiftInfo=Kx,h.GetClubOffersMessageComposer=qx,h.GetCommunityGoalEarnedPrizesMessageComposer=Dk,h.GetCommunityGoalHallOfFameMessageComposer=Lk,h.GetCommunityGoalProgressMessageComposer=Uk,h.GetConcurrentUsersGoalProgressMessageComposer=Fk,h.GetConcurrentUsersRewardMessageComposer=wk,h.GetCraftableProductsComposer=NG,h.GetCraftingRecipeComposer=bG,h.GetCraftingRecipesAvailableComposer=DG,h.GetCurrentTimingCodeMessageComposer=OG,h.GetCustomRoomFilterMessageComposer=jH,h.GetDailyQuestMessageComposer=xk,h.GetDirectClubBuyAvailableComposer=Qx,h.GetEmailStatusComposer=JV,h.GetExtendedProfileByNameMessageComposer=KV,h.GetFaqCategoryMessageComposer=g2,h.GetFaqTextMessageComposer=E2,h.GetForumStatsMessageComposer=HB,h.GetForumsListMessageComposer=BB,h.GetForumsListMessageParser=b0,h.GetFriendRequestsComposer=HG,h.GetGameAchievementsMessageComposer=iB,h.GetGameListMessageComposer=nB,h.GetGameStatusMessageComposer=aB,h.GetGiftMessageComposer=WE,h.GetGiftWrappingConfigurationComposer=Zx,h.GetGuestRoomMessageComposer=YH,h.GetGuestRoomResultEvent=Qc,h.GetGuestRoomResultMessageParser=cN,h.GetGuideReportingStatusMessageComposer=m2,h.GetHabboBasicMembershipExtendOfferComposer=Jx,h.GetHabboClubExtendOfferMessageComposer=$x,h.GetHabboGroupBadgesMessageComposer=mp,h.GetIgnoredUsersComposer=lp,h.GetInterstitialMessageComposer=yx,h.GetIsBadgeRequestFulfilledComposer=w2,h.GetIsOfferGiftableComposer=eG,h.GetIsUserPartOfCompetitionMessageComposer=SG,h.GetItemDataComposer=Om,h.GetJukeboxPlayListMessageComposer=ap,h.GetLimitedOfferAppearingNextComposer=tG,h.GetMarketplaceCanMakeOfferComposer=aH,h.GetMarketplaceConfigurationMessageComposer=oH,h.GetMarketplaceItemStatsComposer=hH,h.GetMarketplaceOffersMessageComposer=uH,h.GetMarketplaceOwnOffersMessageComposer=lH,h.GetMessagesMessageComposer=kB,h.GetModeratorRoomInfoMessageComposer=EH,h.GetModeratorUserInfoMessageComposer=mH,h.GetNextTargetedOfferComposer=sG,h.GetNowPlayingMessageComposer=op,h.GetOccupiedTilesMessageComposer=IV,h.GetOfficialRoomsMessageComposer=WH,h.GetOfficialSongIdMessageComposer=xV,h.GetPendingCallsForHelpMessageComposer=p2,h.GetPetCommandsComposer=em,h.GetPopularRoomTagsMessageComposer=zH,h.GetProductOfferComposer=rG,h.GetPromoArticlesComposer=tH,h.GetQuestsMessageComposer=Gk,h.GetQuizQuestionsComposer=I2,h.GetRecyclerStatusMessageComposer=Yk,h.GetRentOrBuyoutOfferMessageComposer=nV,h.GetResolutionAchievementsMessageComposer=YE,h.GetRoomAdPurchaseInfoComposer=iG,h.GetRoomChatlogMessageComposer=pH,h.GetRoomEntryDataMessageComposer=H_,h.GetRoomEntryTileMessageComposer=TV,h.GetRoomVisitsMessageComposer=IH,h.GetSeasonalCalendarDailyOfferComposer=nG,h.GetSeasonalQuestsOnlyMessageComposer=Bk,h.GetSecondsUntilMessageComposer=AG,h.GetSellablePetPalettesComposer=aG,h.GetSongInfoMessageComposer=hp,h.GetSoundMachinePlayListMessageComposer=GV,h.GetSoundSettingsComposer=BV,h.GetTalentTrackLevelMessageComposer=kV,h.GetTargetedOfferComposer=oG,h.GetThreadMessageComposer=VB,h.GetThreadsMessageComposer=jB,h.GetTicker=Jr,h.GetTickerFPS=Xv,h.GetTickerTime=ve,h.GetUnreadForumsCountMessageComposer=YB,h.GetUserChatlogMessageComposer=TH,h.GetUserEventCatsMessageComposer=XH,h.GetUserFlatCatsMessageComposer=KH,h.GetUserGameAchievementsMessageComposer=oB,h.GetUserSongDisksMessageComposer=up,h.GetUserTagsComposer=cp,h.GetWardrobeMessageComposer=bx,h.GetWeeklyGameRewardComposer=dB,h.GetWeeklyGameRewardWinnersComposer=fB,h.GetYoutubeDisplayStatusMessageComposer=mV,h.GiftReceiverNotFoundEvent=jD,h.GiftReceiverNotFoundParser=JS,h.GiftWrappingConfigurationEvent=YD,h.GiftWrappingConfigurationParser=$S,h.GoToBreedingNestFailureEvent=$q,h.GoToBreedingNestFailureParser=Ng,h.GoToFlatMessageComposer=qm,h.GotMysteryBoxPrizeMessageEvent=aF,h.GotMysteryBoxPrizeMessageParser=zP,h.GraphicAsset=vn,h.GraphicAssetCollection=la,h.GraphicAssetGifCollection=$v,h.GraphicAssetPalette=Jv,h.GroupAdminGiveComposer=IB,h.GroupAdminTakeComposer=TB,h.GroupBadge=cY,h.GroupBadgePart=nt,h.GroupBadgePartsComposer=RB,h.GroupBadgePartsEvent=Xg,h.GroupBadgePartsParser=T0,h.GroupBuyComposer=vB,h.GroupBuyDataComposer=OB,h.GroupBuyDataEvent=uU,h.GroupBuyDataParser=R0,h.GroupConfirmMemberRemoveEvent=lU,h.GroupConfirmMemberRemoveParser=v0,h.GroupConfirmRemoveMemberComposer=SB,h.GroupDataBadgePart=S0,h.GroupDeleteComposer=AB,h.GroupDetailsChangedMessageEvent=dx,h.GroupDetailsChangedMessageParser=SA,h.GroupFavoriteComposer=yB,h.GroupFurniContextMenuInfoMessageEvent=Ow,h.GroupFurniContextMenuInfoMessageParser=Uy,h.GroupInformationComposer=CB,h.GroupInformationEvent=cU,h.GroupInformationManager=_Y,h.GroupInformationParser=O0,h.GroupJoinComposer=MB,h.GroupMemberParser=A0,h.GroupMembersComposer=PB,h.GroupMembersEvent=_U,h.GroupMembersParser=y0,h.GroupMembershipAcceptComposer=NB,h.GroupMembershipDeclineComposer=bB,h.GroupMembershipRequestedMessageEvent=fx,h.GroupMembershipRequestedMessageParser=AA,h.GroupPurchasedEvent=dU,h.GroupPurchasedParser=C0,h.GroupRank=Fo,h.GroupRemoveMemberComposer=DB,h.GroupSaveBadgeComposer=LB,h.GroupSaveColorsComposer=UB,h.GroupSaveInformationComposer=FB,h.GroupSavePreferencesComposer=wB,h.GroupSettingsComposer=xB,h.GroupSettingsEvent=fU,h.GroupSettingsParser=M0,h.GroupUnfavoriteComposer=GB,h.GuestRoomSearchResultData=JP,h.GuestRoomSearchResultEvent=EF,h.GuestRoomSearchResultMessageParser=_N,h.GuideOnDutyStatusMessageEvent=BU,h.GuideOnDutyStatusMessageParser=$0,h.GuideReportingStatusMessageEvent=HU,h.GuideReportingStatusMessageParser=Bo,h.GuideSessionAttachedMessageEvent=kU,h.GuideSessionAttachedMessageParser=tP,h.GuideSessionCreateMessageComposer=T2,h.GuideSessionDetachedMessageEvent=VU,h.GuideSessionDetachedMessageParser=sP,h.GuideSessionEndedMessageEvent=qg,h.GuideSessionEndedMessageParser=rP,h.GuideSessionErrorMessageEvent=Qg,h.GuideSessionErrorMessageParser=Ma,h.GuideSessionFeedbackMessageComposer=R2,h.GuideSessionGetRequesterRoomMessageComposer=v2,h.GuideSessionGuideDecidesMessageComposer=O2,h.GuideSessionInviteRequesterMessageComposer=S2,h.GuideSessionInvitedToGuideRoomMessageEvent=jU,h.GuideSessionInvitedToGuideRoomMessageParser=iP,h.GuideSessionIsTypingMessageComposer=A2,h.GuideSessionMessageMessageComposer=y2,h.GuideSessionMessageMessageEvent=YU,h.GuideSessionMessageMessageParser=nP,h.GuideSessionOnDutyUpdateMessageComposer=C2,h.GuideSessionPartnerIsTypingMessageEvent=WU,h.GuideSessionPartnerIsTypingMessageParser=aP,h.GuideSessionReportMessageComposer=M2,h.GuideSessionRequesterCancelsMessageComposer=P2,h.GuideSessionRequesterRoomMessageEvent=zU,h.GuideSessionRequesterRoomMessageParser=oP,h.GuideSessionResolvedMessageComposer=N2,h.GuideSessionStartedMessageEvent=Zg,h.GuideSessionStartedMessageParser=hP,h.GuideStatusBubbleAddition=C3,h.GuideTicketCreationResultMessageEvent=XU,h.GuideTicketCreationResultMessageParser=Ho,h.GuideTicketResolutionMessageEvent=KU,h.GuideTicketResolutionMessageParser=Pu,h.GuildBaseSearchMessageComposer=qH,h.GuildEditFailedMessageEvent=gx,h.GuildEditFailedMessageParser=yg,h.GuildForumThread=xo,h.GuildForumThreadsEvent=pU,h.GuildForumThreadsParser=D0,h.GuildMemberMgmtFailedMessageEvent=Ex,h.GuildMemberMgmtFailedMessageParser=yA,h.GuildMembershipsMessageEvent=mx,h.GuildMembershipsMessageParser=CA,h.HabboAvatarAnimations=GY,h.HabboAvatarGeometry=BY,h.HabboAvatarPartSets=HY,h.HabboBroadcastMessageEvent=GF,h.HabboBroadcastMessageParser=kN,h.HabboClubExtendOfferMessageEvent=WD,h.HabboClubExtendOfferMessageParser=eA,h.HabboClubLevelEnum=od,h.HabboClubOffersMessageEvent=zD,h.HabboClubOffersMessageParser=tA,h.HabboGroupBadgesMessageEvent=GE,h.HabboGroupBadgesMessageParser=MA,h.HabboGroupDeactivatedMessageEvent=gU,h.HabboGroupDeactivatedMessageParser=P0,h.HabboGroupEntryData=Ag,h.HabboGroupJoinFailedMessageEvent=px,h.HabboGroupJoinFailedMessageParser=Cg,h.HabboSearchComposer=kG,h.HabboSearchResultData=Fg,h.HabboSearchResultEvent=AL,h.HabboSearchResultParser=BM,h.HabboWebTools=Ti,h.HallOfFameEntryData=pb,h.HarvestPetMessageComposer=Sm,h.HighScoreData=ug,h.HighScoreDataType=po,h.HotelClosedAndOpensEvent=hD,h.HotelClosedAndOpensMessageParser=aS,h.HotelClosesAndWillOpenAtEvent=uD,h.HotelClosesAndWillOpenAtMessageParser=oS,h.HotelMergeNameChangeEvent=qU,h.HotelMergeNameChangeParser=uP,h.HotelWillCloseInMinutesEvent=lD,h.HotelWillCloseInMinutesMessageParser=hS,h.HotelWillShutdownEvent=eQ,h.HotelWillShutdownParser=VN,h.IdentityAccountsEvent=CU,h.IdentityAccountsParser=k0,h.IgnoreResultEvent=U_,h.IgnoreResultParser=NA,h.IgnoreUserComposer=_p,h.IgnoreUserIdComposer=dp,h.IgnoredUsersEvent=BE,h.IgnoredUsersManager=AY,h.IgnoredUsersParser=PA,h.ImageData=dg,h.ImageResult=Mp,h.InClientLinkEvent=HE,h.InClientLinkParser=bA,h.IncomingHeader=m,h.InfoFeedEnableMessageEvent=BF,h.InfoFeedEnableMessageParser=jN,h.InfoRetrieveMessageComposer=KE,h.InitCameraMessageEvent=yD,h.InitCameraMessageParser=NS,h.InitDiffieHandshakeEvent=MU,h.InitDiffieHandshakeMessageComposer=e2,h.InitDiffieHandshakeParser=V0,h.InstantMessageErrorEvent=yL,h.InstantMessageErrorParser=HM,h.InterstitialMessageEvent=nD,h.InterstitialMessageParser=sS,h.InterstitialShownMessageComposer=Cx,h.Interval=Zo,h.IsBadgeRequestFulfilledEvent=u1,h.IsBadgeRequestFulfilledParser=XA,h.IsOfferGiftableMessageEvent=XD,h.IsOfferGiftableMessageParser=sA,h.IsUserPartOfCompetitionMessageEvent=cL,h.IsUserPartOfCompetitionMessageParser=vM,h.IsometricImageFurniVisualization=wa,h.IssueCloseNotificationMessageEvent=QU,h.IssueCloseNotificationMessageParser=lP,h.IssueDeletedMessageEvent=W1,h.IssueDeletedMessageParser=SP,h.IssueInfoMessageEvent=z1,h.IssueInfoMessageParser=Bg,h.IssueMessageData=ko,h.IssuePickFailedMessageEvent=X1,h.IssuePickFailedMessageParser=yP,h.ItemDataStructure=zC,h.ItemDataUpdateMessageEvent=__,h.ItemDataUpdateMessageParser=Fy,h.JoinQueueMessageComposer=hB,h.JoinedQueueMessageEvent=KL,h.JoinedQueueMessageParser=o0,h.JoiningQueueFailedMessageEvent=qL,h.JoiningQueueFailedMessageParser=wg,h.JukeboxPlayListFullMessageEvent=ME,h.JukeboxPlayListFullMessageParser=jb,h.JukeboxPlaylistController=bY,h.JukeboxSongDisksMessageEvent=PE,h.JukeboxSongDisksMessageParser=Yb,h.JumpBy=TZ,h.LagWarningReportMessageComposer=jV,h.LandscapePlane=Hn,h.LandscapeRasterizer=Rr,h.LayerData=fe,h.LeaderboardEntry=Qq,h.LeaveQueueMessageComposer=uB,h.LeftQueueMessageEvent=QL,h.LeftQueueMessageParser=h0,h.LegacyDataType=ns,h.LegacyExternalInterface=Ae,h.LegacyWallGeometry=ps,h.LimitedEditionSoldOutEvent=KD,h.LimitedEditionSoldOutParser=rA,h.LimitedOfferAppearingNextMessageEvent=qD,h.LimitedOfferAppearingNextMessageParser=iA,h.LoadGameMessageEvent=ZL,h.LoadGameMessageParser=u0,h.LoadGameUrlEvent=zg,h.LoadGameUrlParser=l0,h.LoveLockFurniFinishedEvent=Sw,h.LoveLockFurniFinishedParser=wy,h.LoveLockFurniFriendConfirmedEvent=Aw,h.LoveLockFurniFriendConfirmedParser=xy,h.LoveLockFurniStartEvent=yw,h.LoveLockFurniStartParser=Gy,h.MOTDNotificationEvent=HF,h.MOTDNotificationParser=YN,h.MaintenanceStatusMessageEvent=cD,h.MaintenanceStatusMessageParser=uS,h.MakeOfferMessageComposer=cH,h.MapDataType=Xs,h.MarkCatalogNewAdditionsPageOpenedComposer=hG,h.MarketPlaceOffersEvent=V1,h.MarketplaceBuyOfferResultEvent=w1,h.MarketplaceBuyOfferResultParser=gP,h.MarketplaceCanMakeOfferResult=G1,h.MarketplaceCanMakeOfferResultParser=mP,h.MarketplaceCancelOfferResultEvent=x1,h.MarketplaceCancelOfferResultParser=EP,h.MarketplaceConfigurationEvent=B1,h.MarketplaceConfigurationMessageParser=pP,h.MarketplaceItemStatsEvent=H1,h.MarketplaceItemStatsParser=TP,h.MarketplaceMakeOfferResult=k1,h.MarketplaceMakeOfferResultParser=IP,h.MarketplaceOffer=xg,h.MarketplaceOfferData=Gg,h.MarketplaceOffersParser=li,h.MarketplaceOwnOffersEvent=j1,h.MarketplaceOwnOffersParser=bu,h.Matrix4x4=Rs,h.MemberData=$s,h.MessageClassManager=uO,h.MessageData=Go,h.MessageErrorEvent=CL,h.MessageErrorParser=kM,h.MessageEvent=v,h.MessengerInitComposer=VG,h.MessengerInitEvent=ML,h.MessengerInitParser=VM,h.MiniMailNewMessageEvent=PL,h.MiniMailNewMessageParser=jM,h.MiniMailUnreadCountEvent=NL,h.MiniMailUnreadCountParser=YM,h.ModAlertMessageComposer=RH,h.ModBanMessageComposer=Ur,h.ModKickMessageComposer=OH,h.ModMessageMessageComposer=SH,h.ModMuteMessageComposer=AH,h.ModRoomData=DP,h.ModToolPreferencesComposer=yH,h.ModToolSanctionComposer=CH,h.ModTradingLockMessageComposer=MH,h.ModerateMessageMessageComposer=WB,h.ModerateRoomMessageComposer=vH,h.ModerateThreadMessageComposer=zB,h.ModerationCautionParser=CP,h.ModeratorActionMessageComposer=jo,h.ModeratorActionResultMessageEvent=K1,h.ModeratorActionResultMessageParser=MP,h.ModeratorCautionEvent=q1,h.ModeratorInitData=PP,h.ModeratorInitMessageEvent=Q1,h.ModeratorInitMessageParser=NP,h.ModeratorMessageEvent=Z1,h.ModeratorMessageParser=bP,h.ModeratorRoomInfoEvent=J1,h.ModeratorRoomInfoMessageParser=UP,h.ModeratorToolPreferencesEvent=$1,h.ModeratorToolPreferencesMessageParser=FP,h.ModeratorUserInfoData=wP,h.ModeratorUserInfoEvent=eF,h.ModeratorUserInfoMessageParser=xP,h.MoodlightSettingsComposer=bm,h.MoodlightSettingsSaveComposer=Dm,h.MoodlightTogggleStateComposer=Lm,h.Motion=Ba,h.Motions=ge,h.MouseEventType=W,h.MoveBy=RZ,h.MoveTo=WY,h.MovingObjectLogic=Er,h.MusicController=kn,h.MusicPriorities=us,h.MuteAllInRoomEvent=Xw,h.MuteAllInRoomParser=dy,h.MutedBubbleAddition=M3,h.MyFavouriteRoomsSearchMessageComposer=QH,h.MyFrequentRoomHistorySearchMessageComposer=ZH,h.MyFriendsRoomsSearchMessageComposer=JH,h.MyGuildBasesSearchMessageComposer=$H,h.MyRecommendedRoomsMessageComposer=ek,h.MyRoomHistorySearchMessageComposer=tk,h.MyRoomRightsSearchMessageComposer=sk,h.MyRoomsSearchMessageComposer=rk,h.MysteryBoxKeysEvent=eE,h.MysteryBoxKeysParser=XP,h.MysteryBoxKeysUpdateEvent=Jh,h.MysteryBoxWaitingCanceledMessageComposer=bH,h.NavigatorCategoryDataParser=dN,h.NavigatorCategoryListModeComposer=ik,h.NavigatorCollapsedEvent=mF,h.NavigatorCollapsedParser=fN,h.NavigatorDeleteSavedSearchComposer=nk,h.NavigatorEventCategoryDataParser=gN,h.NavigatorHomeRoomEvent=pF,h.NavigatorHomeRoomParser=EN,h.NavigatorInitComposer=ak,h.NavigatorLiftedDataParser=mN,h.NavigatorLiftedEvent=IF,h.NavigatorLiftedParser=pN,h.NavigatorMetadataEvent=TF,h.NavigatorMetadataParser=IN,h.NavigatorOpenRoomCreatorEvent=RF,h.NavigatorOpenRoomCreatorParser=TN,h.NavigatorSavedSearch=Hg,h.NavigatorSearchCloseComposer=ok,h.NavigatorSearchComposer=hk,h.NavigatorSearchEvent=OF,h.NavigatorSearchOpenComposer=uk,h.NavigatorSearchParser=vN,h.NavigatorSearchResultList=$P,h.NavigatorSearchResultSet=eN,h.NavigatorSearchSaveComposer=lk,h.NavigatorSearchesEvent=vF,h.NavigatorSearchesParser=RN,h.NavigatorSettingsEvent=SF,h.NavigatorSettingsParser=ON,h.NavigatorSettingsSaveComposer=ck,h.NavigatorTopLevelContext=tN,h.NestBreedingSuccessEvent=p1,h.NestBreedingSuccessParser=kC,h.NewConsoleMessageEvent=bL,h.NewConsoleMessageParser=WM,h.NewFriendRequestEvent=Wg,h.NewFriendRequestParser=zM,h.NewUserExperienceGetGiftsComposer=yk,h.NewUserExperienceGetGiftsSelection=iQ,h.NewUserExperienceGift=KF,h.NewUserExperienceGiftOfferMessageEvent=qF,h.NewUserExperienceGiftOptions=QF,h.NewUserExperienceNotCompleteEvent=ZF,h.NewUserExperienceScriptProceedComposer=$E,h.Nitro=X,h.NitroAlphaFilter=pq,h.NitroBaseTexture=Kv,h.NitroBundle=_o,h.NitroCommunicationDemo=hj,h.NitroCommunicationDemoEvent=qt,h.NitroCommunicationManager=lj,h.NitroConfiguration=ue,h.NitroContainer=nr,h.NitroCore=dO,h.NitroEvent=Ce,h.NitroFilter=qv,h.NitroLocalizationEvent=ga,h.NitroLocalizationManager=_j,h.NitroLogger=Y,h.NitroManager=Pr,h.NitroMessages=uj,h.NitroPoint=Hh,h.NitroPolygon=Iq,h.NitroRectangle=Tq,h.NitroRenderTexture=Rq,h.NitroSettingsEvent=si,h.NitroSoundEvent=Xh,h.NitroSprite=ot,h.NitroSpritesheet=Sq,h.NitroTexture=ig,h.NitroTilemap=Aq,h.NitroToolbarAnimateIconEvent=Ro,h.NitroToolbarEvent=Ec,h.NitroVersion=hi,h.NoOwnedRoomsAlertMessageEvent=_L,h.NoOwnedRoomsAlertMessageParser=OM,h.NoSuchFlatEvent=Kw,h.NoSuchFlatParser=fy,h.Node3D=mI,h.NodeData=wc,h.NoobnessLevelEnum=_a,h.NoobnessLevelMessageEvent=Kg,h.NoobnessLevelMessageParser=j0,h.NotEnoughBalanceMessageEvent=QD,h.NotEnoughBalanceMessageParser=nA,h.NotificationDialogMessageEvent=kF,h.NotificationDialogMessageParser=WN,h.NotifyPlayedSongEvent=ol,h.NowPlayingEvent=Ri,h.NowPlayingMessageEvent=NE,h.NowPlayingMessageParser=Wb,h.NumberBank=vg,h.NumberBubbleAddition=P3,h.NumberDataType=ei,h.ObjectAdUpdateMessage=fs,h.ObjectAvatarCarryObjectUpdateMessage=Pp,h.ObjectAvatarChatUpdateMessage=Y_,h.ObjectAvatarDanceUpdateMessage=Np,h.ObjectAvatarEffectUpdateMessage=bp,h.ObjectAvatarExperienceUpdateMessage=Dp,h.ObjectAvatarExpressionUpdateMessage=Lp,h.ObjectAvatarFigureUpdateMessage=Xu,h.ObjectAvatarFlatControlUpdateMessage=Up,h.ObjectAvatarGestureUpdateMessage=Fp,h.ObjectAvatarGuideStatusUpdateMessage=Oj,h.ObjectAvatarMutedUpdateMessage=wp,h.ObjectAvatarOwnMessage=xp,h.ObjectAvatarPetGestureUpdateMessage=Gp,h.ObjectAvatarPlayerValueUpdateMessage=Bp,h.ObjectAvatarPlayingGameUpdateMessage=Hp,h.ObjectAvatarPostureUpdateMessage=W_,h.ObjectAvatarSelectedMessage=Ku,h.ObjectAvatarSignUpdateMessage=kp,h.ObjectAvatarSleepUpdateMessage=z_,h.ObjectAvatarTypingUpdateMessage=Vp,h.ObjectAvatarUpdateMessage=qu,h.ObjectAvatarUseObjectUpdateMessage=jp,h.ObjectData=Sy,h.ObjectDataBase=Ui,h.ObjectDataFactory=Fi,h.ObjectDataFlags=hg,h.ObjectDataKey=is,h.ObjectDataUpdateMessage=Ve,h.ObjectGroupBadgeUpdateMessage=Na,h.ObjectHeightUpdateMessage=Yp,h.ObjectItemDataUpdateMessage=X_,h.ObjectModelDataUpdateMessage=Wp,h.ObjectMouseData=KO,h.ObjectMoveUpdateMessage=qi,h.ObjectRolling=ti,h.ObjectRoomColorUpdateMessage=Qu,h.ObjectRoomFloorHoleUpdateMessage=_i,h.ObjectRoomMapUpdateMessage=Yo,h.ObjectRoomMaskUpdateMessage=Ft,h.ObjectRoomPlanePropertyUpdateMessage=di,h.ObjectRoomPlaneVisibilityUpdateMessage=fi,h.ObjectRoomUpdateMessage=wt,h.ObjectSelectedMessage=Wo,h.ObjectStateUpdateMessage=Rt,h.ObjectTileCursorUpdateMessage=ba,h.ObjectVisibilityUpdateMessage=gi,h.ObjectsDataUpdateEvent=r_,h.ObjectsDataUpdateParser=tC,h.ObjectsRollingEvent=i_,h.ObjectsRollingParser=sC,h.OfferRewardDeliveredMessageEvent=VF,h.OfferRewardDeliveredMessageParser=zN,h.OfficialRoomEntryData=ci,h.OfficialSongIdMessageEvent=tx,h.OfficialSongIdMessageParser=zb,h.OneWayDoorStatusMessageEvent=d_,h.OneWayDoorStatusMessageParser=By,h.OpenCampaignCalendarDoorAsStaffComposer=xx,h.OpenCampaignCalendarDoorComposer=Gx,h.OpenMessageComposer=NV,h.OpenMysteryTrophyMessageComposer=lV,h.OpenPetPackageMessageComposer=Wm,h.OpenPetPackageRequestedMessageEvent=iE,h.OpenPetPackageRequestedMessageParser=eb,h.OpenPetPackageResultMessageEvent=nE,h.OpenPetPackageResultMessageParser=tb,h.OpenPresentComposer=zm,h.OpenQuestTrackerMessageComposer=Hk,h.OpenWelcomeGiftComposer=cV,h.OutfitData=dS,h.OutgoingHeader=E,h.POINT_STRUCT_SIZE=Ar,h.Palette=gg,h.PaletteMapFilter=Ys,h.PartColor=DO,h.PartDefinition=Pc,h.PartSetsData=UO,h.PatternMatchData=AP,h.PeerUsersClassificationMessageComposer=Ip,h.PendingGuideTicketData=eP,h.PerformanceLogMessageComposer=YV,h.PerkAllowancesMessageEvent=JF,h.PerkAllowancesMessageParser=$N,h.PerkData=JN,h.PerkEnum=Js,h.PerksUpdatedEvent=Ic,h.PetAddedToInventoryEvent=I1,h.PetAddedToInventoryParser=VC,h.PetBreedingMessageEvent=$F,h.PetBreedingMessageParser=yu,h.PetBreedingResultData=Pg,h.PetBreedingResultEvent=pE,h.PetBreedingResultParser=uC,h.PetColorResult=No,h.PetCustomPart=VY,h.PetData=Au,h.PetExperienceEvent=IE,h.PetExperienceParser=lC,h.PetFigureData=ul,h.PetFigureDataParser=Hc,h.PetFigureUpdateEvent=Uu,h.PetFigureUpdateParser=cC,h.PetInfoEvent=TE,h.PetInfoParser=_C,h.PetInventoryEvent=T1,h.PetInventoryParser=jC,h.PetLevelNotificationEvent=jF,h.PetLevelNotificationParser=XN,h.PetLevelUpdateMessageEvent=aE,h.PetLevelUpdateMessageParser=sb,h.PetLogic=R3,h.PetMessageComposer=Rm,h.PetMountComposer=w_,h.PetMoveComposer=x_,h.PetPackageHandler=fY,h.PetPlaceComposer=Am,h.PetPlacingErrorEvent=rE,h.PetPlacingErrorEventParser=KN,h.PetReceivedMessageEvent=R1,h.PetReceivedMessageParser=YC,h.PetRemoveComposer=ym,h.PetRemovedFromInventory=v1,h.PetRemovedFromInventoryParser=WC,h.PetRespectComposer=tm,h.PetRespectNoficationEvent=kE,h.PetRespectNotificationParser=sM,h.PetScratchFailedMessageEvent=oE,h.PetScratchFailedMessageParser=rb,h.PetSelectedMessageComposer=CV,h.PetSizeData=tn,h.PetStatusUpdateEvent=RE,h.PetStatusUpdateParser=dC,h.PetSupplementComposer=Ck,h.PetSupplementTypeEnum=Xi,h.PetSupplementedNotificationEvent=VE,h.PetSupplementedNotificationParser=rM,h.PetTrainingMessageParser=ib,h.PetTrainingPanelMessageEvent=ew,h.PetType=be,h.PetVisualization=et,h.PetVisualizationData=oI,h.PhoneCollectionStateMessageEvent=aU,h.PhoneCollectionStateParser=m0,h.PhotoCompetitionMessageComposer=Lx,h.PickIssuesMessageComposer=PH,h.PixiApplicationProxy=_t,h.PixiInteractionEventProxy=Dq,h.PlaceHolderAvatarImage=kY,h.Plane=sd,h.PlaneBitmapData=rl,h.PlaneDrawingData=zo,h.PlaneMask=Q3,h.PlaneMaskBitmap=td,h.PlaneMaskManager=Z3,h.PlaneMaskVisualization=xn,h.PlaneMaterial=rd,h.PlaneMaterialCell=eY,h.PlaneMaterialCellColumn=vt,h.PlaneMaterialCellMatrix=ye,h.PlaneRasterizer=an,h.PlaneTexture=Bn,h.PlaneTextureBitmap=id,h.PlaneTextureCache=Vh,h.PlaneVisualization=$3,h.PlaneVisualizationAnimationLayer=hI,h.PlaneVisualizationLayer=Jt,h.PlayListEntry=Du,h.PlayListMessageEvent=sx,h.PlayListMessageParser=Xb,h.PlayListSongAddedMessageEvent=rx,h.PlayListSongAddedMessageParser=Kb,h.PlayListStatusEvent=un,h.PointMath=zq,h.PollAnswerComposer=om,h.PollChoice=nb,h.PollContentsEvent=hE,h.PollContentsParser=ob,h.PollErrorEvent=uE,h.PollErrorParser=hb,h.PollHandler=gY,h.PollOfferEvent=lE,h.PollOfferParser=ub,h.PollQuestion=ab,h.PollRejectComposer=hm,h.PollStartComposer=um,h.PongMessageComposer=qE,h.PopularRoomTagsData=AN,h.PopularRoomTagsResultEvent=AF,h.PopularRoomTagsResultMessageParser=yN,h.PopularRoomsSearchMessageComposer=_k,h.PopularTagData=SN,h.PostMessageMessageComposer=XB,h.PostMessageMessageEvent=IU,h.PostMessageMessageParser=L0,h.PostQuizAnswersComposer=b2,h.PostThreadMessageEvent=TU,h.PostThreadMessageParser=U0,h.PresentOpenedMessageEvent=$g,h.PresentOpenedMessageParser=GC,h.PrizeData=Eb,h.ProductData=yY,h.ProductDataLoader=hn,h.ProductOffer=XF,h.ProductOfferEvent=ZD,h.ProductOfferMessageParser=aA,h.PromoArticleData=Nu,h.PromoArticlesMessageEvent=U1,h.PromoArticlesMessageParser=dP,h.PublishPhotoMessageComposer=Ux,h.PurchaseBasicMembershipExtensionComposer=uG,h.PurchaseErrorMessageEvent=JD,h.PurchaseErrorMessageParser=oA,h.PurchaseFromCatalogAsGiftComposer=lG,h.PurchaseFromCatalogComposer=cG,h.PurchaseNotAllowedMessageEvent=$D,h.PurchaseNotAllowedMessageParser=hA,h.PurchaseOKMessageEvent=eL,h.PurchaseOKMessageOfferData=uA,h.PurchaseOKMessageParser=lA,h.PurchasePhotoMessageComposer=Fx,h.PurchaseRoomAdMessageComposer=_G,h.PurchaseTargetedOfferComposer=dG,h.PurchaseVipMembershipExtensionComposer=fG,h.QuestCancelledMessageEvent=aw,h.QuestCancelledMessageParser=Sb,h.QuestCompletedMessageEvent=ow,h.QuestCompletedMessageParser=Ab,h.QuestDailyMessageEvent=hw,h.QuestDailyMessageParser=yb,h.QuestMessageData=Dn,h.QuestMessageEvent=uw,h.QuestMessageParser=Cb,h.QuestionAnsweredEvent=cE,h.QuestionAnsweredParser=lb,h.QuestionEvent=_E,h.QuestionFinishedEvent=dE,h.QuestionFinishedParser=cb,h.QuestionParser=_b,h.QuestsMessageEvent=lw,h.QuestsMessageParser=Mb,h.Queue=vZ,h.QuizDataMessageEvent=ZU,h.QuizDataMessageParser=cP,h.QuizResultsMessageEvent=JU,h.QuizResultsMessageParser=_P,h.Randomizer=it,h.RarityCategoryData=fC,h.Rasterizer=zO,h.RateFlatMessageComposer=dk,h.RecycleItemsEntry=nQ,h.RecycleItemsMessageComposer=Wk,h.RecyclerFinishedMessageEvent=Zc,h.RecyclerFinishedMessageParser=Nb,h.RecyclerStatusMessageEvent=Lu,h.RecyclerStatusMessageParser=bb,h.RedeemCommunityGoalPrizeMessageComposer=kk,h.RedeemItemClothingComposer=vV,h.RedeemMarketplaceOfferCreditsMessageComposer=_H,h.RedeemVoucherMessageComposer=gG,h.RejectQuestMessageComposer=Vk,h.RelationshipStatusEnum=Sn,h.RelationshipStatusInfo=dA,h.RelationshipStatusInfoEvent=ux,h.RelationshipStatusInfoMessageParser=fA,h.ReleaseIssuesMessageComposer=NH,h.RemainingMuteEvent=AE,h.RemainingMuteParser=pC,h.RemoveAllRightsMessageComposer=zk,h.RemoveFriendComposer=jG,h.RemoveJukeboxDiskComposer=HV,h.RemoveOwnRoomRightsRoomMessageComposer=fk,h.RemovePetSaddleComposer=sm,h.RemoveWallItemComposer=Cm,h.RenderMode=Wh,h.RenderRoomMessageComposer=Vu,h.RenderRoomThumbnailMessageComposer=F_,h.RentableSpaceCancelRentMessageComposer=_V,h.RentableSpaceRentFailedMessageEvent=Cw,h.RentableSpaceRentFailedMessageParser=Hy,h.RentableSpaceRentMessageComposer=dV,h.RentableSpaceRentOkMessageEvent=Mw,h.RentableSpaceRentOkMessageParser=ky,h.RentableSpaceStatusMessageComposer=fV,h.RentableSpaceStatusMessageEvent=Pw,h.RentableSpaceStatusMessageParser=fr,h.RequestABadgeComposer=x2,h.RequestAchievementsMessageComposer=Mx,h.RequestBadgesComposer=G2,h.RequestBotCommandConfigurationComposer=qk,h.RequestCameraConfigurationComposer=wx,h.RequestFriendComposer=YG,h.RequestFurniInventoryWhenNotInRoomComposer=k2,h.RequestPetInfoComposer=rm,h.RequestPetsComposer=JE,h.RequestSpamWallPostItMessageEvent=Nw,h.RequestSpamWallPostItMessageParser=Vy,h.ResetPhoneNumberStateMessageComposer=gB,h.ResetResolutionAchievementMessageComposer=lB,h.ResizeTo=OZ,h.RespectReceivedEvent=jE,h.RespectReceivedParser=iM,h.RestoreClientMessageEvent=YF,h.RestoreClientMessageParser=qN,h.RoomAdErrorEvent=aD,h.RoomAdErrorMessageParser=rS,h.RoomAdEventTabAdClickedComposer=gk,h.RoomAdEventTabViewedComposer=Ek,h.RoomAdPurchaseInfoEvent=tL,h.RoomAdPurchaseInfoEventParser=lM,h.RoomAdPurchaseInitiatedComposer=EG,h.RoomAdSearchMessageComposer=mk,h.RoomAmbassadorAlertComposer=dm,h.RoomBackgroundColorEvent=Kh,h.RoomBanUserComposer=fm,h.RoomBannedUsersComposer=Qk,h.RoomCamera=al,h.RoomCameraWidgetEffect=eS,h.RoomCameraWidgetManager=tS,h.RoomCameraWidgetManagerEvent=gc,h.RoomCameraWidgetSelectedEffect=Xq,h.RoomChatHandler=EY,h.RoomChatSettings=Cs,h.RoomChatSettingsEvent=mw,h.RoomChatSettingsParser=Ty,h.RoomChatlogEvent=tF,h.RoomChatlogMessageParser=GP,h.RoomCompetitionInitMessageComposer=yG,h.RoomContentLoadedEvent=Nr,h.RoomContentLoader=Ne,h.RoomControllerLevel=Fs,h.RoomData=_I,h.RoomDataHandler=mY,h.RoomDataParser=It,h.RoomDeleteComposer=Xk,h.RoomDimmerPresetsEvent=mE,h.RoomDimmerPresetsHandler=pY,h.RoomDimmerPresetsMessageData=jy,h.RoomDimmerPresetsMessageParser=Yy,h.RoomDoorbellAcceptedEvent=Jc,h.RoomDoorbellAcceptedParser=ZA,h.RoomDoorbellAccessComposer=cm,h.RoomDragEvent=qh,h.RoomEngine=Oe,h.RoomEngineDimmerStateEvent=Qh,h.RoomEngineEvent=Ue,h.RoomEngineObjectEvent=ee,h.RoomEngineObjectPlacedEvent=iO,h.RoomEngineObjectPlacedOnUserEvent=nO,h.RoomEngineObjectPlaySoundEvent=Ea,h.RoomEngineRoomAdEvent=Gi,h.RoomEngineSamplePlaybackEvent=_s,h.RoomEngineTriggerWidgetEvent=H,h.RoomEngineUseProductEvent=Zh,h.RoomEnterComposer=_m,h.RoomEnterEffect=ne,h.RoomEnterErrorEvent=_w,h.RoomEnterEvent=s_,h.RoomEnterParser=ty,h.RoomEntryData=nM,h.RoomEntryInfoMessageEvent=pw,h.RoomEntryInfoMessageParser=Ry,h.RoomEntryTileMessageEvent=I_,h.RoomEntryTileMessageParser=rC,h.RoomEventCancelEvent=yF,h.RoomEventCancelMessageParser=CN,h.RoomEventData=sN,h.RoomEventEvent=CF,h.RoomEventMessageParser=MN,h.RoomFilterSettingsMessageEvent=MF,h.RoomFilterSettingsMessageParser=PN,h.RoomFloorHole=S3,h.RoomForwardEvent=dw,h.RoomFowardParser=sy,h.RoomFurnitureData=nd,h.RoomGeometry=ys,h.RoomGiveRightsComposer=gm,h.RoomHeightMapEvent=T_,h.RoomHeightMapParser=zi,h.RoomHeightMapUpdateEvent=R_,h.RoomHeightMapUpdateParser=iC,h.RoomId=Oa,h.RoomInstance=JO,h.RoomInstanceData=aY,h.RoomInviteErrorEvent=DL,h.RoomInviteErrorParser=XM,h.RoomInviteEvent=LL,h.RoomInviteParser=KM,h.RoomKickUserComposer=Em,h.RoomLogic=A3,h.RoomManager=ds,h.RoomMapData=Xp,h.RoomMapMaskData=v3,h.RoomMessageHandler=hY,h.RoomMessageNotificationMessageEvent=bw,h.RoomMessageNotificationMessageParser=Wy,h.RoomModerationData=LP,h.RoomModerationSettings=Lo,h.RoomMuteComposer=bV,h.RoomMuteUserComposer=mm,h.RoomNetworkOpenConnectionMessageComposer=MV,h.RoomObject=pu,h.RoomObjectBadgeAssetEvent=br,h.RoomObjectBadgeImageAssetListener=oY,h.RoomObjectCache=yo,h.RoomObjectCacheItem=xO,h.RoomObjectCategory=U,h.RoomObjectDataRequestEvent=Qs,h.RoomObjectDimmerStateUpdateEvent=Bi,h.RoomObjectEvent=qs,h.RoomObjectEventHandler=uY,h.RoomObjectFloorHoleEvent=os,h.RoomObjectFurnitureActionEvent=B,h.RoomObjectHSLColorEnableEvent=Hi,h.RoomObjectHSLColorEnabledEvent=mc,h.RoomObjectLocationCacheItem=FO,h.RoomObjectLogicBase=mu,h.RoomObjectLogicFactory=lY,h.RoomObjectLogicType=w,h.RoomObjectManager=$O,h.RoomObjectModel=mg,h.RoomObjectMouseEvent=re,h.RoomObjectMoveEvent=hs,h.RoomObjectOperationType=_e,h.RoomObjectPlacementSource=_c,h.RoomObjectPlaySoundIdEvent=ri,h.RoomObjectRoomAdEvent=We,h.RoomObjectSamplePlaybackEvent=ut,h.RoomObjectSortableSpriteCacheItem=wO,h.RoomObjectSoundMachineEvent=ke,h.RoomObjectSprite=Ao,h.RoomObjectSpriteData=lg,h.RoomObjectSpriteType=cs,h.RoomObjectSpriteVisualization=Mn,h.RoomObjectStateChangedEvent=Me,h.RoomObjectTileMouseEvent=ii,h.RoomObjectType=hr,h.RoomObjectUpdateMessage=St,h.RoomObjectUserType=me,h.RoomObjectVariable=T,h.RoomObjectVisualizationFactory=nl,h.RoomObjectVisualizationType=G,h.RoomObjectWallMouseEvent=ma,h.RoomObjectWidgetRequestEvent=P,h.RoomOccupiedTilesMessageEvent=ww,h.RoomOccupiedTilesMessageParser=nC,h.RoomPaintEvent=v_,h.RoomPaintParser=aC,h.RoomPermissionsHandler=IY,h.RoomPetData=RY,h.RoomPlane=Ie,h.RoomPlaneBitmapMask=uI,h.RoomPlaneBitmapMaskData=Un,h.RoomPlaneBitmapMaskParser=Kp,h.RoomPlaneData=$e,h.RoomPlaneMaskData=O3,h.RoomPlaneParser=te,h.RoomPlaneRectangleMask=lI,h.RoomPollDataParser=fb,h.RoomPollResultEvent=fE,h.RoomPollResultParser=db,h.RoomPresentHandler=TY,h.RoomPreviewer=V,h.RoomReadyMessageEvent=Pa,h.RoomReadyMessageParser=oC,h.RoomRenderer=QO,h.RoomRendererFactory=ZO,h.RoomRightsClearEvent=$c,h.RoomRightsClearParser=JA,h.RoomRightsEvent=e_,h.RoomRightsOwnerEvent=t_,h.RoomRightsOwnerParser=$A,h.RoomRightsParser=ey,h.RoomRotatingEffect=_r,h.RoomScoreEvent=Iw,h.RoomScoreParser=vy,h.RoomSession=CY,h.RoomSessionChatEvent=Pe,h.RoomSessionConfirmPetBreedingEvent=$h,h.RoomSessionConfirmPetBreedingResultEvent=eu,h.RoomSessionDanceEvent=tu,h.RoomSessionDimmerPresetsEvent=Tc,h.RoomSessionDimmerPresetsEventPresetItem=hO,h.RoomSessionDoorbellEvent=ni,h.RoomSessionErrorMessageEvent=tt,h.RoomSessionEvent=ce,h.RoomSessionFavoriteGroupUpdateEvent=su,h.RoomSessionFriendRequestEvent=ru,h.RoomSessionHandler=sr,h.RoomSessionManager=MY,h.RoomSessionNestBreedingSuccessEvent=iu,h.RoomSessionPetBreedingEvent=nu,h.RoomSessionPetBreedingResultEvent=au,h.RoomSessionPetCommandsUpdateEvent=Rc,h.RoomSessionPetFigureUpdateEvent=ou,h.RoomSessionPetInfoUpdateEvent=hu,h.RoomSessionPetLevelUpdateEvent=uu,h.RoomSessionPetPackageEvent=pa,h.RoomSessionPetStatusUpdateEvent=lu,h.RoomSessionPollEvent=ai,h.RoomSessionPresentEvent=vc,h.RoomSessionPropertyUpdateEvent=Oc,h.RoomSessionQueueEvent=Cn,h.RoomSessionSpectatorModeEvent=Sc,h.RoomSessionUserBadgesEvent=cu,h.RoomSessionUserDataUpdateEvent=_u,h.RoomSessionUserFigureUpdateEvent=du,h.RoomSessionUserTagsEvent=Ac,h.RoomSessionVoteEvent=Ia,h.RoomSessionWordQuizEvent=oi,h.RoomSettingsComposer=Zk,h.RoomSettingsData=Vt,h.RoomSettingsDataEvent=qw,h.RoomSettingsDataParser=gy,h.RoomSettingsErrorEvent=Qw,h.RoomSettingsErrorParser=Ey,h.RoomSettingsSaveErrorEvent=Jw,h.RoomSettingsSaveErrorParser=Ms,h.RoomSettingsSavedEvent=Zw,h.RoomSettingsSavedParser=my,h.RoomSettingsUpdatedEvent=PF,h.RoomSettingsUpdatedParser=NN,h.RoomShakingEffect=dr,h.RoomSpriteCanvas=qO,h.RoomSpriteMouseEvent=aO,h.RoomTakeRightsComposer=pm,h.RoomTextSearchMessageComposer=Tk,h.RoomThumbnailUpdateResultEvent=NF,h.RoomThumbnailUpdateResultMessageParser=bN,h.RoomToObjectEvent=oO,h.RoomToObjectOwnAvatarMoveEvent=vo,h.RoomTradingLevelEnum=wi,h.RoomUnbanUserComposer=Kk,h.RoomUnitActionComposer=ep,h.RoomUnitChatComposer=k_,h.RoomUnitChatEvent=S_,h.RoomUnitChatParser=Bc,h.RoomUnitChatShoutComposer=Qm,h.RoomUnitChatShoutEvent=Fu,h.RoomUnitChatStyleComposer=OV,h.RoomUnitChatWhisperComposer=Zm,h.RoomUnitChatWhisperEvent=wu,h.RoomUnitDanceComposer=tp,h.RoomUnitDanceEvent=xu,h.RoomUnitDanceParser=TC,h.RoomUnitDropHandItemComposer=SV,h.RoomUnitEffectEvent=y_,h.RoomUnitEffectParser=RC,h.RoomUnitEvent=Gu,h.RoomUnitExpressionEvent=C_,h.RoomUnitExpressionParser=vC,h.RoomUnitGiveHandItemComposer=AV,h.RoomUnitGiveHandItemPetComposer=yV,h.RoomUnitHandItemEvent=M_,h.RoomUnitHandItemParser=OC,h.RoomUnitHandItemReceivedEvent=yE,h.RoomUnitHandItemReceivedParser=SC,h.RoomUnitIdleEvent=P_,h.RoomUnitIdleParser=AC,h.RoomUnitInfoEvent=Bu,h.RoomUnitInfoParser=yC,h.RoomUnitLookComposer=sp,h.RoomUnitNumberEvent=N_,h.RoomUnitNumberParser=CC,h.RoomUnitParser=MC,h.RoomUnitPostureComposer=rp,h.RoomUnitRemoveEvent=Hu,h.RoomUnitRemoveParser=PC,h.RoomUnitSignComposer=ip,h.RoomUnitStatusAction=NC,h.RoomUnitStatusEvent=b_,h.RoomUnitStatusMessage=bC,h.RoomUnitStatusParser=DC,h.RoomUnitTypingEvent=A_,h.RoomUnitTypingParser=IC,h.RoomUnitTypingStartComposer=Jm,h.RoomUnitTypingStopComposer=$m,h.RoomUnitWalkComposer=np,h.RoomUserData=vY,h.RoomUsersClassificationMessageComposer=Tp,h.RoomUsersHandler=OY,h.RoomUsersWithRightsComposer=Jk,h.RoomVariableEnum=ze,h.RoomVisitData=BP,h.RoomVisitsData=HP,h.RoomVisitsEvent=sF,h.RoomVisitsMessageParser=kP,h.RoomVisualization=qe,h.RoomVisualizationData=cI,h.RoomVisualizationSettingsEvent=O_,h.RoomVisualizationSettingsParser=hC,h.RoomWallData=xs,h.RoomWidgetEnum=ie,h.RoomWidgetEnumItemExtradataParameter=Ut,h.RoomWidgetFurniInfoUsagePolicyEnum=fc,h.RoomZoomEvent=pc,h.RoomsWhereMyFriendsAreSearchMessageComposer=pk,h.RoomsWithHighestScoreSearchMessageComposer=Ik,h.SSOTicketMessageComposer=QE,h.SanctionStatusEvent=TD,h.SanctionStatusMessageParser=SS,h.SaveRoomSettingsComposer=$k,h.SaveWardrobeOutfitMessageComposer=Dx,h.SaveableRoomSettingsData=aQ,h.ScrGetKickbackInfoMessageComposer=tj,h.ScrKickbackData=aM,h.ScrSendKickbackInfoMessageEvent=vx,h.ScrSendKickbackInfoMessageParser=oM,h.SearchFaqsMessageComposer=D2,h.SeasonalCalendarDailyOfferMessageEvent=sL,h.SeasonalCalendarDailyOfferMessageParser=cM,h.SeasonalQuestsMessageEvent=cw,h.SeasonalQuestsParser=Pb,h.SecondsUntilMessageEvent=dL,h.SecondsUntilMessageParser=SM,h.SecurityLevel=ur,h.SelectClubGiftComposer=mG,h.SelectedRoomObjectData=ad,h.SelectionArrowLogic=y3,h.SellablePetPaletteData=_M,h.SellablePetPalettesMessageEvent=rL,h.SellablePetPalettesParser=dM,h.SendMessageComposer=WG,h.SendRoomInviteComposer=zG,h.SessionDataManager=PY,h.SessionDataPreferencesEvent=fu,h.SetActivatedBadgesComposer=B2,h.SetClothingChangeDataMessageComposer=Mm,h.SetItemDataMessageComposer=Pm,h.SetObjectDataMessageComposer=Nm,h.SetPhoneNumberVerificationStatusMessageComposer=zE,h.SetRelationshipStatusComposer=XG,h.SetRoomSessionTagsMessageComposer=Rk,h.SetTargetedOfferStateComposer=pG,h.SetType=Mc,h.SetYoutubeDisplayPlaylistMessageComposer=pV,h.ShopTargetedOfferViewedComposer=IG,h.Short=sO,h.ShowEnforceRoomCategoryDialogEvent=$w,h.ShowEnforceRoomCategoryDialogParser=py,h.ShowMysteryBoxWaitMessageEvent=oF,h.ShowMysteryBoxWaitMessageParser=KP,h.SimpleAlertMessageEvent=WF,h.SimpleAlertMessageParser=QN,h.SizeData=Ua,h.SocketConnection=lO,h.SocketConnectionEvent=Ct,h.SongDataEntry=gI,h.SongDiskInventoryReceivedEvent=Xo,h.SongInfoEntry=qb,h.SongInfoReceivedEvent=Ko,h.SongStartRequestData=NY,h.SortableSprite=Ru,h.SoundManager=UY,h.SoundManagerEvent=qo,h.SpriteDataCollector=Is,h.SpriteDataContainer=vO,h.SpriteUtilities=XO,h.StartCampaignMessageComposer=jk,h.StartRoomPollEvent=gE,h.StringDataType=Mr,h.SubmitRoomToCompetitionMessageComposer=Vo,h.SystemChatStyleEnum=xi,h.TalentLevelUpEvent=ix,h.TalentLevelUpMessageParser=Jb,h.TalentTrackComposer=VV,h.TalentTrackLevel=$b,h.TalentTrackLevelMessageEvent=nx,h.TalentTrackLevelMessageParser=eD,h.TalentTrackMessageEvent=ax,h.TalentTrackParser=sD,h.TalentTrackRewardPerk=rD,h.TalentTrackRewardProduct=kg,h.TalentTrackTask=tD,h.TargetedOfferData=fM,h.TargetedOfferEvent=iL,h.TargetedOfferNotFoundEvent=nL,h.TargetedOfferNotFoundParser=gM,h.TargetedOfferParser=EM,h.TextureUtils=Je,h.ThreadMessagesMessageEvent=RU,h.ThreadMessagesMessageParser=F0,h.ThumbnailStatusMessageEvent=CD,h.ThumbnailStatusMessageParser=bS,h.TileCursorLogic=Fr,h.TileCursorVisualization=rY,h.TileObjectMap=nY,h.ToInt32=EI,h.TogglePetBreedingComposer=im,h.TogglePetRidingComposer=nm,h.ToggleStaffPickMessageComposer=vk,h.ToolbarIconEnum=$r,h.TouchEventType=Io,h.TradingAcceptComposer=Y2,h.TradingAcceptEvent=O1,h.TradingAcceptParser=XC,h.TradingCancelComposer=W2,h.TradingCloseComposer=z2,h.TradingCloseEvent=S1,h.TradingCloseParser=bg,h.TradingCompletedEvent=A1,h.TradingCompletedParser=KC,h.TradingConfirmationComposer=X2,h.TradingConfirmationEvent=y1,h.TradingConfirmationParser=qC,h.TradingListAddItemComposer=K2,h.TradingListAddItemsComposer=q2,h.TradingListItemEvent=C1,h.TradingListItemParser=QC,h.TradingListItemRemoveComposer=Q2,h.TradingNoSuchItemEvent=M1,h.TradingNoSuchItemParser=ZC,h.TradingNotOpenEvent=P1,h.TradingNotOpenParser=JC,h.TradingOpenComposer=Z2,h.TradingOpenEvent=N1,h.TradingOpenFailedEvent=b1,h.TradingOpenFailedParser=kc,h.TradingOpenParser=$C,h.TradingOtherNotAllowedEvent=D1,h.TradingOtherNotAllowedParser=eM,h.TradingUnacceptComposer=J2,h.TradingYouAreNotAllowedEvent=L1,h.TradingYouAreNotAllowedParser=tM,h.TraxChannel=DY,h.TraxChannelItem=LY,h.TraxData=hd,h.TraxSongInfoMessageEvent=bE,h.TraxSongInfoMessageParser=Qb,h.TriggerDefinition=Lb,h.Triggerable=zc,h.TryPhoneNumberMessageComposer=EB,h.TryPhoneNumberResultMessageEvent=oU,h.TryPhoneNumberResultParser=p0,h.TryVerificationCodeResultMessageEvent=hU,h.TryVerificationCodeResultParser=I0,h.TypingBubbleAddition=N3,h.UnblockGroupMemberMessageComposer=aj,h.UnignoreUserComposer=fp,h.UniqueIDMessageComposer=t2,h.UnloadGameMessageEvent=JL,h.UnloadGameMessageParser=c0,h.UnreadForumsCountMessageEvent=vU,h.UnreadForumsCountMessageParser=w0,h.UnseenItemsEvent=zF,h.UnseenItemsParser=ZN,h.UnseenResetCategoryComposer=$2,h.UnseenResetItemsComposer=eH,h.UpdateActionMessageComposer=DV,h.UpdateConditionMessageComposer=LV,h.UpdateFloorPropertiesMessageComposer=RV,h.UpdateForumReadMarkerEntry=rQ,h.UpdateForumReadMarkerMessageComposer=KB,h.UpdateForumSettingsMessageComposer=qB,h.UpdateHomeRoomMessageComposer=Ok,h.UpdateMessageMessageEvent=OU,h.UpdateMessageMessageParser=x0,h.UpdateRoomCategoryAndTradeSettingsComposer=FV,h.UpdateRoomFilterMessageComposer=Sk,h.UpdateRoomThumbnailMessageComposer=Ak,h.UpdateThreadMessageComposer=QB,h.UpdateThreadMessageEvent=SU,h.UpdateThreadMessageParser=G0,h.UpdateTriggerMessageComposer=UV,h.UsePetProductComposer=am,h.UserBannedMessageEvent=rF,h.UserBannedMessageParser=VP,h.UserChatlogData=jP,h.UserChatlogEvent=iF,h.UserChatlogMessageParser=YP,h.UserClassificationMessageEvent=Ax,h.UserClassificationMessageParser=iD,h.UserCreditsEvent=Ix,h.UserCreditsMessageParser=qq,h.UserCreditsParser=DA,h.UserCurrencyComposer=$V,h.UserCurrencyEvent=Tx,h.UserCurrencyParser=LA,h.UserCurrentBadgesComposer=gp,h.UserCurrentBadgesEvent=FE,h.UserCurrentBadgesParser=gA,h.UserDataManager=Br,h.UserEventCatsEvent=bF,h.UserEventCatsMessageParser=DN,h.UserFigureComposer=qV,h.UserFigureParser=Kq,h.UserFlatCatsEvent=DF,h.UserFlatCatsMessageParser=LN,h.UserGameAchievementsMessageEvent=$L,h.UserGameAchievementsMessageParser=_0,h.UserInfoDataParser=EA,h.UserInfoEvent=ku,h.UserInfoParser=mA,h.UserMessageData=ya,h.UserMottoComposer=Ep,h.UserNameChangeMessageEvent=L_,h.UserNameChangeMessageParser=pA,h.UserNameUpdateEvent=Oo,h.UserPermissionsEvent=LE,h.UserPermissionsParser=cA,h.UserProfileComposer=QV,h.UserProfileEvent=lx,h.UserProfileParser=IA,h.UserRelationshipsComposer=ZV,h.UserRespectComposer=pp,h.UserSettingsCameraFollowComposer=sj,h.UserSettingsEvent=cx,h.UserSettingsOldChatComposer=rj,h.UserSettingsParser=TA,h.UserSettingsRoomInvitesComposer=ij,h.UserSettingsSoundComposer=nj,h.UserSongDisksInventoryMessageEvent=DE,h.UserSongDisksInventoryMessageParser=Zb,h.UserSubscriptionComposer=ej,h.UserSubscriptionEvent=Rx,h.UserSubscriptionParser=bo,h.UserTagsMessageEvent=wE,h.UserTagsParser=RA,h.UserUnbannedFromRoomEvent=ex,h.UserUnbannedFromRoomParser=Iy,h.UserWardrobePageEvent=Ox,h.UserWardrobePageParser=hM,h.Vector3D=Hs,h.Vector3d=y,h.VerifyCodeMessageComposer=mB,h.VersionCheckMessageComposer=s2,h.VisitUserComposer=KG,h.VoteDataType=ca,h.VoteForRoomMessageComposer=CG,h.VotePollCounterMessageComposer=lm,h.VoucherRedeemErrorMessageEvent=aL,h.VoucherRedeemErrorMessageParser=mM,h.VoucherRedeemOkMessageEvent=oL,h.VoucherRedeemOkMessageParser=pM,h.Wait=SZ,h.WallPlane=il,h.WallRasterizer=sY,h.WardrobeMessageEvent=dD,h.WardrobeMessageParser=fS,h.WebSocketEventEnum=zs,h.WeeklyCompetitiveFriendsLeaderboardEvent=sU,h.WeeklyCompetitiveLeaderboardEvent=rU,h.WeeklyGameRewardEvent=iU,h.WeeklyGameRewardParser=f0,h.WeeklyGameRewardWinnersEvent=nU,h.WeeklyGameRewardWinnersParser=g0,h.WelcomeGiftChangeEmailComposer=oj,h.WelcomeGiftChangeEmailResultEvent=Sx,h.WelcomeGiftChangeEmailResultParser=uM,h.WelcomeGiftStatusEvent=Dw,h.WelcomeGiftStatusParser=Qy,h.WiredActionDefinition=Ub,h.WiredFurniActionEvent=xw,h.WiredFurniActionParser=Fb,h.WiredFurniConditionEvent=Gw,h.WiredFurniConditionParser=wb,h.WiredFurniTriggerEvent=Bw,h.WiredFurniTriggerParser=xb,h.WiredOpenEvent=Hw,h.WiredOpenParser=Gb,h.WiredRewardResultMessageEvent=D_,h.WiredRewardResultMessageParser=Bb,h.WiredSaveSuccessEvent=kw,h.WiredSaveSuccessParser=Hb,h.WiredValidationErrorEvent=Vw,h.WiredValidationErrorParser=kb,h.WordQuizHandler=SY,h.YouArePlayingGameEvent=vE,h.YouArePlayingGameParser=gC,h.YouAreSpectatorMessageEvent=OE,h.YouAreSpectatorMessageParser=EC,h.YoutubeControlVideoMessageEvent=Lw,h.YoutubeControlVideoMessageParser=Zy,h.YoutubeDisplayPlaylist=Jy,h.YoutubeDisplayPlaylistsEvent=Uw,h.YoutubeDisplayPlaylistsMessageParser=$y,h.YoutubeDisplayVideoMessageEvent=Fw,h.YoutubeDisplayVideoMessageParser=eC,h._Str_16135=Zq,h._Str_17532=Jq,h._Str_8728=qA,h._Str_9021=QA,Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})});
